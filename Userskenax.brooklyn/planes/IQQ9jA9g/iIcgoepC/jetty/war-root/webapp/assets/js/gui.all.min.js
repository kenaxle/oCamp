// > http://underscorejs.org
// > (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
// > Underscore may be freely distributed under the MIT license.

/*!
 * jQuery JavaScript Library v1.7.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Wed Mar 21 12:46:34 2012 -0700
 */

/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/**
 * @license RequireJS text 2.0.6 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
*/

// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

/* ===================================================
 * bootstrap-transition.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ==========================================================
 * bootstrap-alert.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ============================================================
 * bootstrap-button.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ==========================================================
 * bootstrap-carousel.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#carousel
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =============================================================
 * bootstrap-collapse.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ============================================================
 * bootstrap-dropdown.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =========================================================
 * bootstrap-modal.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ===========================================================
 * bootstrap-tooltip.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ===========================================================
 * bootstrap-popover.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */

/* =============================================================
 * bootstrap-scrollspy.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#scrollspy
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================== */

/* ========================================================
 * bootstrap-tab.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */

/* =============================================================
 * bootstrap-typeahead.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#typeahead
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/*
 * easy-autocomplete
 * jQuery plugin for autocompletion
 * 
 * @author Łukasz Pawełczak (http://github.com/pawelczak)
 * @version 1.3.3
 * Copyright MIT License: https://github.com/pawelczak/easy-autocomplete/blob/master/LICENSE.txt
 */

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

// moment.js
// version : 2.1.0
// author : Tim Wood
// license : MIT
// momentjs.com

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 *
 * ---
 *
 * This code has been created by the Apache Brooklyn contributors.
 * It is heavily based on earlier software but rewritten for readability 
 * and to preserve license integrity.
 *
 * Our influences are:
 *
 * * jquery.slideto.min.js in Swagger UI, provenance unknown, added in:
 *   https://github.com/wordnik/swagger-ui/commit/d2eb882e5262e135dfa3f5919796bbc3785880b8#diff-bd86720650a2ebd1ab11e870dc475564
 *
 *   Swagger UI is distributed under ASL but it is not clear that this code originated in that project.
 *   No other original author could be identified.
 *
 * * Nearly identical code referenced here:
 *   http://stackoverflow.com/questions/12375440/scrolling-works-in-chrome-but-not-in-firefox-or-ie
 *
 * Note that the project https://github.com/Sleavely/jQuery-slideto is NOT this.
 *
 */

/*
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

/*
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Released under MIT license.  See https://github.com/wycats/handlebars.js .

/*!
* ZeroClipboard
* The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
* Copyright (c) 2014 Jon Rohan, James M. Greene
* Licensed MIT
* http://zeroclipboard.org/
* v1.3.5
*
* BROOKLYN NOTE: The accompanying SWF artifact can also be built from source using a free toolchain
* as described at https://github.com/zeroclipboard/zeroclipboard/blob/master/CONTRIBUTING.md .
* (It has been included in the Apache project as a binary artifact because building it is tedious.
* Also- it is small!) This paragraph is the only change to this source file.
*/

/**
 * @summary     DataTables
 * @description Paginate, search and sort HTML tables
 * @version     1.9.4
 * @file        jquery.dataTables.js
 * @author      Allan Jardine (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 *
 * @copyright Copyright 2008-2012 Allan Jardine, all rights reserved.
 *
 * This source file is free software, under either the GPL v2 license or a
 * BSD style license, available at:
 *   http://datatables.net/license_gpl2
 *   http://datatables.net/license_bsd
 * 
 * This source file is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 * 
 * For details please refer to: http://www.datatables.net
 */

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 *
 * ---
 *
 * This code has been created by the Apache Brooklyn contributors.
 * It is heavily based on earlier software but rewritten for clarity 
 * and to preserve license integrity.
 *
 * This work is based on the existing jQuery DataTables plug-ins for:
 *
 * * fnStandingRedraw by Jonathan Hoguet, 
 *   http://www.datatables.net/plug-ins/api/fnStandingRedraw
 *
 * * fnProcessingIndicator by Allan Chappell
 *   https://www.datatables.net/plug-ins/api/fnProcessingIndicator
 *
 */

/*
 * Taken from http://code.google.com/p/js-uri/ v0.1.  BSD license.
 * No changes in this Brooklyn copy, apart from these header lines.
 * TODO Consider switching to  http://medialize.github.io/URI.js/  which appears more modern.
 * 
 *  
 * An URI datatype.  Based upon examples in RFC3986.
 *
 * TODO %-escaping
 * TODO split apart authority
 * TODO split apart query_string (on demand, anyway)
 *
 * @(#) $Id$
 */

/*!
 * jQuery Form Plugin
 * version: 3.09 (16-APR-2012)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

function URI(e){e||(e="");var t=/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/,n=e.match(t);this.scheme=n[1]||null,this.authority=n[2]||null,this.path=n[3]||null,this.query=n[4]||null,this.fragment=n[5]||null}(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?null:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,0,t):e[0]},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s},x.bind=function(e,t){if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));var n=u.call(arguments,2);return function(){return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);return t.length===0&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,f<=0?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]==null&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var O=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=O(e[o],t[o],n,r)))break}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)){o++;if(!(u=x.has(t,c)&&O(e[c],t[c],n,r)))break}if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return O(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(e);for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=x.invert(M.escape);var _={escape:new RegExp("["+x.keys(M.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(M.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(_[e],function(t){return M[e][t]})}}),x.result=function(e,t){if(e==null)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),j.call(this,n.apply(x,e))}})};var D=0;x.uniqueId=function(e){var t=++D+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||P).source,(n.interpolate||P).source,(n.evaluate||P).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(B,function(e){return"\\"+H[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var j=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],j.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(e,t){function u(e){var t=o[e]={},n,r;e=e.split(/\s+/);for(n=0,r=e.length;n<r;n++)t[e[n]]=!0;return t}function c(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(l,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:s.isNumeric(r)?+r:f.test(r)?s.parseJSON(r):r}catch(o){}s.data(e,n,r)}else r=t}return r}function h(e){for(var t in e){if(t==="data"&&s.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function p(e,t,n){var r=t+"defer",i=t+"queue",o=t+"mark",u=s._data(e,r);u&&(n==="queue"||!s._data(e,i))&&(n==="mark"||!s._data(e,o))&&setTimeout(function(){!s._data(e,i)&&!s._data(e,o)&&(s.removeData(e,r,!0),u.fire())},0)}function H(){return!1}function B(){return!0}function W(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function X(e,t,n){t=t||0;if(s.isFunction(t))return s.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return s.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=s.grep(e,function(e){return e.nodeType===1});if(q.test(t))return s.filter(t,r,!n);t=s.filter(t,r)}return s.grep(e,function(e,r){return s.inArray(e,t)>=0===n})}function V(e){var t=$.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function at(e,t){return s.nodeName(e,"table")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e,t){if(t.nodeType!==1||!s.hasData(e))return;var n,r,i,o=s._data(e),u=s._data(t,o),a=o.events;if(a){delete u.handle,u.events={};for(n in a)for(r=0,i=a[n].length;r<i;r++)s.event.add(t,n,a[n][r])}u.data&&(u.data=s.extend({},u.data))}function lt(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?t.outerHTML=e.outerHTML:n!=="input"||e.type!=="checkbox"&&e.type!=="radio"?n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text):(e.checked&&(t.defaultChecked=t.checked=e.checked),t.value!==e.value&&(t.value=e.value)),t.removeAttribute(s.expando),t.removeAttribute("_submit_attached"),t.removeAttribute("_change_attached")}function ct(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function ht(e){if(e.type==="checkbox"||e.type==="radio")e.defaultChecked=e.checked}function pt(e){var t=(e.nodeName||"").toLowerCase();t==="input"?ht(e):t!=="script"&&typeof e.getElementsByTagName!="undefined"&&s.grep(e.getElementsByTagName("input"),ht)}function dt(e){var t=n.createElement("div");return ut.appendChild(t),t.innerHTML=e.outerHTML,t.firstChild}function kt(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=t==="width"?1:0,o=4;if(r>0){if(n!=="border")for(;i<o;i+=2)n||(r-=parseFloat(s.css(e,"padding"+xt[i]))||0),n==="margin"?r+=parseFloat(s.css(e,n+xt[i]))||0:r-=parseFloat(s.css(e,"border"+xt[i]+"Width"))||0;return r+"px"}r=Tt(e,t);if(r<0||r==null)r=e.style[t];if(bt.test(r))return r;r=parseFloat(r)||0;if(n)for(;i<o;i+=2)r+=parseFloat(s.css(e,"padding"+xt[i]))||0,n!=="padding"&&(r+=parseFloat(s.css(e,"border"+xt[i]+"Width"))||0),n==="margin"&&(r+=parseFloat(s.css(e,n+xt[i]))||0);return r+"px"}function Qt(e){return function(t,n){typeof t!="string"&&(n=t,t="*");if(s.isFunction(n)){var r=t.toLowerCase().split(qt),i=0,o=r.length,u,a,f;for(;i<o;i++)u=r[i],f=/^\+/.test(u),f&&(u=u.substr(1)||"*"),a=e[u]=e[u]||[],a[f?"unshift":"push"](n)}}}function Gt(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u=e[s],a=0,f=u?u.length:0,l=e===Wt,c;for(;a<f&&(l||!c);a++)c=u[a](n,r,i),typeof c=="string"&&(!l||o[c]?c=t:(n.dataTypes.unshift(c),c=Gt(e,n,r,i,c,o)));return(l||!c)&&!o["*"]&&(c=Gt(e,n,r,i,"*",o)),c}function Yt(e,n){var r,i,o=s.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);i&&s.extend(!0,e,i)}function Zt(e,t,n,r){if(s.isArray(t))s.each(t,function(t,i){n||At.test(e)?r(e,i):Zt(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&s.type(t)==="object")for(var i in t)Zt(e+"["+i+"]",t[i],n,r);else r(e,t)}function en(e,n,r){var i=e.contents,s=e.dataTypes,o=e.responseFields,u,a,f,l;for(a in o)a in r&&(n[o[a]]=r[a]);while(s[0]==="*")s.shift(),u===t&&(u=e.mimeType||n.getResponseHeader("content-type"));if(u)for(a in i)if(i[a]&&i[a].test(u)){s.unshift(a);break}if(s[0]in r)f=s[0];else{for(a in r){if(!s[0]||e.converters[a+" "+s[0]]){f=a;break}l||(l=a)}f=f||l}if(f)return f!==s[0]&&s.unshift(f),r[f]}function tn(e,n){e.dataFilter&&(n=e.dataFilter(n,e.dataType));var r=e.dataTypes,i={},o,u,a=r.length,f,l=r[0],c,h,p,d,v;for(o=1;o<a;o++){if(o===1)for(u in e.converters)typeof u=="string"&&(i[u.toLowerCase()]=e.converters[u]);c=l,l=r[o];if(l==="*")l=c;else if(c!=="*"&&c!==l){h=c+" "+l,p=i[h]||i["* "+l];if(!p){v=t;for(d in i){f=d.split(" ");if(f[0]===c||f[0]==="*"){v=i[f[1]+" "+l];if(v){d=i[d],d===!0?p=v:v===!0&&(p=d);break}}}}!p&&!v&&s.error("No conversion from "+h.replace(" "," to ")),p!==!0&&(n=p?p(n):v(d(n)))}}return n}function an(){try{return new e.XMLHttpRequest}catch(t){}}function fn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function yn(){return setTimeout(bn,0),gn=s.now()}function bn(){gn=t}function wn(e,t){var n={};return s.each(mn.concat.apply([],mn.slice(0,t)),function(){n[this]=e}),n}function En(e){if(!ln[e]){var t=n.body,r=s("<"+e+">").appendTo(t),i=r.css("display");r.remove();if(i==="none"||i===""){cn||(cn=n.createElement("iframe"),cn.frameBorder=cn.width=cn.height=0),t.appendChild(cn);if(!hn||!cn.createElement)hn=(cn.contentWindow||cn.contentDocument).document,hn.write((s.support.boxModel?"<!doctype html>":"")+"<html><body>"),hn.close();r=hn.createElement(e),hn.body.appendChild(r),i=s.css(r,"display"),t.removeChild(cn)}ln[e]=i}return ln[e]}function Nn(e){return s.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n=e.document,r=e.navigator,i=e.location,s=function(){function H(){if(i.isReady)return;try{n.documentElement.doScroll("left")}catch(e){setTimeout(H,1);return}i.ready()}var i=function(e,t){return new i.fn.init(e,t,u)},s=e.jQuery,o=e.$,u,a=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,f=/\S/,l=/^\s+/,c=/\s+$/,h=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,p=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,v=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,m=/(?:^|:|,)(?:\s*\[)+/g,g=/(webkit)[ \/]([\w.]+)/,y=/(opera)(?:.*version)?[ \/]([\w.]+)/,b=/(msie) ([\w.]+)/,w=/(mozilla)(?:.*? rv:([\w.]+))?/,E=/-([a-z]|[0-9])/ig,S=/^-ms-/,x=function(e,t){return(t+"").toUpperCase()},T=r.userAgent,N,C,k,L=Object.prototype.toString,A=Object.prototype.hasOwnProperty,O=Array.prototype.push,M=Array.prototype.slice,_=String.prototype.trim,D=Array.prototype.indexOf,P={};return i.fn=i.prototype={constructor:i,init:function(e,r,s){var o,u,f,l;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(e==="body"&&!r&&n.body)return this.context=n,this[0]=n.body,this.selector=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?o=[null,e,null]:o=a.exec(e);if(o&&(o[1]||!r)){if(o[1])return r=r instanceof i?r[0]:r,l=r?r.ownerDocument||r:n,f=h.exec(e),f?i.isPlainObject(r)?(e=[n.createElement(f[1])],i.fn.attr.call(e,r,!0)):e=[l.createElement(f[1])]:(f=i.buildFragment([o[1]],[l]),e=(f.cacheable?i.clone(f.fragment):f.fragment).childNodes),i.merge(this,e);u=n.getElementById(o[2]);if(u&&u.parentNode){if(u.id!==o[2])return s.find(e);this.length=1,this[0]=u}return this.context=n,this.selector=e,this}return!r||r.jquery?(r||s).find(e):this.constructor(r).find(e)}return i.isFunction(e)?s.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),i.makeArray(e,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return M.call(this,0)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=this.constructor();return i.isArray(e)?O.apply(r,e):i.merge(r,e),r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return i.each(this,e,t)},ready:function(e){return i.bindReady(),C.add(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(M.apply(this,arguments),"slice",M.call(arguments).join(","))},map:function(e){return this.pushStack(i.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:O,sort:[].sort,splice:[].splice},i.fn.init.prototype=i.fn,i.extend=i.fn.extend=function(){var e,n,r,s,o,u,a=arguments[0]||{},f=1,l=arguments.length,c=!1;typeof a=="boolean"&&(c=a,a=arguments[1]||{},f=2),typeof a!="object"&&!i.isFunction(a)&&(a={}),l===f&&(a=this,--f);for(;f<l;f++)if((e=arguments[f])!=null)for(n in e){r=a[n],s=e[n];if(a===s)continue;c&&s&&(i.isPlainObject(s)||(o=i.isArray(s)))?(o?(o=!1,u=r&&i.isArray(r)?r:[]):u=r&&i.isPlainObject(r)?r:{},a[n]=i.extend(c,u,s)):s!==t&&(a[n]=s)}return a},i.extend({noConflict:function(t){return e.$===i&&(e.$=o),t&&e.jQuery===i&&(e.jQuery=s),i},isReady:!1,readyWait:1,holdReady:function(e){e?i.readyWait++:i.ready(!0)},ready:function(e){if(e===!0&&!--i.readyWait||e!==!0&&!i.isReady){if(!n.body)return setTimeout(i.ready,1);i.isReady=!0;if(e!==!0&&--i.readyWait>0)return;C.fireWith(n,[i]),i.fn.trigger&&i(n).trigger("ready").off("ready")}},bindReady:function(){if(C)return;C=i.Callbacks("once memory");if(n.readyState==="complete")return setTimeout(i.ready,1);if(n.addEventListener)n.addEventListener("DOMContentLoaded",k,!1),e.addEventListener("load",i.ready,!1);else if(n.attachEvent){n.attachEvent("onreadystatechange",k),e.attachEvent("onload",i.ready);var t=!1;try{t=e.frameElement==null}catch(r){}n.documentElement.doScroll&&t&&H()}},isFunction:function(e){return i.type(e)==="function"},isArray:Array.isArray||function(e){return i.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):P[L.call(e)]||"object"},isPlainObject:function(e){if(!e||i.type(e)!=="object"||e.nodeType||i.isWindow(e))return!1;try{if(e.constructor&&!A.call(e,"constructor")&&!A.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||A.call(e,r)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw new Error(e)},parseJSON:function(t){if(typeof t!="string"||!t)return null;t=i.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(p.test(t.replace(d,"@").replace(v,"]").replace(m,"")))return(new Function("return "+t))();i.error("Invalid JSON: "+t)},parseXML:function(n){if(typeof n!="string"||!n)return null;var r,s;try{e.DOMParser?(s=new DOMParser,r=s.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&i.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&f.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(S,"ms-").replace(E,x)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,n,r){var s,o=0,u=e.length,a=u===t||i.isFunction(e);if(r){if(a){for(s in e)if(n.apply(e[s],r)===!1)break}else for(;o<u;)if(n.apply(e[o++],r)===!1)break}else if(a){for(s in e)if(n.call(e[s],s,e[s])===!1)break}else for(;o<u;)if(n.call(e[o],o,e[o++])===!1)break;return e},trim:_?function(e){return e==null?"":_.call(e)}:function(e){return e==null?"":e.toString().replace(l,"").replace(c,"")},makeArray:function(e,t){var n=t||[];if(e!=null){var r=i.type(e);e.length==null||r==="string"||r==="function"||r==="regexp"||i.isWindow(e)?O.call(n,e):i.merge(n,e)}return n},inArray:function(e,t,n){var r;if(t){if(D)return D.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=e.length,i=0;if(typeof n.length=="number")for(var s=n.length;i<s;i++)e[r++]=n[i];else while(n[i]!==t)e[r++]=n[i++];return e.length=r,e},grep:function(e,t,n){var r=[],i;n=!!n;for(var s=0,o=e.length;s<o;s++)i=!!t(e[s],s),n!==i&&r.push(e[s]);return r},map:function(e,n,r){var s,o,u=[],a=0,f=e.length,l=e instanceof i||f!==t&&typeof f=="number"&&(f>0&&e[0]&&e[f-1]||f===0||i.isArray(e));if(l)for(;a<f;a++)s=n(e[a],a,r),s!=null&&(u[u.length]=s);else for(o in e)s=n(e[o],o,r),s!=null&&(u[u.length]=s);return u.concat.apply([],u)},guid:1,proxy:function(e,n){if(typeof n=="string"){var r=e[n];n=e,e=r}if(!i.isFunction(e))return t;var s=M.call(arguments,2),o=function(){return e.apply(n,s.concat(M.call(arguments)))};return o.guid=e.guid=e.guid||o.guid||i.guid++,o},access:function(e,n,r,s,o,u,a){var f,l=r==null,c=0,h=e.length;if(r&&typeof r=="object"){for(c in r)i.access(e,n,c,r[c],1,u,s);o=1}else if(s!==t){f=a===t&&i.isFunction(s),l&&(f?(f=n,n=function(e,t,n){return f.call(i(e),n)}):(n.call(e,s),n=null));if(n)for(;c<h;c++)n(e[c],r,f?s.call(e[c],c,n(e[c],r)):s,a);o=1}return o?e:l?n.call(e):h?n(e[0],r):u},now:function(){return(new Date).getTime()},uaMatch:function(e){e=e.toLowerCase();var t=g.exec(e)||y.exec(e)||b.exec(e)||e.indexOf("compatible")<0&&w.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},sub:function(){function e(t,n){return new e.fn.init(t,n)}i.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,s){return s&&s instanceof i&&!(s instanceof e)&&(s=e(s)),i.fn.init.call(this,r,s,t)},e.fn.init.prototype=e.fn;var t=e(n);return e},browser:{}}),i.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){P["[object "+t+"]"]=t.toLowerCase()}),N=i.uaMatch(T),N.browser&&(i.browser[N.browser]=!0,i.browser.version=N.version),i.browser.webkit&&(i.browser.safari=!0),f.test(" ")&&(l=/^[\s\xA0]+/,c=/[\s\xA0]+$/),u=i(n),n.addEventListener?k=function(){n.removeEventListener("DOMContentLoaded",k,!1),i.ready()}:n.attachEvent&&(k=function(){n.readyState==="complete"&&(n.detachEvent("onreadystatechange",k),i.ready())}),i}(),o={};s.Callbacks=function(e){e=e?o[e]||u(e):{};var n=[],r=[],i,a,f,l,c,h,p=function(t){var r,i,o,u,a;for(r=0,i=t.length;r<i;r++)o=t[r],u=s.type(o),u==="array"?p(o):u==="function"&&(!e.unique||!v.has(o))&&n.push(o)},d=function(t,s){s=s||[],i=!e.memory||[t,s],a=!0,f=!0,h=l||0,l=0,c=n.length;for(;n&&h<c;h++)if(n[h].apply(t,s)===!1&&e.stopOnFalse){i=!0;break}f=!1,n&&(e.once?i===!0?v.disable():n=[]:r&&r.length&&(i=r.shift(),v.fireWith(i[0],i[1])))},v={add:function(){if(n){var e=n.length;p(arguments),f?c=n.length:i&&i!==!0&&(l=e,d(i[0],i[1]))}return this},remove:function(){if(n){var t=arguments,r=0,i=t.length;for(;r<i;r++)for(var s=0;s<n.length;s++)if(t[r]===n[s]){f&&s<=c&&(c--,s<=h&&h--),n.splice(s--,1);if(e.unique)break}}return this},has:function(e){if(n){var t=0,r=n.length;for(;t<r;t++)if(e===n[t])return!0}return!1},empty:function(){return n=[],this},disable:function(){return n=r=i=t,this},disabled:function(){return!n},lock:function(){return r=t,(!i||i===!0)&&v.disable(),this},locked:function(){return!r},fireWith:function(t,n){return r&&(f?e.once||r.push([t,n]):(!e.once||!i)&&d(t,n)),this},fire:function(){return v.fireWith(this,arguments),this},fired:function(){return!!a}};return v};var a=[].slice;s.extend({Deferred:function(e){var t=s.Callbacks("once memory"),n=s.Callbacks("once memory"),r=s.Callbacks("memory"),i="pending",o={resolve:t,reject:n,notify:r},u={done:t.add,fail:n.add,progress:r.add,state:function(){return i},isResolved:t.fired,isRejected:n.fired,then:function(e,t,n){return a.done(e).fail(t).progress(n),this},always:function(){return a.done.apply(a,arguments).fail.apply(a,arguments),this},pipe:function(e,t,n){return s.Deferred(function(r){s.each({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n=t[0],i=t[1],o;s.isFunction(n)?a[e](function(){o=n.apply(this,arguments),o&&s.isFunction(o.promise)?o.promise().then(r.resolve,r.reject,r.notify):r[i+"With"](this===a?r:this,[o])}):a[e](r[i])})}).promise()},promise:function(e){if(e==null)e=u;else for(var t in u)e[t]=u[t];return e}},a=u.promise({}),f;for(f in o)a[f]=o[f].fire,a[f+"With"]=o[f].fireWith;return a.done(function(){i="resolved"},n.disable,r.lock).fail(function(){i="rejected"},t.disable,r.lock),e&&e.call(a,a),a},when:function(e){function c(e){return function(n){t[e]=arguments.length>1?a.call(arguments,0):n,--o||f.resolveWith(f,t)}}function h(e){return function(t){i[e]=arguments.length>1?a.call(arguments,0):t,f.notifyWith(l,i)}}var t=a.call(arguments,0),n=0,r=t.length,i=new Array(r),o=r,u=r,f=r<=1&&e&&s.isFunction(e.promise)?e:s.Deferred(),l=f.promise();if(r>1){for(;n<r;n++)t[n]&&t[n].promise&&s.isFunction(t[n].promise)?t[n].promise().then(c(n),f.reject,h(n)):--o;o||f.resolveWith(f,t)}else f!==e&&f.resolveWith(f,r?[e]:[]);return l}}),s.support=function(){var t,r,i,o,u,a,f,l,c,h,p,d,v=n.createElement("div"),m=n.documentElement;v.setAttribute("className","t"),v.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",r=v.getElementsByTagName("*"),i=v.getElementsByTagName("a")[0];if(!r||!r.length||!i)return{};o=n.createElement("select"),u=o.appendChild(n.createElement("option")),a=v.getElementsByTagName("input")[0],t={leadingWhitespace:v.firstChild.nodeType===3,tbody:!v.getElementsByTagName("tbody").length,htmlSerialize:!!v.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:i.getAttribute("href")==="/a",opacity:/^0.55/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:a.value==="on",optSelected:u.selected,getSetAttribute:v.className!=="t",enctype:!!n.createElement("form").enctype,html5Clone:n.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},s.boxModel=t.boxModel=n.compatMode==="CSS1Compat",a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!u.disabled;try{delete v.test}catch(g){t.deleteExpando=!1}!v.addEventListener&&v.attachEvent&&v.fireEvent&&(v.attachEvent("onclick",function(){t.noCloneEvent=!1}),v.cloneNode(!0).fireEvent("onclick")),a=n.createElement("input"),a.value="t",a.setAttribute("type","radio"),t.radioValue=a.value==="t",a.setAttribute("checked","checked"),a.setAttribute("name","t"),v.appendChild(a),f=n.createDocumentFragment(),f.appendChild(v.lastChild),t.checkClone=f.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=a.checked,f.removeChild(a),f.appendChild(v);if(v.attachEvent)for(p in{submit:1,change:1,focusin:1})h="on"+p,d=h in v,d||(v.setAttribute(h,"return;"),d=typeof v[h]=="function"),t[p+"Bubbles"]=d;return f.removeChild(v),f=o=u=v=a=null,s(function(){var r,i,o,u,a,f,c,h,p,m,g,y,b,w=n.getElementsByTagName("body")[0];if(!w)return;h=1,b="padding:0;margin:0;border:",g="position:absolute;top:0;left:0;width:1px;height:1px;",y=b+"0;visibility:hidden;",p="style='"+g+b+"5px solid #000;",m="<div "+p+"display:block;'><div style='"+b+"0;display:block;overflow:hidden;'></div></div>"+"<table "+p+"' cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",r=n.createElement("div"),r.style.cssText=y+"width:0;height:0;position:static;top:0;margin-top:"+h+"px",w.insertBefore(r,w.firstChild),v=n.createElement("div"),r.appendChild(v),v.innerHTML="<table><tr><td style='"+b+"0;display:none'></td><td>t</td></tr></table>",l=v.getElementsByTagName("td"),d=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",t.reliableHiddenOffsets=d&&l[0].offsetHeight===0,e.getComputedStyle&&(v.innerHTML="",c=n.createElement("div"),c.style.width="0",c.style.marginRight="0",v.style.width="2px",v.appendChild(c),t.reliableMarginRight=(parseInt((e.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0)===0),typeof v.style.zoom!="undefined"&&(v.innerHTML="",v.style.width=v.style.padding="1px",v.style.border=0,v.style.overflow="hidden",v.style.display="inline",v.style.zoom=1,t.inlineBlockNeedsLayout=v.offsetWidth===3,v.style.display="block",v.style.overflow="visible",v.innerHTML="<div style='width:5px;'></div>",t.shrinkWrapBlocks=v.offsetWidth!==3),v.style.cssText=g+y,v.innerHTML=m,i=v.firstChild,o=i.firstChild,a=i.nextSibling.firstChild.firstChild,f={doesNotAddBorder:o.offsetTop!==5,doesAddBorderForTableAndCells:a.offsetTop===5},o.style.position="fixed",o.style.top="20px",f.fixedPosition=o.offsetTop===20||o.offsetTop===15,o.style.position=o.style.top="",i.style.overflow="hidden",i.style.position="relative",f.subtractsBorderForOverflowNotVisible=o.offsetTop===-5,f.doesNotIncludeMarginInBodyOffset=w.offsetTop!==h,e.getComputedStyle&&(v.style.marginTop="1%",t.pixelMargin=(e.getComputedStyle(v,null)||{marginTop:0}).marginTop!=="1%"),typeof r.style.zoom!="undefined"&&(r.style.zoom=1),w.removeChild(r),c=v=r=null,s.extend(t,f)}),t}();var f=/^(?:\{.*\}|\[.*\])$/,l=/([A-Z])/g;s.extend({cache:{},uuid:0,expando:"jQuery"+(s.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?s.cache[e[s.expando]]:e[s.expando],!!e&&!h(e)},data:function(e,n,r,i){if(!s.acceptData(e))return;var o,u,a,f=s.expando,l=typeof n=="string",c=e.nodeType,h=c?s.cache:e,p=c?e[f]:e[f]&&f,d=n==="events";if((!p||!h[p]||!d&&!i&&!h[p].data)&&l&&r===t)return;p||(c?e[f]=p=++s.uuid:p=f),h[p]||(h[p]={},c||(h[p].toJSON=s.noop));if(typeof n=="object"||typeof n=="function")i?h[p]=s.extend(h[p],n):h[p].data=s.extend(h[p].data,n);return o=u=h[p],i||(u.data||(u.data={}),u=u.data),r!==t&&(u[s.camelCase(n)]=r),d&&!u[n]?o.events:(l?(a=u[n],a==null&&(a=u[s.camelCase(n)])):a=u,a)},removeData:function(e,t,n){if(!s.acceptData(e))return;var r,i,o,u=s.expando,a=e.nodeType,f=a?s.cache:e,l=a?e[u]:u;if(!f[l])return;if(t){r=n?f[l]:f[l].data;if(r){s.isArray(t)||(t in r?t=[t]:(t=s.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,o=t.length;i<o;i++)delete r[t[i]];if(!(n?h:s.isEmptyObject)(r))return}}if(!n){delete f[l].data;if(!h(f[l]))return}s.support.deleteExpando||!f.setInterval?delete f[l]:f[l]=null,a&&(s.support.deleteExpando?delete e[u]:e.removeAttribute?e.removeAttribute(u):e[u]=null)},_data:function(e,t,n){return s.data(e,t,n,!0)},acceptData:function(e){if(e.nodeName){var t=s.noData[e.nodeName.toLowerCase()];if(t)return t!==!0&&e.getAttribute("classid")===t}return!0}}),s.fn.extend({data:function(e,n){var r,i,o,u,a,f=this[0],l=0,h=null;if(e===t){if(this.length){h=s.data(f);if(f.nodeType===1&&!s._data(f,"parsedAttrs")){o=f.attributes;for(a=o.length;l<a;l++)u=o[l].name,u.indexOf("data-")===0&&(u=s.camelCase(u.substring(5)),c(f,u,h[u]));s._data(f,"parsedAttrs",!0)}}return h}return typeof e=="object"?this.each(function(){s.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",s.access(this,function(n){if(n===t)return h=this.triggerHandler("getData"+i,[r[0]]),h===t&&f&&(h=s.data(f,e),h=c(f,e,h)),h===t&&r[1]?this.data(r[0]):h;r[1]=n,this.each(function(){var t=s(this);t.triggerHandler("setData"+i,r),s.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){s.removeData(this,e)})}}),s.extend({_mark:function(e,t){e&&(t=(t||"fx")+"mark",s._data(e,t,(s._data(e,t)||0)+1))},_unmark:function(e,t,n){e!==!0&&(n=t,t=e,e=!1);if(t){n=n||"fx";var r=n+"mark",i=e?0:(s._data(t,r)||1)-1;i?s._data(t,r,i):(s.removeData(t,r,!0),p(t,n,"mark"))}},queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=s._data(e,t),n&&(!r||s.isArray(n)?r=s._data(e,t,s.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=s.queue(e,t),r=n.shift(),i={};r==="inprogress"&&(r=n.shift()),r&&(t==="fx"&&n.unshift("inprogress"),s._data(e,t+".run",i),r.call(e,function(){s.dequeue(e,t)},i)),n.length||(s.removeData(e,t+"queue "+t+".run",!0),p(e,t,"queue"))}}),s.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?s.queue(this[0],e):n===t?this:this.each(function(){var t=s.queue(this,e,n);e==="fx"&&t[0]!=="inprogress"&&s.dequeue(this,e)})},dequeue:function(e){return this.each(function(){s.dequeue(this,e)})},delay:function(e,t){return e=s.fx?s.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){function h(){--u||r.resolveWith(i,[i])}typeof e!="string"&&(n=e,e=t),e=e||"fx";var r=s.Deferred(),i=this,o=i.length,u=1,a=e+"defer",f=e+"queue",l=e+"mark",c;while(o--)if(c=s.data(i[o],a,t,!0)||(s.data(i[o],f,t,!0)||s.data(i[o],l,t,!0))&&s.data(i[o],a,s.Callbacks("once memory"),!0))u++,c.add(h);return h(),r.promise(n)}});var d=/[\n\t\r]/g,v=/\s+/,m=/\r/g,g=/^(?:button|input)$/i,y=/^(?:button|input|object|select|textarea)$/i,b=/^a(?:rea)?$/i,w=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,E=s.support.getSetAttribute,S,x,T;s.fn.extend({attr:function(e,t){return s.access(this,s.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){s.removeAttr(this,e)})},prop:function(e,t){return s.access(this,s.prop,e,t,arguments.length>1)},removeProp:function(e){return e=s.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,u,a;if(s.isFunction(e))return this.each(function(t){s(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(v);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{o=" "+i.className+" ";for(u=0,a=t.length;u<a;u++)~o.indexOf(" "+t[u]+" ")||(o+=t[u]+" ");i.className=s.trim(o)}}}return this},removeClass:function(e){var n,r,i,o,u,a,f;if(s.isFunction(e))return this.each(function(t){s(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(v);for(r=0,i=this.length;r<i;r++){o=this[r];if(o.nodeType===1&&o.className)if(e){u=(" "+o.className+" ").replace(d," ");for(a=0,f=n.length;a<f;a++)u=u.replace(" "+n[a]+" "," ");o.className=s.trim(u)}else o.className=""}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return s.isFunction(e)?this.each(function(n){s(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,o=0,u=s(this),a=t,f=e.split(v);while(i=f[o++])a=r?a:!u.hasClass(i),u[a?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&s._data(this,"__className__",this.className),this.className=this.className||e===!1?"":s._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(d," ").indexOf(t)>-1)return!0;return!1},val:function(e){var n,r,i,o=this[0];if(!arguments.length){if(o)return n=s.valHooks[o.type]||s.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(o,"value"))!==t?r:(r=o.value,typeof r=="string"?r.replace(m,""):r==null?"":r);return}return i=s.isFunction(e),this.each(function(r){var o=s(this),u;if(this.nodeType!==1)return;i?u=e.call(this,r,o.val()):u=e,u==null?u="":typeof u=="number"?u+="":s.isArray(u)&&(u=s.map(u,function(e){return e==null?"":e+""})),n=s.valHooks[this.type]||s.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,u,"value")===t)this.value=u})}}),s.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r,i,o=e.selectedIndex,u=[],a=e.options,f=e.type==="select-one";if(o<0)return null;n=f?o:0,r=f?o+1:a.length;for(;n<r;n++){i=a[n];if(i.selected&&(s.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!s.nodeName(i.parentNode,"optgroup"))){t=s(i).val();if(f)return t;u.push(t)}}return f&&!u.length&&a.length?s(a[o]).val():u},set:function(e,t){var n=s.makeArray(t);return s(e).find("option").each(function(){this.selected=s.inArray(s(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(e,n,r,i){var o,u,a,f=e.nodeType;if(!e||f===3||f===8||f===2)return;if(i&&n in s.attrFn)return s(e)[n](r);if(typeof e.getAttribute=="undefined")return s.prop(e,n,r);a=f!==1||!s.isXMLDoc(e),a&&(n=n.toLowerCase(),u=s.attrHooks[n]||(w.test(n)?x:S));if(r!==t){if(r===null){s.removeAttr(e,n);return}return u&&"set"in u&&a&&(o=u.set(e,r,n))!==t?o:(e.setAttribute(n,""+r),r)}return u&&"get"in u&&a&&(o=u.get(e,n))!==null?o:(o=e.getAttribute(n),o===null?t:o)},removeAttr:function(e,t){var n,r,i,o,u,a=0;if(t&&e.nodeType===1){r=t.toLowerCase().split(v),o=r.length;for(;a<o;a++)i=r[a],i&&(n=s.propFix[i]||i,u=w.test(i),u||s.attr(e,i,""),e.removeAttribute(E?i:n),u&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(g.test(e.nodeName)&&e.parentNode)s.error("type property can't be changed");else if(!s.support.radioValue&&t==="radio"&&s.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return S&&s.nodeName(e,"button")?S.get(e,t):t in e?e.value:null},set:function(e,t,n){if(S&&s.nodeName(e,"button"))return S.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;return u=a!==1||!s.isXMLDoc(e),u&&(n=s.propFix[n]||n,o=s.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&(i=o.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):y.test(e.nodeName)||b.test(e.nodeName)&&e.href?0:t}}}}),s.attrHooks.tabindex=s.propHooks.tabIndex,x={get:function(e,n){var r,i=s.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?s.removeAttr(e,n):(r=s.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},E||(T={name:!0,id:!0,coords:!0},S=s.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(T[n]?r.nodeValue!=="":r.specified)?r.nodeValue:t},set:function(e,t,r){var i=e.getAttributeNode(r);return i||(i=n.createAttribute(r),e.setAttributeNode(i)),i.nodeValue=t+""}},s.attrHooks.tabindex.set=S.set,s.each(["width","height"],function(e,t){s.attrHooks[t]=s.extend(s.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),s.attrHooks.contenteditable={get:S.get,set:function(e,t,n){t===""&&(t="false"),S.set(e,t,n)}}),s.support.hrefNormalized||s.each(["href","src","width","height"],function(e,n){s.attrHooks[n]=s.extend(s.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),s.support.style||(s.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),s.support.optSelected||(s.propHooks.selected=s.extend(s.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),s.support.enctype||(s.propFix.enctype="encoding"),s.support.checkOn||s.each(["radio","checkbox"],function(){s.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),s.each(["radio","checkbox"],function(){s.valHooks[this]=s.extend(s.valHooks[this],{set:function(e,t){if(s.isArray(t))return e.checked=s.inArray(s(e).val(),t)>=0}})});var N=/^(?:textarea|input|select)$/i,C=/^([^\.]*)?(?:\.(.+))?$/,k=/(?:^|\s)hover(\.\S+)?\b/,L=/^key/,A=/^(?:mouse|contextmenu)|click/,O=/^(?:focusinfocus|focusoutblur)$/,M=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,_=function(e){var t=M.exec(e);return t&&(t[1]=(t[1]||"").toLowerCase(),t[3]=t[3]&&new RegExp("(?:^|\\s)"+t[3]+"(?:\\s|$)")),t},D=function(e,t){var n=e.attributes||{};return(!t[1]||e.nodeName.toLowerCase()===t[1])&&(!t[2]||(n.id||{}).value===t[2])&&(!t[3]||t[3].test((n["class"]||{}).value))},P=function(e){return s.event.special.hover?e:e.replace(k,"mouseenter$1 mouseleave$1")};s.event={add:function(e,n,r,i,o){var u,a,f,l,c,h,p,d,v,m,g,y;if(e.nodeType===3||e.nodeType===8||!n||!r||!(u=s._data(e)))return;r.handler&&(v=r,r=v.handler,o=v.selector),r.guid||(r.guid=s.guid++),f=u.events,f||(u.events=f={}),a=u.handle,a||(u.handle=a=function(e){return typeof s=="undefined"||!!e&&s.event.triggered===e.type?t:s.event.dispatch.apply(a.elem,arguments)},a.elem=e),n=s.trim(P(n)).split(" ");for(l=0;l<n.length;l++){c=C.exec(n[l])||[],h=c[1],p=(c[2]||"").split(".").sort(),y=s.event.special[h]||{},h=(o?y.delegateType:y.bindType)||h,y=s.event.special[h]||{},d=s.extend({type:h,origType:c[1],data:i,handler:r,guid:r.guid,selector:o,quick:o&&_(o),namespace:p.join(".")},v),g=f[h];if(!g){g=f[h]=[],g.delegateCount=0;if(!y.setup||y.setup.call(e,i,p,a)===!1)e.addEventListener?e.addEventListener(h,a,!1):e.attachEvent&&e.attachEvent("on"+h,a)}y.add&&(y.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),o?g.splice(g.delegateCount++,0,d):g.push(d),s.event.global[h]=!0}e=null},global:{},remove:function(e,t,n,r,i){var o=s.hasData(e)&&s._data(e),u,a,f,l,c,h,p,d,v,m,g,y;if(!o||!(d=o.events))return;t=s.trim(P(t||"")).split(" ");for(u=0;u<t.length;u++){a=C.exec(t[u])||[],f=l=a[1],c=a[2];if(!f){for(f in d)s.event.remove(e,f+t[u],n,r,!0);continue}v=s.event.special[f]||{},f=(r?v.delegateType:v.bindType)||f,g=d[f]||[],h=g.length,c=c?new RegExp("(^|\\.)"+c.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(p=0;p<g.length;p++)y=g[p],(i||l===y.origType)&&(!n||n.guid===y.guid)&&(!c||c.test(y.namespace))&&(!r||r===y.selector||r==="**"&&y.selector)&&(g.splice(p--,1),y.selector&&g.delegateCount--,v.remove&&v.remove.call(e,y));g.length===0&&h!==g.length&&((!v.teardown||v.teardown.call(e,c)===!1)&&s.removeEvent(e,f,o.handle),delete d[f])}s.isEmptyObject(d)&&(m=o.handle,m&&(m.elem=null),s.removeData(e,["events","handle"],!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,o){if(!i||i.nodeType!==3&&i.nodeType!==8){var u=n.type||n,a=[],f,l,c,h,p,d,v,m,g,y;if(O.test(u+s.event.triggered))return;u.indexOf("!")>=0&&(u=u.slice(0,-1),l=!0),u.indexOf(".")>=0&&(a=u.split("."),u=a.shift(),a.sort());if((!i||s.event.customEvent[u])&&!s.event.global[u])return;n=typeof n=="object"?n[s.expando]?n:new s.Event(u,n):new s.Event(u),n.type=u,n.isTrigger=!0,n.exclusive=l,n.namespace=a.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+a.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,d=u.indexOf(":")<0?"on"+u:"";if(!i){f=s.cache;for(c in f)f[c].events&&f[c].events[u]&&s.event.trigger(n,r,f[c].handle.elem,!0);return}n.result=t,n.target||(n.target=i),r=r!=null?s.makeArray(r):[],r.unshift(n),v=s.event.special[u]||{};if(v.trigger&&v.trigger.apply(i,r)===!1)return;g=[[i,v.bindType||u]];if(!o&&!v.noBubble&&!s.isWindow(i)){y=v.delegateType||u,h=O.test(y+u)?i:i.parentNode,p=null;for(;h;h=h.parentNode)g.push([h,y]),p=h;p&&p===i.ownerDocument&&g.push([p.defaultView||p.parentWindow||e,y])}for(c=0;c<g.length&&!n.isPropagationStopped();c++)h=g[c][0],n.type=g[c][1],m=(s._data(h,"events")||{})[n.type]&&s._data(h,"handle"),m&&m.apply(h,r),m=d&&h[d],m&&s.acceptData(h)&&m.apply(h,r)===!1&&n.preventDefault();return n.type=u,!o&&!n.isDefaultPrevented()&&(!v._default||v._default.apply(i.ownerDocument,r)===!1)&&(u!=="click"||!s.nodeName(i,"a"))&&s.acceptData(i)&&d&&i[u]&&(u!=="focus"&&u!=="blur"||n.target.offsetWidth!==0)&&!s.isWindow(i)&&(p=i[d],p&&(i[d]=null),s.event.triggered=u,i[u](),s.event.triggered=t,p&&(i[d]=p)),n.result}return},dispatch:function(n){n=s.event.fix(n||e.event);var r=(s._data(this,"events")||{})[n.type]||[],i=r.delegateCount,o=[].slice.call(arguments,0),u=!n.exclusive&&!n.namespace,a=s.event.special[n.type]||{},f=[],l,c,h,p,d,v,m,g,y,b,w;o[0]=n,n.delegateTarget=this;if(a.preDispatch&&a.preDispatch.call(this,n)===!1)return;if(i&&(!n.button||n.type!=="click")){p=s(this),p.context=this.ownerDocument||this;for(h=n.target;h!=this;h=h.parentNode||this)if(h.disabled!==!0){v={},g=[],p[0]=h;for(l=0;l<i;l++)y=r[l],b=y.selector,v[b]===t&&(v[b]=y.quick?D(h,y.quick):p.is(b)),v[b]&&g.push(y);g.length&&f.push({elem:h,matches:g})}}r.length>i&&f.push({elem:this,matches:r.slice(i)});for(l=0;l<f.length&&!n.isPropagationStopped();l++){m=f[l],n.currentTarget=m.elem;for(c=0;c<m.matches.length&&!n.isImmediatePropagationStopped();c++){y=m.matches[c];if(u||!n.namespace&&!y.namespace||n.namespace_re&&n.namespace_re.test(y.namespace))n.data=y.data,n.handleObj=y,d=((s.event.special[y.origType]||{}).handle||y.handler).apply(m.elem,o),d!==t&&(n.result=d,d===!1&&(n.preventDefault(),n.stopPropagation()))}}return a.postDispatch&&a.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,r){var i,s,o,u=r.button,a=r.fromElement;return e.pageX==null&&r.clientX!=null&&(i=e.target.ownerDocument||n,s=i.documentElement,o=i.body,e.pageX=r.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=r.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?r.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[s.expando])return e;var r,i,o=e,u=s.event.fixHooks[e.type]||{},a=u.props?this.props.concat(u.props):this.props;e=s.Event(o);for(r=a.length;r;)i=a[--r],e[i]=o[i];return e.target||(e.target=o.srcElement||n),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey===t&&(e.metaKey=e.ctrlKey),u.filter?u.filter(e,o):e},special:{ready:{setup:s.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){s.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=s.extend(new s.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?s.event.trigger(i,null,t):s.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},s.event.handle=s.event.dispatch,s.removeEvent=n.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},s.Event=function(e,t){if(!(this instanceof s.Event))return new s.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?B:H):this.type=e,t&&s.extend(this,t),this.timeStamp=e&&e.timeStamp||s.now(),this[s.expando]=!0},s.Event.prototype={preventDefault:function(){this.isDefaultPrevented=B;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=B;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=B,this.stopPropagation()},isDefaultPrevented:H,isPropagationStopped:H,isImmediatePropagationStopped:H},s.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){s.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n=this,r=e.relatedTarget,i=e.handleObj,o=i.selector,u;if(!r||r!==n&&!s.contains(n,r))e.type=i.origType,u=i.handler.apply(this,arguments),e.type=t;return u}}}),s.support.submitBubbles||(s.event.special.submit={setup:function(){if(s.nodeName(this,"form"))return!1;s.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=s.nodeName(n,"input")||s.nodeName(n,"button")?n.form:t;r&&!r._submit_attached&&(s.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),r._submit_attached=!0)})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&s.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(s.nodeName(this,"form"))return!1;s.event.remove(this,"._submit")}}),s.support.changeBubbles||(s.event.special.change={setup:function(){if(N.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")s.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),s.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1,s.event.simulate("change",this,e,!0))});return!1}s.event.add(this,"beforeactivate._change",function(e){var t=e.target;N.test(t.nodeName)&&!t._change_attached&&(s.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&s.event.simulate("change",this.parentNode,e,!0)}),t._change_attached=!0)})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return s.event.remove(this,"._change"),N.test(this.nodeName)}}),s.support.focusinBubbles||s.each({focus:"focusin",blur:"focusout"},function(e,t){var r=0,i=function(e){s.event.simulate(t,e.target,s.event.fix(e),!0)};s.event.special[t]={setup:function(){r++===0&&n.addEventListener(e,i,!0)},teardown:function(){--r===0&&n.removeEventListener(e,i,!0)}}}),s.fn.extend({on:function(e,n,r,i,o){var u,a;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=H;else if(!i)return this;return o===1&&(u=i,i=function(e){return s().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=s.guid++)),this.each(function(){s.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){if(e&&e.preventDefault&&e.handleObj){var i=e.handleObj;return s(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if(typeof e=="object"){for(var o in e)this.off(o,n,e[o]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=H),this.each(function(){s.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return s(this.context).on(e,this.selector,t,n),this},die:function(e,t){return s(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length==1?this.off(e,"**"):this.off(t,e,n)},trigger:function(e,t){return this.each(function(){s.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return s.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||s.guid++,r=0,i=function(n){var i=(s._data(this,"lastToggle"+e.guid)||0)%r;return s._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),s.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){s.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},s.attrFn&&(s.attrFn[t]=!0),L.test(t)&&(s.event.fixHooks[t]=s.event.keyHooks),A.test(t)&&(s.event.fixHooks[t]=s.event.mouseHooks)}),function(){function S(e,t,n,i,s,o){for(var u=0,a=i.length;u<a;u++){var f=i[u];if(f){var l=!1;f=f[e];while(f){if(f[r]===n){l=i[f.sizset];break}f.nodeType===1&&!o&&(f[r]=n,f.sizset=u);if(f.nodeName.toLowerCase()===t){l=f;break}f=f[e]}i[u]=l}}}function x(e,t,n,i,s,o){for(var u=0,a=i.length;u<a;u++){var f=i[u];if(f){var l=!1;f=f[e];while(f){if(f[r]===n){l=i[f.sizset];break}if(f.nodeType===1){o||(f[r]=n,f.sizset=u);if(typeof t!="string"){if(f===t){l=!0;break}}else if(h.filter(t,[f]).length>0){l=f;break}}f=f[e]}i[u]=l}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,r="sizcache"+(Math.random()+"").replace(".",""),i=0,o=Object.prototype.toString,u=!1,a=!0,f=/\\/g,l=/\r\n/g,c=/\W/;[0,0].sort(function(){return a=!1,0});var h=function(t,r,i,s){i=i||[],r=r||n;var u=r;if(r.nodeType!==1&&r.nodeType!==9)return[];if(!t||typeof t!="string")return i;var a,f,l,c,p,m,g,b,w=!0,E=h.isXML(r),S=[],x=t;do{e.exec(""),a=e.exec(x);if(a){x=a[3],S.push(a[1]);if(a[2]){c=a[3];break}}}while(a);if(S.length>1&&v.exec(t))if(S.length===2&&d.relative[S[0]])f=T(S[0]+S[1],r,s);else{f=d.relative[S[0]]?[r]:h(S.shift(),r);while(S.length)t=S.shift(),d.relative[t]&&(t+=S.shift()),f=T(t,f,s)}else{!s&&S.length>1&&r.nodeType===9&&!E&&d.match.ID.test(S[0])&&!d.match.ID.test(S[S.length-1])&&(p=h.find(S.shift(),r,E),r=p.expr?h.filter(p.expr,p.set)[0]:p.set[0]);if(r){p=s?{expr:S.pop(),set:y(s)}:h.find(S.pop(),S.length!==1||S[0]!=="~"&&S[0]!=="+"||!r.parentNode?r:r.parentNode,E),f=p.expr?h.filter(p.expr,p.set):p.set,S.length>0?l=y(f):w=!1;while(S.length)m=S.pop(),g=m,d.relative[m]?g=S.pop():m="",g==null&&(g=r),d.relative[m](l,g,E)}else l=S=[]}l||(l=f),l||h.error(m||t);if(o.call(l)==="[object Array]")if(!w)i.push.apply(i,l);else if(r&&r.nodeType===1)for(b=0;l[b]!=null;b++)l[b]&&(l[b]===!0||l[b].nodeType===1&&h.contains(r,l[b]))&&i.push(f[b]);else for(b=0;l[b]!=null;b++)l[b]&&l[b].nodeType===1&&i.push(f[b]);else y(l,i);return c&&(h(c,u,i,s),h.uniqueSort(i)),i};h.uniqueSort=function(e){if(w){u=a,e.sort(w);if(u)for(var t=1;t<e.length;t++)e[t]===e[t-1]&&e.splice(t--,1)}return e},h.matches=function(e,t){return h(e,null,null,t)},h.matchesSelector=function(e,t){return h(t,null,null,[e]).length>0},h.find=function(e,t,n){var r,i,s,o,u,a;if(!e)return[];for(i=0,s=d.order.length;i<s;i++){u=d.order[i];if(o=d.leftMatch[u].exec(e)){a=o[1],o.splice(1,1);if(a.substr(a.length-1)!=="\\"){o[1]=(o[1]||"").replace(f,""),r=d.find[u](o,t,n);if(r!=null){e=e.replace(d.match[u],"");break}}}}return r||(r=typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName("*"):[]),{set:r,expr:e}},h.filter=function(e,n,r,i){var s,o,u,a,f,l,c,p,v,m=e,g=[],y=n,b=n&&n[0]&&h.isXML(n[0]);while(e&&n.length){for(u in d.filter)if((s=d.leftMatch[u].exec(e))!=null&&s[2]){l=d.filter[u],c=s[1],o=!1,s.splice(1,1);if(c.substr(c.length-1)==="\\")continue;y===g&&(g=[]);if(d.preFilter[u]){s=d.preFilter[u](s,y,r,g,i,b);if(!s)o=a=!0;else if(s===!0)continue}if(s)for(p=0;(f=y[p])!=null;p++)f&&(a=l(f,s,p,y),v=i^a,r&&a!=null?v?o=!0:y[p]=!1:v&&(g.push(f),o=!0));if(a!==t){r||(y=g),e=e.replace(d.match[u],"");if(!o)return[];break}}if(e===m){if(o!=null)break;h.error(e)}m=e}return y},h.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};var p=h.getText=function(e){var t,n,r=e.nodeType,i="";if(r){if(r===1||r===9||r===11){if(typeof e.textContent=="string")return e.textContent;if(typeof e.innerText=="string")return e.innerText.replace(l,"");for(e=e.firstChild;e;e=e.nextSibling)i+=p(e)}else if(r===3||r===4)return e.nodeValue}else for(t=0;n=e[t];t++)n.nodeType!==8&&(i+=p(n));return i},d=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(e,t){var n=typeof t=="string",r=n&&!c.test(t),i=n&&!r;r&&(t=t.toLowerCase());for(var s=0,o=e.length,u;s<o;s++)if(u=e[s]){while((u=u.previousSibling)&&u.nodeType!==1);e[s]=i||u&&u.nodeName.toLowerCase()===t?u||!1:u===t}i&&h.filter(t,e,!0)},">":function(e,t){var n,r=typeof t=="string",i=0,s=e.length;if(r&&!c.test(t)){t=t.toLowerCase();for(;i<s;i++){n=e[i];if(n){var o=n.parentNode;e[i]=o.nodeName.toLowerCase()===t?o:!1}}}else{for(;i<s;i++)n=e[i],n&&(e[i]=r?n.parentNode:n.parentNode===t);r&&h.filter(t,e,!0)}},"":function(e,t,n){var r,s=i++,o=x;typeof t=="string"&&!c.test(t)&&(t=t.toLowerCase(),r=t,o=S),o("parentNode",t,s,e,r,n)},"~":function(e,t,n){var r,s=i++,o=x;typeof t=="string"&&!c.test(t)&&(t=t.toLowerCase(),r=t,o=S),o("previousSibling",t,s,e,r,n)}},find:{ID:function(e,t,n){if(typeof t.getElementById!="undefined"&&!n){var r=t.getElementById(e[1]);return r&&r.parentNode?[r]:[]}},NAME:function(e,t){if(typeof t.getElementsByName!="undefined"){var n=[],r=t.getElementsByName(e[1]);for(var i=0,s=r.length;i<s;i++)r[i].getAttribute("name")===e[1]&&n.push(r[i]);return n.length===0?null:n}},TAG:function(e,t){if(typeof t.getElementsByTagName!="undefined")return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(e,t,n,r,i,s){e=" "+e[1].replace(f,"")+" ";if(s)return e;for(var o=0,u;(u=t[o])!=null;o++)u&&(i^(u.className&&(" "+u.className+" ").replace(/[\t\n\r]/g," ").indexOf(e)>=0)?n||r.push(u):n&&(t[o]=!1));return!1},ID:function(e){return e[1].replace(f,"")},TAG:function(e,t){return e[1].replace(f,"").toLowerCase()},CHILD:function(e){if(e[1]==="nth"){e[2]||h.error(e[0]),e[2]=e[2].replace(/^\+|\s*/g,"");var t=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=t[1]+(t[2]||1)-0,e[3]=t[3]-0}else e[2]&&h.error(e[0]);return e[0]=i++,e},ATTR:function(e,t,n,r,i,s){var o=e[1]=e[1].replace(f,"");return!s&&d.attrMap[o]&&(e[1]=d.attrMap[o]),e[4]=(e[4]||e[5]||"").replace(f,""),e[2]==="~="&&(e[4]=" "+e[4]+" "),e},PSEUDO:function(t,n,r,i,s){if(t[1]==="not"){if(!((e.exec(t[3])||"").length>1||/^\w/.test(t[3]))){var o=h.filter(t[3],n,r,!0^s);return r||i.push.apply(i,o),!1}t[3]=h(t[3],null,null,n)}else if(d.match.POS.test(t[0])||d.match.CHILD.test(t[0]))return!0;return t},POS:function(e){return e.unshift(!0),e}},filters:{enabled:function(e){return e.disabled===!1&&e.type!=="hidden"},disabled:function(e){return e.disabled===!0},checked:function(e){return e.checked===!0},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!!e.firstChild},empty:function(e){return!e.firstChild},has:function(e,t,n){return!!h(n[3],e).length},header:function(e){return/h\d/i.test(e.nodeName)},text:function(e){var t=e.getAttribute("type"),n=e.type;return e.nodeName.toLowerCase()==="input"&&"text"===n&&(t===n||t===null)},radio:function(e){return e.nodeName.toLowerCase()==="input"&&"radio"===e.type},checkbox:function(e){return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type},file:function(e){return e.nodeName.toLowerCase()==="input"&&"file"===e.type},password:function(e){return e.nodeName.toLowerCase()==="input"&&"password"===e.type},submit:function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&"submit"===e.type},image:function(e){return e.nodeName.toLowerCase()==="input"&&"image"===e.type},reset:function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&"reset"===e.type},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&"button"===e.type||t==="button"},input:function(e){return/input|select|textarea|button/i.test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t){return t===0},last:function(e,t,n,r){return t===r.length-1},even:function(e,t){return t%2===0},odd:function(e,t){return t%2===1},lt:function(e,t,n){return t<n[3]-0},gt:function(e,t,n){return t>n[3]-0},nth:function(e,t,n){return n[3]-0===t},eq:function(e,t,n){return n[3]-0===t}},filter:{PSEUDO:function(e,t,n,r){var i=t[1],s=d.filters[i];if(s)return s(e,n,t,r);if(i==="contains")return(e.textContent||e.innerText||p([e])||"").indexOf(t[3])>=0;if(i==="not"){var o=t[3];for(var u=0,a=o.length;u<a;u++)if(o[u]===e)return!1;return!0}h.error(i)},CHILD:function(e,t){var n,i,s,o,u,a,f,l=t[1],c=e;switch(l){case"only":case"first":while(c=c.previousSibling)if(c.nodeType===1)return!1;if(l==="first")return!0;c=e;case"last":while(c=c.nextSibling)if(c.nodeType===1)return!1;return!0;case"nth":n=t[2],i=t[3];if(n===1&&i===0)return!0;s=t[0],o=e.parentNode;if(o&&(o[r]!==s||!e.nodeIndex)){a=0;for(c=o.firstChild;c;c=c.nextSibling)c.nodeType===1&&(c.nodeIndex=++a);o[r]=s}return f=e.nodeIndex-i,n===0?f===0:f%n===0&&f/n>=0}},ID:function(e,t){return e.nodeType===1&&e.getAttribute("id")===t},TAG:function(e,t){return t==="*"&&e.nodeType===1||!!e.nodeName&&e.nodeName.toLowerCase()===t},CLASS:function(e,t){return(" "+(e.className||e.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(e,t){var n=t[1],r=h.attr?h.attr(e,n):d.attrHandle[n]?d.attrHandle[n](e):e[n]!=null?e[n]:e.getAttribute(n),i=r+"",s=t[2],o=t[4];return r==null?s==="!=":!s&&h.attr?r!=null:s==="="?i===o:s==="*="?i.indexOf(o)>=0:s==="~="?(" "+i+" ").indexOf(o)>=0:o?s==="!="?i!==o:s==="^="?i.indexOf(o)===0:s==="$="?i.substr(i.length-o.length)===o:s==="|="?i===o||i.substr(0,o.length+1)===o+"-":!1:i&&r!==!1},POS:function(e,t,n,r){var i=t[2],s=d.setFilters[i];if(s)return s(e,n,t,r)}}},v=d.match.POS,m=function(e,t){return"\\"+(t-0+1)};for(var g in d.match)d.match[g]=new RegExp(d.match[g].source+/(?![^\[]*\])(?![^\(]*\))/.source),d.leftMatch[g]=new RegExp(/(^(?:.|\r|\n)*?)/.source+d.match[g].source.replace(/\\(\d+)/g,m));d.match.globalPOS=v;var y=function(e,t){return e=Array.prototype.slice.call(e,0),t?(t.push.apply(t,e),t):e};try{Array.prototype.slice.call(n.documentElement.childNodes,0)[0].nodeType}catch(b){y=function(e,t){var n=0,r=t||[];if(o.call(e)==="[object Array]")Array.prototype.push.apply(r,e);else if(typeof e.length=="number")for(var i=e.length;n<i;n++)r.push(e[n]);else for(;e[n];n++)r.push(e[n]);return r}}var w,E;n.documentElement.compareDocumentPosition?w=function(e,t){return e===t?(u=!0,0):!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition?-1:1:e.compareDocumentPosition(t)&4?-1:1}:(w=function(e,t){if(e===t)return u=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,a=t.parentNode,f=o;if(o===a)return E(e,t);if(!o)return-1;if(!a)return 1;while(f)i.unshift(f),f=f.parentNode;f=a;while(f)s.unshift(f),f=f.parentNode;n=i.length,r=s.length;for(var l=0;l<n&&l<r;l++)if(i[l]!==s[l])return E(i[l],s[l]);return l===n?E(e,s[l],-1):E(i[l],t,1)},E=function(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}),function(){var e=n.createElement("div"),r="script"+(new Date).getTime(),i=n.documentElement;e.innerHTML="<a name='"+r+"'/>",i.insertBefore(e,i.firstChild),n.getElementById(r)&&(d.find.ID=function(e,n,r){if(typeof n.getElementById!="undefined"&&!r){var i=n.getElementById(e[1]);return i?i.id===e[1]||typeof i.getAttributeNode!="undefined"&&i.getAttributeNode("id").nodeValue===e[1]?[i]:t:[]}},d.filter.ID=function(e,t){var n=typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id");return e.nodeType===1&&n&&n.nodeValue===t}),i.removeChild(e),i=e=null}(),function(){var e=n.createElement("div");e.appendChild(n.createComment("")),e.getElementsByTagName("*").length>0&&(d.find.TAG=function(e,t){var n=t.getElementsByTagName(e[1]);if(e[1]==="*"){var r=[];for(var i=0;n[i];i++)n[i].nodeType===1&&r.push(n[i]);n=r}return n}),e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!="undefined"&&e.firstChild.getAttribute("href")!=="#"&&(d.attrHandle.href=function(e){return e.getAttribute("href",2)}),e=null}(),n.querySelectorAll&&function(){var e=h,t=n.createElement("div"),r="__sizzle__";t.innerHTML="<p class='TEST'></p>";if(t.querySelectorAll&&t.querySelectorAll(".TEST").length===0)return;h=function(t,i,s,o){i=i||n;if(!o&&!h.isXML(i)){var u=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t);if(u&&(i.nodeType===1||i.nodeType===9)){if(u[1])return y(i.getElementsByTagName(t),s);if(u[2]&&d.find.CLASS&&i.getElementsByClassName)return y(i.getElementsByClassName(u[2]),s)}if(i.nodeType===9){if(t==="body"&&i.body)return y([i.body],s);if(u&&u[3]){var a=i.getElementById(u[3]);if(!a||!a.parentNode)return y([],s);if(a.id===u[3])return y([a],s)}try{return y(i.querySelectorAll(t),s)}catch(f){}}else if(i.nodeType===1&&i.nodeName.toLowerCase()!=="object"){var l=i,c=i.getAttribute("id"),p=c||r,v=i.parentNode,m=/^\s*[+~]/.test(t);c?p=p.replace(/'/g,"\\$&"):i.setAttribute("id",p),m&&v&&(i=i.parentNode);try{if(!m||v)return y(i.querySelectorAll("[id='"+p+"'] "+t),s)}catch(g){}finally{c||l.removeAttribute("id")}}}return e(t,i,s,o)};for(var i in e)h[i]=e[i];t=null}(),function(){var e=n.documentElement,t=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(t){var r=!t.call(n.createElement("div"),"div"),i=!1;try{t.call(n.documentElement,"[test!='']:sizzle")}catch(s){i=!0}h.matchesSelector=function(e,n){n=n.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!h.isXML(e))try{if(i||!d.match.PSEUDO.test(n)&&!/!=/.test(n)){var s=t.call(e,n);if(s||!r||e.document&&e.document.nodeType!==11)return s}}catch(o){}return h(n,null,null,[e]).length>0}}}(),function(){var e=n.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0)return;e.lastChild.className="e";if(e.getElementsByClassName("e").length===1)return;d.order.splice(1,0,"CLASS"),d.find.CLASS=function(e,t,n){if(typeof t.getElementsByClassName!="undefined"&&!n)return t.getElementsByClassName(e[1])},e=null}(),n.documentElement.contains?h.contains=function(e,t){return e!==t&&(e.contains?e.contains(t):!0)}:n.documentElement.compareDocumentPosition?h.contains=function(e,t){return!!(e.compareDocumentPosition(t)&16)}:h.contains=function(){return!1},h.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?t.nodeName!=="HTML":!1};var T=function(e,t,n){var r,i=[],s="",o=t.nodeType?[t]:t;while(r=d.match.PSEUDO.exec(e))s+=r[0],e=e.replace(d.match.PSEUDO,"");e=d.relative[e]?e+"*":e;for(var u=0,a=o.length;u<a;u++)h(e,o[u],i,n);return h.filter(s,i)};h.attr=s.attr,h.selectors.attrMap={},s.find=h,s.expr=h.selectors,s.expr[":"]=s.expr.filters,s.unique=h.uniqueSort,s.text=h.getText,s.isXMLDoc=h.isXML,s.contains=h.contains}();var j=/Until$/,F=/^(?:parents|prevUntil|prevAll)/,I=/,/,q=/^.[^:#\[\.,]*$/,R=Array.prototype.slice,U=s.expr.match.globalPOS,z={children:!0,contents:!0,next:!0,prev:!0};s.fn.extend({find:function(e){var t=this,n,r;if(typeof e!="string")return s(e).filter(function(){for(n=0,r=t.length;n<r;n++)if(s.contains(t[n],this))return!0});var i=this.pushStack("","find",e),o,u,a;for(n=0,r=this.length;n<r;n++){o=i.length,s.find(e,this[n],i);if(n>0)for(u=o;u<i.length;u++)for(a=0;a<o;a++)if(i[a]===i[u]){i.splice(u--,1);break}}return i},has:function(e){var t=s(e);return this.filter(function(){for(var e=0,n=t.length;e<n;e++)if(s.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(X(this,e,!1),"not",e)},filter:function(e){return this.pushStack(X(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?U.test(e)?s(e,this.context).index(this[0])>=0:s.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n=[],r,i,o=this[0];if(s.isArray(e)){var u=1;while(o&&o.ownerDocument&&o!==t){for(r=0;r<e.length;r++)s(o).is(e[r])&&n.push({selector:e[r],elem:o,level:u});o=o.parentNode,u++}return n}var a=U.test(e)||typeof e!="string"?s(e,t||this.context):0;for(r=0,i=this.length;r<i;r++){o=this[r];while(o){if(a?a.index(o)>-1:s.find.matchesSelector(o,e)){n.push(o);break}o=o.parentNode;if(!o||!o.ownerDocument||o===t||o.nodeType===11)break}}return n=n.length>1?s.unique(n):n,this.pushStack(n,"closest",e)},index:function(e){return e?typeof e=="string"?s.inArray(this[0],s(e)):s.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?s(e,t):s.makeArray(e&&e.nodeType?[e]:e),r=s.merge(this.get(),n);return this.pushStack(W(n[0])||W(r[0])?r:s.unique(r))},andSelf:function(){return this.add(this.prevObject)}}),s.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return s.dir(e,"parentNode")},parentsUntil:function(e,t,n){return s.dir(e,"parentNode",n)},next:function(e){return s.nth(e,2,"nextSibling")},prev:function(e){return s.nth(e,2,"previousSibling")},nextAll:function(e){return s.dir(e,"nextSibling")},prevAll:function(e){return s.dir(e,"previousSibling")},nextUntil:function(e,t,n){return s.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return s.dir(e,"previousSibling",n)},siblings:function(e){return s.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return s.sibling(e.firstChild)},contents:function(e){return s.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:s.makeArray(e.childNodes)}},function(e,t){s.fn[e]=function(n,r){var i=s.map(this,t,n);return j.test(e)||(r=n),r&&typeof r=="string"&&(i=s.filter(r,i)),i=this.length>1&&!z[e]?s.unique(i):i,(this.length>1||I.test(r))&&F.test(e)&&(i=i.reverse()),this.pushStack(i,e,R.call(arguments).join(","))}}),s.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?s.find.matchesSelector(t[0],e)?[t[0]]:[]:s.find.matches(e,t)},dir:function(e,n,r){var i=[],o=e[n];while(o&&o.nodeType!==9&&(r===t||o.nodeType!==1||!s(o).is(r)))o.nodeType===1&&i.push(o),o=o[n];return i},nth:function(e,t,n,r){t=t||1;var i=0;for(;e;e=e[n])if(e.nodeType===1&&++i===t)break;return e},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var $="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",J=/ jQuery\d+="(?:\d+|null)"/g,K=/^\s+/,Q=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,G=/<([\w:]+)/,Y=/<tbody/i,Z=/<|&#?\w+;/,et=/<(?:script|style)/i,tt=/<(?:script|object|embed|option|style)/i,nt=new RegExp("<(?:"+$+")[\\s/>]","i"),rt=/checked\s*(?:[^=]|=\s*.checked.)/i,it=/\/(java|ecma)script/i,st=/^\s*<!(?:\[CDATA\[|\-\-)/,ot={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ut=V(n);ot.optgroup=ot.option,ot.tbody=ot.tfoot=ot.colgroup=ot.caption=ot.thead,ot.th=ot.td,s.support.htmlSerialize||(ot._default=[1,"div<div>","</div>"]),s.fn.extend({text:function(e){return s.access(this,function(e){return e===t?s.text(this):this.empty().append((this[0]&&this[0].ownerDocument||n).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(s.isFunction(e))return this.each(function(t){s(this).wrapAll(e.call(this,t))});if(this[0]){var t=s(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return s.isFunction(e)?this.each(function(t){s(this).wrapInner(e.call(this,t))}):this.each(function(){var t=s(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=s.isFunction(e);return this.each(function(n){s(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){s.nodeName(this,"body")||s(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){this.nodeType===1&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){this.nodeType===1&&this.insertBefore(e,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=s.clean(arguments);return e.push.apply(e,this.toArray()),this.pushStack(e,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=this.pushStack(this,"after",arguments);return e.push.apply(e,s.clean(arguments)),e}},remove:function(e,t){for(var n=0,r;(r=this[n])!=null;n++)if(!e||s.filter(e,[r]).length)!t&&r.nodeType===1&&(s.cleanData(r.getElementsByTagName("*")),s.cleanData([r])),r.parentNode&&r.parentNode.removeChild(r);return this},empty:function(){for(var e=0,t;(t=this[e])!=null;e++){t.nodeType===1&&s.cleanData(t.getElementsByTagName("*"));while(t.firstChild)t.removeChild(t.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return s.clone(this,e,t)})},html:function(e){return s.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(J,""):null;if(typeof e=="string"&&!et.test(e)&&(s.support.leadingWhitespace||!K.test(e))&&!ot[(G.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Q,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(s.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return this[0]&&this[0].parentNode?s.isFunction(e)?this.each(function(t){var n=s(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=s(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;s(this).remove(),t?s(t).before(e):s(n).append(e)})):this.length?this.pushStack(s(s.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){var i,o,u,a,f=e[0],l=[];if(!s.support.checkClone&&arguments.length===3&&typeof f=="string"&&rt.test(f))return this.each(function(){s(this).domManip(e,n,r,!0)});if(s.isFunction(f))return this.each(function(i){var o=s(this);e[0]=f.call(this,i,n?o.html():t),o.domManip(e,n,r)});if(this[0]){a=f&&f.parentNode,s.support.parentNode&&a&&a.nodeType===11&&a.childNodes.length===this.length?i={fragment:a}:i=s.buildFragment(e,this,l),u=i.fragment,u.childNodes.length===1?o=u=u.firstChild:o=u.firstChild;if(o){n=n&&s.nodeName(o,"tr");for(var c=0,h=this.length,p=h-1;c<h;c++)r.call(n?at(this[c],o):this[c],i.cacheable||h>1&&c<p?s.clone(u,!0,!0):u)}l.length&&s.each(l,function(e,t){t.src?s.ajax({type:"GET",global:!1,url:t.src,async:!1,dataType:"script"}):s.globalEval((t.text||t.textContent||t.innerHTML||"").replace(st,"/*$0*/")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),s.buildFragment=function(e,t,r){var i,o,u,a,f=e[0];return t&&t[0]&&(a=t[0].ownerDocument||t[0]),a.createDocumentFragment||(a=n),e.length===1&&typeof f=="string"&&f.length<512&&a===n&&f.charAt(0)==="<"&&!tt.test(f)&&(s.support.checkClone||!rt.test(f))&&(s.support.html5Clone||!nt.test(f))&&(o=!0,u=s.fragments[f],u&&u!==1&&(i=u)),i||(i=a.createDocumentFragment(),s.clean(e,a,i,r)),o&&(s.fragments[f]=u?i:1),{fragment:i,cacheable:o}},s.fragments={},s.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){s.fn[e]=function(n){var r=[],i=s(n),o=this.length===1&&this[0].parentNode;if(o&&o.nodeType===11&&o.childNodes.length===1&&i.length===1)return i[t](this[0]),this;for(var u=0,a=i.length;u<a;u++){var f=(u>0?this.clone(!0):this).get();s(i[u])[t](f),r=r.concat(f)}return this.pushStack(r,e,i.selector)}}),s.extend({clone:function(e,t,n){var r,i,o,u=s.support.html5Clone||s.isXMLDoc(e)||!nt.test("<"+e.nodeName+">")?e.cloneNode(!0):dt(e);if((!s.support.noCloneEvent||!s.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!s.isXMLDoc(e)){lt(e,u),r=ct(e),i=ct(u);for(o=0;r[o];++o)i[o]&&lt(r[o],i[o])}if(t){ft(e,u);if(n){r=ct(e),i=ct(u);for(o=0;r[o];++o)ft(r[o],i[o])}}return r=i=null,u},clean:function(e,t,r,i){var o,u,a,f=[];t=t||n,typeof t.createElement=="undefined"&&(t=t.ownerDocument||t[0]&&t[0].ownerDocument||n);for(var l=0,c;(c=e[l])!=null;l++){typeof c=="number"&&(c+="");if(!c)continue;if(typeof c=="string")if(!Z.test(c))c=t.createTextNode(c);else{c=c.replace(Q,"<$1></$2>");var h=(G.exec(c)||["",""])[1].toLowerCase(),p=ot[h]||ot._default,d=p[0],v=t.createElement("div"),m=ut.childNodes,g;t===n?ut.appendChild(v):V(t).appendChild(v),v.innerHTML=p[1]+c+p[2];while(d--)v=v.lastChild;if(!s.support.tbody){var y=Y.test(c),b=h==="table"&&!y?v.firstChild&&v.firstChild.childNodes:p[1]==="<table>"&&!y?v.childNodes:[];for(a=b.length-1;a>=0;--a)s.nodeName(b[a],"tbody")&&!b[a].childNodes.length&&b[a].parentNode.removeChild(b[a])}!s.support.leadingWhitespace&&K.test(c)&&v.insertBefore(t.createTextNode(K.exec(c)[0]),v.firstChild),c=v.childNodes,v&&(v.parentNode.removeChild(v),m.length>0&&(g=m[m.length-1],g&&g.parentNode&&g.parentNode.removeChild(g)))}var w;if(!s.support.appendChecked)if(c[0]&&typeof (w=c.length)=="number")for(a=0;a<w;a++)pt(c[a]);else pt(c);c.nodeType?f.push(c):f=s.merge(f,c)}if(r){o=function(e){return!e.type||it.test(e.type)};for(l=0;f[l];l++){u=f[l];if(i&&s.nodeName(u,"script")&&(!u.type||it.test(u.type)))i.push(u.parentNode?u.parentNode.removeChild(u):u);else{if(u.nodeType===1){var E=s.grep(u.getElementsByTagName("script"),o);f.splice.apply(f,[l+1,0].concat(E))}r.appendChild(u)}}}return f},cleanData:function(e){var t,n,r=s.cache,i=s.event.special,o=s.support.deleteExpando;for(var u=0,a;(a=e[u])!=null;u++){if(a.nodeName&&s.noData[a.nodeName.toLowerCase()])continue;n=a[s.expando];if(n){t=r[n];if(t&&t.events){for(var f in t.events)i[f]?s.event.remove(a,f):s.removeEvent(a,f,t.handle);t.handle&&(t.handle.elem=null)}o?delete a[s.expando]:a.removeAttribute&&a.removeAttribute(s.expando),delete r[n]}}}});var vt=/alpha\([^)]*\)/i,mt=/opacity=([^)]*)/,gt=/([A-Z]|^ms)/g,yt=/^[\-+]?(?:\d*\.)?\d+$/i,bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,wt=/^([\-+])=([\-+.\de]+)/,Et=/^margin/,St={position:"absolute",visibility:"hidden",display:"block"},xt=["Top","Right","Bottom","Left"],Tt,Nt,Ct;s.fn.css=function(e,n){return s.access(this,function(e,n,r){return r!==t?s.style(e,n,r):s.css(e,n)},e,n,arguments.length>1)},s.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Tt(e,"opacity");return n===""?"1":n}return e.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":s.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var o,u,a=s.camelCase(n),f=e.style,l=s.cssHooks[a];n=s.cssProps[a]||a;if(r===t)return l&&"get"in l&&(o=l.get(e,!1,i))!==t?o:f[n];u=typeof r,u==="string"&&(o=wt.exec(r))&&(r=+(o[1]+1)*+o[2]+parseFloat(s.css(e,n)),u="number");if(r==null||u==="number"&&isNaN(r))return;u==="number"&&!s.cssNumber[a]&&(r+="px");if(!l||!("set"in l)||(r=l.set(e,r))!==t)try{f[n]=r}catch(c){}},css:function(e,n,r){var i,o;n=s.camelCase(n),o=s.cssHooks[n],n=s.cssProps[n]||n,n==="cssFloat"&&(n="float");if(o&&"get"in o&&(i=o.get(e,!0,r))!==t)return i;if(Tt)return Tt(e,n)},swap:function(e,t,n){var r={},i,s;for(s in t)r[s]=e.style[s],e.style[s]=t[s];i=n.call(e);for(s in t)e.style[s]=r[s];return i}}),s.curCSS=s.css,n.defaultView&&n.defaultView.getComputedStyle&&(Nt=function(e,t){var n,r,i,o,u=e.style;return t=t.replace(gt,"-$1").toLowerCase(),(r=e.ownerDocument.defaultView)&&(i=r.getComputedStyle(e,null))&&(n=i.getPropertyValue(t),n===""&&!s.contains(e.ownerDocument.documentElement,e)&&(n=s.style(e,t))),!s.support.pixelMargin&&i&&Et.test(t)&&bt.test(n)&&(o=u.width,u.width=n,n=i.width,u.width=o),n}),n.documentElement.currentStyle&&(Ct=function(e,t){var n,r,i,s=e.currentStyle&&e.currentStyle[t],o=e.style;return s==null&&o&&(i=o[t])&&(s=i),bt.test(s)&&(n=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left=t==="fontSize"?"1em":s,s=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),s===""?"auto":s}),Tt=Nt||Ct,s.each(["height","width"],function(e,t){s.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth!==0?kt(e,t,r):s.swap(e,St,function(){return kt(e,t,r)})},set:function(e,t){return yt.test(t)?t+"px":t}}}),s.support.opacity||(s.cssHooks.opacity={get:function(e,t){return mt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=s.isNumeric(t)?"alpha(opacity="+t*100+")":"",o=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&s.trim(o.replace(vt,""))===""){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=vt.test(o)?o.replace(vt,i):o+" "+i}}),s(function(){s.support.reliableMarginRight||(s.cssHooks.marginRight={get:function(e,t){return s.swap(e,{display:"inline-block"},function(){return t?Tt(e,"margin-right"):e.style.marginRight})}})}),s.expr&&s.expr.filters&&(s.expr.filters.hidden=function(e){var t=e.offsetWidth,n=e.offsetHeight;return t===0&&n===0||!s.support.reliableHiddenOffsets&&(e.style&&e.style.display||s.css(e,"display"))==="none"},s.expr.filters.visible=function(e){return!s.expr.filters.hidden(e)}),s.each({margin:"",padding:"",border:"Width"},function(e,t){s.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+xt[r]+t]=i[r]||i[r-2]||i[0];return s}}});var Lt=/%20/g,At=/\[\]$/,Ot=/\r?\n/g,Mt=/#.*$/,_t=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Dt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Pt=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Ht=/^(?:GET|HEAD)$/,Bt=/^\/\//,jt=/\?/,Ft=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,It=/^(?:select|textarea)/i,qt=/\s+/,Rt=/([?&])_=[^&]*/,Ut=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,zt=s.fn.load,Wt={},Xt={},Vt,$t,Jt=["*/"]+["*"];try{Vt=i.href}catch(Kt){Vt=n.createElement("a"),Vt.href="",Vt=Vt.href}$t=Ut.exec(Vt.toLowerCase())||[],s.fn.extend({load:function(e,n,r){if(typeof e!="string"&&zt)return zt.apply(this,arguments);if(!this.length)return this;var i=e.indexOf(" ");if(i>=0){var o=e.slice(i,e.length);e=e.slice(0,i)}var u="GET";n&&(s.isFunction(n)?(r=n,n=t):typeof n=="object"&&(n=s.param(n,s.ajaxSettings.traditional),u="POST"));var a=this;return s.ajax({url:e,type:u,dataType:"html",data:n,complete:function(e,t,n){n=e.responseText,e.isResolved()&&(e.done(function(e){n=e}),a.html(o?s("<div>").append(n.replace(Ft,"")).find(o):n)),r&&a.each(r,[n,t,e])}}),this},serialize:function(){return s.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?s.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||It.test(this.nodeName)||Dt.test(this.type))}).map(function(e,t){var n=s(this).val();return n==null?null:s.isArray(n)?s.map(n,function(e,n){return{name:t.name,value:e.replace(Ot,"\r\n")}}):{name:t.name,value:n.replace(Ot,"\r\n")}}).get()}}),s.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){s.fn[t]=function(e){return this.on(t,e)}}),s.each(["get","post"],function(e,n){s[n]=function(e,r,i,o){return s.isFunction(r)&&(o=o||i,i=r,r=t),s.ajax({type:n,url:e,data:r,success:i,dataType:o})}}),s.extend({getScript:function(e,n){return s.get(e,t,n,"script")},getJSON:function(e,t,n){return s.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Yt(e,s.ajaxSettings):(t=e,e=s.ajaxSettings),Yt(e,t),e},ajaxSettings:{url:Vt,isLocal:Pt.test($t[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Jt},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":s.parseJSON,"text xml":s.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Qt(Wt),ajaxTransport:Qt(Xt),ajax:function(e,n){function S(e,n,c,h){if(y===2)return;y=2,m&&clearTimeout(m),v=t,p=h||"",E.readyState=e>0?4:0;var d,g,w,S=n,x=c?en(r,E,c):t,T,N;if(e>=200&&e<300||e===304){if(r.ifModified){if(T=E.getResponseHeader("Last-Modified"))s.lastModified[l]=T;if(N=E.getResponseHeader("Etag"))s.etag[l]=N}if(e===304)S="notmodified",d=!0;else try{g=tn(r,x),S="success",d=!0}catch(C){S="parsererror",w=C}}else{w=S;if(!S||e)S="error",e<0&&(e=0)}E.status=e,E.statusText=""+(n||S),d?u.resolveWith(i,[g,S,E]):u.rejectWith(i,[E,S,w]),E.statusCode(f),f=t,b&&o.trigger("ajax"+(d?"Success":"Error"),[E,r,d?g:w]),a.fireWith(i,[E,S]),b&&(o.trigger("ajaxComplete",[E,r]),--s.active||s.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r=s.ajaxSetup({},n),i=r.context||r,o=i!==r&&(i.nodeType||i instanceof s)?s(i):s.event,u=s.Deferred(),a=s.Callbacks("once memory"),f=r.statusCode||{},l,c={},h={},p,d,v,m,g,y=0,b,w,E={readyState:0,setRequestHeader:function(e,t){if(!y){var n=e.toLowerCase();e=h[n]=h[n]||e,c[e]=t}return this},getAllResponseHeaders:function(){return y===2?p:null},getResponseHeader:function(e){var n;if(y===2){if(!d){d={};while(n=_t.exec(p))d[n[1].toLowerCase()]=n[2]}n=d[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return y||(r.mimeType=e),this},abort:function(e){return e=e||"abort",v&&v.abort(e),S(0,e),this}};u.promise(E),E.success=E.done,E.error=E.fail,E.complete=a.add,E.statusCode=function(e){if(e){var t;if(y<2)for(t in e)f[t]=[f[t],e[t]];else t=e[E.status],E.then(t,t)}return this},r.url=((e||r.url)+"").replace(Mt,"").replace(Bt,$t[1]+"//"),r.dataTypes=s.trim(r.dataType||"*").toLowerCase().split(qt),r.crossDomain==null&&(g=Ut.exec(r.url.toLowerCase()),r.crossDomain=!(!g||g[1]==$t[1]&&g[2]==$t[2]&&(g[3]||(g[1]==="http:"?80:443))==($t[3]||($t[1]==="http:"?80:443)))),r.data&&r.processData&&typeof r.data!="string"&&(r.data=s.param(r.data,r.traditional)),Gt(Wt,r,n,E);if(y===2)return!1;b=r.global,r.type=r.type.toUpperCase(),r.hasContent=!Ht.test(r.type),b&&s.active++===0&&s.event.trigger("ajaxStart");if(!r.hasContent){r.data&&(r.url+=(jt.test(r.url)?"&":"?")+r.data,delete r.data),l=r.url;if(r.cache===!1){var x=s.now(),T=r.url.replace(Rt,"$1_="+x);r.url=T+(T===r.url?(jt.test(r.url)?"&":"?")+"_="+x:"")}}(r.data&&r.hasContent&&r.contentType!==!1||n.contentType)&&E.setRequestHeader("Content-Type",r.contentType),r.ifModified&&(l=l||r.url,s.lastModified[l]&&E.setRequestHeader("If-Modified-Since",s.lastModified[l]),s.etag[l]&&E.setRequestHeader("If-None-Match",s.etag[l])),E.setRequestHeader("Accept",r.dataTypes[0]&&r.accepts[r.dataTypes[0]]?r.accepts[r.dataTypes[0]]+(r.dataTypes[0]!=="*"?", "+Jt+"; q=0.01":""):r.accepts["*"]);for(w in r.headers)E.setRequestHeader(w,r.headers[w]);if(!r.beforeSend||r.beforeSend.call(i,E,r)!==!1&&y!==2){for(w in{success:1,error:1,complete:1})E[w](r[w]);v=Gt(Xt,r,n,E);if(!v)S(-1,"No Transport");else{E.readyState=1,b&&o.trigger("ajaxSend",[E,r]),r.async&&r.timeout>0&&(m=setTimeout(function(){E.abort("timeout")},r.timeout));try{y=1,v.send(c,S)}catch(N){if(!(y<2))throw N;S(-1,N)}}return E}return E.abort(),!1},param:function(e,n){var r=[],i=function(e,t){t=s.isFunction(t)?t():t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=s.ajaxSettings.traditional);if(s.isArray(e)||e.jquery&&!s.isPlainObject(e))s.each(e,function(){i(this.name,this.value)});else for(var o in e)Zt(o,e[o],n,i);return r.join("&").replace(Lt,"+")}}),s.extend({active:0,lastModified:{},etag:{}});var nn=s.now(),rn=/(\=)\?(&|$)|\?\?/i;s.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return s.expando+"_"+nn++}}),s.ajaxPrefilter("json jsonp",function(t,n,r){var i=typeof t.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(t.contentType);if(t.dataTypes[0]==="jsonp"||t.jsonp!==!1&&(rn.test(t.url)||i&&rn.test(t.data))){var o,u=t.jsonpCallback=s.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a=e[u],f=t.url,l=t.data,c="$1"+u+"$2";return t.jsonp!==!1&&(f=f.replace(rn,c),t.url===f&&(i&&(l=l.replace(rn,c)),t.data===l&&(f+=(/\?/.test(f)?"&":"?")+t.jsonp+"="+u))),t.url=f,t.data=l,e[u]=function(e){o=[e]},r.always(function(){e[u]=a,o&&s.isFunction(a)&&e[u](o[0])}),t.converters["script json"]=function(){return o||s.error(u+" was not called"),o[0]},t.dataTypes[0]="json","script"}}),s.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return s.globalEval(e),e}}}),s.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),s.ajaxTransport("script",function(e){if(e.crossDomain){var r,i=n.head||n.getElementsByTagName("head")[0]||n.documentElement;return{send:function(s,o){r=n.createElement("script"),r.async="async",e.scriptCharset&&(r.charset=e.scriptCharset),r.src=e.url,r.onload=r.onreadystatechange=function(e,n){if(n||!r.readyState||/loaded|complete/.test(r.readyState))r.onload=r.onreadystatechange=null,i&&r.parentNode&&i.removeChild(r),r=t,n||o(200,"success")},i.insertBefore(r,i.firstChild)},abort:function(){r&&r.onload(0,1)}}}});var sn=e.ActiveXObject?function(){for(var e in un)un[e](0,1)}:!1,on=0,un;s.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&an()||fn()}:an,function(e){s.extend(s.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(s.ajaxSettings.xhr()),s.support.ajax&&s.ajaxTransport(function(n){if(!n.crossDomain||s.support.cors){var r;return{send:function(i,o){var u=n.xhr(),a,f;n.username?u.open(n.type,n.url,n.async,n.username,n.password):u.open(n.type,n.url,n.async);if(n.xhrFields)for(f in n.xhrFields)u[f]=n.xhrFields[f];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(f in i)u.setRequestHeader(f,i[f])}catch(l){}u.send(n.hasContent&&n.data||null),r=function(e,i){var f,l,c,h,p;try{if(r&&(i||u.readyState===4)){r=t,a&&(u.onreadystatechange=s.noop,sn&&delete un[a]);if(i)u.readyState!==4&&u.abort();else{f=u.status,c=u.getAllResponseHeaders(),h={},p=u.responseXML,p&&p.documentElement&&(h.xml=p);try{h.text=u.responseText}catch(e){}try{l=u.statusText}catch(d){l=""}!f&&n.isLocal&&!n.crossDomain?f=h.text?200:404:f===1223&&(f=204)}}}catch(v){i||o(-1,v)}h&&o(f,l,h,c)},!n.async||u.readyState===4?r():(a=++on,sn&&(un||(un={},s(e).unload(sn)),un[a]=r),u.onreadystatechange=r)},abort:function(){r&&r(0,1)}}}});var ln={},cn,hn,pn=/^(?:toggle|show|hide)$/,dn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,vn,mn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],gn;s.fn.extend({show:function(e,t,n){var r,i;if(e||e===0)return this.animate(wn("show",3),e,t,n);for(var o=0,u=this.length;o<u;o++)r=this[o],r.style&&(i=r.style.display,!s._data(r,"olddisplay")&&i==="none"&&(i=r.style.display=""),(i===""&&s.css(r,"display")==="none"||!s.contains(r.ownerDocument.documentElement,r))&&s._data(r,"olddisplay",En(r.nodeName)));for(o=0;o<u;o++){r=this[o];if(r.style){i=r.style.display;if(i===""||i==="none")r.style.display=s._data(r,"olddisplay")||""}}return this},hide:function(e,t,n){if(e||e===0)return this.animate(wn("hide",3),e,t,n);var r,i,o=0,u=this.length;for(;o<u;o++)r=this[o],r.style&&(i=s.css(r,"display"),i!=="none"&&!s._data(r,"olddisplay")&&s._data(r,"olddisplay",i));for(o=0;o<u;o++)this[o].style&&(this[o].style.display="none");return this},_toggle:s.fn.toggle,toggle:function(e,t,n){var r=typeof e=="boolean";return s.isFunction(e)&&s.isFunction(t)?this._toggle.apply(this,arguments):e==null||r?this.each(function(){var t=r?e:s(this).is(":hidden");s(this)[t?"show":"hide"]()}):this.animate(wn("toggle",3),e,t,n),this},fadeTo:function(e,t,n,r){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){function o(){i.queue===!1&&s._mark(this);var t=s.extend({},i),n=this.nodeType===1,r=n&&s(this).is(":hidden"),o,u,a,f,l,c,h,p,d,v,m;t.animatedProperties={};for(a in e){o=s.camelCase(a),a!==o&&(e[o]=e[a],delete e[a]);if((l=s.cssHooks[o])&&"expand"in l){c=l.expand(e[o]),delete e[o];for(a in c)a in e||(e[a]=c[a])}}for(o in e){u=e[o],s.isArray(u)?(t.animatedProperties[o]=u[1],u=e[o]=u[0]):t.animatedProperties[o]=t.specialEasing&&t.specialEasing[o]||t.easing||"swing";if(u==="hide"&&r||u==="show"&&!r)return t.complete.call(this);n&&(o==="height"||o==="width")&&(t.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],s.css(this,"display")==="inline"&&s.css(this,"float")==="none"&&(!s.support.inlineBlockNeedsLayout||En(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}t.overflow!=null&&(this.style.overflow="hidden");for(a in e)f=new s.fx(this,t,a),u=e[a],pn.test(u)?(m=s._data(this,"toggle"+a)||(u==="toggle"?r?"show":"hide":0),m?(s._data(this,"toggle"+a,m==="show"?"hide":"show"),f[m]()):f[u]()):(h=dn.exec(u),p=f.cur(),h?(d=parseFloat(h[2]),v=h[3]||(s.cssNumber[a]?"":"px"),v!=="px"&&(s.style(this,a,(d||1)+v),p=(d||1)/f.cur()*p,s.style(this,a,p+v)),h[1]&&(d=(h[1]==="-="?-1:1)*d+p),f.custom(p,d,v)):f.custom(p,u,""));return!0}var i=s.speed(t,n,r);return s.isEmptyObject(e)?this.each(i.complete,[!1]):(e=s.extend({},e),i.queue===!1?this.each(o):this.queue(i.queue,o))},stop:function(e,n,r){return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){function u(e,t,n){var i=t[n];s.removeData(e,n,!0),i.stop(r)}var t,n=!1,i=s.timers,o=s._data(this);r||s._unmark(!0,this);if(e==null)for(t in o)o[t]&&o[t].stop&&t.indexOf(".run")===t.length-4&&u(this,o,t);else o[t=e+".run"]&&o[t].stop&&u(this,o,t);for(t=i.length;t--;)i[t].elem===this&&(e==null||i[t].queue===e)&&(r?i[t](!0):i[t].saveState(),n=!0,i.splice(t,1));(!r||!n)&&s.dequeue(this,e)})}}),s.each({slideDown:wn("show",1),slideUp:wn("hide",1),slideToggle:wn("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){s.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),s.extend({speed:function(e,t,n){var r=e&&typeof e=="object"?s.extend({},e):{complete:n||!n&&t||s.isFunction(e)&&e,duration:e,easing:n&&t||t&&!s.isFunction(t)&&t};r.duration=s.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in s.fx.speeds?s.fx.speeds[r.duration]:s.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(e){s.isFunction(r.old)&&r.old.call(this),r.queue?s.dequeue(this,r.queue):e!==!1&&s._unmark(this)},r},easing:{linear:function(e){return e},swing:function(e){return-Math.cos(e*Math.PI)/2+.5}},timers:[],fx:function(e,t,n){this.options=t,this.elem=e,this.prop=n,t.orig=t.orig||{}}}),s.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(s.fx.step[this.prop]||s.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]==null||!!this.elem.style&&this.elem.style[this.prop]!=null){var e,t=s.css(this.elem,this.prop);return isNaN(e=parseFloat(t))?!t||t==="auto"?0:t:e}return this.elem[this.prop]},custom:function(e,n,r){function u(e){return i.step(e)}var i=this,o=s.fx;this.startTime=gn||yn(),this.end=n,this.now=this.start=e,this.pos=this.state=0,this.unit=r||this.unit||(s.cssNumber[this.prop]?"":"px"),u.queue=this.options.queue,u.elem=this.elem,u.saveState=function(){s._data(i.elem,"fxshow"+i.prop)===t&&(i.options.hide?s._data(i.elem,"fxshow"+i.prop,i.start):i.options.show&&s._data(i.elem,"fxshow"+i.prop,i.end))},u()&&s.timers.push(u)&&!vn&&(vn=setInterval(o.tick,o.interval))},show:function(){var e=s._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||s.style(this.elem,this.prop),this.options.show=!0,e!==t?this.custom(this.cur(),e):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),s(this.elem).show()},hide:function(){this.options.orig[this.prop]=s._data(this.elem,"fxshow"+this.prop)||s.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(e){var t,n,r,i=gn||yn(),o=!0,u=this.elem,a=this.options;if(e||i>=a.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),a.animatedProperties[this.prop]=!0;for(t in a.animatedProperties)a.animatedProperties[t]!==!0&&(o=!1);if(o){a.overflow!=null&&!s.support.shrinkWrapBlocks&&s.each(["","X","Y"],function(e,t){u.style["overflow"+t]=a.overflow[e]}),a.hide&&s(u).hide();if(a.hide||a.show)for(t in a.animatedProperties)s.style(u,t,a.orig[t]),s.removeData(u,"fxshow"+t,!0),s.removeData(u,"toggle"+t,!0);r=a.complete,r&&(a.complete=!1,r.call(u))}return!1}return a.duration==Infinity?this.now=i:(n=i-this.startTime,this.state=n/a.duration,this.pos=s.easing[a.animatedProperties[this.prop]](this.state,n,0,1,a.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},s.extend(s.fx,{tick:function(){var e,t=s.timers,n=0;for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||s.fx.stop()},interval:13,stop:function(){clearInterval(vn),vn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){s.style(e.elem,"opacity",e.now)},_default:function(e){e.elem.style&&e.elem.style[e.prop]!=null?e.elem.style[e.prop]=e.now+e.unit:e.elem[e.prop]=e.now}}}),s.each(mn.concat.apply([],mn),function(e,t){t.indexOf("margin")&&(s.fx.step[t]=function(e){s.style(e.elem,t,Math.max(0,e.now)+e.unit)})}),s.expr&&s.expr.filters&&(s.expr.filters.animated=function(e){return s.grep(s.timers,function(t){return e===t.elem}).length});var Sn,xn=/^t(?:able|d|h)$/i,Tn=/^(?:body|html)$/i;"getBoundingClientRect"in n.documentElement?Sn=function(e,t,n,r){try{r=e.getBoundingClientRect()}catch(i){}if(!r||!s.contains(n,e))return r?{top:r.top,left:r.left}:{top:0,left:0};var o=t.body,u=Nn(t),a=n.clientTop||o.clientTop||0,f=n.clientLeft||o.clientLeft||0,l=u.pageYOffset||s.support.boxModel&&n.scrollTop||o.scrollTop,c=u.pageXOffset||s.support.boxModel&&n.scrollLeft||o.scrollLeft,h=r.top+l-a,p=r.left+c-f;return{top:h,left:p}}:Sn=function(e,t,n){var r,i=e.offsetParent,o=e,u=t.body,a=t.defaultView,f=a?a.getComputedStyle(e,null):e.currentStyle,l=e.offsetTop,c=e.offsetLeft;while((e=e.parentNode)&&e!==u&&e!==n){if(s.support.fixedPosition&&f.position==="fixed")break;r=a?a.getComputedStyle(e,null):e.currentStyle,l-=e.scrollTop,c-=e.scrollLeft,e===i&&(l+=e.offsetTop,c+=e.offsetLeft,s.support.doesNotAddBorder&&(!s.support.doesAddBorderForTableAndCells||!xn.test(e.nodeName))&&(l+=parseFloat(r.borderTopWidth)||0,c+=parseFloat(r.borderLeftWidth)||0),o=i,i=e.offsetParent),s.support.subtractsBorderForOverflowNotVisible&&r.overflow!=="visible"&&(l+=parseFloat(r.borderTopWidth)||0,c+=parseFloat(r.borderLeftWidth)||0),f=r}if(f.position==="relative"||f.position==="static")l+=u.offsetTop,c+=u.offsetLeft;return s.support.fixedPosition&&f.position==="fixed"&&(l+=Math.max(n.scrollTop,u.scrollTop),c+=Math.max(n.scrollLeft,u.scrollLeft)),{top:l,left:c}},s.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){s.offset.setOffset(this,e,t)});var n=this[0],r=n&&n.ownerDocument;return r?n===r.body?s.offset.bodyOffset(n):Sn(n,r,r.documentElement):null},s.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return s.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(s.css(e,"marginTop"))||0,n+=parseFloat(s.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=s.css(e,"position");r==="static"&&(e.style.position="relative");var i=s(e),o=i.offset(),u=s.css(e,"top"),a=s.css(e,"left"),f=(r==="absolute"||r==="fixed")&&s.inArray("auto",[u,a])>-1,l={},c={},h,p;f?(c=i.position(),h=c.top,p=c.left):(h=parseFloat(u)||0,p=parseFloat(a)||0),s.isFunction(t)&&(t=t.call(e,n,o)),t.top!=null&&(l.top=t.top-o.top+h),t.left!=null&&(l.left=t.left-o.left+p),"using"in t?t.using.call(e,l):i.css(l)}},s.fn.extend({position:function(){if(!this[0])return null;var e=this[0],t=this.offsetParent(),n=this.offset(),r=Tn.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(s.css(e,"marginTop"))||0,n.left-=parseFloat(s.css(e,"marginLeft"))||0,r.top+=parseFloat(s.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(s.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||n.body;while(e&&!Tn.test(e.nodeName)&&s.css(e,"position")==="static")e=e.offsetParent;return e})}}),s.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);s.fn[e]=function(i){return s.access(this,function(e,i,o){var u=Nn(e);if(o===t)return u?n in u?u[n]:s.support.boxModel&&u.document.documentElement[i]||u.document.body[i]:e[i];u?u.scrollTo(r?s(u).scrollLeft():o,r?o:s(u).scrollTop()):e[i]=o},e,i,arguments.length,null)}}),s.each({Height:"height",Width:"width"},function(e,n){var r="client"+e,i="scroll"+e,o="offset"+e;s.fn["inner"+e]=function(){var e=this[0];return e?e.style?parseFloat(s.css(e,n,"padding")):this[n]():null},s.fn["outer"+e]=function(e){var t=this[0];return t?t.style?parseFloat(s.css(t,n,e?"margin":"border")):this[n]():null},s.fn[n]=function(e){return s.access(this,function(e,n,u){var a,f,l,c;if(s.isWindow(e))return a=e.document,f=a.documentElement[r],s.support.boxModel&&f||a.body&&a.body[r]||f;if(e.nodeType===9)return a=e.documentElement,a[r]>=a[i]?a[r]:Math.max(e.body[i],a[i],e.body[o],a[o]);if(u===t)return l=s.css(e,n),c=parseFloat(l),s.isNumeric(c)?c:l;s(e).css(n,u)},n,e,arguments.length,null)}}),e.jQuery=e.$=s,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return s})}(window),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("brooklyn-utils",["jquery","underscore"],function(e,t){function r(e){return Math.abs(Math.round(e)-e)<1e-12}var n={};return n.escape=function(e){return e==undefined||e==null?"":t.escape(e)},n.roundIfNumberToNumDecimalPlaces=function(e,n){if(!t.isNumber(e)||n<0)return e;if(r(e))return Math.round(e);var i=e,s=1;for(var o=0;o<n;o++){i*=10,s*=10;if(r(i))return Math.round(i)/s}return Number(e.toFixed(n))},n.toDisplayString=function(e){return e==null?null:(e=n.roundIfNumberToNumDecimalPlaces(e,4),typeof e!="string"&&(e=JSON.stringify(e)),n.escape(e))},n.toTextAreaString=function(e){return e==null?null:(e=n.roundIfNumberToNumDecimalPlaces(e,8),typeof e!="string"&&(e=JSON.stringify(e,null,2)),e)},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),typeof String.prototype.startsWith!="function"&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),typeof String.prototype.endsWith!="function"&&(String.prototype.endsWith=function(e){return this.slice(-e.length)==e}),n.promptCopyToClipboard=function(e){window.prompt("To copy to the clipboard, press Ctrl+C then Enter.",e)},n.pathOf=function(e){if(!e)return"";var t=document.createElement("a");return t.href=e,t.pathname},n.inputValue=function(e){return e.attr("type")==="checkbox"?e.is(":checked"):e.val()},n.bindModelFromForm=function(r,i){var s=t.isFunction(r)?new r:r,o={};return e("[name]",i).each(function(t,r){var i=e(r),s=i.attr("name");o[s]=n.inputValue(i)}),s.set(o,{silent:!0}),s},n.extractError=function(e,t,n){n&&(n===!0?console.error(t):console.error(n),console.log(e));try{var r=JSON.parse(e.responseText);return r.message?r.message:t}catch(i){return t}},secretWords=["password","passwd","credential","secret","private","access.cert","access.key"],n.isSecret=function(e){if(!e)return!1;e=e.toString().toLowerCase();for(secretWord in secretWords)if(e.indexOf(secretWords[secretWord])>=0)return!0;return!1},n.logout=function(){e.ajax({type:"POST",dataType:"text",url:"/logout",success:function(){window.location.replace("/")},failure:function(){window.location.replace("/")}})},n.setSelectionRange=function(e,t,n){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r.select()}},n.setCaretToPos=function(e,t){n.setSelectionRange(e,t,t)},e.fn.setCaretToStart=function(){return this.each(function(t,r){n.setCaretToPos(r,0),e(r).scrollTop(0)}),this},e("#logout-link").on("click",function(e){return e.preventDefault(),n.logout(),!1}),n}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.6",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!tpl/lib/basic-modal.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">&times;</button>\n    <h3><% if (title) { %><%= title %><% } else { %>&nbsp;<% } %></h3>\n</div>\n\n<div class="modal-body"></div>\n\n<div class="modal-footer">\n    <a href="#" class="btn" data-dismiss="modal"><%= cancelButtonText %></a>\n    <a href="#" class="btn btn-info modal-submit"><%= submitButtonText %></a>\n</div>\n'}),define("text!tpl/lib/config-key-type-value-input-pair.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div class="config-key-input-pair form-inline">\n    <input type="text" class="config-key-type" placeholder="Name" value="<%= type %>"/>\n    <input type="text" class="config-key-value" placeholder="Value" value="<%= value %>"/>\n    <button type="button" class="btn config-key-row-remove">-</button>\n</div>'}),define("brooklyn-view",["jquery","underscore","backbone","brooklyn-utils","text!tpl/lib/basic-modal.html","text!tpl/lib/config-key-type-value-input-pair.html"],function(e,t,n,r,i,s){var o={};return o.refresh=!0,o.toggleRefresh=function(){return this.refresh=!this.refresh,this.refresh},n.View.prototype.close=function(){this.viewIsClosed=!0,t.isFunction(this.beforeClose)&&this.beforeClose(),t.each(this._periodicFunctions,function(e){clearInterval(e)}),this.remove(),this.unbind()},n.View.prototype.viewIsClosed=!1,n.View.prototype.callPeriodically=function(e,n,r){this._periodicFunctions||(this._periodicFunctions={});var i=this._periodicFunctions[e];i&&clearInterval(i);var s=function(){o.refresh&&n.apply(this)};s=t.bind(s,this),this._periodicFunctions[e]=setInterval(s,r)},o.Form=n.View.extend({events:{change:"onChange",submit:"onSubmit"},initialize:function(){if(!this.options.body&&!this.options.template)throw new Error("body view or template function required by GenericForm");if(!this.options.onSubmit)throw new Error("onSubmit function required by GenericForm");this.onSubmitCallback=this.options.onSubmit,this.model=new(this.options.model||n.Model),t.bindAll(this,"onSubmit","onChange"),this.render()},beforeClose:function(){this.options.body&&this.options.body.close()},render:function(){return this.options.body?(this.options.body.render(),this.$el.html(this.options.body.$el)):this.$el.html(this.options.template()),r.bindModelFromForm(this.model,this.$el),this},onChange:function(t){var n=e(t.target),i=n.attr("name");this.model.set(i,r.inputValue(n),{silent:!0})},onSubmit:function(e){return e.preventDefault(),this.onSubmitCallback(this.model.clone()),!1}}),o.Modal=n.View.extend({id:t.uniqueId("modal"),className:"modal",template:t.template(i),events:{hide:"onClose","click .modal-submit":"onSubmit"},initialize:function(){if(!this.options.body)throw new Error("Modal view requires body to render");t.bindAll(this,"onSubmit","onCancel","show"),this.options.autoOpen&&this.show()},beforeClose:function(){this.options.body&&this.options.body.close()},render:function(){var e=this.options.body.title,n=t.isFunction(e)?e():t.isString(e)?e:this.options.title;return this.$el.html(this.template({title:n,submitButtonText:this.options.submitButtonText||"Apply",cancelButtonText:this.options.cancelButtonText||"Cancel"})),this.options.body.render(),this.$(".modal-body").html(this.options.body.$el),this},show:function(){return this.render().$el.modal(),this},onSubmit:function(e){if(t.isFunction(this.options.body.onSubmit)){var n=this.options.body.onSubmit.apply(this.options.body,[e]),r=this,i=function(){r.closingSuccessfully=!0,r.$el.modal("hide")},s=function(){console.log("modal submission failed!",arguments)};n||(n=!0),t.isBoolean(n)&&n?i():t.isBoolean(n)?s():t.isFunction(n.done)&&t.isFunction(n.fail)?n.done(i).fail(s):i()}return!1},onCancel:function(){t.isFunction(this.options.body.onCancel)&&this.options.body.onCancel.apply(this.options.body)},onClose:function(){this.closingSuccessfully||this.onCancel(),this.close()}}),o.requestConfirmation=function(t,r){var i=e.Deferred(),s=n.View.extend({title:r||"Confirm action",render:function(){this.$el.html(t||"")},onSubmit:function(){i.resolve()},onCancel:function(){i.reject()}});return new o.Modal({body:new s,autoOpen:!0,submitButtonText:"Yes",cancelButtonText:"No"}),i.promise()},o.showModalWith=function(e){return(new o.Modal({body:e})).show()},o.ConfigKeyInputPairList=n.View.extend({template:t.template(s),events:{"click .config-key-row-remove":"rowRemove","keypress .last":"rowAdd"},render:function(){if(this.options.configKeys){var e=t.map(this.options.configKeys,function(e,t){return this.templateRow(t,e)},this);this.$el.html(e.join(""))}return this.$el.append(this.templateRow()),this.markLast(),this},rowAdd:function(e){this.$el.append(this.templateRow()),this.markLast()},rowRemove:function(t){e(t.currentTarget).parent().remove(),this.$el.children().length==0&&this.rowAdd(),this.markLast()},markLast:function(){this.$(".last").removeClass("last"),this.$(".config-key-type").last().addClass("last"),this.$(".config-key-value").last().addClass("last")},templateRow:function(e,t){return this.template({type:e||"",value:t||""})},getConfigKeys:function(){var t={};return this.$(".config-key-type").each(function(n,r){r=e(r);var i=r.val()&&r.val().trim(),s=r.next().val()&&r.next().val().trim();i&&s&&(t[i]=s)}),t}}),o}),define("brooklyn",["underscore","brooklyn-view","brooklyn-utils"],function(e,t,n){(function(){var e=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=t.length,r=window.console=window.console||{};while(n--){var i=t[n];r[i]||(r[i]=e)}Function.prototype.bind?window.log=Function.prototype.bind.call(r.log,r):window.log=function(){Function.prototype.apply.call(r.log,r,arguments)}})();var r=e.template;e.mixin({stripComments:function(e){return e.replace(/<!--(.|[\n\r\t])*?-->\r?\n?/g,"")},template:function(t,n,i){return r(e.stripComments(t),n,i)}});var i={view:t,util:n};return i}),define("model/application",["underscore","backbone"],function(e,t){var n={};return n.Spec=t.Model.extend({defaults:function(){return{id:null,name:"",type:null,entities:null,locations:[]}},hasLocation:function(t){if(t)return e.include(this.get("locations"),t)},addLocation:function(e){var t=this.get("locations");t.push(e),this.set("locations",t),this.trigger("change"),this.trigger("change:locations")},removeLocation:function(e){var t=[],n=this.get("locations");for(var r in n)n[r]!=e&&r!=null&&t.push(n[r]);this.set("locations",t)},removeLocationIndex:function(e){var t=[],n=this.get("locations");for(var r=0;r<n.length;r++)r!=e&&t.push(n[r]);this.set("locations",t)},pruneLocations:function(){var t=e.compact(this.get("locations"));t&&e.size(t)?this.set("locations",t):this.unset("locations")},setLocationAtIndex:function(e,t){var n=[],r=this.get("locations");for(var i=0;i<r.length;i++)i!=e?n.push(r[i]):n.push(t);this.set("locations",n)},getEntities:function(){var e=this.get("entities");return e===undefined?[]:e},addEntity:function(e){var t=this.getEntities();t||(t=[],this.set("entities",t)),t.push(e.toJSON()),this.set("entities",t),this.trigger("change"),this.trigger("change:entities")},removeEntityIndex:function(e){var t=[],n=this.getEntities();for(var r=0;r<n.length;r++)r!=e&&t.push(n[r]);this.set("entities",t)},removeEntityByName:function(e){var t=[],n=this.getEntities();for(var r in n)n[r].name!=e&&t.push(n[r]);this.set("entities",t)},hasEntityWithName:function(t){return e.any(this.getEntities(),function(e){return e.name===t})}}),n.Model=t.Model.extend({defaults:function(){return{id:null,spec:{},status:"UNKNOWN",links:{}}},initialize:function(){this.id=this.get("id")},getSpec:function(){return new n.Spec(this.get("spec"))},getLinkByName:function(e){if(e)return this.get("links")[e]}}),n.Collection=t.Collection.extend({model:n.Model,url:"/v1/applications"}),n}),define("model/app-tree",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{id:"",name:"",type:"",iconUrl:"",serviceUp:"",serviceState:"",applicationId:"",parentId:"",children:[],members:[]}},getDisplayName:function(){return this.get("name")},hasChildren:function(){return this.get("children").length>0},hasMembers:function(){return this.get("members").length>0}}),n.Collection=t.Collection.extend({model:n.Model,includedEntities:[],getApplications:function(){var t=[];return e.each(this.models,function(e){e.get("id")==e.get("applicationId")&&t.push(e.get("id"))}),t},getNonApplications:function(){var t=[];return e.each(this.models,function(e){e.get("id")!=e.get("applicationId")&&t.push(e.get("id"))}),t},includeEntities:function(t){var n=this.includedEntities.length,r=[].concat(this.includedEntities);for(entityId in t){var i=t[entityId];typeof i=="string"?r.push(i):r.push(i.id)}return this.includedEntities=e.uniq(r),this.includedEntities.length>n},getEntityNameFromId:function(t){if(!this.models.length)return undefined;for(var n=0,r=this.models.length;n<r;n++){var i=this.models[n];if(i.get("id")===t)return i.getDisplayName();var s=i.get("children").slice(0);while(s.length){var o=s.pop();if(o.id===t)return o.name;e.has(o,"children")&&(s=s.concat(o.children))}}return""},url:function(){if(this.includedEntities.length){var e=this.includedEntities.join(",");return"/v1/applications/fetch?items="+e}return"/v1/applications/fetch"}}),n}),define("model/location",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({urlRoot:"/v1/locations",defaults:function(){return{name:"",spec:"",config:{}}},idFromSelfLink:function(){return this.get("id")},initialize:function(){},addConfig:function(e,t){if(e){var n=this.get("config");return n[e]=t,this.set("config",n),!0}return!1},removeConfig:function(e){if(e){var t=this.get("config");return delete t[e],this.set("config",t),!0}return!1},getConfigByName:function(e){if(e)return this.get("config")[e]},getLinkByName:function(e){if(e)return this.get("links")[e]},hasSelfUrl:function(e){return this.getLinkByName("self")===e},getPrettyName:function(){var e=null;return this.get("config")&&this.get("config").displayName&&(e=this.get("config").displayName),e!=null&&e.length>0?e:(e=this.get("name"),e!=null&&e.length>0?e:this.get("spec"))},getIdentifierName:function(){var e=null;return e=this.get("name"),e!=null&&e.length>0?e:this.get("spec")}}),n.Collection=t.Collection.extend({model:n.Model,url:"/v1/locations"}),n.UsageLocated=t.Model.extend({url:"/v1/locations/usage/LocatedLocations"}),n}),define("view/viewutils",["underscore","jquery","brooklyn"],function(e,t,n){var r={myDataTable:function(n,i){t.fn.dataTableExt.sErrMode="throw";var s={bDestroy:!0,iDisplayLength:25,bDeferRender:!0,sPaginationType:"full_numbers",sDom:"fp<'brook-db-top-toolbar'>tilp<'brook-db-bot-toolbar'>",oLanguage:{sSearch:"",sInfo:"Showing _START_ - _END_ of _TOTAL_ ",sInfoEmpty:"<i>No data</i> ",sEmptyTable:"<i>No matching records available</i>",sZeroRecords:"<i>No matching records found</i>",oPaginate:{sFirst:"&lt;&lt;",sPrevious:"&lt;",sNext:"&gt;",sLast:"&gt;&gt;"},sInfoFiltered:"(of _MAX_)",sLengthMenu:'( <select><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="-1">all</option></select> / page )'}};return e.extend(s,i),r.fadeToIndicateInitialLoad(n),n.dataTable(s)},myDataTableToolbarAddHtml:function(e,n){t(".brook-db-bot-toolbar",e.parent().parent()).append(n),t(".brook-db-top-toolbar",e.parent().parent()).append(n)},addRefreshButton:function(e){this.myDataTableToolbarAddHtml(e,'<i class="refresh table-toolbar-icon bootstrap-glyph icon-refresh handy smallpadside" rel="tooltip" title="Reload content immediately"></i>')},addFilterEmptyButton:function(e){this.myDataTableToolbarAddHtml(e,'<i class="filterEmpty table-toolbar-icon bootstrap-glyph icon-eye-open handy bottom smallpadside" rel="tooltip" title="Show/hide empty records"></i>')},addAutoRefreshButton:function(e){this.myDataTableToolbarAddHtml(e,'<i class="toggleAutoRefresh table-toolbar-icon bootstrap-glyph icon-pause handy smallpadside" rel="tooltip" title="Toggle auto-refresh"></i>')},updateMyDataTable:function(t,n,i,s){if(t==null)return;s==null&&(s={});var o=[];try{o=t.dataTable().fnGetData()}catch(u){log("WARNING: could not fetch data; clearing"),log(u),log(u.stack),t.dataTable().fnClearTable()}var a={},f={};for(var l in o){var c=o[l];a[c[0]]=l,f[c[0]]=c}var h={},p=[];r.each(n,function(e,t){var n=i(e,t);if(n!=null){var r=n[0],s=a[r];s!=null?(p[s]=n,delete a[r]):h[r]=n}});for(var d in p){var v=p[d],m=f[v[0]];for(l in v){var g=v[l];if(s.refreshAllRows||!e.isEqual(g,m[l]))try{t.fnUpdate(g,Number(d),l,!1,!1)}catch(u){log("WARNING: cannot update row"),log(u),log(u.stack),log(g),log(d),log(l)}}}for(var d in a){var y=a[d];t.fnDeleteRow(Number(y),null,!1)}for(var d in h)try{t.fnAddData(h[d],!1)}catch(u){log("WARNING: cannot add to row"),log(u),log(u.stack),log(d),log(h[d])}try{t.fnStandingRedraw()}catch(u){log("WARNING: could not redraw"),log(u),log(u.stack)}r.cancelFadeOnceLoaded(t)},toggleFilterEmpty:function(e,n){var r=t(".filterEmpty",e.parent().parent()).toggleClass("icon-eye-open icon-eye-close").hasClass("icon-eye-close");r?e.dataTable().fnFilter(".+",n,!0):e.dataTable().fnFilter(".*",n,!0)},toggleAutoRefresh:function(e){var n=t(".toggleAutoRefresh",e.$el).toggleClass("icon-pause icon-play").hasClass("icon-pause");e.enableAutoRefresh(n)},attachToggler:function(e){var n;e===undefined?n=t(".toggler-header"):n=t(".toggler-header",e),n.click(this.onTogglerClick)},onTogglerClick:function(e){r.onTogglerClickElement(t(e.currentTarget).closest(".toggler-header"))},onTogglerClickElement:function(e){e.toggleClass("user-hidden"),t(".toggler-icon",e).toggleClass("icon-chevron-left").toggleClass("icon-chevron-down");var n=e.next();e.hasClass("user-hidden")?n.slideUp("fast"):n.slideDown("fast")},showTogglerClickElement:function(e){e.removeClass("user-hidden"),t(".toggler-icon",e).removeClass("icon-chevron-left").addClass("icon-chevron-down"),e.next().slideDown("fast")},updateTextareaWithData:function(e,n,r,i,s,o){var u=t("textarea",e),a=r;n!==undefined?(u.val(n),a=!0):u.val(""),a?(this.setHeightAutomatically(u,s,o,!1),i&&e.slideDown(100)):e.hide()},setHeightAutomatically:function(t,n,r,i){var s=t.prop("scrollHeight"),o=this;return t.css("padding-top")&&(s-=parseInt(t.css("padding-top"),10)),t.css("padding-bottom")&&(s-=parseInt(t.css("padding-bottom"),10)),s==0&&!i?e.defer(function(){o.setHeightAutomatically(t,n,r,!0)}):(s=Math.min(s,r),s=Math.max(s,n),t.css("height",s)),s},each:function(t,n){return e.isFunction(t.each)?t.each(n):e.each(t,n)},processTooltips:function(e){e.find('*[rel="tooltip"]').tooltip()},fadeToIndicateInitialLoad:function(e){try{e.fadeTo(1e3,.3)}catch(t){}},cancelFadeOnceLoaded:function(e){try{e.stop(!0,!1).fadeTo(200,1)}catch(t){}},get:function(e,i,s,o){if(e.viewIsClosed)return;o||(o={}),o.count?o.count++:o.count=1;var u=o.enablement&&!o.enablement()||!n.view.refresh;if(o.count>1&&u){o.period&&setTimeout(function(){r.get(e,i,s,o)},o.period);return}var a=function(e,t,n){if(t.viewIsClosed)return!1;if(e=="success"||e=="notmodified"){if(t._loadingProblem){log("getting view data is back to normal - "+i),log(t),t._loadingProblem=!1;var o=t.$el;"fadeTarget"in n&&(o=n.fadeTarget),o&&r.cancelFadeOnceLoaded(o),n.originalPeriod&&(n.period=n.originalPeriod)}return!0}if(e=="error"||e=="timeout"||e=="parsererror"){t._loadingProblem||(log("error getting view data from "+i+" - is the server reachable?"),t._loadingProblem=!0);var o=t.$el;"fadeTarget"in n&&(o=n.fadeTarget),o&&r.fadeToIndicateInitialLoad(o);if(n.period){n.originalPeriod||(n.originalPeriod=n.period);var u=n.period;u*=2;var a=n.backoffMaxPeriod||9e5;u>a&&(u=a),n.period=u,setTimeout(function(){r.get(t,i,s,n)},u)}return!1}return!0};return t.get(i,function(t,n){if(!a(n,e,o))return;s&&s(t),o.period&&setTimeout(function(){r.get(e,i,s,o)},o.period)}).fail(function(){a("error",e,o)})},getRepeatedlyWithDelay:function(e,t,n,i){i||(i={}),i.period||(i.period=3e3),r.get(e,t,n,i)},fetchModelRepeatedlyWithDelay:function(e,t){this.fetchRepeatedlyWithDelay(undefined,e,t)},fetchRepeatedlyWithDelay:function(t,i,s){if(t&&t.viewIsClosed)return;s||(s={}),s.count?s.count++:s.count=1;var o=s.period||3e3,u=s.originalPeriod||o,a=function(){if(t&&t.viewIsClosed)return;var a=s.enablement&&!s.enablement()||!n.view.refresh;if(s.count>1&&a){r.fetchRepeatedlyWithDelay(t,i,s);return}var f=s.fetchOptions?e.clone(s.fetchOptions):{};f.success=function(e,n,o){var a=s.success;a&&a(e,n,o);if(t&&t._loadingProblem){log("fetching view data is back to normal - "+i.url),t._loadingProblem=!1;var f=t.$el;"fadeTarget"in s&&(f=s.fadeTarget),f&&r.cancelFadeOnceLoaded(f)}s.period=u,r.fetchRepeatedlyWithDelay(t,i,s)},f.error=function(n,a,f){var l=s.error;l&&l(n,a,f),t&&!t._loadingProblem&&(log("error fetching view data from "+i.url+" - is the server reachable?"),log(a),t._loadingProblem=!0);if(t){var c=t.$el;"fadeTarget"in s&&(c=s.fadeTarget),c&&r.fadeToIndicateInitialLoad(c)}o*=2;var h=s.backoffMaxPeriod||9e5;o>h&&(o=h),s=e.clone(s),s.originalPeriod=u,s.period=o,r.fetchRepeatedlyWithDelay(t,i,s)},i.fetch(f)};s.doitnow?(s.doitnow=!1,a()):setTimeout(a,o)},computeStatusIcon:function(e,t){return this.computeStatusIconInfo(e,t).url},computeStatusIconInfo:function(e,t){var n={};t!=null&&(t=t.toLowerCase()),e===!1||e=="false"?e=!1:e===!0||e=="true"?e=!0:(e!=null&&e!==""&&e!==undefined&&e.toLowerCase().indexOf("loading")<0&&(log("Unknown 'serviceUp' value:"),log(e)),e=null);var r=null,i="png",s=!1;if(t=="running")e==0?(r="running-onfire",s=!0):r="running";else if(t=="stopped"||t=="created")e==1?(r="stopped-onfire",s=!0):r="stopped";else if(t=="starting")r="starting",i="gif";else if(t=="stopping")r="stopping",i="gif";else if(t=="on_fire"||t=="on-fire"||t=="onfire")r="onfire",s=!0;return r==null&&(t!=null&&t!==""&&t!==undefined&&t.toLowerCase().indexOf("loading")<0&&(log("Unknown 'lifecycleState' value:"),log(t)),e?r="running":e===!1&&(r="stopped")),n.word=r,n.problem=s,r==null?n.url=null:n.url="/assets/img/icon-status-"+r+"."+i,n}};return r}),define("model/server-extended-status",["backbone","brooklyn","view/viewutils"],function(e,t,n){var r=e.Model.extend({callbacks:[],loaded:!1,url:"/v1/server/up/extended",onError:function(e,t,n){log("ServerExtendedStatus: error contacting Brooklyn server"),log(t),t.readyState==0?this.loaded=!1:(log(t.responseText),this.set("healthy",!1)),this.applyCallbacks()},whenUp:function(e){var t=this;this.isUp()?e():this.addCallback(function(){t.whenUp(e)})},onLoad:function(e){this.loaded?e():this.addCallback(e)},addCallback:function(e){this.callbacks.push(e)},autoUpdate:function(){var e=this;n.fetchModelRepeatedlyWithDelay(this,{doitnow:!0,backoffMaxPeriod:3e3})},isUp:function(){return this.get("up")},isShuttingDown:function(){return this.get("shuttingDown")},isHealthy:function(){return this.get("healthy")},isMaster:function(){return ha=this.get("ha")||{},ownId=ha.ownId,ownId?ha.masterId==ownId:null},getMasterUri:function(){return ha=this.get("ha")||{},nodes=ha.nodes||{},master=nodes[ha.masterId],!master||master.status!="MASTER"?null:master.nodeUri},applyCallbacks:function(){var e=this.callbacks;this.callbacks=[],_.invoke(e,"apply")}}),i=new r;return i.on("sync",function(){i.loaded=!0,i.applyCallbacks()}),i.on("error",i.onError),i}),function(e){if(typeof exports=="object"&&typeof module!="undefined")module.exports=e();else if(typeof define=="function"&&define.amd)define("js-yaml",[],e);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.jsyaml=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){function s(e){return function(){throw new Error("Function "+e+" is deprecated and cannot be used.")}}var r=e("./js-yaml/loader"),i=e("./js-yaml/dumper");t.exports.Type=e("./js-yaml/type"),t.exports.Schema=e("./js-yaml/schema"),t.exports.FAILSAFE_SCHEMA=e("./js-yaml/schema/failsafe"),t.exports.JSON_SCHEMA=e("./js-yaml/schema/json"),t.exports.CORE_SCHEMA=e("./js-yaml/schema/core"),t.exports.DEFAULT_SAFE_SCHEMA=e("./js-yaml/schema/default_safe"),t.exports.DEFAULT_FULL_SCHEMA=e("./js-yaml/schema/default_full"),t.exports.load=r.load,t.exports.loadAll=r.loadAll,t.exports.safeLoad=r.safeLoad,t.exports.safeLoadAll=r.safeLoadAll,t.exports.dump=i.dump,t.exports.safeDump=i.safeDump,t.exports.YAMLException=e("./js-yaml/exception"),t.exports.MINIMAL_SCHEMA=e("./js-yaml/schema/failsafe"),t.exports.SAFE_SCHEMA=e("./js-yaml/schema/default_safe"),t.exports.DEFAULT_SCHEMA=e("./js-yaml/schema/default_full"),t.exports.scan=s("scan"),t.exports.parse=s("parse"),t.exports.compose=s("compose"),t.exports.addConstructor=s("addConstructor")},{"./js-yaml/dumper":3,"./js-yaml/exception":4,"./js-yaml/loader":5,"./js-yaml/schema":7,"./js-yaml/schema/core":8,"./js-yaml/schema/default_full":9,"./js-yaml/schema/default_safe":10,"./js-yaml/schema/failsafe":11,"./js-yaml/schema/json":12,"./js-yaml/type":13}],2:[function(e,t,n){function r(e){return typeof e=="undefined"||null===e}function i(e){return typeof e=="object"&&null!==e}function s(e){return Array.isArray(e)?e:r(e)?[]:[e]}function o(e,t){var n,r,i,s;if(t){s=Object.keys(t);for(n=0,r=s.length;n<r;n+=1)i=s[n],e[i]=t[i]}return e}function u(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function a(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e}t.exports.isNothing=r,t.exports.isObject=i,t.exports.toArray=s,t.exports.repeat=u,t.exports.isNegativeZero=a,t.exports.extend=o},{}],3:[function(e,t,n){function P(e,t){var n,r,i,s,o,u,f;if(null===t)return{};n={},r=Object.keys(t);for(i=0,s=r.length;i<s;i+=1)o=r[i],u=String(t[o]),"!!"===o.slice(0,2)&&(o="tag:yaml.org,2002:"+o.slice(2)),f=e.compiledTypeMap[o],f&&a.call(f.styleAliases,u)&&(u=f.styleAliases[u]),n[o]=u;return n}function H(e){var t,n,s;t=e.toString(16).toUpperCase();if(e<=255)n="x",s=2;else if(e<=65535)n="u",s=4;else{if(!(e<=4294967295))throw new i("code point within a string may not be greater than 0xFFFFFFFF");n="U",s=8}return"\\"+n+r.repeat("0",s-t.length)+t}function B(e){this.schema=e.schema||s,this.indent=Math.max(1,e.indent||2),this.skipInvalid=e.skipInvalid||!1,this.flowLevel=r.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=P(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function j(e,t){var n=r.repeat(" ",t),i=0,s=-1,o="",u,a=e.length;while(i<a)s=e.indexOf("\n",i),s===-1?(u=e.slice(i),i=a):(u=e.slice(i,s+1),i=s+1),u.length&&u!=="\n"&&(o+=n),o+=u;return o}function F(e,t){return"\n"+r.repeat(" ",e.indent*t)}function I(e,t){var n,r,i;for(n=0,r=e.implicitTypes.length;n<r;n+=1){i=e.implicitTypes[n];if(i.resolve(t))return!0}return!1}function q(e){this.source=e,this.result="",this.checkpoint=0}function R(e,t,n,r){var i,s,o,u,a,f,c,p,v,m,g,b,w,S,x,C,k,A,O,M,P;if(0===t.length){e.dump="''";return}if(-1!==D.indexOf(t)){e.dump="'"+t+"'";return}i=!0,s=t.length?t.charCodeAt(0):0,o=h===s||h===t.charCodeAt(t.length-1);if(E===s||T===s||N===s||L===s)i=!1;o||e.flowLevel>-1&&e.flowLevel<=n?(o&&(i=!1),u=!1,a=!1):(u=!r,a=!r),f=!0,c=new q(t),p=!1,v=0,m=0,g=e.indent*n,b=e.lineWidth,b===-1&&(b=9007199254740991),g<40?b-=g:b=40;for(S=0;S<t.length;S++){w=t.charCodeAt(S);if(i){if(!!W(w))continue;i=!1}f&&w===y&&(f=!1),x=_[w],C=X(w);if(!x&&!C)continue;w!==l&&w!==d&&w!==y?(u=!1,a=!1):w===l&&(p=!0,f=!1,S>0&&(k=t.charCodeAt(S-1),k===h&&(a=!1,u=!1)),u&&(A=S-v,v=S,A>m&&(m=A))),w!==d&&(f=!1),c.takeUpTo(S),c.escapeChar()}i&&I(e,t)&&(i=!1),O="";if(u||a)M=0,t.charCodeAt(t.length-1)===l&&(M+=1,t.charCodeAt(t.length-2)===l&&(M+=1)),M===0?O="-":M===2&&(O="+");if(a&&m<b||e.tag!==null)u=!1;p||(a=!1);if(i)e.dump=t;else if(f)e.dump="'"+t+"'";else if(u)P=U(t,b),e.dump=">"+O+"\n"+j(P,g);else if(a)O||(t=t.replace(/\n$/,"")),e.dump="|"+O+"\n"+j(t,g);else{if(!c)throw new Error("Failed to dump scalar value");c.finish(),e.dump='"'+c.result+'"'}return}function U(e,t){var n="",r=0,i=e.length,s=/\n+$/.exec(e),o;s&&(i=s.index+1);while(r<i)o=e.indexOf("\n",r),o>i||o===-1?(n&&(n+="\n\n"),n+=z(e.slice(r,i),t),r=i):(n&&(n+="\n\n"),n+=z(e.slice(r,o),t),r=o+1);return s&&s[0]!=="\n"&&(n+=s[0]),n}function z(e,t){if(e==="")return e;var n=/[^\s] [^\s]/g,r="",i=0,s=0,o=n.exec(e),u,a,f;while(o)u=o.index,u-s>t&&(i!==s?a=i:a=u,r&&(r+="\n"),f=e.slice(s,a),r+=f,s=a+1),i=u+1,o=n.exec(e);return r&&(r+="\n"),s!==i&&e.length-s>t?r+=e.slice(s,i)+"\n"+e.slice(i+1):r+=e.slice(s),r}function W(e){return f!==e&&l!==e&&c!==e&&w!==e&&C!==e&&k!==e&&A!==e&&M!==e&&v!==e&&g!==e&&b!==e&&p!==e&&O!==e&&x!==e&&y!==e&&d!==e&&m!==e&&S!==e&&!_[e]&&!X(e)}function X(e){return!(32<=e&&e<=126||133===e||160<=e&&e<=55295||57344<=e&&e<=65533||65536<=e&&e<=1114111)}function V(e,t,n){var r="",i=e.tag,s,o;for(s=0,o=n.length;s<o;s+=1)G(e,t,n[s],!1,!1)&&(0!==s&&(r+=", "),r+=e.dump);e.tag=i,e.dump="["+r+"]"}function $(e,t,n,r){var i="",s=e.tag,o,u;for(o=0,u=n.length;o<u;o+=1)if(G(e,t+1,n[o],!0,!0)){if(!r||0!==o)i+=F(e,t);i+="- "+e.dump}e.tag=s,e.dump=i||"[]"}function J(e,t,n){var r="",i=e.tag,s=Object.keys(n),o,u,a,f,l;for(o=0,u=s.length;o<u;o+=1){l="",0!==o&&(l+=", "),a=s[o],f=n[a];if(!G(e,t,a,!1,!1))continue;e.dump.length>1024&&(l+="? "),l+=e.dump+": ";if(!G(e,t,f,!1,!1))continue;l+=e.dump,r+=l}e.tag=i,e.dump="{"+r+"}"}function K(e,t,n,r){var s="",o=e.tag,u=Object.keys(n),a,f,c,h,p,d;if(e.sortKeys===!0)u.sort();else if(typeof e.sortKeys=="function")u.sort(e.sortKeys);else if(e.sortKeys)throw new i("sortKeys must be a boolean or a function");for(a=0,f=u.length;a<f;a+=1){d="";if(!r||0!==a)d+=F(e,t);c=u[a],h=n[c];if(!G(e,t+1,c,!0,!0,!0))continue;p=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024,p&&(e.dump&&l===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,p&&(d+=F(e,t));if(!G(e,t+1,h,!0,p))continue;e.dump&&l===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,s+=d}e.tag=o,e.dump=s||"{}"}function Q(e,t,n){var r,s,o,f,l,c;s=n?e.explicitTypes:e.implicitTypes;for(o=0,f=s.length;o<f;o+=1){l=s[o];if((l.instanceOf||l.predicate)&&(!l.instanceOf||"object"==typeof t&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){e.tag=n?l.tag:"?";if(l.represent){c=e.styleMap[l.tag]||l.defaultStyle;if("[object Function]"===u.call(l.represent))r=l.represent(t,c);else{if(!a.call(l.represent,c))throw new i("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');r=l.represent[c](t,c)}e.dump=r}return!0}}return!1}function G(e,t,n,r,s,o){e.tag=null,e.dump=n,Q(e,n,!1)||Q(e,n,!0);var a=u.call(e.dump);r&&(r=0>e.flowLevel||e.flowLevel>t);var f="[object Object]"===a||"[object Array]"===a,l,c;f&&(l=e.duplicates.indexOf(n),c=l!==-1);if(null!==e.tag&&"?"!==e.tag||c||2!==e.indent&&t>0)s=!1;if(c&&e.usedDuplicates[l])e.dump="*ref_"+l;else{f&&c&&!e.usedDuplicates[l]&&(e.usedDuplicates[l]=!0);if("[object Object]"===a)r&&0!==Object.keys(e.dump).length?(K(e,t,e.dump,s),c&&(e.dump="&ref_"+l+e.dump)):(J(e,t,e.dump),c&&(e.dump="&ref_"+l+" "+e.dump));else if("[object Array]"===a)r&&0!==e.dump.length?($(e,t,e.dump,s),c&&(e.dump="&ref_"+l+e.dump)):(V(e,t,e.dump),c&&(e.dump="&ref_"+l+" "+e.dump));else{if("[object String]"!==a){if(e.skipInvalid)return!1;throw new i("unacceptable kind of an object to dump "+a)}"?"!==e.tag&&R(e,e.dump,t,o)}null!==e.tag&&"?"!==e.tag&&(e.dump="!<"+e.tag+"> "+e.dump)}return!0}function Y(e,t){var n=[],r=[],i,s;Z(e,n,r);for(i=0,s=r.length;i<s;i+=1)t.duplicates.push(n[r[i]]);t.usedDuplicates=new Array(s)}function Z(e,t,n){var r,i,s;if(null!==e&&"object"==typeof e){i=t.indexOf(e);if(-1!==i)-1===n.indexOf(i)&&n.push(i);else{t.push(e);if(Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)Z(e[i],t,n);else{r=Object.keys(e);for(i=0,s=r.length;i<s;i+=1)Z(e[r[i]],t,n)}}}}function et(e,t){t=t||{};var n=new B(t);return n.noRefs||Y(e,n),G(n,0,e,!0,!0)?n.dump+"\n":""}function tt(e,t){return et(e,r.extend({schema:o},t))}var r=e("./common"),i=e("./exception"),s=e("./schema/default_full"),o=e("./schema/default_safe"),u=Object.prototype.toString,a=Object.prototype.hasOwnProperty,f=9,l=10,c=13,h=32,p=33,d=34,v=35,m=37,g=38,y=39,b=42,w=44,E=45,S=58,x=62,T=63,N=64,C=91,k=93,L=96,A=123,O=124,M=125,_={};_[0]="\\0",_[7]="\\a",_[8]="\\b",_[9]="\\t",_[10]="\\n",_[11]="\\v",_[12]="\\f",_[13]="\\r",_[27]="\\e",_[34]='\\"',_[92]="\\\\",_[133]="\\N",_[160]="\\_",_[8232]="\\L",_[8233]="\\P";var D=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];q.prototype.takeUpTo=function(e){var t;if(e<this.checkpoint)throw t=new Error("position should be > checkpoint"),t.position=e,t.checkpoint=this.checkpoint,t;return this.result+=this.source.slice(this.checkpoint,e),this.checkpoint=e,this},q.prototype.escapeChar=function(){var e,t;return e=this.source.charCodeAt(this.checkpoint),t=_[e]||H(e),this.result+=t,this.checkpoint+=1,this},q.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)},t.exports.dump=et,t.exports.safeDump=tt},{"./common":2,"./exception":4,"./schema/default_full":9,"./schema/default_safe":10}],4:[function(e,t,n){function r(e,t){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=e,this.mark=t,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.toString=function i(e){var t=this.name+": ";return t+=this.reason||"(unknown reason)",!e&&this.mark&&(t+=" "+this.mark.toString()),t},t.exports=r},{}],5:[function(e,t,n){function E(e){return e===10||e===13}function S(e){return e===9||e===32}function x(e){return e===9||e===32||e===10||e===13}function T(e){return 44===e||91===e||93===e||123===e||125===e}function N(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function C(e){return e===120?2:e===117?4:e===85?8:0}function k(e){return 48<=e&&e<=57?e-48:-1}function L(e){return e===48?"\0":e===97?"":e===98?"\b":e===116?"	":e===9?"	":e===110?"\n":e===118?"":e===102?"\f":e===114?"\r":e===101?"":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function A(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function D(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||u,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function P(e,t){return new i(t,new s(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function H(e,t){throw P(e,t)}function B(e,t){e.onWarning&&e.onWarning.call(null,P(e,t))}function F(e,t,n,r){var i,s,o,u;if(t<n){u=e.input.slice(t,n);if(r)for(i=0,s=u.length;i<s;i+=1)o=u.charCodeAt(i),9===o||32<=o&&o<=1114111||H(e,"expected valid JSON character");else m.test(u)&&H(e,"the stream contains non-printable characters");e.result+=u}}function I(e,t,n,i){var s,o,u,f;r.isObject(n)||H(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n);for(u=0,f=s.length;u<f;u+=1)o=s[u],a.call(t,o)||(t[o]=n[o],i[o]=!0)}function q(e,t,n,r,i,s){var o,u;i=String(i),null===t&&(t={});if("tag:yaml.org,2002:merge"===r)if(Array.isArray(s))for(o=0,u=s.length;o<u;o+=1)I(e,t,s[o],n);else I(e,t,s,n);else!e.json&&!a.call(n,i)&&a.call(t,i)&&H(e,"duplicated mapping key"),t[i]=s,delete n[i];return t}function R(e){var t;t=e.input.charCodeAt(e.position),10===t?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):H(e,"a line break is expected"),e.line+=1,e.lineStart=e.position}function U(e,t,n){var r=0,i=e.input.charCodeAt(e.position);while(0!==i){while(S(i))i=e.input.charCodeAt(++e.position);if(t&&35===i)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&0!==i);if(!E(i))break;R(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;while(32===i)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&B(e,"deficient indentation"),r}function z(e){var t=e.position,n;n=e.input.charCodeAt(t);if((45===n||46===n)&&e.input.charCodeAt(t+1)===n&&e.input.charCodeAt(t+2)===n){t+=3,n=e.input.charCodeAt(t);if(n===0||x(n))return!0}return!1}function W(e,t){1===t?e.result+=" ":t>1&&(e.result+=r.repeat("\n",t-1))}function X(e,t,n){var r,i,s,o,u,a,f,l,c=e.kind,h=e.result,p;p=e.input.charCodeAt(e.position);if(x(p)||T(p)||35===p||38===p||42===p||33===p||124===p||62===p||39===p||34===p||37===p||64===p||96===p)return!1;if(63===p||45===p){i=e.input.charCodeAt(e.position+1);if(x(i)||n&&T(i))return!1}e.kind="scalar",e.result="",s=o=e.position,u=!1;while(0!==p){if(58===p){i=e.input.charCodeAt(e.position+1);if(x(i)||n&&T(i))break}else if(35===p){r=e.input.charCodeAt(e.position-1);if(x(r))break}else{if(e.position===e.lineStart&&z(e)||n&&T(p))break;if(E(p)){a=e.line,f=e.lineStart,l=e.lineIndent,U(e,!1,-1);if(e.lineIndent>=t){u=!0,p=e.input.charCodeAt(e.position);continue}e.position=o,e.line=a,e.lineStart=f,e.lineIndent=l;break}}u&&(F(e,s,o,!1),W(e,e.line-a),s=o=e.position,u=!1),S(p)||(o=e.position+1),p=e.input.charCodeAt(++e.position)}return F(e,s,o,!1),e.result?!0:(e.kind=c,e.result=h,!1)}function V(e,t){var n,r,i;n=e.input.charCodeAt(e.position);if(39!==n)return!1;e.kind="scalar",e.result="",e.position++,r=i=e.position;while(0!==(n=e.input.charCodeAt(e.position)))if(39===n){F(e,r,e.position,!0),n=e.input.charCodeAt(++e.position);if(39!==n)return!0;r=i=e.position,e.position++}else E(n)?(F(e,r,i,!0),W(e,U(e,!1,t)),r=i=e.position):e.position===e.lineStart&&z(e)?H(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);H(e,"unexpected end of the stream within a single quoted scalar")}function $(e,t){var n,r,i,s,o,u;u=e.input.charCodeAt(e.position);if(34!==u)return!1;e.kind="scalar",e.result="",e.position++,n=r=e.position;while(0!==(u=e.input.charCodeAt(e.position))){if(34===u)return F(e,n,e.position,!0),e.position++,!0;if(92===u){F(e,n,e.position,!0),u=e.input.charCodeAt(++e.position);if(E(u))U(e,!1,t);else if(u<256&&O[u])e.result+=M[u],e.position++;else if((o=C(u))>0){i=o,s=0;for(;i>0;i--)u=e.input.charCodeAt(++e.position),(o=N(u))>=0?s=(s<<4)+o:H(e,"expected hexadecimal character");e.result+=A(s),e.position++}else H(e,"unknown escape sequence");n=r=e.position}else E(u)?(F(e,n,r,!0),W(e,U(e,!1,t)),n=r=e.position):e.position===e.lineStart&&z(e)?H(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}H(e,"unexpected end of the stream within a double quoted scalar")}function J(e,t){var n=!0,r,i=e.tag,s,o=e.anchor,u,a,l,c,h,p={},d,v,m,g;g=e.input.charCodeAt(e.position);if(g===91)a=93,h=!1,s=[];else{if(g!==123)return!1;a=125,h=!0,s={}}null!==e.anchor&&(e.anchorMap[e.anchor]=s),g=e.input.charCodeAt(++e.position);while(0!==g){U(e,!0,t),g=e.input.charCodeAt(e.position);if(g===a)return e.position++,e.tag=i,e.anchor=o,e.kind=h?"mapping":"sequence",e.result=s,!0;n||H(e,"missed comma between flow collection entries"),v=d=m=null,l=c=!1,63===g&&(u=e.input.charCodeAt(e.position+1),x(u)&&(l=c=!0,e.position++,U(e,!0,t))),r=e.line,tt(e,t,f,!1,!0),v=e.tag,d=e.result,U(e,!0,t),g=e.input.charCodeAt(e.position),(c||e.line===r)&&58===g&&(l=!0,g=e.input.charCodeAt(++e.position),U(e,!0,t),tt(e,t,f,!1,!0),m=e.result),h?q(e,s,p,v,d,m):l?s.push(q(e,null,p,v,d,m)):s.push(d),U(e,!0,t),g=e.input.charCodeAt(e.position),44===g?(n=!0,g=e.input.charCodeAt(++e.position)):n=!1}H(e,"unexpected end of the stream within a flow collection")}function K(e,t){var n,i,s=p,o=!1,u=t,a=0,f=!1,l,c;c=e.input.charCodeAt(e.position);if(c===124)i=!1;else{if(c!==62)return!1;i=!0}e.kind="scalar",e.result="";while(0!==c){c=e.input.charCodeAt(++e.position);if(43===c||45===c)p===s?s=43===c?v:d:H(e,"repeat of a chomping mode identifier");else{if(!((l=k(c))>=0))break;l===0?H(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?H(e,"repeat of an indentation width identifier"):(u=t+l-1,o=!0)}}if(S(c)){do c=e.input.charCodeAt(++e.position);while(S(c));if(35===c)do c=e.input.charCodeAt(++e.position);while(!E(c)&&0!==c)}while(0!==c){R(e),e.lineIndent=0,c=e.input.charCodeAt(e.position);while((!o||e.lineIndent<u)&&32===c)e.lineIndent++,c=e.input.charCodeAt(++e.position);!o&&e.lineIndent>u&&(u=e.lineIndent);if(E(c)){a++;continue}if(e.lineIndent<u){s===v?e.result+=r.repeat("\n",a):s===p&&o&&(e.result+="\n");break}i?S(c)?(f=!0,e.result+=r.repeat("\n",a+1)):f?(f=!1,e.result+=r.repeat("\n",a+1)):0===a?o&&(e.result+=" "):e.result+=r.repeat("\n",a):o?e.result+=r.repeat("\n",a+1):e.result+=r.repeat("\n",a),o=!0,a=0,n=e.position;while(!E(c)&&0!==c)c=e.input.charCodeAt(++e.position);F(e,n,e.position,!1)}return!0}function Q(e,t){var n,r=e.tag,i=e.anchor,s=[],o,u=!1,a;null!==e.anchor&&(e.anchorMap[e.anchor]=s),a=e.input.charCodeAt(e.position);while(0!==a){if(45!==a)break;o=e.input.charCodeAt(e.position+1);if(!x(o))break;u=!0,e.position++;if(U(e,!0,-1)&&e.lineIndent<=t){s.push(null),a=e.input.charCodeAt(e.position);continue}n=e.line,tt(e,t,c,!1,!0),s.push(e.result),U(e,!0,-1),a=e.input.charCodeAt(e.position);if((e.line===n||e.lineIndent>t)&&0!==a)H(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return u?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function G(e,t,n){var r,i,s,o=e.tag,u=e.anchor,a={},f={},c=null,p=null,d=null,v=!1,m=!1,g;null!==e.anchor&&(e.anchorMap[e.anchor]=a),g=e.input.charCodeAt(e.position);while(0!==g){r=e.input.charCodeAt(e.position+1),s=e.line;if(63!==g&&58!==g||!x(r)){if(!tt(e,n,l,!1,!0))break;if(e.line===s){g=e.input.charCodeAt(e.position);while(S(g))g=e.input.charCodeAt(++e.position);if(58===g)g=e.input.charCodeAt(++e.position),x(g)||H(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(q(e,a,f,c,p,null),c=p=d=null),m=!0,v=!1,i=!1,c=e.tag,p=e.result;else{if(!m)return e.tag=o,e.anchor=u,!0;H(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!m)return e.tag=o,e.anchor=u,!0;H(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===g?(v&&(q(e,a,f,c,p,null),c=p=d=null),m=!0,v=!0,i=!0):v?(v=!1,i=!0):H(e,"incomplete explicit mapping pair; a key node is missed"),e.position+=1,g=r;if(e.line===s||e.lineIndent>t)tt(e,t,h,!0,i)&&(v?p=e.result:d=e.result),v||(q(e,a,f,c,p,d),c=p=d=null),U(e,!0,-1),g=e.input.charCodeAt(e.position);if(e.lineIndent>t&&0!==g)H(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&q(e,a,f,c,p,null),m&&(e.tag=o,e.anchor=u,e.kind="mapping",e.result=a),m}function Y(e){var t,n=!1,r=!1,i,s,o;o=e.input.charCodeAt(e.position);if(33!==o)return!1;null!==e.tag&&H(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),60===o?(n=!0,o=e.input.charCodeAt(++e.position)):33===o?(r=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position;if(n){do o=e.input.charCodeAt(++e.position);while(0!==o&&62!==o);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):H(e,"unexpected end of the stream within a verbatim tag")}else{while(0!==o&&!x(o))33===o&&(r?H(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),b.test(i)||H(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),y.test(s)&&H(e,"tag suffix cannot contain flow indicator characters")}return s&&!w.test(s)&&H(e,"tag name cannot contain such characters: "+s),n?e.tag=s:a.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:"!"===i?e.tag="!"+s:"!!"===i?e.tag="tag:yaml.org,2002:"+s:H(e,'undeclared tag handle "'+i+'"'),!0}function Z(e){var t,n;n=e.input.charCodeAt(e.position);if(38!==n)return!1;null!==e.anchor&&H(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;while(0!==n&&!x(n)&&!T(n))n=e.input.charCodeAt(++e.position);return e.position===t&&H(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function et(e){var t,n,r;r=e.input.charCodeAt(e.position);if(42!==r)return!1;r=e.input.charCodeAt(++e.position),t=e.position;while(0!==r&&!x(r)&&!T(r))r=e.input.charCodeAt(++e.position);return e.position===t&&H(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),e.anchorMap.hasOwnProperty(n)||H(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],U(e,!0,-1),!0}function tt(e,t,n,r,i){var s,o,u,p=1,d=!1,v=!1,m,g,y,b,w;e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=u=h===n||c===n,r&&U(e,!0,-1)&&(d=!0,e.lineIndent>t?p=1:e.lineIndent===t?p=0:e.lineIndent<t&&(p=-1));if(1===p)while(Y(e)||Z(e))U(e,!0,-1)?(d=!0,u=s,e.lineIndent>t?p=1:e.lineIndent===t?p=0:e.lineIndent<t&&(p=-1)):u=!1;u&&(u=d||i);if(1===p||h===n)f===n||l===n?b=t:b=t+1,w=e.position-e.lineStart,1===p?u&&(Q(e,w)||G(e,w,b))||J(e,b)?v=!0:(o&&K(e,b)||V(e,b)||$(e,b)?v=!0:et(e)?(v=!0,(null!==e.tag||null!==e.anchor)&&H(e,"alias node should not have any properties")):X(e,b,f===n)&&(v=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===p&&(v=u&&Q(e,w));if(null!==e.tag&&"!"!==e.tag)if("?"===e.tag)for(m=0,g=e.implicitTypes.length;m<g;m+=1){y=e.implicitTypes[m];if(y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else a.call(e.typeMap,e.tag)?(y=e.typeMap[e.tag],null!==e.result&&y.kind!==e.kind&&H(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result)?(e.result=y.construct(e.result),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):H(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")):H(e,"unknown tag !<"+e.tag+">");return e.listener!==null&&e.listener("close",e),null!==e.tag||null!==e.anchor||v}function nt(e){var t=e.position,n,r,i,s=!1,o;e.version=null,e.checkLineBreaks=e.legacy,e.tagMap={},e.anchorMap={};while(0!==(o=e.input.charCodeAt(e.position))){U(e,!0,-1),o=e.input.charCodeAt(e.position);if(e.lineIndent>0||37!==o)break;s=!0,o=e.input.charCodeAt(++e.position),n=e.position;while(0!==o&&!x(o))o=e.input.charCodeAt(++e.position);r=e.input.slice(n,e.position),i=[],r.length<1&&H(e,"directive name must not be less than one character in length");while(0!==o){while(S(o))o=e.input.charCodeAt(++e.position);if(35===o){do o=e.input.charCodeAt(++e.position);while(0!==o&&!E(o));break}if(E(o))break;n=e.position;while(0!==o&&!x(o))o=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}0!==o&&R(e),a.call(j,r)?j[r](e,r,i):B(e,'unknown document directive "'+r+'"')}U(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,U(e,!0,-1)):s&&H(e,"directives end mark is expected"),tt(e,e.lineIndent-1,h,!1,!0),U(e,!0,-1),e.checkLineBreaks&&g.test(e.input.slice(t,e.position))&&B(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result);if(e.position===e.lineStart&&z(e)){46===e.input.charCodeAt(e.position)&&(e.position+=3,U(e,!0,-1));return}if(!(e.position<e.length-1))return;H(e,"end of the stream or a document separator is expected")}function rt(e,t){e=String(e),t=t||{},e.length!==0&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new D(e,t);n.input+="\0";while(32===n.input.charCodeAt(n.position))n.lineIndent+=1,n.position+=1;while(n.position<n.length-1)nt(n);return n.documents}function it(e,t,n){var r=rt(e,n),i,s;for(i=0,s=r.length;i<s;i+=1)t(r[i])}function st(e,t){var n=rt(e,t);if(0===n.length)return undefined;if(1===n.length)return n[0];throw new i("expected a single document in the stream, but found more")}function ot(e,t,n){it(e,t,r.extend({schema:o},n))}function ut(e,t){return st(e,r.extend({schema:o},t))}var r=e("./common"),i=e("./exception"),s=e("./mark"),o=e("./schema/default_safe"),u=e("./schema/default_full"),a=Object.prototype.hasOwnProperty,f=1,l=2,c=3,h=4,p=1,d=2,v=3,m=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=/[\x85\u2028\u2029]/,y=/[,\[\]\{\}]/,b=/^(?:!|!!|![a-z\-]+!)$/i,w=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i,O=new Array(256),M=new Array(256);for(var _=0;_<256;_++)O[_]=L(_)?1:0,M[_]=L(_);var j={YAML:function(t,n,r){var i,s,o;null!==t.version&&H(t,"duplication of %YAML directive"),1!==r.length&&H(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),null===i&&H(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),1!==s&&H(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&B(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var i,s;2!==r.length&&H(t,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],b.test(i)||H(t,"ill-formed tag handle (first argument) of the TAG directive"),a.call(t.tagMap,i)&&H(t,'there is a previously declared suffix for "'+i+'" tag handle'),w.test(s)||H(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[i]=s}};t.exports.loadAll=it,t.exports.load=st,t.exports.safeLoadAll=ot,t.exports.safeLoad=ut},{"./common":2,"./exception":4,"./mark":6,"./schema/default_full":9,"./schema/default_safe":10}],6:[function(e,t,n){function i(e,t,n,r,i){this.name=e,this.buffer=t,this.position=n,this.line=r,this.column=i}var r=e("./common");i.prototype.getSnippet=function(t,n){var i,s,o,u,a;if(!this.buffer)return null;t=t||4,n=n||75,i="",s=this.position;while(s>0&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(s-1))){s-=1;if(this.position-s>n/2-1){i=" ... ",s+=5;break}}o="",u=this.position;while(u<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(u))){u+=1;if(u-this.position>n/2-1){o=" ... ",u-=5;break}}return a=this.buffer.slice(s,u),r.repeat(" ",t)+i+a+o+"\n"+r.repeat(" ",t+this.position-s+i.length)+"^"},i.prototype.toString=function s(e){var t,n="";return this.name&&(n+='in "'+this.name+'" '),n+="at line "+(this.line+1)+", column "+(this.column+1),e||(t=this.getSnippet(),t&&(n+=":\n"+t)),n},t.exports=i},{"./common":2}],7:[function(e,t,n){function o(e,t,n){var r=[];return e.include.forEach(function(e){n=o(e,t,n)}),e[t].forEach(function(e){n.forEach(function(t,n){t.tag===e.tag&&r.push(n)}),n.push(e)}),n.filter(function(e,t){return-1===r.indexOf(t)})}function u(){function r(t){e[t.tag]=t}var e={},t,n;for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function a(e){this.include=e.include||[],this.implicit=e.implicit||[],this.explicit=e.explicit||[],this.implicit.forEach(function(e){if(e.loadKind&&"scalar"!==e.loadKind)throw new i("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=o(this,"implicit",[]),this.compiledExplicit=o(this,"explicit",[]),this.compiledTypeMap=u(this.compiledImplicit,this.compiledExplicit)}var r=e("./common"),i=e("./exception"),s=e("./type");a.DEFAULT=null,a.create=function(){var t,n;switch(arguments.length){case 1:t=a.DEFAULT,n=arguments[0];break;case 2:t=arguments[0],n=arguments[1];break;default:throw new i("Wrong number of arguments for Schema.create function")}t=r.toArray(t),n=r.toArray(n);if(!t.every(function(e){return e instanceof a}))throw new i("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!n.every(function(e){return e instanceof s}))throw new i("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new a({include:t,explicit:n})},t.exports=a},{"./common":2,"./exception":4,"./type":13}],8:[function(e,t,n){var r=e("../schema");t.exports=new r({include:[e("./json")]})},{"../schema":7,"./json":12}],9:[function(e,t,n){var r=e("../schema");t.exports=r.DEFAULT=new r({include:[e("./default_safe")],explicit:[e("../type/js/undefined"),e("../type/js/regexp"),e("../type/js/function")]})},{"../schema":7,"../type/js/function":18,"../type/js/regexp":19,"../type/js/undefined":20,"./default_safe":10}],10:[function(e,t,n){var r=e("../schema");t.exports=new r({include:[e("./core")],implicit:[e("../type/timestamp"),e("../type/merge")],explicit:[e("../type/binary"),e("../type/omap"),e("../type/pairs"),e("../type/set")]})},{"../schema":7,"../type/binary":14,"../type/merge":22,"../type/omap":24,"../type/pairs":25,"../type/set":27,"../type/timestamp":29,"./core":8}],11:[function(e,t,n){var r=e("../schema");t.exports=new r({explicit:[e("../type/str"),e("../type/seq"),e("../type/map")]})},{"../schema":7,"../type/map":21,"../type/seq":26,"../type/str":28}],12:[function(e,t,n){var r=e("../schema");t.exports=new r({include:[e("./failsafe")],implicit:[e("../type/null"),e("../type/bool"),e("../type/int"),e("../type/float")]})},{"../schema":7,"../type/bool":15,"../type/float":16,"../type/int":17,"../type/null":23,"./failsafe":11}],13:[function(e,t,n){function o(e){var t={};return null!==e&&Object.keys(e).forEach(function(n){e[n].forEach(function(e){t[String(e)]=n})}),t}function u(e,t){t=t||{},Object.keys(t).forEach(function(t){if(-1===i.indexOf(t))throw new r('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.defaultStyle=t.defaultStyle||null,this.styleAliases=o(t.styleAliases||null);if(-1===s.indexOf(this.kind))throw new r('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var r=e("./exception"),i=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],s=["scalar","sequence","mapping"];t.exports=u},{"./exception":4}],14:[function(e,t,n){function o(e){if(null===e)return!1;var t,n,r=0,i=e.length,o=s;for(n=0;n<i;n++){t=o.indexOf(e.charAt(n));if(t>64)continue;if(t<0)return!1;r+=6}return r%8===0}function u(e){var t,n,i=e.replace(/[\r\n=]/g,""),o=i.length,u=s,a=0,f=[];for(t=0;t<o;t++)t%4===0&&t&&(f.push(a>>16&255),f.push(a>>8&255),f.push(a&255)),a=a<<6|u.indexOf(i.charAt(t));return n=o%4*6,n===0?(f.push(a>>16&255),f.push(a>>8&255),f.push(a&255)):n===18?(f.push(a>>10&255),f.push(a>>2&255)):n===12&&f.push(a>>4&255),r?new r(f):f}function a(e){var t="",n=0,r,i,o=e.length,u=s;for(r=0;r<o;r++)r%3===0&&r&&(t+=u[n>>18&63],t+=u[n>>12&63],t+=u[n>>6&63],t+=u[n&63]),n=(n<<8)+e[r];return i=o%3,i===0?(t+=u[n>>18&63],t+=u[n>>12&63],t+=u[n>>6&63],t+=u[n&63]):i===2?(t+=u[n>>10&63],t+=u[n>>4&63],t+=u[n<<2&63],t+=u[64]):i===1&&(t+=u[n>>2&63],t+=u[n<<4&63],t+=u[64],t+=u[64]),t}function f(e){return r&&r.isBuffer(e)}var r=e("buffer").Buffer,i=e("../type"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";t.exports=new i("tag:yaml.org,2002:binary",{kind:"scalar",resolve:o,construct:u,predicate:f,represent:a})},{"../type":13,buffer:30}],15:[function(e,t,n){function i(e){if(null===e)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function s(e){return e==="true"||e==="True"||e==="TRUE"}function o(e){return"[object Boolean]"===Object.prototype.toString.call(e)}var r=e("../type");t.exports=new r("tag:yaml.org,2002:bool",{kind:"scalar",resolve:i,construct:s,predicate:o,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"})},{"../type":13}],16:[function(e,t,n){function o(e){return null===e?!1:s.test(e)?!0:!1}function u(e){var t,n,r,i;return t=e.replace(/_/g,"").toLowerCase(),n="-"===t[0]?-1:1,i=[],0<="+-".indexOf(t[0])&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:0<=t.indexOf(":")?(t.split(":").forEach(function(e){i.unshift(parseFloat(e,10))}),t=0,r=1,i.forEach(function(e){t+=e*r,r*=60}),n*t):n*parseFloat(t,10)}function f(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(r.isNegativeZero(e))return"-0.0";return n=e.toString(10),a.test(n)?n.replace("e",".e"):n}function l(e){return"[object Number]"===Object.prototype.toString.call(e)&&(0!==e%1||r.isNegativeZero(e))}var r=e("../common"),i=e("../type"),s=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),a=/^[-+]?[0-9]+e/;t.exports=new i("tag:yaml.org,2002:float",{kind:"scalar",resolve:o,construct:u,predicate:l,represent:f,defaultStyle:"lowercase"})},{"../common":2,"../type":13}],17:[function(e,t,n){function s(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function o(e){return 48<=e&&e<=55}function u(e){return 48<=e&&e<=57}function a(e){if(null===e)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;i=e[n];if(i==="-"||i==="+")i=e[++n];if(i==="0"){if(n+1===t)return!0;i=e[++n];if(i==="b"){n++;for(;n<t;n++){i=e[n];if(i==="_")continue;if(i!=="0"&&i!=="1")return!1;r=!0}return r}if(i==="x"){n++;for(;n<t;n++){i=e[n];if(i==="_")continue;if(!s(e.charCodeAt(n)))return!1;r=!0}return r}for(;n<t;n++){i=e[n];if(i==="_")continue;if(!o(e.charCodeAt(n)))return!1;r=!0}return r}for(;n<t;n++){i=e[n];if(i==="_")continue;if(i===":")break;if(!u(e.charCodeAt(n)))return!1;r=!0}return r?i!==":"?!0:/^(:[0-5]?[0-9])+$/.test(e.slice(n)):!1}function f(e){var t=e,n=1,r,i,s=[];t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0];if(r==="-"||r==="+")r==="-"&&(n=-1),t=t.slice(1),r=t[0];return"0"===t?0:r==="0"?t[1]==="b"?n*parseInt(t.slice(2),2):t[1]==="x"?n*parseInt(t,16):n*parseInt(t,8):t.indexOf(":")!==-1?(t.split(":").forEach(function(e){s.unshift(parseInt(e,10))}),t=0,i=1,s.forEach(function(e){t+=e*i,i*=60}),n*t):n*parseInt(t,10)}function l(e){return"[object Number]"===Object.prototype.toString.call(e)&&0===e%1&&!r.isNegativeZero(e)}var r=e("../common"),i=e("../type");t.exports=new i("tag:yaml.org,2002:int",{kind:"scalar",resolve:a,construct:f,predicate:l,represent:{binary:function(e){return"0b"+e.toString(2)},octal:function(e){return"0"+e.toString(8)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return"0x"+e.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},{"../common":2,"../type":13}],18:[function(e,t,n){function u(e){if(null===e)return!1;try{var t="("+e+")",n=r.parse(t,{range:!0});return"Program"!==n.type||1!==n.body.length||"ExpressionStatement"!==n.body[0].type||"FunctionExpression"!==n.body[0].expression.type?!1:!0}catch(i){return!1}}function a(e){var t="("+e+")",n=r.parse(t,{range:!0}),i=[],s;if("Program"!==n.type||1!==n.body.length||"ExpressionStatement"!==n.body[0].type||"FunctionExpression"!==n.body[0].expression.type)throw new Error("Failed to resolve function");return n.body[0].expression.params.forEach(function(e){i.push(e.name)}),s=n.body[0].expression.body.range,new Function(i,t.slice(s[0]+1,s[1]-1))}function f(e){return e.toString()}function l(e){return"[object Function]"===Object.prototype.toString.call(e)}var r;try{var i=e;r=i("esprima")}catch(s){typeof window!="undefined"&&(r=window.esprima)}var o=e("../../type");t.exports=new o("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:u,construct:a,predicate:l,represent:f})},{"../../type":13}],19:[function(e,t,n){function i(e){if(null===e)return!1;if(0===e.length)return!1;var t=e,n=/\/([gim]*)$/.exec(e),r="";if("/"===t[0]){n&&(r=n[1]);if(r.length>3)return!1;if(t[t.length-r.length-1]!=="/")return!1}return!0}function s(e){var t=e,n=/\/([gim]*)$/.exec(e),r="";return"/"===t[0]&&(n&&(r=n[1]),t=t.slice(1,t.length-r.length-1)),new RegExp(t,r)}function o(e){var t="/"+e.source+"/";return e.global&&(t+="g"),e.multiline&&(t+="m"),e.ignoreCase&&(t+="i"),t}function u(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var r=e("../../type");t.exports=new r("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:i,construct:s,predicate:u,represent:o})},{"../../type":13}],20:[function(e,t,n){function i(){return!0}function s(){return undefined}function o(){return""}function u(e){return"undefined"==typeof e}var r=e("../../type");t.exports=new r("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:i,construct:s,predicate:u,represent:o})},{"../../type":13}],21:[function(e,t,n){var r=e("../type");t.exports=new r("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})},{"../type":13}],22:[function(e,t,n){function i(e){return"<<"===e||null===e}var r=e("../type");t.exports=new r("tag:yaml.org,2002:merge",{kind:"scalar",resolve:i})},{"../type":13}],23:[function(e,t,n){function i(e){if(null===e)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function s(){return null}function o(e){return null===e}var r=e("../type");t.exports=new r("tag:yaml.org,2002:null",{kind:"scalar",resolve:i,construct:s,predicate:o,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},{"../type":13}],24:[function(e,t,n){function o(e){if(null===e)return!0;var t=[],n,r,o,u,a,f=e;for(n=0,r=f.length;n<r;n+=1){o=f[n],a=!1;if("[object Object]"!==s.call(o))return!1;for(u in o)if(i.call(o,u)){if(!!a)return!1;a=!0}if(!a)return!1;if(-1!==t.indexOf(u))return!1;t.push(u)}return!0}function u(e){return null!==e?e:[]}var r=e("../type"),i=Object.prototype.hasOwnProperty,s=Object.prototype.toString;t.exports=new r("tag:yaml.org,2002:omap",{kind:"sequence",resolve:o,construct:u})},{"../type":13}],25:[function(e,t,n){function s(e){if(null===e)return!0;var t,n,r,s,o,u=e;o=new Array(u.length);for(t=0,n=u.length;t<n;t+=1){r=u[t];if("[object Object]"!==i.call(r))return!1;s=Object.keys(r);if(1!==s.length)return!1;o[t]=[s[0],r[s[0]]]}return!0}function o(e){if(null===e)return[];var t,n,r,i,s,o=e;s=new Array(o.length);for(t=0,n=o.length;t<n;t+=1)r=o[t],i=Object.keys(r),s[t]=[i[0],r[i[0]]];return s}var r=e("../type"),i=Object.prototype.toString;t.exports=new r("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:s,construct:o})},{"../type":13}],26:[function(e,t,n){var r=e("../type");t.exports=new r("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}})},{"../type":13}],27:[function(e,t,n){function s(e){if(null===e)return!0;var t,n=e;for(t in n)if(i.call(n,t)&&null!==n[t])return!1;return!0}function o(e){return null!==e?e:{}}var r=e("../type"),i=Object.prototype.hasOwnProperty;t.exports=new r("tag:yaml.org,2002:set",{kind:"mapping",resolve:s,construct:o})},{"../type":13}],28:[function(e,t,n){var r=e("../type");t.exports=new r("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}})},{"../type":13}],29:[function(e,t,n){function s(e){return null===e?!1:i.exec(e)===null?!1:!0}function o(e){var t,n,r,s,o,u,a,f=0,l=null,c,h,p;t=i.exec(e);if(null===t)throw new Error("Date resolve error");n=+t[1],r=+t[2]-1,s=+t[3];if(!t[4])return new Date(Date.UTC(n,r,s));o=+t[4],u=+t[5],a=+t[6];if(t[7]){f=t[7].slice(0,3);while(f.length<3)f+="0";f=+f}return t[9]&&(c=+t[10],h=+(t[11]||0),l=(c*60+h)*6e4,"-"===t[9]&&(l=-l)),p=new Date(Date.UTC(n,r,s,o,u,a,f)),l&&p.setTime(p.getTime()-l),p}function u(e){return e.toISOString()}var r=e("../type"),i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$");t.exports=new r("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:s,construct:o,instanceOf:Date,represent:u})},{"../type":13}],30:[function(e,t,n){},{}],"/":[function(e,t,n){var r=e("./lib/js-yaml.js");t.exports=r},{"./lib/js-yaml.js":1}]},{},[])("/")}),function(e){if(typeof exports=="object"&&typeof module=="object")module.exports=e();else{if(typeof define=="function"&&define.amd)return define("codemirror",[],e);this.CodeMirror=e()}}(function(){function E(e,t){if(!(this instanceof E))return new E(e,t);this.options=t=t?au(t):{},au(ki,t,!1),P(t);var n=t.value;typeof n=="string"&&(n=new to(n,t.mode,null,t.lineSeparator)),this.doc=n;var o=new E.inputStyles[t.inputStyle](this),u=this.display=new S(e,n,o);u.wrapper.CodeMirror=this,O(this),L(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),t.autofocus&&!p&&u.input.focus(),F(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Go,keySeq:null,specialChars:null};var a=this;r&&i<11&&setTimeout(function(){a.display.input.reset(!0)},20),mr(this),Lu(),Jn(this),this.curOp.forceUpdate=!0,so(this,n),t.autofocus&&!p||a.hasFocus()?setTimeout(fu(Yr,this),20):Zr(this);for(var f in Li)Li.hasOwnProperty(f)&&Li[f](this,t[f],Oi);z(this),t.finishInit&&t.finishInit(this);for(var l=0;l<Pi.length;++l)Pi[l](this);Qn(this),s&&t.lineWrapping&&getComputedStyle(u.lineDiv).textRendering=="optimizelegibility"&&(u.lineDiv.style.textRendering="auto")}function S(t,n,o){var u=this;this.input=o,u.scrollbarFiller=mu("div",null,"CodeMirror-scrollbar-filler"),u.scrollbarFiller.setAttribute("cm-not-content","true"),u.gutterFiller=mu("div",null,"CodeMirror-gutter-filler"),u.gutterFiller.setAttribute("cm-not-content","true"),u.lineDiv=mu("div",null,"CodeMirror-code"),u.selectionDiv=mu("div",null,null,"position: relative; z-index: 1"),u.cursorDiv=mu("div",null,"CodeMirror-cursors"),u.measure=mu("div",null,"CodeMirror-measure"),u.lineMeasure=mu("div",null,"CodeMirror-measure"),u.lineSpace=mu("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none"),u.mover=mu("div",[mu("div",[u.lineSpace],"CodeMirror-lines")],null,"position: relative"),u.sizer=mu("div",[u.mover],"CodeMirror-sizer"),u.sizerWidth=null,u.heightForcer=mu("div",null,null,"position: absolute; height: "+Vo+"px; width: 1px;"),u.gutters=mu("div",null,"CodeMirror-gutters"),u.lineGutter=null,u.scroller=mu("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll"),u.scroller.setAttribute("tabIndex","-1"),u.wrapper=mu("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror"),r&&i<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0),!s&&(!e||!p)&&(u.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(u.wrapper):t(u.wrapper)),u.viewFrom=u.viewTo=n.first,u.reportedViewFrom=u.reportedViewTo=n.first,u.view=[],u.renderedView=null,u.externalMeasured=null,u.viewOffset=0,u.lastWrapHeight=u.lastWrapWidth=0,u.updateLineNumbers=null,u.nativeBarWidth=u.barHeight=u.barWidth=0,u.scrollbarsClipped=!1,u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null,u.alignWidgets=!1,u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null,u.maxLine=null,u.maxLineLength=0,u.maxLineChanged=!1,u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null,u.shift=!1,u.selForContextMenu=null,u.activeTouch=null,o.init(u)}function x(e){e.doc.mode=E.getMode(e.options,e.doc.modeOption),T(e)}function T(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,fn(e,100),e.state.modeGen++,e.curOp&&fr(e)}function N(e){e.options.lineWrapping?(Tu(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(xu(e.display.wrapper,"CodeMirror-wrap"),D(e)),k(e),fr(e),_n(e),setTimeout(function(){I(e)},100)}function C(e){var t=Wn(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/Xn(e.display)-3);return function(i){if(xs(e.doc,i))return 0;var s=0;if(i.widgets)for(var o=0;o<i.widgets.length;o++)i.widgets[o].height&&(s+=i.widgets[o].height);return n?s+(Math.ceil(i.text.length/r)||1)*t:s+t}}function k(e){var t=e.doc,n=C(e);t.iter(function(e){var t=n(e);t!=e.height&&fo(e,t)})}function L(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),_n(e)}function A(e){O(e),fr(e),setTimeout(function(){U(e)},20)}function O(e){var t=e.display.gutters,n=e.options.gutters;yu(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(mu("div",null,"CodeMirror-gutter "+i));i=="CodeMirror-linenumbers"&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none",M(e)}function M(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function _(e){if(e.height==0)return 0;var t=e.text.length,n,r=e;while(n=ms(r)){var i=n.find(0,!0);r=i.from.line,t+=i.from.ch-i.to.ch}r=e;while(n=gs(r)){var i=n.find(0,!0);t-=r.text.length-i.from.ch,r=i.to.line,t+=r.text.length-i.to.ch}return t}function D(e){var t=e.display,n=e.doc;t.maxLine=oo(n,n.first),t.maxLineLength=_(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=_(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function P(e){var t=iu(e.gutters,"CodeMirror-linenumbers");t==-1&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function H(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+dn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+mn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function B(e,t,n){this.cm=n;var s=this.vert=mu("div",[mu("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=mu("div",[mu("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(s),e(o),Bo(s,"scroll",function(){s.clientHeight&&t(s.scrollTop,"vertical")}),Bo(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")}),this.checkedOverlay=!1,r&&i<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function j(){}function F(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&xu(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new E.scrollbarModel[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),Bo(t,"mousedown",function(){e.state.focused&&setTimeout(function(){e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){n=="horizontal"?Hr(e,t):Pr(e,t)},e),e.display.scrollbars.addClass&&Tu(e.display.wrapper,e.display.scrollbars.addClass)}function I(e,t){t||(t=H(e));var n=e.display.barWidth,r=e.display.barHeight;q(e,t);for(var i=0;i<4&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&Y(e),q(e,H(e)),n=e.display.barWidth,r=e.display.barHeight}function q(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function R(e,t,n){var r=n&&n.top!=null?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-pn(e));var i=n&&n.bottom!=null?n.bottom:r+e.wrapper.clientHeight,s=co(t,r),o=co(t,i);if(n&&n.ensure){var u=n.ensure.from.line,a=n.ensure.to.line;u<s?(s=u,o=co(t,ho(oo(t,u))+e.wrapper.clientHeight)):Math.min(a,t.lastLine())>=o&&(s=co(t,ho(oo(t,a))-e.wrapper.clientHeight),o=a)}return{from:s,to:Math.max(o,s+1)}}function U(e){var t=e.display,n=t.view;if(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))return;var r=X(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,s=r+"px";for(var o=0;o<n.length;o++)if(!n[o].hidden){e.options.fixedGutter&&n[o].gutter&&(n[o].gutter.style.left=s);var u=n[o].alignable;if(u)for(var a=0;a<u.length;a++)u[a].style.left=s}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}function z(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=W(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(mu("div",[mu("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o)+1,r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",M(e),!0}return!1}function W(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function X(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function V(e,t,n){var r=e.display;this.viewport=t,this.visible=R(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=gn(e),this.force=n,this.dims=et(e),this.events=[]}function $(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=mn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=mn(e)+"px",t.scrollbarsClipped=!0)}function J(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return cr(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(n.updateLineNumbers==null||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&vr(e)==0)return!1;z(e)&&(cr(e),t.dims=et(e));var i=r.first+r.size,s=Math.max(t.visible.from-e.options.viewportMargin,r.first),o=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<s&&s-n.viewFrom<20&&(s=Math.max(r.first,n.viewFrom)),n.viewTo>o&&n.viewTo-o<20&&(o=Math.min(i,n.viewTo)),w&&(s=Es(e.doc,s),o=Ss(e.doc,o));var u=s!=n.viewFrom||o!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;dr(e,s,o),n.viewOffset=ho(oo(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var a=vr(e);if(!u&&a==0&&!t.force&&n.renderedView==n.view&&(n.updateLineNumbers==null||n.updateLineNumbers>=n.viewTo))return!1;var f=Eu();return a>4&&(n.lineDiv.style.display="none"),tt(e,n.updateLineNumbers,t.dims),a>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,f&&Eu()!=f&&f.offsetHeight&&f.focus(),yu(n.cursorDiv),yu(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,u&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,fn(e,400)),n.updateLineNumbers=null,!0}function K(e,t){var n=t.viewport;for(var r=!0;;r=!1){if(!r||!e.options.lineWrapping||t.oldDisplayWidth==gn(e)){n&&n.top!=null&&(n={top:Math.min(e.doc.height+dn(e.display)-yn(e),n.top)}),t.visible=R(e.display,e.doc,n);if(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break}if(!J(e,t))break;Y(e);var i=H(e);rn(e),G(e,i),I(e,i)}t.signal(e,"update",e);if(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo}function Q(e,t){var n=new V(e,t);if(J(e,n)){Y(e),K(e,n);var r=H(e);rn(e),G(e,r),I(e,r),n.finish()}}function G(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var n=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=n+"px",e.display.gutters.style.height=Math.max(n+mn(e),t.clientHeight)+"px"}function Y(e){var t=e.display,n=t.lineDiv.offsetTop;for(var s=0;s<t.view.length;s++){var o=t.view[s],u;if(o.hidden)continue;if(r&&i<8){var a=o.node.offsetTop+o.node.offsetHeight;u=a-n,n=a}else{var f=o.node.getBoundingClientRect();u=f.bottom-f.top}var l=o.line.height-u;u<2&&(u=Wn(t));if(l>.001||l<-0.001){fo(o.line,u),Z(o.line);if(o.rest)for(var c=0;c<o.rest.length;c++)Z(o.rest[c])}}}function Z(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function et(e){var t=e.display,n={},r={},i=t.gutters.clientLeft;for(var s=t.gutters.firstChild,o=0;s;s=s.nextSibling,++o)n[e.options.gutters[o]]=s.offsetLeft+s.clientLeft+i,r[e.options.gutters[o]]=s.clientWidth;return{fixedPos:X(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function tt(e,t,n){function a(t){var n=t.nextSibling;return s&&d&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}var r=e.display,i=e.options.lineNumbers,o=r.lineDiv,u=o.firstChild,f=r.view,l=r.viewFrom;for(var c=0;c<f.length;c++){var h=f[c];if(!h.hidden)if(!h.node||h.node.parentNode!=o){var p=lt(e,h,l,n);o.insertBefore(p,u)}else{while(u!=h.node)u=a(u);var v=i&&t!=null&&t<=l&&h.lineNumber;h.changes&&(iu(h.changes,"gutter")>-1&&(v=!1),nt(e,h,l,n)),v&&(yu(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(W(e.options,l)))),u=h.node.nextSibling}l+=h.size}while(u)u=a(u)}function nt(e,t,n,r){for(var i=0;i<t.changes.length;i++){var s=t.changes[i];s=="text"?ot(e,t):s=="gutter"?at(e,t,n,r):s=="class"?ut(t):s=="widget"&&ft(e,t,r)}t.changes=null}function rt(e){return e.node==e.text&&(e.node=mu("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),r&&i<8&&(e.node.style.zIndex=2)),e.node}function it(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;t&&(t+=" CodeMirror-linebackground");if(e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=rt(e);e.background=n.insertBefore(mu("div",null,t),n.firstChild)}}function st(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):zs(e,t)}function ot(e,t){var n=t.text.className,r=st(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,ut(t)):n&&(t.text.className=n)}function ut(e){it(e),e.line.wrapClass?rt(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function at(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null);if(t.line.gutterClass){var i=rt(t);t.gutterBackground=mu("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),i.insertBefore(t.gutterBackground,t.text)}var s=t.line.gutterMarkers;if(e.options.lineNumbers||s){var i=rt(t),o=t.gutter=mu("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");e.display.input.setUneditable(o),i.insertBefore(o,t.text),t.line.gutterClass&&(o.className+=" "+t.line.gutterClass),e.options.lineNumbers&&(!s||!s["CodeMirror-linenumbers"])&&(t.lineNumber=o.appendChild(mu("div",W(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px")));if(s)for(var u=0;u<e.options.gutters.length;++u){var a=e.options.gutters[u],f=s.hasOwnProperty(a)&&s[a];f&&o.appendChild(mu("div",[f],"CodeMirror-gutter-elt","left: "+r.gutterLeft[a]+"px; width: "+r.gutterWidth[a]+"px"))}}}function ft(e,t,n){t.alignable&&(t.alignable=null);for(var r=t.node.firstChild,i;r;r=i){var i=r.nextSibling;r.className=="CodeMirror-linewidget"&&t.node.removeChild(r)}ct(e,t,n)}function lt(e,t,n,r){var i=st(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),ut(t),at(e,t,n,r),ct(e,t,r),t.node}function ct(e,t,n){ht(e,t.line,t,n,!0);if(t.rest)for(var r=0;r<t.rest.length;r++)ht(e,t.rest[r],t,n,!1)}function ht(e,t,n,r,i){if(!t.widgets)return;var s=rt(n);for(var o=0,u=t.widgets;o<u.length;++o){var a=u[o],f=mu("div",[a.node],"CodeMirror-linewidget");a.handleMouseEvents||f.setAttribute("cm-ignore-events","true"),pt(a,f,n,r),e.display.input.setUneditable(f),i&&a.above?s.insertBefore(f,n.gutter||n.text):s.appendChild(f),qo(a,"redraw")}}function pt(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function mt(e){return dt(e.line,e.ch)}function gt(e,t){return vt(e,t)<0?t:e}function yt(e,t){return vt(e,t)<0?e:t}function bt(e){e.state.focused||(e.display.input.focus(),Yr(e))}function wt(e){return e.options.readOnly||e.doc.cantEdit}function St(e,t,n,r,i){var s=e.doc;e.display.shift=!1,r||(r=s.sel);var o=e.state.pasteIncoming||i=="paste",u=s.splitLines(t),a=null;if(o&&r.ranges.length>1)if(Et&&Et.join("\n")==t){if(r.ranges.length%Et.length==0){a=[];for(var f=0;f<Et.length;f++)a.push(s.splitLines(Et[f]))}}else u.length==r.ranges.length&&(a=su(u,function(e){return[e]}));for(var f=r.ranges.length-1;f>=0;f--){var l=r.ranges[f],c=l.from(),h=l.to();l.empty()&&(n&&n>0?c=dt(c.line,c.ch-n):e.state.overwrite&&!o&&(h=dt(h.line,Math.min(oo(s,h.line).text.length,h.ch+nu(u).length))));var p=e.curOp.updateInput,d={from:c,to:h,text:a?a[f%a.length]:u,origin:i||(o?"paste":e.state.cutIncoming?"cut":"+input")};ai(e.doc,d),qo(e,"inputRead",e,d)}t&&!o&&Tt(e,t),wi(e),e.curOp.updateInput=p,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function xt(e,t){var n=e.clipboardData&&e.clipboardData.getData("text/plain");if(n)return e.preventDefault(),!wt(t)&&!t.options.disableInput&&rr(t,function(){St(t,n,0,null,"paste")}),!0}function Tt(e,t){if(!e.options.electricChars||!e.options.smartIndent)return;var n=e.doc.sel;for(var r=n.ranges.length-1;r>=0;r--){var i=n.ranges[r];if(i.head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)continue;var s=e.getModeAt(i.head),o=!1;if(s.electricChars){for(var u=0;u<s.electricChars.length;u++)if(t.indexOf(s.electricChars.charAt(u))>-1){o=Si(e,i.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(oo(e.doc,i.head.line).text.slice(0,i.head.ch))&&(o=Si(e,i.head.line,"smart"));o&&qo(e,"electricInput",e,i.head.line)}}function Nt(e){var t=[],n=[];for(var r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,s={anchor:dt(i,0),head:dt(i+1,0)};n.push(s),t.push(e.getRange(s.anchor,s.head))}return{text:t,ranges:n}}function Ct(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function kt(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Go,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function Lt(){var e=mu("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=mu("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return s?e.style.width="1000px":e.setAttribute("wrap","off"),h&&(e.style.border="1px solid black"),Ct(e),t}function At(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Go,this.gracePeriod=!1}function Ot(e,t){var n=xn(e,t.line);if(!n||n.hidden)return null;var r=oo(e.doc,t.line),i=wn(n,r,t.line),s=po(r),o="left";if(s){var u=Gu(s,t.ch);o=u%2?"right":"left"}var a=kn(i.map,t.ch,o);return a.offset=a.collapse=="right"?a.end:a.start,a}function Mt(e,t){return t&&(e.bad=!0),e}function _t(e,t,n){var r;if(t==e.display.lineDiv){r=e.display.lineDiv.childNodes[n];if(!r)return Mt(e.clipPos(dt(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var s=e.display.view[i];if(s.node==r)return Dt(s,t,n)}}function Dt(e,t,n){function l(t,n,r){for(var i=-1;i<(f?f.length:0);i++){var s=i<0?a.map:f[i];for(var o=0;o<s.length;o+=3){var u=s[o+2];if(u==t||u==n){var l=lo(i<0?e.line:e.rest[i]),c=s[o]+r;if(r<0||u!=t)c=s[o+(r?1:0)];return dt(l,c)}}}}var r=e.text.firstChild,i=!1;if(!t||!wu(r,t))return Mt(dt(lo(e.line),0),!0);if(t==r){i=!0,t=r.childNodes[n],n=0;if(!t){var s=e.rest?nu(e.rest):e.line;return Mt(dt(lo(s),s.text.length),i)}}var o=t.nodeType==3?t:null,u=t;!o&&t.childNodes.length==1&&t.firstChild.nodeType==3&&(o=t.firstChild,n&&(n=o.nodeValue.length));while(u.parentNode!=r)u=u.parentNode;var a=e.measure,f=a.maps,c=l(o,u,n);if(c)return Mt(c,i);for(var h=u.nextSibling,p=o?o.nodeValue.length-n:0;h;h=h.nextSibling){c=l(h,h.firstChild,0);if(c)return Mt(dt(c.line,c.ch-p),i);p+=h.textContent.length}for(var d=u.previousSibling,p=n;d;d=d.previousSibling){c=l(d,d.firstChild,-1);if(c)return Mt(dt(c.line,c.ch+p),i);p+=h.textContent.length}}function Pt(e,t,n,r,i){function a(e){return function(t){return t.id==e}}function f(t){if(t.nodeType==1){var n=t.getAttribute("cm-text");if(n!=null){n==""&&(n=t.textContent.replace(/\u200b/g,"")),s+=n;return}var l=t.getAttribute("cm-marker"),c;if(l){var h=e.findMarks(dt(r,0),dt(i+1,0),a(+l));h.length&&(c=h[0].find())&&(s+=uo(e.doc,c.from,c.to).join(u));return}if(t.getAttribute("contenteditable")=="false")return;for(var p=0;p<t.childNodes.length;p++)f(t.childNodes[p]);/^(pre|div|p)$/i.test(t.nodeName)&&(o=!0)}else if(t.nodeType==3){var d=t.nodeValue;if(!d)return;o&&(s+=u,o=!1),s+=d}}var s="",o=!1,u=e.doc.lineSeparator();for(;;){f(t);if(t==n)break;t=t.nextSibling}return s}function Ht(e,t){this.ranges=e,this.primIndex=t}function Bt(e,t){this.anchor=e,this.head=t}function jt(e,t){var n=e[t];e.sort(function(e,t){return vt(e.from(),t.from())}),t=iu(e,n);for(var r=1;r<e.length;r++){var i=e[r],s=e[r-1];if(vt(s.to(),i.from())>=0){var o=yt(s.from(),i.from()),u=gt(s.to(),i.to()),a=s.empty()?i.from()==i.head:s.from()==s.head;r<=t&&--t,e.splice(--r,2,new Bt(a?u:o,a?o:u))}}return new Ht(e,t)}function Ft(e,t){return new Ht([new Bt(e,t||e)],0)}function It(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function qt(e,t){if(t.line<e.first)return dt(e.first,0);var n=e.first+e.size-1;return t.line>n?dt(n,oo(e,n).text.length):Rt(t,oo(e,t.line).text.length)}function Rt(e,t){var n=e.ch;return n==null||n>t?dt(e.line,t):n<0?dt(e.line,0):e}function Ut(e,t){return t>=e.first&&t<e.first+e.size}function zt(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=qt(e,t[r]);return n}function Wt(e,t,n,r){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(r){var s=vt(n,i)<0;s!=vt(r,i)<0?(i=n,n=r):s!=vt(n,r)<0&&(n=r)}return new Bt(i,n)}return new Bt(r||n,n)}function Xt(e,t,n,r){Gt(e,new Ht([Wt(e,e.sel.primary(),t,n)],0),r)}function Vt(e,t,n){for(var r=[],i=0;i<e.sel.ranges.length;i++)r[i]=Wt(e,e.sel.ranges[i],t[i],null);var s=jt(r,e.sel.primIndex);Gt(e,s,n)}function $t(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,Gt(e,jt(i,e.sel.primIndex),r)}function Jt(e,t,n,r){Gt(e,Ft(t,n),r)}function Kt(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new Bt(qt(e,t[n].anchor),qt(e,t[n].head))}};return Fo(e,"beforeSelectionChange",e,n),e.cm&&Fo(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?jt(n.ranges,n.ranges.length-1):t}function Qt(e,t,n){var r=e.history.done,i=nu(r);i&&i.ranges?(r[r.length-1]=t,Yt(e,t,n)):Gt(e,t,n)}function Gt(e,t,n){Yt(e,t,n),Eo(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Yt(e,t,n){if(Wo(e,"beforeSelectionChange")||e.cm&&Wo(e.cm,"beforeSelectionChange"))t=Kt(e,t);var r=n&&n.bias||(vt(t.primary().head,e.sel.primary().head)<0?-1:1);Zt(e,tn(e,t,r,!0)),(!n||n.scroll!==!1)&&e.cm&&wi(e.cm)}function Zt(e,t){if(t.equals(e.sel))return;e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,zo(e.cm)),qo(e,"cursorActivity",e)}function en(e){Zt(e,tn(e,e.sel,null,!1),Jo)}function tn(e,t,n,r){var i;for(var s=0;s<t.ranges.length;s++){var o=t.ranges[s],u=nn(e,o.anchor,n,r),a=nn(e,o.head,n,r);if(i||u!=o.anchor||a!=o.head)i||(i=t.ranges.slice(0,s)),i[s]=new Bt(u,a)}return i?jt(i,t.primIndex):t}function nn(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=oo(e,s.line);if(u.markedSpans)for(var a=0;a<u.markedSpans.length;++a){var f=u.markedSpans[a],l=f.marker;if((f.from==null||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(f.to==null||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch))){if(r){Fo(l,"beforeCursorEnter");if(l.explicitlyCleared){if(!u.markedSpans)break;--a;continue}}if(!l.atomic)continue;var c=l.find(o<0?-1:1);if(vt(c,s)==0){c.ch+=o,c.ch<0?c.line>e.first?c=qt(e,dt(c.line-1)):c=null:c.ch>u.text.length&&(c.line<e.first+e.size-1?c=dt(c.line+1,0):c=null);if(!c){if(i)return r?(e.cantEdit=!0,dt(e.first,0)):nn(e,t,n,!0);i=!0,c=t,o=-o}}s=c;continue e}}return s}}function rn(e){e.display.input.showSelection(e.display.input.prepareSelection())}function sn(e,t){var n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),s=r.selection=document.createDocumentFragment();for(var o=0;o<n.sel.ranges.length;o++){if(t===!1&&o==n.sel.primIndex)continue;var u=n.sel.ranges[o],a=u.empty();(a||e.options.showCursorWhenSelecting)&&on(e,u.head,i),a||un(e,u,s)}return r}function on(e,t,n){var r=Fn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(mu("div"," ","CodeMirror-cursor"));i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px";if(r.other){var s=n.appendChild(mu("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));s.style.display="",s.style.left=r.other.left+"px",s.style.top=r.other.top+"px",s.style.height=(r.other.bottom-r.other.top)*.85+"px"}}function un(e,t,n){function f(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),s.appendChild(mu("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(n==null?a-e:n)+"px; height: "+(r-t)+"px"))}function l(t,n,r){function h(n,r){return jn(e,dt(t,n),"div",s,r)}var s=oo(i,t),o=s.text.length,l,c;return Ru(po(s),n||0,r==null?o:r,function(e,t,i){var s=h(e,"left"),p,d,v;if(e==t)p=s,d=v=s.left;else{p=h(t-1,"right");if(i=="rtl"){var m=s;s=p,p=m}d=s.left,v=p.right}n==null&&e==0&&(d=u),p.top-s.top>3&&(f(d,s.top,null,s.bottom),d=u,s.bottom<p.top&&f(d,s.bottom,null,p.top)),r==null&&t==o&&(v=a);if(!l||s.top<l.top||s.top==l.top&&s.left<l.left)l=s;if(!c||p.bottom>c.bottom||p.bottom==c.bottom&&p.right>c.right)c=p;d<u+1&&(d=u),f(d,p.top,v-d,p.bottom)}),{start:l,end:c}}var r=e.display,i=e.doc,s=document.createDocumentFragment(),o=vn(e.display),u=o.left,a=Math.max(r.sizerWidth,gn(e)-r.sizer.offsetLeft)-o.right,c=t.from(),h=t.to();if(c.line==h.line)l(c.line,c.ch,h.ch);else{var p=oo(i,c.line),d=oo(i,h.line),v=bs(p)==bs(d),m=l(c.line,c.ch,v?p.text.length+1:null).end,g=l(h.line,v?0:null,h.ch).start;v&&(m.top<g.top-2?(f(m.right,m.top,null,m.bottom),f(u,g.top,g.left,g.bottom)):f(m.right,m.top,g.left-m.right,m.bottom)),m.bottom<g.top&&f(u,m.bottom,null,g.top)}n.appendChild(s)}function an(e){if(!e.state.focused)return;var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}function fn(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,fu(ln,e))}function ln(e){var t=e.doc;t.frontier<t.first&&(t.frontier=t.first);if(t.frontier>=e.display.viewTo)return;var n=+(new Date)+e.options.workTime,r=Bi(t.mode,hn(e,t.frontier)),i=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(s){if(t.frontier>=e.display.viewFrom){var o=s.styles,u=s.text.length>e.options.maxHighlightLength,a=js(e,s,u?Bi(t.mode,r):r,!0);s.styles=a.styles;var f=s.styleClasses,l=a.classes;l?s.styleClasses=l:f&&(s.styleClasses=null);var c=!o||o.length!=s.styles.length||f!=l&&(!f||!l||f.bgClass!=l.bgClass||f.textClass!=l.textClass);for(var h=0;!c&&h<o.length;++h)c=o[h]!=s.styles[h];c&&i.push(t.frontier),s.stateAfter=u?r:Bi(t.mode,r)}else s.text.length<=e.options.maxHighlightLength&&Is(e,s.text,r),s.stateAfter=t.frontier%5==0?Bi(t.mode,r):null;++t.frontier;if(+(new Date)>n)return fn(e,e.options.workDelay),!0}),i.length&&rr(e,function(){for(var t=0;t<i.length;t++)lr(e,i[t],"text")})}function cn(e,t,n){var r,i,s=e.doc,o=n?-1:t-(e.doc.mode.innerMode?1e3:100);for(var u=t;u>o;--u){if(u<=s.first)return s.first;var a=oo(s,u-1);if(a.stateAfter&&(!n||u<=s.frontier))return u;var f=Yo(a.text,null,e.options.tabSize);if(i==null||r>f)i=u-1,r=f}return i}function hn(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var s=cn(e,t,n),o=s>r.first&&oo(r,s-1).stateAfter;return o?o=Bi(r.mode,o):o=ji(r.mode),r.iter(s,t,function(n){Is(e,n.text,o);var u=s==t-1||s%5==0||s>=i.viewFrom&&s<i.viewTo;n.stateAfter=u?Bi(r.mode,o):null,++s}),n&&(r.frontier=s),o}function pn(e){return e.lineSpace.offsetTop}function dn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function vn(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=bu(e.measure,mu("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return!isNaN(r.left)&&!isNaN(r.right)&&(e.cachedPaddingH=r),r}function mn(e){return Vo-e.display.nativeBarWidth}function gn(e){return e.display.scroller.clientWidth-mn(e)-e.display.barWidth}function yn(e){return e.display.scroller.clientHeight-mn(e)-e.display.barHeight}function bn(e,t,n){var r=e.options.lineWrapping,i=r&&gn(e);if(!t.measure.heights||r&&t.measure.width!=i){var s=t.measure.heights=[];if(r){t.measure.width=i;var o=t.text.firstChild.getClientRects();for(var u=0;u<o.length-1;u++){var a=o[u],f=o[u+1];Math.abs(a.bottom-f.bottom)>2&&s.push((a.bottom+f.top)/2-n.top)}}s.push(n.bottom-n.top)}}function wn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var r=0;r<e.rest.length;r++)if(lo(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function En(e,t){t=bs(t);var n=lo(t),r=e.display.externalMeasured=new ur(e.doc,t,n);r.lineN=n;var i=r.built=zs(e,r);return r.text=i.pre,bu(e.display.lineMeasure,i.pre),r}function Sn(e,t,n,r){return Nn(e,Tn(e,t),n,r)}function xn(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[hr(e,t)];var n=e.display.externalMeasured;if(n&&t>=n.lineN&&t<n.lineN+n.size)return n}function Tn(e,t){var n=lo(t),r=xn(e,n);r&&!r.text?r=null:r&&r.changes&&(nt(e,r,n,et(e)),e.curOp.forceUpdate=!0),r||(r=En(e,t));var i=wn(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Nn(e,t,n,r,i){t.before&&(n=-1);var s=n+(r||""),o;return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(bn(e,t.view,t.rect),t.hasHeights=!0),o=Ln(e,t,n,r),o.bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function kn(e,t,n){var r,i,s,o;for(var u=0;u<e.length;u+=3){var a=e[u],f=e[u+1];if(t<a)i=0,s=1,o="left";else if(t<f)i=t-a,s=i+1;else if(u==e.length-3||t==f&&e[u+3]>t)s=f-a,i=s-1,t>=f&&(o="right");if(i!=null){r=e[u+2],a==f&&n==(r.insertLeft?"left":"right")&&(o=n);if(n=="left"&&i==0)while(u&&e[u-2]==e[u-3]&&e[u-1].insertLeft)r=e[(u-=3)+2],o="left";if(n=="right"&&i==f-a)while(u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft)r=e[(u+=3)+2],o="right";break}}return{node:r,start:i,end:s,collapse:o,coverStart:a,coverEnd:f}}function Ln(e,t,n,s){var o=kn(t.map,n,s),u=o.node,a=o.start,f=o.end,l=o.collapse,c;if(u.nodeType==3){for(var h=0;h<4;h++){while(a&&vu(t.line.text.charAt(o.coverStart+a)))--a;while(o.coverStart+f<o.coverEnd&&vu(t.line.text.charAt(o.coverStart+f)))++f;if(r&&i<9&&a==0&&f==o.coverEnd-o.coverStart)c=u.parentNode.getBoundingClientRect();else if(r&&e.options.lineWrapping){var p=gu(u,a,f).getClientRects();p.length?c=p[s=="right"?p.length-1:0]:c=Cn}else c=gu(u,a,f).getBoundingClientRect()||Cn;if(c.left||c.right||a==0)break;f=a,a-=1,l="right"}r&&i<11&&(c=An(e.display.measure,c))}else{a>0&&(l=s="right");var p;e.options.lineWrapping&&(p=u.getClientRects()).length>1?c=p[s=="right"?p.length-1:0]:c=u.getBoundingClientRect()}if(r&&i<9&&!a&&(!c||!c.left&&!c.right)){var d=u.parentNode.getClientRects()[0];d?c={left:d.left,right:d.left+Xn(e.display),top:d.top,bottom:d.bottom}:c=Cn}var v=c.top-t.rect.top,m=c.bottom-t.rect.top,g=(v+m)/2,y=t.view.measure.heights;for(var h=0;h<y.length-1;h++)if(g<y[h])break;var b=h?y[h-1]:0,w=y[h],E={left:(l=="right"?c.right:c.left)-t.rect.left,right:(l=="left"?c.left:c.right)-t.rect.left,top:b,bottom:w};return!c.left&&!c.right&&(E.bogus=!0),e.options.singleCursorHeightPerLine||(E.rtop=v,E.rbottom=m),E}function An(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Iu(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function On(e){if(e.measure){e.measure.cache={},e.measure.heights=null;if(e.rest)for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}}function Mn(e){e.display.externalMeasure=null,yu(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)On(e.display.view[t])}function _n(e){Mn(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Dn(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Pn(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Hn(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=ks(t.widgets[i]);n.top+=s,n.bottom+=s}if(r=="line")return n;r||(r="local");var o=ho(t);r=="local"?o+=pn(e.display):o-=e.display.viewOffset;if(r=="page"||r=="window"){var u=e.display.lineSpace.getBoundingClientRect();o+=u.top+(r=="window"?0:Pn());var a=u.left+(r=="window"?0:Dn());n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function Bn(e,t,n){if(n=="div")return t;var r=t.left,i=t.top;if(n=="page")r-=Dn(),i-=Pn();else if(n=="local"||!n){var s=e.display.sizer.getBoundingClientRect();r+=s.left,i+=s.top}var o=e.display.lineSpace.getBoundingClientRect();return{left:r-o.left,top:i-o.top}}function jn(e,t,n,r,i){return r||(r=oo(e.doc,t.line)),Hn(e,r,Sn(e,r,t.ch,i),n)}function Fn(e,t,n,r,i,s){function o(t,o){var u=Nn(e,i,t,o?"right":"left",s);return o?u.left=u.right:u.right=u.left,Hn(e,r,u,n)}function u(e,t){var n=a[t],r=n.level%2;return e==Uu(n)&&t&&n.level<a[t-1].level?(n=a[--t],e=zu(n)-(n.level%2?0:1),r=!0):e==zu(n)&&t<a.length-1&&n.level<a[t+1].level&&(n=a[++t],e=Uu(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?o(e-1):o(e,r)}r=r||oo(e.doc,t.line),i||(i=Tn(e,r));var a=po(r),f=t.ch;if(!a)return o(f);var l=Gu(a,f),c=u(f,l);return Qu!=null&&(c.other=u(f,Qu)),c}function In(e,t){var n=0,t=qt(e.doc,t);e.options.lineWrapping||(n=Xn(e.display)*t.ch);var r=oo(e.doc,t.line),i=ho(r)+pn(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function qn(e,t,n,r){var i=dt(e,t);return i.xRel=r,n&&(i.outside=!0),i}function Rn(e,t,n){var r=e.doc;n+=e.display.viewOffset;if(n<0)return qn(r.first,0,!0,-1);var i=co(r,n),s=r.first+r.size-1;if(i>s)return qn(r.first+r.size-1,oo(r,s).text.length,!0,1);t<0&&(t=0);var o=oo(r,i);for(;;){var u=Un(e,o,i,t,n),a=gs(o),f=a&&a.find(0,!0);if(!a||!(u.ch>f.from.ch||u.ch==f.from.ch&&u.xRel>0))return u;i=lo(o=f.to.line)}}function Un(e,t,n,r,i){function f(r){var i=Fn(e,dt(n,r),"line",t,a);return o=!0,s>i.bottom?i.left-u:s<i.top?i.left+u:(o=!1,i.left)}var s=i-ho(t),o=!1,u=2*e.display.wrapper.clientWidth,a=Tn(e,t),l=po(t),c=t.text.length,h=Wu(t),p=Xu(t),d=f(h),v=o,m=f(p),g=o;if(r>m)return qn(n,p,g,1);for(;;){if(l?p==h||p==Zu(t,h,1):p-h<=1){var y=r<d||r-d<=m-r?h:p,b=r-(y==h?d:m);while(vu(t.text.charAt(y)))++y;var w=qn(n,y,y==h?v:g,b<-1?-1:b>1?1:0);return w}var E=Math.ceil(c/2),S=h+E;if(l){S=h;for(var x=0;x<E;++x)S=Zu(t,S,1)}var T=f(S);if(T>r){p=S,m=T;if(g=o)m+=1e3;c=E}else h=S,d=T,v=o,c-=E}}function Wn(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(zn==null){zn=mu("pre");for(var t=0;t<49;++t)zn.appendChild(document.createTextNode("x")),zn.appendChild(mu("br"));zn.appendChild(document.createTextNode("x"))}bu(e.measure,zn);var n=zn.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),yu(e.measure),n||1}function Xn(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=mu("span","xxxxxxxxxx"),n=mu("pre",[t]);bu(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function Jn(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++$n},Vn?Vn.ops.push(e.curOp):e.curOp.ownsGroup=Vn={ops:[e.curOp],delayedCallbacks:[]}}function Kn(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)while(i.cursorActivityCalled<i.cursorActivityHandlers.length)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<t.length)}function Qn(e){var t=e.curOp,n=t.ownsGroup;if(!n)return;try{Kn(n)}finally{Vn=null;for(var r=0;r<n.ops.length;r++)n.ops[r].cm.curOp=null;Gn(n)}}function Gn(e){var t=e.ops;for(var n=0;n<t.length;n++)Yn(t[n]);for(var n=0;n<t.length;n++)Zn(t[n]);for(var n=0;n<t.length;n++)er(t[n]);for(var n=0;n<t.length;n++)tr(t[n]);for(var n=0;n<t.length;n++)nr(t[n])}function Yn(e){var t=e.cm,n=t.display;$(t),e.updateMaxLine&&D(t),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new V(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Zn(e){e.updatedDisplay=e.mustUpdate&&J(e.cm,e.update)}function er(e){var t=e.cm,n=t.display;e.updatedDisplay&&Y(t),e.barMeasure=H(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Sn(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+mn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-gn(t)));if(e.updatedDisplay||e.selectionChanged)e.preparedSelection=n.input.prepareSelection()}function tr(e){var t=e.cm;e.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Hr(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&G(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&I(t,e.barMeasure),e.selectionChanged&&an(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),e.focus&&e.focus==Eu()&&bt(e.cm)}function nr(e){var t=e.cm,n=t.display,r=t.doc;e.updatedDisplay&&K(t,e.update),n.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(n.wheelStartX=n.wheelStartY=null),e.scrollTop!=null&&(n.scroller.scrollTop!=e.scrollTop||e.forceScroll)&&(r.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(r.scrollTop),n.scroller.scrollTop=r.scrollTop),e.scrollLeft!=null&&(n.scroller.scrollLeft!=e.scrollLeft||e.forceScroll)&&(r.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-gn(t),e.scrollLeft)),n.scrollbars.setScrollLeft(r.scrollLeft),n.scroller.scrollLeft=r.scrollLeft,U(t));if(e.scrollToPos){var i=mi(t,qt(r,e.scrollToPos.from),qt(r,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&vi(t,i)}var s=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(s)for(var u=0;u<s.length;++u)s[u].lines.length||Fo(s[u],"hide");if(o)for(var u=0;u<o.length;++u)o[u].lines.length&&Fo(o[u],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Fo(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function rr(e,t){if(e.curOp)return t();Jn(e);try{return t()}finally{Qn(e)}}function ir(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Jn(e);try{return t.apply(e,arguments)}finally{Qn(e)}}}function sr(e){return function(){if(this.curOp)return e.apply(this,arguments);Jn(this);try{return e.apply(this,arguments)}finally{Qn(this)}}}function or(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Jn(t);try{return e.apply(this,arguments)}finally{Qn(t)}}}function ur(e,t,n){this.line=t,this.rest=ws(t),this.size=this.rest?lo(nu(this.rest))-n+1:1,this.node=this.text=null,this.hidden=xs(e,t)}function ar(e,t,n){var r=[],i;for(var s=t;s<n;s=i){var o=new ur(e.doc,oo(e.doc,s),s);i=s+o.size,r.push(o)}return r}function fr(e,t,n,r){t==null&&(t=e.doc.first),n==null&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;r&&n<i.viewTo&&(i.updateLineNumbers==null||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0;if(t>=i.viewTo)w&&Es(e.doc,t)<i.viewTo&&cr(e);else if(n<=i.viewFrom)w&&Ss(e.doc,n+r)>i.viewFrom?cr(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)cr(e);else if(t<=i.viewFrom){var s=pr(e,n,n+r,1);s?(i.view=i.view.slice(s.index),i.viewFrom=s.lineN,i.viewTo+=r):cr(e)}else if(n>=i.viewTo){var s=pr(e,t,t,-1);s?(i.view=i.view.slice(0,s.index),i.viewTo=s.lineN):cr(e)}else{var o=pr(e,t,t,-1),u=pr(e,n,n+r,1);o&&u?(i.view=i.view.slice(0,o.index).concat(ar(e,o.lineN,u.lineN)).concat(i.view.slice(u.index)),i.viewTo+=r):cr(e)}var a=i.externalMeasured;a&&(n<a.lineN?a.lineN+=r:t<a.lineN+a.size&&(i.externalMeasured=null))}function lr(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null);if(t<r.viewFrom||t>=r.viewTo)return;var s=r.view[hr(e,t)];if(s.node==null)return;var o=s.changes||(s.changes=[]);iu(o,n)==-1&&o.push(n)}function cr(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function hr(e,t){if(t>=e.display.viewTo)return null;t-=e.display.viewFrom;if(t<0)return null;var n=e.display.view;for(var r=0;r<n.length;r++){t-=n[r].size;if(t<0)return r}}function pr(e,t,n,r){var i=hr(e,t),s,o=e.display.view;if(!w||n==e.doc.first+e.doc.size)return{index:i,lineN:n};for(var u=0,a=e.display.viewFrom;u<i;u++)a+=o[u].size;if(a!=t){if(r>0){if(i==o.length-1)return null;s=a+o[i].size-t,i++}else s=a-t;t+=s,n+=s}while(Es(e.doc,n)!=n){if(i==(r<0?0:o.length-1))return null;n+=r*o[i-(r<0?1:0)].size,i+=r}return{index:i,lineN:n}}function dr(e,t,n){var r=e.display,i=r.view;i.length==0||t>=r.viewTo||n<=r.viewFrom?(r.view=ar(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=ar(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(hr(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(ar(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,hr(e,n)))),r.viewTo=n}function vr(e){var t=e.display.view,n=0;for(var r=0;r<t.length;r++){var i=t[r];!i.hidden&&(!i.node||i.changes)&&++n}return n}function mr(e){function o(){t.activeTouch&&(n=setTimeout(function(){t.activeTouch=null},1e3),s=t.activeTouch,s.end=+(new Date))}function u(e){if(e.touches.length!=1)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function a(e,t){if(t.left==null)return!0;var n=t.left-e.left,r=t.top-e.top;return n*n+r*r>400}var t=e.display;Bo(t.scroller,"mousedown",ir(e,Er)),r&&i<11?Bo(t.scroller,"dblclick",ir(e,function(t){if(Uo(e,t))return;var n=wr(e,t);if(!n||Lr(e,t)||br(e.display,t))return;Oo(t);var r=e.findWordAt(n);Xt(e.doc,r.anchor,r.head)})):Bo(t.scroller,"dblclick",function(t){Uo(e,t)||Oo(t)}),y||Bo(t.scroller,"contextmenu",function(t){ei(e,t)});var n,s={end:0};Bo(t.scroller,"touchstart",function(e){if(!u(e)){clearTimeout(n);var r=+(new Date);t.activeTouch={start:r,moved:!1,prev:r-s.end<=300?s:null},e.touches.length==1&&(t.activeTouch.left=e.touches[0].pageX,t.activeTouch.top=e.touches[0].pageY)}}),Bo(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),Bo(t.scroller,"touchend",function(n){var r=t.activeTouch;if(r&&!br(t,n)&&r.left!=null&&!r.moved&&new Date-r.start<300){var i=e.coordsChar(t.activeTouch,"page"),s;!r.prev||a(r,r.prev)?s=new Bt(i,i):!r.prev.prev||a(r,r.prev.prev)?s=e.findWordAt(i):s=new Bt(dt(i.line,0),qt(e.doc,dt(i.line+1,0))),e.setSelection(s.anchor,s.head),e.focus(),Oo(n)}o()}),Bo(t.scroller,"touchcancel",o),Bo(t.scroller,"scroll",function(){t.scroller.clientHeight&&(Pr(e,t.scroller.scrollTop),Hr(e,t.scroller.scrollLeft,!0),Fo(e,"scroll",e))}),Bo(t.scroller,"mousewheel",function(t){Ir(e,t)}),Bo(t.scroller,"DOMMouseScroll",function(t){Ir(e,t)}),Bo(t.wrapper,"scroll",function(){t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(t){Uo(e,t)||Do(t)},over:function(t){Uo(e,t)||(_r(e,t),Do(t))},start:function(t){Mr(e,t)},drop:ir(e,Or),leave:function(){Dr(e)}};var f=t.input.getField();Bo(f,"keyup",function(t){Kr.call(e,t)}),Bo(f,"keydown",ir(e,$r)),Bo(f,"keypress",ir(e,Qr)),Bo(f,"focus",fu(Yr,e)),Bo(f,"blur",fu(Zr,e))}function gr(e,t,n){var r=n&&n!=E.Init;if(!t!=!r){var i=e.display.dragFunctions,s=t?Bo:jo;s(e.display.scroller,"dragstart",i.start),s(e.display.scroller,"dragenter",i.enter),s(e.display.scroller,"dragover",i.over),s(e.display.scroller,"dragleave",i.leave),s(e.display.scroller,"drop",i.drop)}}function yr(e){var t=e.display;if(t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth)return;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}function br(e,t){for(var n=Po(t);n!=e.wrapper;n=n.parentNode)if(!n||n.nodeType==1&&n.getAttribute("cm-ignore-events")=="true"||n.parentNode==e.sizer&&n!=e.mover)return!0}function wr(e,t,n,r){var i=e.display;if(!n&&Po(t).getAttribute("cm-not-content")=="true")return null;var s,o,u=i.lineSpace.getBoundingClientRect();try{s=t.clientX-u.left,o=t.clientY-u.top}catch(t){return null}var a=Rn(e,s,o),f;if(r&&a.xRel==1&&(f=oo(e.doc,a.line).text).length==a.ch){var l=Yo(f,f.length,e.options.tabSize)-f.length;a=dt(a.line,Math.max(0,Math.round((s-vn(e.display).left)/Xn(e.display))-l))}return a}function Er(e){var t=this,n=t.display;if(n.activeTouch&&n.input.supportsTouch()||Uo(t,e))return;n.shift=e.shiftKey;if(br(n,e)){s||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100));return}if(Lr(t,e))return;var r=wr(t,e);window.focus();switch(Ho(e)){case 1:t.state.selectingText?t.state.selectingText(e):r?Tr(t,e,r):Po(e)==n.scroller&&Oo(e);break;case 2:s&&(t.state.lastMiddleDown=+(new Date)),r&&Xt(t.doc,r),setTimeout(function(){n.input.focus()},20),Oo(e);break;case 3:y?ei(t,e):Gr(t)}}function Tr(e,t,n){r?setTimeout(fu(bt,e),0):e.curOp.focus=Eu();var i=+(new Date),s;xr&&xr.time>i-400&&vt(xr.pos,n)==0?s="triple":Sr&&Sr.time>i-400&&vt(Sr.pos,n)==0?(s="double",xr={time:i,pos:n}):(s="single",Sr={time:i,pos:n});var o=e.doc.sel,u=d?t.metaKey:t.ctrlKey,a;e.options.dragDrop&&Ou&&!wt(e)&&s=="single"&&(a=o.contains(n))>-1&&(vt((a=o.ranges[a]).from(),n)<0||n.xRel>0)&&(vt(a.to(),n)>0||n.xRel<0)?Nr(e,t,n,u):Cr(e,t,n,s,u)}function Nr(e,t,n,o){var u=e.display,a=+(new Date),f=ir(e,function(l){s&&(u.scroller.draggable=!1),e.state.draggingText=!1,jo(document,"mouseup",f),jo(u.scroller,"drop",f),Math.abs(t.clientX-l.clientX)+Math.abs(t.clientY-l.clientY)<10&&(Oo(l),!o&&+(new Date)-200<a&&Xt(e.doc,n),s||r&&i==9?setTimeout(function(){document.body.focus(),u.input.focus()},20):u.input.focus())});s&&(u.scroller.draggable=!0),e.state.draggingText=f,u.scroller.dragDrop&&u.scroller.dragDrop(),Bo(document,"mouseup",f),Bo(u.scroller,"drop",f)}function Cr(e,t,n,r,i){function d(t){if(vt(p,t)==0)return;p=t;if(r=="rect"){var i=[],s=e.options.tabSize,l=Yo(oo(o,n.line).text,n.ch,s),c=Yo(oo(o,t.line).text,t.ch,s),h=Math.min(l,c),d=Math.max(l,c);for(var v=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));v<=m;v++){var g=oo(o,v).text,y=Zo(g,h,s);h==d?i.push(new Bt(dt(v,y),dt(v,y))):g.length>y&&i.push(new Bt(dt(v,y),dt(v,Zo(g,d,s))))}i.length||i.push(new Bt(n,n)),Gt(o,jt(f.ranges.slice(0,a).concat(i),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b=u,w=b.anchor,E=t;if(r!="single"){if(r=="double")var S=e.findWordAt(t);else var S=new Bt(dt(t.line,0),qt(o,dt(t.line+1,0)));vt(S.anchor,w)>0?(E=S.head,w=yt(b.from(),S.anchor)):(E=S.anchor,w=gt(b.to(),S.head))}var i=f.ranges.slice(0);i[a]=new Bt(qt(o,w),E),Gt(o,jt(i,a),Ko)}}function g(t){var n=++m,i=wr(e,t,!0,r=="rect");if(!i)return;if(vt(i,p)!=0){e.curOp.focus=Eu(),d(i);var u=R(s,o);(i.line>=u.to||i.line<u.from)&&setTimeout(ir(e,function(){m==n&&g(t)}),150)}else{var a=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;a&&setTimeout(ir(e,function(){if(m!=n)return;s.scroller.scrollTop+=a,g(t)}),50)}}function y(t){e.state.selectingText=!1,m=Infinity,Oo(t),s.input.focus(),jo(document,"mousemove",b),jo(document,"mouseup",w),o.history.lastSelOrigin=null}var s=e.display,o=e.doc;Oo(t);var u,a,f=o.sel,l=f.ranges;i&&!t.shiftKey?(a=o.sel.contains(n),a>-1?u=l[a]:u=new Bt(n,n)):(u=o.sel.primary(),a=o.sel.primIndex);if(t.altKey)r="rect",i||(u=new Bt(n,n)),n=wr(e,t,!0,!0),a=-1;else if(r=="double"){var c=e.findWordAt(n);e.display.shift||o.extend?u=Wt(o,u,c.anchor,c.head):u=c}else if(r=="triple"){var h=new Bt(dt(n.line,0),qt(o,dt(n.line+1,0)));e.display.shift||o.extend?u=Wt(o,u,h.anchor,h.head):u=h}else u=Wt(o,u,n);i?a==-1?(a=l.length,Gt(o,jt(l.concat([u]),a),{scroll:!1,origin:"*mouse"})):l.length>1&&l[a].empty()&&r=="single"&&!t.shiftKey?(Gt(o,jt(l.slice(0,a).concat(l.slice(a+1)),0),{scroll:!1,origin:"*mouse"}),f=o.sel):$t(o,a,u,Ko):(a=0,Gt(o,new Ht([u],0),Ko),f=o.sel);var p=n,v=s.wrapper.getBoundingClientRect(),m=0,b=ir(e,function(e){Ho(e)?g(e):y(e)}),w=ir(e,y);e.state.selectingText=w,Bo(document,"mousemove",b),Bo(document,"mouseup",w)}function kr(e,t,n,r,i){try{var s=t.clientX,o=t.clientY}catch(t){return!1}if(s>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&Oo(t);var u=e.display,a=u.lineDiv.getBoundingClientRect();if(o>a.bottom||!Wo(e,n))return _o(t);o-=a.top-u.viewOffset;for(var f=0;f<e.options.gutters.length;++f){var l=u.gutters.childNodes[f];if(l&&l.getBoundingClientRect().right>=s){var c=co(e.doc,o),h=e.options.gutters[f];return i(e,n,e,c,h,t),_o(t)}}}function Lr(e,t){return kr(e,t,"gutterClick",!0,qo)}function Or(e){var t=this;Dr(t);if(Uo(t,e)||br(t.display,e))return;Oo(e),r&&(Ar=+(new Date));var n=wr(t,e,!0),i=e.dataTransfer.files;if(!n||wt(t))return;if(i&&i.length&&window.FileReader&&window.File){var s=i.length,o=Array(s),u=0,a=function(e,r){var i=new FileReader;i.onload=ir(t,function(){o[r]=i.result;if(++u==s){n=qt(t.doc,n);var e={from:n,to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};ai(t.doc,e),Qt(t.doc,Ft(n,ni(e)))}}),i.readAsText(e)};for(var f=0;f<s;++f)a(i[f],f)}else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1){t.state.draggingText(e),setTimeout(function(){t.display.input.focus()},20);return}try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&(d?!e.altKey:!e.ctrlKey))var l=t.listSelections();Yt(t.doc,Ft(n,n));if(l)for(var f=0;f<l.length;++f)di(t.doc,"",l[f].anchor,l[f].head,"drag");t.replaceSelection(o,"around","paste"),t.display.input.focus()}}catch(e){}}}function Mr(e,t){if(r&&(!e.state.draggingText||+(new Date)-Ar<100)){Do(t);return}if(Uo(e,t)||br(e.display,t))return;t.dataTransfer.setData("Text",e.getSelection());if(t.dataTransfer.setDragImage&&!f){var n=mu("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),a&&n.parentNode.removeChild(n)}}function _r(e,t){var n=wr(e,t);if(!n)return;var r=document.createDocumentFragment();on(e,n,r),e.display.dragCursor||(e.display.dragCursor=mu("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),bu(e.display.dragCursor,r)}function Dr(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Pr(t,n){if(Math.abs(t.doc.scrollTop-n)<2)return;t.doc.scrollTop=n,e||Q(t,{top:n}),t.display.scroller.scrollTop!=n&&(t.display.scroller.scrollTop=n),t.display.scrollbars.setScrollTop(n),e&&Q(t),fn(t,100)}function Hr(e,t,n){if(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)return;t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,U(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t)}function Ir(t,n){var r=Fr(n),i=r.x,o=r.y,u=t.display,f=u.scroller;if(!(i&&f.scrollWidth>f.clientWidth||o&&f.scrollHeight>f.clientHeight))return;if(o&&d&&s)e:for(var l=n.target,c=u.view;l!=f;l=l.parentNode)for(var h=0;h<c.length;h++)if(c[h].node==l){t.display.currentWheelTarget=l;break e}if(i&&!e&&!a&&jr!=null){o&&Pr(t,Math.max(0,Math.min(f.scrollTop+o*jr,f.scrollHeight-f.clientHeight))),Hr(t,Math.max(0,Math.min(f.scrollLeft+i*jr,f.scrollWidth-f.clientWidth))),Oo(n),u.wheelStartX=null;return}if(o&&jr!=null){var p=o*jr,v=t.doc.scrollTop,m=v+u.wrapper.clientHeight;p<0?v=Math.max(0,v+p-50):m=Math.min(t.doc.height,m+p+50),Q(t,{top:v,bottom:m})}Br<20&&(u.wheelStartX==null?(u.wheelStartX=f.scrollLeft,u.wheelStartY=f.scrollTop,u.wheelDX=i,u.wheelDY=o,setTimeout(function(){if(u.wheelStartX==null)return;var e=f.scrollLeft-u.wheelStartX,t=f.scrollTop-u.wheelStartY,n=t&&u.wheelDY&&t/u.wheelDY||e&&u.wheelDX&&e/u.wheelDX;u.wheelStartX=u.wheelStartY=null;if(!n)return;jr=(jr*Br+n)/(Br+1),++Br},200)):(u.wheelDX+=i,u.wheelDY+=o))}function qr(e,t,n){if(typeof t=="string"){t=Fi[t];if(!t)return!1}e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{wt(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=$o}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function Rr(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=Ri(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&Ri(t,e.options.extraKeys,n,e)||Ri(t,e.options.keyMap,n,e)}function zr(e,t,n,r){var i=e.state.keySeq;if(i){if(Ui(t))return"handled";Ur.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),t=i+" "+t}var s=Rr(e,t,r);s=="multi"&&(e.state.keySeq=t),s=="handled"&&qo(e,"keyHandled",e,t,n);if(s=="handled"||s=="multi")Oo(n),an(e);return i&&!s&&/\'$/.test(t)?(Oo(n),!0):!!s}function Wr(e,t){var n=zi(t,!0);return n?t.shiftKey&&!e.state.keySeq?zr(e,"Shift-"+n,t,function(t){return qr(e,t,!0)})||zr(e,n,t,function(t){if(typeof t=="string"?/^go[A-Z]/.test(t):t.motion)return qr(e,t)}):zr(e,n,t,function(t){return qr(e,t)}):!1}function Xr(e,t,n){return zr(e,"'"+n+"'",t,function(t){return qr(e,t,!0)})}function $r(e){var t=this;t.curOp.focus=Eu();if(Uo(t,e))return;r&&i<11&&e.keyCode==27&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=n==16||e.shiftKey;var s=Wr(t,e);a&&(Vr=s?n:null,!s&&n==88&&!ju&&(d?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),n==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)&&Jr(t)}function Jr(e){function n(e){if(e.keyCode==18||!e.altKey)xu(t,"CodeMirror-crosshair"),jo(document,"keyup",n),jo(document,"mouseover",n)}var t=e.display.lineDiv;Tu(t,"CodeMirror-crosshair"),Bo(document,"keyup",n),Bo(document,"mouseover",n)}function Kr(e){e.keyCode==16&&(this.doc.sel.shift=!1),Uo(this,e)}function Qr(e){var t=this;if(br(t.display,e)||Uo(t,e)||e.ctrlKey&&!e.altKey||d&&e.metaKey)return;var n=e.keyCode,r=e.charCode;if(a&&n==Vr){Vr=null,Oo(e);return}if(a&&(!e.which||e.which<10)&&Wr(t,e))return;var i=String.fromCharCode(r==null?n:r);if(Xr(t,e,i))return;t.display.input.onKeyPress(e)}function Gr(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Zr(e))},100)}function Yr(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1);if(e.options.readOnly=="nocursor")return;e.state.focused||(Fo(e,"focus",e),e.state.focused=!0,Tu(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),s&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),an(e)}function Zr(e){if(e.state.delayingBlurEvent)return;e.state.focused&&(Fo(e,"blur",e),e.state.focused=!1,xu(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150)}function ei(e,t){if(br(e.display,t)||ti(e,t))return;e.display.input.onContextMenu(t)}function ti(e,t){return Wo(e,"gutterContextMenu")?kr(e,t,"gutterContextMenu",!1,Fo):!1}function ri(e,t){if(vt(e,t.from)<0)return e;if(vt(e,t.to)<=0)return ni(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=ni(t).ch-t.to.ch),dt(n,r)}function ii(e,t){var n=[];for(var r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new Bt(ri(i.anchor,t),ri(i.head,t)))}return jt(n,e.sel.primIndex)}function si(e,t,n){return e.line==t.line?dt(n.line,e.ch-t.ch+n.ch):dt(n.line+(e.line-t.line),e.ch)}function oi(e,t,n){var r=[],i=dt(e.first,0),s=i;for(var o=0;o<t.length;o++){var u=t[o],a=si(u.from,i,s),f=si(ni(u),i,s);i=u.to,s=f;if(n=="around"){var l=e.sel.ranges[o],c=vt(l.head,l.anchor)<0;r[o]=new Bt(c?f:a,c?a:f)}else r[o]=new Bt(a,a)}return new Ht(r,e.sel.primIndex)}function ui(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=qt(e,t)),n&&(this.to=qt(e,n)),r&&(this.text=r),i!==undefined&&(this.origin=i)}),Fo(e,"beforeChange",e,r),e.cm&&Fo(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function ai(e,t,n){if(e.cm){if(!e.cm.curOp)return ir(e.cm,ai)(e,t,n);if(e.cm.state.suppressEdits)return}if(Wo(e,"beforeChange")||e.cm&&Wo(e.cm,"beforeChange")){t=ui(e,t,!0);if(!t)return}var r=b&&!n&&fs(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)fi(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text});else fi(e,t)}function fi(e,t){if(t.text.length==1&&t.text[0]==""&&vt(t.from,t.to)==0)return;var n=ii(e,t);bo(e,t,n,e.cm?e.cm.curOp.id:NaN),hi(e,t,n,os(e,t));var r=[];io(e,function(e,n){!n&&iu(r,e.history)==-1&&(Ao(e.history,t),r.push(e.history)),hi(e,t,null,os(e,t))})}function li(e,t,n){if(e.cm&&e.cm.state.suppressEdits)return;var r=e.history,i,s=e.sel,o=t=="undo"?r.done:r.undone,u=t=="undo"?r.undone:r.done;for(var a=0;a<o.length;a++){i=o[a];if(n?i.ranges&&!i.equals(e.sel):!i.ranges)break}if(a==o.length)return;r.lastOrigin=r.lastSelOrigin=null;for(;;){i=o.pop();if(!i.ranges)break;So(i,u);if(n&&!i.equals(e.sel)){Gt(e,i,{clearRedo:!1});return}s=i}var f=[];So(s,u),u.push({changes:f,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;var l=Wo(e,"beforeChange")||e.cm&&Wo(e.cm,"beforeChange");for(var a=i.changes.length-1;a>=0;--a){var c=i.changes[a];c.origin=t;if(l&&!ui(e,c,!1)){o.length=0;return}f.push(mo(e,c));var h=a?ii(e,c):nu(o);hi(e,c,h,as(e,c)),!a&&e.cm&&e.cm.scrollIntoView({from:c.from,to:ni(c)});var p=[];io(e,function(e,t){!t&&iu(p,e.history)==-1&&(Ao(e.history,c),p.push(e.history)),hi(e,c,null,as(e,c))})}}function ci(e,t){if(t==0)return;e.first+=t,e.sel=new Ht(su(e.sel.ranges,function(e){return new Bt(dt(e.anchor.line+t,e.anchor.ch),dt(e.head.line+t,e.head.ch))}),e.sel.primIndex);if(e.cm){fr(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)lr(e.cm,r,"gutter")}}function hi(e,t,n,r){if(e.cm&&!e.cm.curOp)return ir(e.cm,hi)(e,t,n,r);if(t.to.line<e.first){ci(e,t.text.length-1-(t.to.line-t.from.line));return}if(t.from.line>e.lastLine())return;if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);ci(e,i),t={from:dt(e.first,0),to:dt(t.to.line+i,t.to.ch),text:[nu(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:dt(s,oo(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=uo(e,t.from,t.to),n||(n=ii(e,t)),e.cm?pi(e.cm,t,r):Gs(e,t,r),Yt(e,n,Jo)}function pi(e,t,n){var r=e.doc,i=e.display,s=t.from,o=t.to,u=!1,a=s.line;e.options.lineWrapping||(a=lo(bs(oo(r,s.line))),r.iter(a,o.line+1,function(e){if(e==i.maxLine)return u=!0,!0})),r.sel.contains(t.from,t.to)>-1&&zo(e),Gs(r,t,n,C(e)),e.options.lineWrapping||(r.iter(a,s.line+t.text.length,function(e){var t=_(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,u=!1)}),u&&(e.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,s.line),fn(e,400);var f=t.text.length-(o.line-s.line)-1;t.full?fr(e):s.line==o.line&&t.text.length==1&&!Qs(e.doc,t)?lr(e,s.line,"text"):fr(e,s.line,o.line+1,f);var l=Wo(e,"changes"),c=Wo(e,"change");if(c||l){var h={from:s,to:o,text:t.text,removed:t.removed,origin:t.origin};c&&qo(e,"change",e,h),l&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(h)}e.display.selForContextMenu=null}function di(e,t,n,r,i){r||(r=n);if(vt(r,n)<0){var s=r;r=n,n=s}typeof t=="string"&&(t=e.splitLines(t)),ai(e,{from:n,to:r,text:t,origin:i})}function vi(e,t){if(Uo(e,"scrollCursorIntoView"))return;var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1);if(i!=null&&!c){var s=mu("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-pn(e.display))+"px; height: "+(t.bottom-t.top+mn(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(i),e.display.lineSpace.removeChild(s)}}function mi(e,t,n,r){r==null&&(r=0);for(var i=0;i<5;i++){var s=!1,o=Fn(e,t),u=!n||n==t?o:Fn(e,n),a=yi(e,Math.min(o.left,u.left),Math.min(o.top,u.top)-r,Math.max(o.left,u.left),Math.max(o.bottom,u.bottom)+r),f=e.doc.scrollTop,l=e.doc.scrollLeft;a.scrollTop!=null&&(Pr(e,a.scrollTop),Math.abs(e.doc.scrollTop-f)>1&&(s=!0)),a.scrollLeft!=null&&(Hr(e,a.scrollLeft),Math.abs(e.doc.scrollLeft-l)>1&&(s=!0));if(!s)break}return o}function gi(e,t,n,r,i){var s=yi(e,t,n,r,i);s.scrollTop!=null&&Pr(e,s.scrollTop),s.scrollLeft!=null&&Hr(e,s.scrollLeft)}function yi(e,t,n,r,i){var s=e.display,o=Wn(e.display);n<0&&(n=0);var u=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:s.scroller.scrollTop,a=yn(e),f={};i-n>a&&(i=n+a);var l=e.doc.height+dn(s),c=n<o,h=i>l-o;if(n<u)f.scrollTop=c?0:n;else if(i>u+a){var p=Math.min(n,(h?l:i)-a);p!=u&&(f.scrollTop=p)}var d=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:s.scroller.scrollLeft,v=gn(e)-(e.options.fixedGutter?s.gutters.offsetWidth:0),m=r-t>v;return m&&(r=t+v),t<10?f.scrollLeft=0:t<d?f.scrollLeft=Math.max(0,t-(m?0:10)):r>v+d-3&&(f.scrollLeft=r+(m?0:10)-v),f}function bi(e,t,n){(t!=null||n!=null)&&Ei(e),t!=null&&(e.curOp.scrollLeft=(e.curOp.scrollLeft==null?e.doc.scrollLeft:e.curOp.scrollLeft)+t),n!=null&&(e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+n)}function wi(e){Ei(e);var t=e.getCursor(),n=t,r=t;e.options.lineWrapping||(n=t.ch?dt(t.line,t.ch-1):t,r=dt(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:r,margin:e.options.cursorScrollMargin,isCursor:!0}}function Ei(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=In(e,t.from),r=In(e,t.to),i=yi(e,Math.min(n.left,r.left),Math.min(n.top,r.top)-t.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function Si(e,t,n,r){var i=e.doc,s;n==null&&(n="add"),n=="smart"&&(i.mode.indent?s=hn(e,t):n="prev");var o=e.options.tabSize,u=oo(i,t),a=Yo(u.text,null,o);u.stateAfter&&(u.stateAfter=null);var f=u.text.match(/^\s*/)[0],l;if(!r&&!/\S/.test(u.text))l=0,n="not";else if(n=="smart"){l=i.mode.indent(s,u.text.slice(f.length),u.text);if(l==$o||l>150){if(!r)return;n="prev"}}n=="prev"?t>i.first?l=Yo(oo(i,t-1).text,null,o):l=0:n=="add"?l=a+e.options.indentUnit:n=="subtract"?l=a-e.options.indentUnit:typeof n=="number"&&(l=a+n),l=Math.max(0,l);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(l/o);p;--p)h+=o,c+="	";h<l&&(c+=tu(l-h));if(c!=f)return di(i,c,dt(t,0),dt(t,f.length),"+input"),u.stateAfter=null,!0;for(var p=0;p<i.sel.ranges.length;p++){var d=i.sel.ranges[p];if(d.head.line==t&&d.head.ch<f.length){var h=dt(t,f.length);$t(i,p,new Bt(h,h));break}}}function xi(e,t,n,r){var i=t,s=t;return typeof t=="number"?s=oo(e,It(e,t)):i=lo(t),i==null?null:(r(s,i)&&e.cm&&lr(e.cm,i,n),s)}function Ti(e,t){var n=e.doc.sel.ranges,r=[];for(var i=0;i<n.length;i++){var s=t(n[i]);while(r.length&&vt(s.from,nu(r).to)<=0){var o=r.pop();if(vt(o.from,s.from)<0){s.from=o.from;break}}r.push(s)}rr(e,function(){for(var t=r.length-1;t>=0;t--)di(e.doc,"",r[t].from,r[t].to,"+delete");wi(e)})}function Ni(e,t,n,r,i){function l(){var t=s+n;return t<e.first||t>=e.first+e.size?f=!1:(s=t,a=oo(e,t))}function c(e){var t=(i?Zu:ea)(a,o,n,!0);if(t==null){if(!!e||!l())return f=!1;i?o=(n<0?Xu:Wu)(a):o=n<0?a.text.length:0}else o=t;return!0}var s=t.line,o=t.ch,u=n,a=oo(e,s),f=!0;if(r=="char")c();else if(r=="column")c(!0);else if(r=="word"||r=="group"){var h=null,p=r=="group",d=e.cm&&e.cm.getHelper(t,"wordChars");for(var v=!0;;v=!1){if(n<0&&!c(!v))break;var m=a.text.charAt(o)||"\n",g=hu(m,d)?"w":p&&m=="\n"?"n":!p||/\s/.test(m)?null:"p";p&&!v&&!g&&(g="s");if(h&&h!=g){n<0&&(n=1,c());break}g&&(h=g);if(n>0&&!c(!v))break}}var y=nn(e,dt(s,o),u,!0);return f||(y.hitSide=!0),y}function Ci(e,t,n,r){var i=e.doc,s=t.left,o;if(r=="page"){var u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);o=t.top+n*(u-(n<0?1.5:.5)*Wn(e.display))}else r=="line"&&(o=n>0?t.bottom+3:t.top-3);for(;;){var a=Rn(e,s,o);if(!a.outside)break;if(n<0?o<=0:o>=i.height){a.hitSide=!0;break}o+=n*5}return a}function Ai(e,t,n,r){E.defaults[e]=t,n&&(Li[e]=r?function(e,t,r){r!=Oi&&n(e,t,r)}:n)}function qi(e){var t=e.split(/-(?!$)/),e=t[t.length-1],n,r,i,s;for(var o=0;o<t.length-1;o++){var u=t[o];if(/^(cmd|meta|m)$/i.test(u))s=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))r=!0;else{if(!/^s(hift)$/i.test(u))throw new Error("Unrecognized modifier name: "+u);i=!0}}return n&&(e="Alt-"+e),r&&(e="Ctrl-"+e),s&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function Wi(e){return typeof e=="string"?Ii[e]:e}function Ji(e,t,n,r,i){if(r&&r.shared)return Qi(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return ir(e.cm,Ji)(e,t,n,r,i);var s=new $i(e,i),o=vt(t,n);r&&au(r,s,!1);if(o>0||o==0&&s.clearWhenEmpty!==!1)return s;s.replacedWith&&(s.collapsed=!0,s.widgetNode=mu("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(s.widgetNode.insertLeft=!0));if(s.collapsed){if(ys(e,t.line,t,n,s)||t.line!=n.line&&ys(e,n.line,t,n,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");w=!0}s.addToHistory&&bo(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var u=t.line,a=e.cm,f;e.iter(u,n.line+1,function(e){a&&s.collapsed&&!a.options.lineWrapping&&bs(e)==a.display.maxLine&&(f=!0),s.collapsed&&u!=t.line&&fo(e,0),rs(e,new es(s,u==t.line?t.ch:null,u==n.line?n.ch:null)),++u}),s.collapsed&&e.iter(t.line,n.line+1,function(t){xs(e,t)&&fo(t,0)}),s.clearOnEnter&&Bo(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(b=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed&&(s.id=++Vi,s.atomic=!0);if(a){f&&(a.curOp.updateMaxLine=!0);if(s.collapsed)fr(a,t.line,n.line+1);else if(s.className||s.title||s.startStyle||s.endStyle||s.css)for(var l=t.line;l<=n.line;l++)lr(a,l,"text");s.atomic&&en(a.doc),qo(a,"markerAdded",a,s)}return s}function Qi(e,t,n,r,i){r=au(r),r.shared=!1;var s=[Ji(e,t,n,r,i)],o=s[0],u=r.widgetNode;return io(e,function(e){u&&(r.widgetNode=u.cloneNode(!0)),s.push(Ji(e,qt(e,t),qt(e,n),r,i));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;o=nu(s)}),new Ki(s,o)}function Gi(e){return e.findMarks(dt(e.first,0),e.clipPos(dt(e.lastLine())),function(e){return e.parent})}function Yi(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),s=e.clipPos(i.from),o=e.clipPos(i.to);if(vt(s,o)){var u=Ji(e,s,o,r.primary,r.primary.type);r.markers.push(u),u.parent=r}}}function Zi(e){for(var t=0;t<e.length;t++){var n=e[t],r=[n.primary.doc];io(n.primary.doc,function(e){r.push(e)});for(var i=0;i<n.markers.length;i++){var s=n.markers[i];iu(r,s.doc)==-1&&(s.parent=null,n.markers.splice(i--,1))}}}function es(e,t,n){this.marker=e,this.from=t,this.to=n}function ts(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function ns(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function rs(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function is(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);if(u||s.from==t&&o.type=="bookmark"&&(!n||!s.marker.insertLeft)){var a=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);(i||(i=[])).push(new es(o,s.from,a?null:s.to))}}return i}function ss(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);if(u||s.from==t&&o.type=="bookmark"&&(!n||s.marker.insertLeft)){var a=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);(i||(i=[])).push(new es(o,a?null:s.from-t,s.to==null?null:s.to-t))}}return i}function os(e,t){if(t.full)return null;var n=Ut(e,t.from.line)&&oo(e,t.from.line).markedSpans,r=Ut(e,t.to.line)&&oo(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=vt(t.from,t.to)==0,u=is(n,i,o),a=ss(r,s,o),f=t.text.length==1,l=nu(t.text).length+(f?i:0);if(u)for(var c=0;c<u.length;++c){var h=u[c];if(h.to==null){var p=ts(a,h.marker);p?f&&(h.to=p.to==null?null:p.to+l):h.to=i}}if(a)for(var c=0;c<a.length;++c){var h=a[c];h.to!=null&&(h.to+=l);if(h.from==null){var p=ts(u,h.marker);p||(h.from=l,f&&(u||(u=[])).push(h))}else h.from+=l,f&&(u||(u=[])).push(h)}u&&(u=us(u)),a&&a!=u&&(a=us(a));var d=[u];if(!f){var v=t.text.length-2,m;if(v>0&&u)for(var c=0;c<u.length;++c)u[c].to==null&&(m||(m=[])).push(new es(u[c].marker,null,null));for(var c=0;c<v;++c)d.push(m);d.push(a)}return d}function us(e){for(var t=0;t<e.length;++t){var n=e[t];n.from!=null&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function as(e,t){var n=No(e,t),r=os(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o)e:for(var u=0;u<o.length;++u){var a=o[u];for(var f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}else o&&(n[i]=o)}return n}function fs(e,t,n){var r=null;e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;n.readOnly&&(!r||iu(r,n)==-1)&&(r||(r=[])).push(n)}});if(!r)return null;var i=[{from:t,to:n}];for(var s=0;s<r.length;++s){var o=r[s],u=o.find(0);for(var a=0;a<i.length;++a){var f=i[a];if(vt(f.to,u.from)<0||vt(f.from,u.to)>0)continue;var l=[a,1],c=vt(f.from,u.from),h=vt(f.to,u.to);(c<0||!o.inclusiveLeft&&!c)&&l.push({from:f.from,to:u.from}),(h>0||!o.inclusiveRight&&!h)&&l.push({from:u.to,to:f.to}),i.splice.apply(i,l),a+=l.length-1}}return i}function ls(e){var t=e.markedSpans;if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}function cs(e,t){if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}function hs(e){return e.inclusiveLeft?-1:0}function ps(e){return e.inclusiveRight?1:0}function ds(e,t){var n=e.lines.length-t.lines.length;if(n!=0)return n;var r=e.find(),i=t.find(),s=vt(r.from,i.from)||hs(e)-hs(t);if(s)return-s;var o=vt(r.to,i.to)||ps(e)-ps(t);return o?o:t.id-e.id}function vs(e,t){var n=w&&e.markedSpans,r;if(n)for(var i,s=0;s<n.length;++s)i=n[s],i.marker.collapsed&&(t?i.from:i.to)==null&&(!r||ds(r,i.marker)<0)&&(r=i.marker);return r}function ms(e){return vs(e,!0)}function gs(e){return vs(e,!1)}function ys(e,t,n,r,i){var s=oo(e,t),o=w&&s.markedSpans;if(o)for(var u=0;u<o.length;++u){var a=o[u];if(!a.marker.collapsed)continue;var f=a.marker.find(0),l=vt(f.from,n)||hs(a.marker)-hs(i),c=vt(f.to,r)||ps(a.marker)-ps(i);if(l>=0&&c<=0||l<=0&&c>=0)continue;if(l<=0&&(vt(f.to,n)>0||a.marker.inclusiveRight&&i.inclusiveLeft)||l>=0&&(vt(f.from,r)<0||a.marker.inclusiveLeft&&i.inclusiveRight))return!0}}function bs(e){var t;while(t=ms(e))e=t.find(-1,!0).line;return e}function ws(e){var t,n;while(t=gs(e))e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function Es(e,t){var n=oo(e,t),r=bs(n);return n==r?t:lo(r)}function Ss(e,t){if(t>e.lastLine())return t;var n=oo(e,t),r;if(!xs(e,n))return t;while(r=gs(n))n=r.find(1,!0).line;return lo(n)+1}function xs(e,t){var n=w&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i){r=n[i];if(!r.marker.collapsed)continue;if(r.from==null)return!0;if(r.marker.widgetNode)continue;if(r.from==0&&r.marker.inclusiveLeft&&Ts(e,t,r))return!0}}function Ts(e,t,n){if(n.to==null){var r=n.marker.find(1,!0);return Ts(e,r.line,ts(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i,s=0;s<t.markedSpans.length;++s){i=t.markedSpans[s];if(i.marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(i.to==null||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&Ts(e,t,i))return!0}}function Cs(e,t,n){ho(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&bi(e,null,n)}function ks(e){if(e.height!=null)return e.height;var t=e.doc.cm;if(!t)return 0;if(!wu(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),bu(t.display.measure,mu("div",[e.node],null,n))}return e.height=e.node.offsetHeight}function Ls(e,t,n,r){var i=new Ns(e,n,r),s=e.cm;return s&&i.noHScroll&&(s.display.alignWidgets=!0),xi(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);i.insertAt==null?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t;if(s&&!xs(e,t)){var r=ho(t)<e.scrollTop;fo(t,t.height+ks(i)),r&&bi(s,null,i.height),s.curOp.forceUpdate=!0}return!0}),i}function Os(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),ls(e),cs(e,n);var i=r?r(e):1;i!=e.height&&fo(e,i)}function Ms(e){e.parent=null,ls(e)}function _s(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";t[r]==null?t[r]=n[2]:(new RegExp("(?:^|s)"+n[2]+"(?:$|s)")).test(t[r])||(t[r]+=" "+n[2])}return e}function Ds(e,t){if(e.blankLine)return e.blankLine(t);if(!e.innerMode)return;var n=E.innerMode(e,t);if(n.mode.blankLine)return n.mode.blankLine(n.state)}function Ps(e,t,n,r){for(var i=0;i<10;i++){r&&(r[0]=E.innerMode(e,n).mode);var s=e.token(t,n);if(t.pos>t.start)return s}throw new Error("Mode "+e.name+" failed to advance stream.")}function Hs(e,t,n,r){function i(e){return{start:l.start,end:l.pos,string:l.current(),type:u||null,state:e?Bi(s.mode,f):f}}var s=e.doc,o=s.mode,u;t=qt(s,t);var a=oo(s,t.line),f=hn(e,t.line,n),l=new Xi(a.text,e.options.tabSize),c;r&&(c=[]);while((r||l.pos<t.ch)&&!l.eol())l.start=l.pos,u=Ps(o,l,f),r&&c.push(i(!0));return r?c:i()}function Bs(e,t,n,r,i,s,o){var u=n.flattenSpans;u==null&&(u=e.options.flattenSpans);var a=0,f=null,l=new Xi(t,e.options.tabSize),c,h=e.options.addModeClass&&[null];t==""&&_s(Ds(n,r),s);while(!l.eol()){l.pos>e.options.maxHighlightLength?(u=!1,o&&Is(e,t,r,l.pos),l.pos=t.length,c=null):c=_s(Ps(n,l,r,h),s);if(h){var p=h[0].name;p&&(c="m-"+(c?p+" "+c:p))}if(!u||f!=c){while(a<l.start)a=Math.min(l.start,a+5e4),i(a,f);f=c}l.start=l.pos}while(a<l.pos){var d=Math.min(l.pos,a+5e4);i(d,f),a=d}}function js(e,t,n,r){var i=[e.state.modeGen],s={};Bs(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},s,r);for(var o=0;o<e.state.overlays.length;++o){var u=e.state.overlays[o],a=1,f=0;Bs(e,t.text,u.mode,!0,function(e,t){var n=a;while(f<e){var r=i[a];r>e&&i.splice(a,1,e,i[a+1],r),a+=2,f=Math.min(e,r)}if(!t)return;if(u.opaque)i.splice(n,a-n,e,"cm-overlay "+t),a=n+2;else for(;n<a;n+=2){var s=i[n+1];i[n+1]=(s?s+" ":"")+"cm-overlay "+t}},s)}return{styles:i,classes:s.bgClass||s.textClass?s:null}}function Fs(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=hn(e,lo(t)),i=js(e,t,t.text.length>e.options.maxHighlightLength?Bi(e.doc.mode,r):r);t.stateAfter=r,t.styles=i.styles,i.classes?t.styleClasses=i.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Is(e,t,n,r){var i=e.doc.mode,s=new Xi(t,e.options.tabSize);s.start=s.pos=r||0,t==""&&Ds(i,n);while(!s.eol())Ps(i,s,n),s.start=s.pos}function Us(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?Rs:qs;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function zs(e,t){var n=mu("span",null,null,s?"padding-right: .1px":null),i={pre:mu("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,splitSpaces:(r||s)&&e.getOption("lineWrapping")};t.measure={};for(var o=0;o<=(t.rest?t.rest.length:0);o++){var u=o?t.rest[o-1]:t.line,a;i.pos=0,i.addToken=Xs,Pu(e.display.measure)&&(a=po(u))&&(i.addToken=$s(i.addToken,a)),i.map=[];var f=t!=e.display.externalMeasured&&lo(u);Ks(u,i,Fs(e,u,f)),u.styleClasses&&(u.styleClasses.bgClass&&(i.bgClass=Nu(u.styleClasses.bgClass,i.bgClass||"")),u.styleClasses.textClass&&(i.textClass=Nu(u.styleClasses.textClass,i.textClass||""))),i.map.length==0&&i.map.push(0,0,i.content.appendChild(_u(e.display.measure))),o==0?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return s&&/\bcm-tab\b/.test(i.content.lastChild.className)&&(i.content.className="cm-tab-wrap-hack"),Fo(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=Nu(i.pre.className,i.textClass||"")),i}function Ws(e){var t=mu("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Xs(e,t,n,s,o,u,a){if(!t)return;var f=e.splitSpaces?t.replace(/ {3,}/g,Vs):t,l=e.cm.state.specialChars,c=!1;if(!l.test(t)){e.col+=t.length;var h=document.createTextNode(f);e.map.push(e.pos,e.pos+t.length,h),r&&i<9&&(c=!0),e.pos+=t.length}else{var h=document.createDocumentFragment(),p=0;for(;;){l.lastIndex=p;var d=l.exec(t),v=d?d.index-p:t.length-p;if(v){var m=document.createTextNode(f.slice(p,p+v));r&&i<9?h.appendChild(mu("span",[m])):h.appendChild(m),e.map.push(e.pos,e.pos+v,m),e.col+=v,e.pos+=v}if(!d)break;p+=v+1;if(d[0]=="	"){var g=e.cm.options.tabSize,y=g-e.col%g,m=h.appendChild(mu("span",tu(y),"cm-tab"));m.setAttribute("role","presentation"),m.setAttribute("cm-text","	"),e.col+=y}else if(d[0]=="\r"||d[0]=="\n"){var m=h.appendChild(mu("span",d[0]=="\r"?"␍":"␤","cm-invalidchar"));m.setAttribute("cm-text",d[0]),e.col+=1}else{var m=e.cm.options.specialCharPlaceholder(d[0]);m.setAttribute("cm-text",d[0]),r&&i<9?h.appendChild(mu("span",[m])):h.appendChild(m),e.col+=1}e.map.push(e.pos,e.pos+1,m),e.pos++}}if(n||s||o||c||a){var b=n||"";s&&(b+=s),o&&(b+=o);var w=mu("span",[h],b,a);return u&&(w.title=u),e.content.appendChild(w)}e.content.appendChild(h)}function Vs(e){var t=" ";for(var n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" ",t}function $s(e,t){return function(n,r,i,s,o,u,a){i=i?i+" cm-force-border":"cm-force-border";var f=n.pos,l=f+r.length;for(;;){for(var c=0;c<t.length;c++){var h=t[c];if(h.to>f&&h.from<=f)break}if(h.to>=l)return e(n,r,i,s,o,u,a);e(n,r.slice(0,h.to-f),i,s,null,u,a),s=null,r=r.slice(h.to-f),f=h.to}}}function Js(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t}function Ks(e,t,n){var r=e.markedSpans,i=e.text,s=0;if(!r){for(var o=1;o<n.length;o+=2)t.addToken(t,i.slice(s,s=n[o]),Us(n[o+1],t.cm.options));return}var u=i.length,a=0,o=1,f="",l,c,h=0,p,d,v,m,g;for(;;){if(h==a){p=d=v=m=c="",g=null,h=Infinity;var y=[];for(var b=0;b<r.length;++b){var w=r[b],E=w.marker;E.type=="bookmark"&&w.from==a&&E.widgetNode?y.push(E):w.from<=a&&(w.to==null||w.to>a||E.collapsed&&w.to==a&&w.from==a)?(w.to!=null&&w.to!=a&&h>w.to&&(h=w.to,d=""),E.className&&(p+=" "+E.className),E.css&&(c=E.css),E.startStyle&&w.from==a&&(v+=" "+E.startStyle),E.endStyle&&w.to==h&&(d+=" "+E.endStyle),E.title&&!m&&(m=E.title),E.collapsed&&(!g||ds(g.marker,E)<0)&&(g=w)):w.from>a&&h>w.from&&(h=w.from)}if(g&&(g.from||0)==a){Js(t,(g.to==null?u+1:g.to)-a,g.marker,g.from==null);if(g.to==null)return;g.to==a&&(g=!1)}if(!g&&y.length)for(var b=0;b<y.length;++b)Js(t,0,y[b])}if(a>=u)break;var S=Math.min(u,h);for(;;){if(f){var x=a+f.length;if(!g){var T=x>S?f.slice(0,S-a):f;t.addToken(t,T,l?l+p:p,v,a+T.length==h?d:"",m,c)}if(x>=S){f=f.slice(S-a),a=S;break}a=x,v=""}f=i.slice(s,s=n[o++]),l=Us(n[o++],t.cm.options)}}}function Qs(e,t){return t.from.ch==0&&t.to.ch==0&&nu(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Gs(e,t,n,r){function i(e){return n?n[e]:null}function s(e,n,i){Os(e,n,i,r),qo(e,"change",e,t)}function o(e,t){for(var n=e,s=[];n<t;++n)s.push(new As(f[n],i(n),r));return s}var u=t.from,a=t.to,f=t.text,l=oo(e,u.line),c=oo(e,a.line),h=nu(f),p=i(f.length-1),d=a.line-u.line;if(t.full)e.insert(0,o(0,f.length)),e.remove(f.length,e.size-f.length);else if(Qs(e,t)){var v=o(0,f.length-1);s(c,c.text,p),d&&e.remove(u.line,d),v.length&&e.insert(u.line,v)}else if(l==c)if(f.length==1)s(l,l.text.slice(0,u.ch)+h+l.text.slice(a.ch),p);else{var v=o(1,f.length-1);v.push(new As(h+l.text.slice(a.ch),p,r)),s(l,l.text.slice(0,u.ch)+f[0],i(0)),e.insert(u.line+1,v)}else if(f.length==1)s(l,l.text.slice(0,u.ch)+f[0]+c.text.slice(a.ch),i(0)),e.remove(u.line+1,d);else{s(l,l.text.slice(0,u.ch)+f[0],i(0)),s(c,h+c.text.slice(a.ch),p);var v=o(1,f.length-1);d>1&&e.remove(u.line+1,d-1),e.insert(u.line+1,v)}qo(e,"change",e,t)}function Ys(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Zs(e){this.children=e;var t=0,n=0;for(var r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}function io(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc==i)continue;var a=s&&u.sharedHist;if(n&&!a)continue;t(u.doc,a),r(u.doc,e,a)}}r(e,null,!0)}function so(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,k(e),x(e),e.options.lineWrapping||D(e),e.options.mode=t.modeOption,fr(e)}function oo(e,t){t-=e.first;if(t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],s=i.chunkSize();if(t<s){n=i;break}t-=s}return n.lines[t]}function uo(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;i==n.line&&(s=s.slice(0,n.ch)),i==t.line&&(s=s.slice(t.ch)),r.push(s),++i}),r}function ao(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function fo(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function lo(e){if(e.parent==null)return null;var t=e.parent,n=iu(t.lines,e);for(var r=t.parent;r;t=r,r=r.parent)for(var i=0;;++i){if(r.children[i]==t)break;n+=r.children[i].chunkSize()}return n+t.first}function co(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],s=i.height;if(t<s){e=i;continue e}t-=s,n+=i.chunkSize()}return n}while(!e.lines);for(var r=0;r<e.lines.length;++r){var o=e.lines[r],u=o.height;if(t<u)break;t-=u}return n+r}function ho(e){e=bs(e);var t=0,n=e.parent;for(var r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var s=n.parent;s;n=s,s=n.parent)for(var r=0;r<s.children.length;++r){var o=s.children[r];if(o==n)break;t+=o.height}return t}function po(e){var t=e.order;return t==null&&(t=e.order=ta(e.text)),t}function vo(e){this.done=[],this.undone=[],this.undoDepth=Infinity,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function mo(e,t){var n={from:mt(t.from),to:ni(t),text:uo(e,t.from,t.to)};return xo(e,n,t.from.line,t.to.line+1),io(e,function(e){xo(e,n,t.from.line,t.to.line+1)},!0),n}function go(e){while(e.length){var t=nu(e);if(!t.ranges)break;e.pop()}}function yo(e,t){if(t)return go(e.done),nu(e.done);if(e.done.length&&!nu(e.done).ranges)return nu(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),nu(e.done)}function bo(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&e.cm&&i.lastModTime>s-e.cm.options.historyEventDelay||t.origin.charAt(0)=="*"))&&(o=yo(i,i.lastOp==r))){var u=nu(o.changes);vt(t.from,t.to)==0&&vt(t.from,u.to)==0?u.to=ni(t):o.changes.push(mo(e,t))}else{var a=nu(i.done);(!a||!a.ranges)&&So(e.sel,i.done),o={changes:[mo(e,t)],generation:i.generation},i.done.push(o);while(i.done.length>i.undoDepth)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,u||Fo(e,"historyAdded")}function wo(e,t,n,r){var i=t.charAt(0);return i=="*"||i=="+"&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Eo(e,t,n,r){var i=e.history,s=r&&r.origin;n==i.lastSelOp||s&&i.lastSelOrigin==s&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==s||wo(e,s,nu(i.done),t))?i.done[i.done.length-1]=t:So(t,i.done),i.lastSelTime=+(new Date),i.lastSelOrigin=s,i.lastSelOp=n,r&&r.clearRedo!==!1&&go(i.undone)}function So(e,t){var n=nu(t);n&&n.ranges&&n.equals(e)||t.push(e)}function xo(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function To(e){if(!e)return null;for(var t=0,n;t<e.length;++t)e[t].marker.explicitlyCleared?n||(n=e.slice(0,t)):n&&n.push(e[t]);return n?n.length?n:null:e}function No(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(To(n[r]));return i}function Co(e,t,n){for(var r=0,i=[];r<e.length;++r){var s=e[r];if(s.ranges){i.push(n?Ht.prototype.deepCopy.call(s):s);continue}var o=s.changes,u=[];i.push({changes:u});for(var a=0;a<o.length;++a){var f=o[a],l;u.push({from:f.from,to:f.to,text:f.text});if(t)for(var c in f)(l=c.match(/^spans_(\d+)$/))&&iu(t,Number(l[1]))>-1&&(nu(u)[c]=f[c],delete f[c])}}return i}function ko(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Lo(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i],o=!0;if(s.ranges){s.copied||(s=e[i]=s.deepCopy(),s.copied=!0);for(var u=0;u<s.ranges.length;u++)ko(s.ranges[u].anchor,t,n,r),ko(s.ranges[u].head,t,n,r);continue}for(var u=0;u<s.changes.length;++u){var a=s.changes[u];if(n<a.from.line)a.from=dt(a.from.line+r,a.from.ch),a.to=dt(a.to.line+r,a.to.ch);else if(t<=a.to.line){o=!1;break}}o||(e.splice(0,i+1),i=0)}}function Ao(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Lo(e.done,n,r,i),Lo(e.undone,n,r,i)}function _o(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==0}function Po(e){return e.target||e.srcElement}function Ho(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),d&&e.ctrlKey&&t==1&&(t=3),t}function qo(e,t){function s(e){return function(){e.apply(null,r)}}var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2),i;Vn?i=Vn.delayedCallbacks:Io?i=Io:(i=Io=[],setTimeout(Ro,0));for(var o=0;o<n.length;++o)i.push(s(n[o]))}function Ro(){var e=Io;Io=null;for(var t=0;t<e.length;++t)e[t]()}function Uo(e,t,n){return typeof t=="string"&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Fo(e,n||t.type,e,t),_o(t)||t.codemirrorIgnore}function zo(e){var t=e._handlers&&e._handlers.cursorActivity;if(!t)return;var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]);for(var r=0;r<t.length;++r)iu(n,t[r])==-1&&n.push(t[r])}function Wo(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function Xo(e){e.prototype.on=function(e,t){Bo(this,e,t)},e.prototype.off=function(e,t){jo(this,e,t)}}function Go(){this.id=null}function tu(e){while(eu.length<=e)eu.push(nu(eu)+" ");return eu[e]}function nu(e){return e[e.length-1]}function iu(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function su(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function ou(){}function uu(e,t){var n;return Object.create?n=Object.create(e):(ou.prototype=e,n=new ou),t&&au(t,n),n}function au(e,t,n){t||(t={});for(var r in e)e.hasOwnProperty(r)&&(n!==!1||!t.hasOwnProperty(r))&&(t[r]=e[r]);return t}function fu(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function hu(e,t){return t?t.source.indexOf("\\w")>-1&&cu(e)?!0:t.test(e):cu(e)}function pu(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function vu(e){return e.charCodeAt(0)>=768&&du.test(e)}function mu(e,t,n,r){var i=document.createElement(e);n&&(i.className=n),r&&(i.style.cssText=r);if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function yu(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function bu(e,t){return yu(e).appendChild(t)}function Eu(){var e=document.activeElement;while(e&&e.root&&e.root.activeElement)e=e.root.activeElement;return e}function Su(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Nu(e,t){var n=e.split(" ");for(var r=0;r<n.length;r++)n[r]&&!Su(n[r]).test(t)&&(t+=" "+n[r]);return t}function Cu(e){if(!document.body.getElementsByClassName)return;var t=document.body.getElementsByClassName("CodeMirror");for(var n=0;n<t.length;n++){var r=t[n].CodeMirror;r&&e(r)}}function Lu(){if(ku)return;Au(),ku=!0}function Au(){var e;Bo(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,Cu(yr)},100))}),Bo(window,"blur",function(){Cu(Zr)})}function _u(e){if(Mu==null){var t=mu("span","​");bu(e,mu("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(Mu=t.offsetWidth<=1&&t.offsetHeight>2&&!(r&&i<8))}var n=Mu?mu("span","​"):mu("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Pu(e){if(Du!=null)return Du;var t=bu(e,document.createTextNode("AخA")),n=gu(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var r=gu(t,1,2).getBoundingClientRect();return Du=r.right-n.right<3}function Iu(e){if(Fu!=null)return Fu;var t=bu(e,mu("span","x")),n=t.getBoundingClientRect(),r=gu(t,0,1).getBoundingClientRect();return Fu=Math.abs(n.left-r.left)>1}function Ru(e,t,n,r){if(!e)return r(t,n,"ltr");var i=!1;for(var s=0;s<e.length;++s){var o=e[s];if(o.from<n&&o.to>t||t==n&&o.to==t)r(Math.max(o.from,t),Math.min(o.to,n),o.level==1?"rtl":"ltr"),i=!0}i||r(t,n,"ltr")}function Uu(e){return e.level%2?e.to:e.from}function zu(e){return e.level%2?e.from:e.to}function Wu(e){var t=po(e);return t?Uu(t[0]):0}function Xu(e){var t=po(e);return t?zu(nu(t)):e.text.length}function Vu(e,t){var n=oo(e.doc,t),r=bs(n);r!=n&&(t=lo(r));var i=po(r),s=i?i[0].level%2?Xu(r):Wu(r):0;return dt(t,s)}function $u(e,t){var n,r=oo(e.doc,t);while(n=gs(r))r=n.find(1,!0).line,t=null;var i=po(r),s=i?i[0].level%2?Wu(r):Xu(r):r.text.length;return dt(t==null?lo(r):t,s)}function Ju(e,t){var n=Vu(e,t.line),r=oo(e.doc,n.line),i=po(r);if(!i||i[0].level==0){var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;return dt(n.line,o?0:s)}return n}function Ku(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:t<n}function Gu(e,t){Qu=null;for(var n=0,r;n<e.length;++n){var i=e[n];if(i.from<t&&i.to>t)return n;if(i.from==t||i.to==t){if(r!=null)return Ku(e,i.level,e[r].level)?(i.from!=i.to&&(Qu=r),n):(i.from!=i.to&&(Qu=n),r);r=n}}return r}function Yu(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&vu(e.text.charAt(t)));return t}function Zu(e,t,n,r){var i=po(e);if(!i)return ea(e,t,n,r);var s=Gu(i,t),o=i[s],u=Yu(e,t,o.level%2?-n:n,r);for(;;){if(u>o.from&&u<o.to)return u;if(u==o.from||u==o.to)return Gu(i,u)==s?u:(o=i[s+=n],n>0==o.level%2?o.to:o.from);o=i[s+=n];if(!o)return null;n>0==o.level%2?u=Yu(e,o.to,-1,r):u=Yu(e,o.from,1,r)}}function ea(e,t,n,r){var i=t+n;if(r)while(i>0&&vu(e.text.charAt(i)))i+=n;return i<0||i>e.text.length?null:i}var e=/gecko\/\d/i.test(navigator.userAgent),t=/MSIE \d/.test(navigator.userAgent),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),r=t||n,i=r&&(t?document.documentMode||6:n[1]),s=/WebKit\//.test(navigator.userAgent),o=s&&/Qt\/\d+\.\d+/.test(navigator.userAgent),u=/Chrome\//.test(navigator.userAgent),a=/Opera\//.test(navigator.userAgent),f=/Apple Computer/.test(navigator.vendor),l=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),c=/PhantomJS/.test(navigator.userAgent),h=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),p=h||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),d=h||/Mac/.test(navigator.platform),v=/win/i.test(navigator.platform),m=a&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);m&&(m=Number(m[1])),m&&m>=15&&(a=!1,s=!0);var g=d&&(o||a&&(m==null||m<12.11)),y=e||r&&i>=9,b=!1,w=!1;B.prototype=au({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var i=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var s=e.viewWidth-e.barLeft-(n?r:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+s+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedOverlay&&e.clientHeight>0&&(r==0&&this.overlayHack(),this.checkedOverlay=!0),{right:n?r:0,bottom:t?r:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e)},overlayHack:function(){var e=d&&!l?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=e;var t=this,n=function(e){Po(e)!=t.vert&&Po(e)!=t.horiz&&ir(t.cm,Er)(e)};Bo(this.vert,"mousedown",n),Bo(this.horiz,"mousedown",n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},B.prototype),j.prototype=au({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},j.prototype),E.scrollbarModel={"native":B,"null":j},V.prototype.signal=function(e,t){Wo(e,t)&&this.events.push(arguments)},V.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Fo.apply(null,this.events[e])};var dt=E.Pos=function(e,t){if(!(this instanceof dt))return new dt(e,t);this.line=e,this.ch=t},vt=E.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Et=null;kt.prototype=au({init:function(e){function u(e){if(n.somethingSelected())Et=n.getSelections(),t.inaccurateSelection&&(t.prevInput="",t.inaccurateSelection=!1,o.value=Et.join("\n"),ru(o));else{if(!n.options.lineWiseCopyCut)return;var r=Nt(n);Et=r.text,e.type=="cut"?n.setSelections(r.ranges,null,Jo):(t.prevInput="",o.value=r.text.join("\n"),ru(o))}e.type=="cut"&&(n.state.cutIncoming=!0)}var t=this,n=this.cm,s=this.wrapper=Lt(),o=this.textarea=s.firstChild;e.wrapper.insertBefore(s,e.wrapper.firstChild),h&&(o.style.width="0px"),Bo(o,"input",function(){r&&i>=9&&t.hasSelection&&(t.hasSelection=null),t.poll()}),Bo(o,"paste",function(e){if(xt(e,n))return!0;n.state.pasteIncoming=!0,t.fastPoll()}),Bo(o,"cut",u),Bo(o,"copy",u),Bo(e.scroller,"paste",function(r){if(br(e,r))return;n.state.pasteIncoming=!0,t.focus()}),Bo(e.lineSpace,"selectstart",function(t){br(e,t)||Oo(t)}),Bo(o,"compositionstart",function(){var e=n.getCursor("from");t.composing&&t.composing.range.clear(),t.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),Bo(o,"compositionend",function(){t.composing&&(t.poll(),t.composing.range.clear(),t.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,r=sn(e);if(e.options.moveInputWithCursor){var i=Fn(e,n.sel.primary().head,"div"),s=t.wrapper.getBoundingClientRect(),o=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+o.top-s.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+o.left-s.left))}return r},showSelection:function(e){var t=this.cm,n=t.display;bu(n.cursorDiv,e.cursors),bu(n.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(this.contextMenuPending)return;var t,n,s=this.cm,o=s.doc;if(s.somethingSelected()){this.prevInput="";var u=o.sel.primary();t=ju&&(u.to().line-u.from().line>100||(n=s.getSelection()).length>1e3);var a=t?"-":n||s.getSelection();this.textarea.value=a,s.state.focused&&ru(this.textarea),r&&i>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",r&&i>=9&&(this.hasSelection=null));this.inaccurateSelection=t},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!p||Eu()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;if(e.pollingFast)return;e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function n(){var r=t.poll();!r&&!e?(e=!0,t.polling.set(60,n)):(t.pollingFast=!1,t.slowPoll())}var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,n)},poll:function(){var e=this.cm,t=this.textarea,n=this.prevInput;if(this.contextMenuPending||!e.state.focused||Bu(t)&&!n&&!this.composing||wt(e)||e.options.disableInput||e.state.keySeq)return!1;var s=t.value;if(s==n&&!e.somethingSelected())return!1;if(r&&i>=9&&this.hasSelection===s||d&&/[\uf700-\uf7ff]/.test(s))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var o=s.charCodeAt(0);o==8203&&!n&&(n="​");if(o==8666)return this.reset(),this.cm.execCommand("undo")}var u=0,a=Math.min(n.length,s.length);while(u<a&&n.charCodeAt(u)==s.charCodeAt(u))++u;var f=this;return rr(e,function(){St(e,s.slice(u),n.length-u,null,f.composing?"*compose":null),s.length>1e3||s.indexOf("\n")>-1?t.value=f.prevInput="":f.prevInput=s,f.composing&&(f.composing.range.clear(),f.composing.range=e.markText(f.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){r&&i>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function d(){if(u.selectionStart!=null){var e=n.somethingSelected(),r="​"+(e?u.value:"");u.value="⇚",u.value=r,t.prevInput=e?"":"​",u.selectionStart=1,u.selectionEnd=r.length,o.selForContextMenu=n.doc.sel}}function v(){t.contextMenuPending=!1,t.wrapper.style.position="relative",u.style.cssText=h,r&&i<9&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l);if(u.selectionStart!=null){(!r||r&&i<9)&&d();var e=0,s=function(){o.selForContextMenu==n.doc.sel&&u.selectionStart==0&&u.selectionEnd>0&&t.prevInput=="​"?ir(n,Fi.selectAll)(n):e++<10?o.detectingSelectAll=setTimeout(s,500):o.input.reset()};o.detectingSelectAll=setTimeout(s,200)}}var t=this,n=t.cm,o=n.display,u=t.textarea,f=wr(n,e),l=o.scroller.scrollTop;if(!f||a)return;var c=n.options.resetSelectionOnContextMenu;c&&n.doc.sel.contains(f)==-1&&ir(n,Gt)(n.doc,Ft(f),Jo);var h=u.style.cssText;t.wrapper.style.position="absolute",u.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(r?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(s)var p=window.scrollY;o.input.focus(),s&&window.scrollTo(null,p),o.input.reset(),n.somethingSelected()||(u.value=t.prevInput=" "),t.contextMenuPending=!0,o.selForContextMenu=n.doc.sel,clearTimeout(o.detectingSelectAll),r&&i>=9&&d();if(y){Do(e);var m=function(){jo(window,"mouseup",m),setTimeout(v,20)};Bo(window,"mouseup",m)}else setTimeout(v,50)},readOnlyChanged:function(e){e||this.reset()},setUneditable:ou,needsContentAttribute:!1},kt.prototype),At.prototype=au({init:function(e){function i(e){if(n.somethingSelected())Et=n.getSelections(),e.type=="cut"&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=Nt(n);Et=t.text,e.type=="cut"&&n.operation(function(){n.setSelections(t.ranges,0,Jo),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!h)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Et.join("\n"));else{var r=Lt(),i=r.firstChild;n.display.lineSpace.insertBefore(r,n.display.lineSpace.firstChild),i.value=Et.join("\n");var s=document.activeElement;ru(i),setTimeout(function(){n.display.lineSpace.removeChild(r),s.focus()},50)}}var t=this,n=t.cm,r=t.div=e.lineDiv;Ct(r),Bo(r,"paste",function(e){xt(e,n)}),Bo(r,"compositionstart",function(e){var r=e.data;t.composing={sel:n.doc.sel,data:r,startData:r};if(!r)return;var i=n.doc.sel.primary(),s=n.getLine(i.head.line),o=s.indexOf(r,Math.max(0,i.head.ch-r.length));o>-1&&o<=i.head.ch&&(t.composing.sel=Ft(dt(i.head.line,o),dt(i.head.line,o+r.length)))}),Bo(r,"compositionupdate",function(e){t.composing.data=e.data}),Bo(r,"compositionend",function(e){var n=t.composing;if(!n)return;e.data!=n.startData&&!/\u200b/.test(e.data)&&(n.data=e.data),setTimeout(function(){n.handled||t.applyComposition(n),t.composing==n&&(t.composing=null)},50)}),Bo(r,"touchstart",function(){t.forceCompositionEnd()}),Bo(r,"input",function(){if(t.composing)return;(wt(n)||!t.pollContent())&&rr(t.cm,function(){fr(n)})}),Bo(r,"copy",i),Bo(r,"cut",i)},prepareSelection:function(){var e=sn(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){if(!e||!this.cm.display.view.length)return;e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e)},showPrimarySelection:function(){var t=window.getSelection(),n=this.cm.doc.sel.primary(),r=_t(this.cm,t.anchorNode,t.anchorOffset),i=_t(this.cm,t.focusNode,t.focusOffset);if(r&&!r.bad&&i&&!i.bad&&vt(yt(r,i),n.from())==0&&vt(gt(r,i),n.to())==0)return;var s=Ot(this.cm,n.from()),o=Ot(this.cm,n.to());if(!s&&!o)return;var u=this.cm.display.view,a=t.rangeCount&&t.getRangeAt(0);if(!s)s={node:u[0].measure.map[2],offset:0};else if(!o){var f=u[u.length-1].measure,l=f.maps?f.maps[f.maps.length-1]:f.map;o={node:l[l.length-1],offset:l[l.length-2]-l[l.length-3]}}try{var c=gu(s.node,s.offset,o.offset,o.node)}catch(h){}c&&(t.removeAllRanges(),t.addRange(c),a&&t.anchorNode==null?t.addRange(a):e&&this.startGracePeriod()),this.rememberSelection()},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){bu(this.cm.display.cursorDiv,e.cursors),bu(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return wu(this.div,t)},focus:function(){this.cm.options.readOnly!="nocursor"&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}var e=this;this.selectionInEditor()?this.pollSelection():rr(this.cm,function(){e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,t)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=_t(t,e.anchorNode,e.anchorOffset),r=_t(t,e.focusNode,e.focusOffset);n&&r&&rr(t,function(){Gt(t.doc,Ft(n,r),Jo);if(n.bad||r.bad)t.curOp.selectionChanged=!0})}},pollContent:function(){var e=this.cm,t=e.display,n=e.doc.sel.primary(),r=n.from(),i=n.to();if(r.line<t.viewFrom||i.line>t.viewTo-1)return!1;var s;if(r.line==t.viewFrom||(s=hr(e,r.line))==0)var o=lo(t.view[0].line),u=t.view[0].node;else var o=lo(t.view[s].line),u=t.view[s-1].node.nextSibling;var a=hr(e,i.line);if(a==t.view.length-1)var f=t.viewTo-1,l=t.lineDiv.lastChild;else var f=lo(t.view[a+1].line)-1,l=t.view[a+1].node.previousSibling;var c=e.doc.splitLines(Pt(e,u,l,o,f)),h=uo(e.doc,dt(o,0),dt(f,oo(e.doc,f).text.length));while(c.length>1&&h.length>1)if(nu(c)==nu(h))c.pop(),h.pop(),f--;else{if(c[0]!=h[0])break;c.shift(),h.shift(),o++}var p=0,d=0,v=c[0],m=h[0],g=Math.min(v.length,m.length);while(p<g&&v.charCodeAt(p)==m.charCodeAt(p))++p;var y=nu(c),b=nu(h),w=Math.min(y.length-(c.length==1?p:0),b.length-(h.length==1?p:0));while(d<w&&y.charCodeAt(y.length-d-1)==b.charCodeAt(b.length-d-1))++d;c[c.length-1]=y.slice(0,y.length-d),c[0]=c[0].slice(p);var E=dt(o,p),S=dt(f,h.length?nu(h).length-d:0);if(c.length>1||c[0]||vt(E,S))return di(e.doc,c,E,S,"+input"),!0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled)return;this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus()},applyComposition:function(e){wt(this.cm)?ir(this.cm,fr)(this.cm):e.data&&e.data!=e.startData&&ir(this.cm,St)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),wt(this.cm)||ir(this.cm,St)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String(e!="nocursor")},onContextMenu:ou,resetPosition:ou,needsContentAttribute:!0},At.prototype),E.inputStyles={textarea:kt,contenteditable:At},Ht.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(vt(n.anchor,r.anchor)!=0||vt(n.head,r.head)!=0)return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new Bt(mt(this.ranges[t].anchor),mt(this.ranges[t].head));return new Ht(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(vt(t,r.from())>=0&&vt(e,r.to())<=0)return n}return-1}},Bt.prototype={from:function(){return yt(this.anchor,this.head)},to:function(){return gt(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Cn={left:0,right:0,top:0,bottom:0},zn,Vn=null,$n=0,Sr,xr,Ar=0,Br=0,jr=null;r?jr=-0.53:e?jr=15:u?jr=-0.7:f&&(jr=-1/3);var Fr=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return t==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),n==null&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:n==null&&(n=e.wheelDelta),{x:t,y:n}};E.wheelEventPixels=function(e){var t=Fr(e);return t.x*=jr,t.y*=jr,t};var Ur=new Go,Vr=null,ni=E.changeEnd=function(e){return e.text?dt(e.from.line+e.text.length-1,nu(e.text).length+(e.text.length==1?e.from.ch:0)):e.to};E.prototype={constructor:E,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,r=n[e];if(n[e]==t&&e!="mode")return;n[e]=t,Li.hasOwnProperty(e)&&ir(this,Li[e])(this,t,r)},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Wi(e))},removeKeyMap:function(e){var t=this.state.keyMaps;for(var n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:sr(function(e,t){var n=e.token?e:E.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,fr(this)}),removeOverlay:sr(function(e){var t=this.state.overlays;for(var n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||typeof e=="string"&&r.name==e){t.splice(n,1),this.state.modeGen++,fr(this);return}}}),indentLine:sr(function(e,t,n){typeof t!="string"&&typeof t!="number"&&(t==null?t=this.options.smartIndent?"smart":"prev":t=t?"add":"subtract"),Ut(this.doc,e)&&Si(this,e,t,n)}),indentSelection:sr(function(e){var t=this.doc.sel.ranges,n=-1;for(var r=0;r<t.length;r++){var i=t[r];if(!i.empty()){var s=i.from(),o=i.to(),u=Math.max(n,s.line);n=Math.min(this.lastLine(),o.line-(o.ch?0:1))+1;for(var a=u;a<n;++a)Si(this,a,e);var f=this.doc.sel.ranges;s.ch==0&&t.length==f.length&&f[r].from().ch>0&&$t(this.doc,r,new Bt(s,f[r].to()),Jo)}else i.head.line>n&&(Si(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&wi(this))}}),getTokenAt:function(e,t){return Hs(this,e,t)},getLineTokens:function(e,t){return Hs(this,dt(e),t,!0)},getTokenTypeAt:function(e){e=qt(this.doc,e);var t=Fs(this,oo(this.doc,e.line)),n=0,r=(t.length-1)/2,i=e.ch,s;if(i==0)s=t[2];else for(;;){var o=n+r>>1;if((o?t[o*2-1]:0)>=i)r=o;else{if(!(t[o*2+1]<i)){s=t[o*2+2];break}n=o+1}}var u=s?s.indexOf("cm-overlay "):-1;return u<0?s:u==0?null:s.slice(0,u-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?E.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Hi.hasOwnProperty(t))return n;var r=Hi[t],i=this.getModeAt(e);if(typeof i[t]=="string")r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var s=0;s<i[t].length;s++){var o=r[i[t][s]];o&&n.push(o)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var s=0;s<r._global.length;s++){var u=r._global[s];u.pred(i,this)&&iu(n,u.val)==-1&&n.push(u.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=It(n,e==null?n.first+n.size-1:e),hn(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel.primary();return e==null?n=r.head:typeof e=="object"?n=qt(this.doc,e):n=e?r.from():r.to(),Fn(this,n,t||"page")},charCoords:function(e,t){return jn(this,qt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=Bn(this,e,t||"page"),Rn(this,e.left,e.top)},lineAtHeight:function(e,t){return e=Bn(this,{top:e,left:0},t||"page").top,co(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r;if(typeof e=="number"){var i=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>i&&(e=i,n=!0),r=oo(this.doc,e)}else r=e;return Hn(this,r,{top:0,left:0},t||"page").top+(n?this.doc.height-ho(r):0)},defaultTextHeight:function(){return Wn(this.display)},defaultCharWidth:function(){return Xn(this.display)},setGutterMarker:sr(function(e,t,n){return xi(this.doc,e,"gutter",function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&pu(r)&&(e.gutterMarkers=null),!0})}),clearGutter:sr(function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,lr(t,r,"gutter"),pu(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),lineInfo:function(e){if(typeof e=="number"){if(!Ut(this.doc,e))return null;var t=e;e=oo(this.doc,e);if(!e)return null}else{var t=lo(e);if(t==null)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=Fn(this,qt(this.doc,e));var o=e.bottom,u=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t);if(r=="over")o=e.top;else if(r=="above"||r=="near"){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);(r=="above"||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="",i=="right"?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):(i=="left"?u=0:i=="middle"&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&gi(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:sr($r),triggerOnKeyPress:sr(Qr),triggerOnKeyUp:Kr,execCommand:function(e){if(Fi.hasOwnProperty(e))return Fi[e].call(null,this)},triggerElectric:sr(function(e){Tt(this,e)}),findPosH:function(e,t,n,r){var i=1;t<0&&(i=-1,t=-t);for(var s=0,o=qt(this.doc,e);s<t;++s){o=Ni(this.doc,o,i,n,r);if(o.hitSide)break}return o},moveH:sr(function(e,t){var n=this;n.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?Ni(n.doc,r.head,e,t,n.options.rtlMoveVisually):e<0?r.from():r.to()},Qo)}),deleteH:sr(function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):Ti(this,function(n){var i=Ni(r,n.head,e,t,!1);return e<0?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(e,t,n,r){var i=1,s=r;t<0&&(i=-1,t=-t);for(var o=0,u=qt(this.doc,e);o<t;++o){var a=Fn(this,u,"div");s==null?s=a.left:a.left=s,u=Ci(this,a,i,n);if(u.hitSide)break}return u},moveV:sr(function(e,t){var n=this,r=this.doc,i=[],s=!n.display.shift&&!r.extend&&r.sel.somethingSelected();r.extendSelectionsBy(function(o){if(s)return e<0?o.from():o.to();var u=Fn(n,o.head,"div");o.goalColumn!=null&&(u.left=o.goalColumn),i.push(u.left);var a=Ci(n,u,e,t);return t=="page"&&o==r.sel.primary()&&bi(n,null,jn(n,a,"div").top-u.top),a},Qo);if(i.length)for(var o=0;o<r.sel.ranges.length;o++)r.sel.ranges[o].goalColumn=i[o]}),findWordAt:function(e){var t=this.doc,n=oo(t,e.line).text,r=e.ch,i=e.ch;if(n){var s=this.getHelper(e,"wordChars");(e.xRel<0||i==n.length)&&r?--r:++i;var o=n.charAt(r),u=hu(o,s)?function(e){return hu(e,s)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!hu(e)};while(r>0&&u(n.charAt(r-1)))--r;while(i<n.length&&u(n.charAt(i)))++i}return new Bt(dt(e.line,r),dt(e.line,i))},toggleOverwrite:function(e){if(e!=null&&e==this.state.overwrite)return;(this.state.overwrite=!this.state.overwrite)?Tu(this.display.cursorDiv,"CodeMirror-overwrite"):xu(this.display.cursorDiv,"CodeMirror-overwrite"),Fo(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==Eu()},scrollTo:sr(function(e,t){(e!=null||t!=null)&&Ei(this),e!=null&&(this.curOp.scrollLeft=e),t!=null&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-mn(this)-this.display.barHeight,width:e.scrollWidth-mn(this)-this.display.barWidth,clientHeight:yn(this),clientWidth:gn(this)}},scrollIntoView:sr(function(e,t){e==null?(e={from:this.doc.sel.primary().head,to:null},t==null&&(t=this.options.cursorScrollMargin)):typeof e=="number"?e={from:dt(e,0),to:null}:e.from==null&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0;if(e.from.line!=null)Ei(this),this.curOp.scrollToPos=e;else{var n=yi(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:sr(function(e,t){function r(e){return typeof e=="number"||/^\d+$/.test(String(e))?e+"px":e}var n=this;e!=null&&(n.display.wrapper.style.width=r(e)),t!=null&&(n.display.wrapper.style.height=r(t)),n.options.lineWrapping&&Mn(this);var i=n.display.viewFrom;n.doc.iter(i,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){lr(n,i,"widget");break}++i}),n.curOp.forceUpdate=!0,Fo(n,"refresh",this)}),operation:function(e){return rr(this,e)},refresh:sr(function(){var e=this.display.cachedTextHeight;fr(this),this.curOp.forceUpdate=!0,_n(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),M(this),(e==null||Math.abs(e-Wn(this.display))>.5)&&k(this),Fo(this,"refresh",this)}),swapDoc:sr(function(e){var t=this.doc;return t.cm=null,so(this,e),_n(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,qo(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Xo(E);var ki=E.defaults={},Li=E.optionHandlers={},Oi=E.Init={toString:function(){return"CodeMirror.Init"}};Ai("value","",function(e,t){e.setValue(t)},!0),Ai("mode",null,function(e,t){e.doc.modeOption=t,x(e)},!0),Ai("indentUnit",2,x,!0),Ai("indentWithTabs",!1),Ai("smartIndent",!0),Ai("tabSize",4,function(e){T(e),_n(e),fr(e)},!0),Ai("lineSeparator",null,function(e,t){e.doc.lineSep=t;if(!t)return;var n=[],r=e.doc.first;e.doc.iter(function(e){for(var i=0;;){var s=e.text.indexOf(t,i);if(s==-1)break;i=s+t.length,n.push(dt(r,s))}r++});for(var i=n.length-1;i>=0;i--)di(e.doc,t,n[i],dt(n[i].line,n[i].ch+t.length))}),Ai("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("	")?"":"|	"),"g"),n!=E.Init&&e.refresh()}),Ai("specialCharPlaceholder",Ws,function(e){e.refresh()},!0),Ai("electricChars",!0),Ai("inputStyle",p?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Ai("rtlMoveVisually",!v),Ai("wholeLineUpdateBefore",!0),Ai("theme","default",function(e){L(e),A(e)},!0),Ai("keyMap","default",function(e,t,n){var r=Wi(t),i=n!=E.Init&&Wi(n);i&&i.detach&&i.detach(e,r),r.attach&&r.attach(e,i||null)}),Ai("extraKeys",null),Ai("lineWrapping",!1,N,!0),Ai("gutters",[],function(e){P(e.options),A(e)},!0),Ai("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?X(e.display)+"px":"0",e.refresh()},!0),Ai("coverGutterNextToScrollbar",!1,function(e){I(e)},!0),Ai("scrollbarStyle","native",function(e){F(e),I(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Ai("lineNumbers",!1,function(e){P(e.options),A(e)},!0),Ai("firstLineNumber",1,A,!0),Ai("lineNumberFormatter",function(e){return e},A,!0),Ai("showCursorWhenSelecting",!1,rn,!0),Ai("resetSelectionOnContextMenu",!0),Ai("lineWiseCopyCut",!0),Ai("readOnly",!1,function(e,t){t=="nocursor"?(Zr(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),Ai("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Ai("dragDrop",!0,gr),Ai("cursorBlinkRate",530),Ai("cursorScrollMargin",0),Ai("cursorHeight",1,rn,!0),Ai("singleCursorHeightPerLine",!0,rn,!0),Ai("workTime",100),Ai("workDelay",100),Ai("flattenSpans",!0,T,!0),Ai("addModeClass",!1,T,!0),Ai("pollInterval",100),Ai("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Ai("historyEventDelay",1250),Ai("viewportMargin",10,function(e){e.refresh()},!0),Ai("maxHighlightLength",1e4,T,!0),Ai("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Ai("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Ai("autofocus",null);var Mi=E.modes={},_i=E.mimeModes={};E.defineMode=function(e,t){!E.defaults.mode&&e!="null"&&(E.defaults.mode=e),arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Mi[e]=t},E.defineMIME=function(e,t){_i[e]=t},E.resolveMode=function(e){if(typeof e=="string"&&_i.hasOwnProperty(e))e=_i[e];else if(e&&typeof e.name=="string"&&_i.hasOwnProperty(e.name)){var t=_i[e.name];typeof t=="string"&&(t={name:t}),e=uu(t,e),e.name=t.name}else if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return E.resolveMode("application/xml");return typeof e=="string"?{name:e}:e||{name:"null"}},E.getMode=function(e,t){var t=E.resolveMode(t),n=Mi[t.name];if(!n)return E.getMode(e,"text/plain");var r=n(e,t);if(Di.hasOwnProperty(t.name)){var i=Di[t.name];for(var s in i){if(!i.hasOwnProperty(s))continue;r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s]}}r.name=t.name,t.helperType&&(r.helperType=t.helperType);if(t.modeProps)for(var s in t.modeProps)r[s]=t.modeProps[s];return r},E.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),E.defineMIME("text/plain","null");var Di=E.modeExtensions={};E.extendMode=function(e,t){var n=Di.hasOwnProperty(e)?Di[e]:Di[e]={};au(t,n)},E.defineExtension=function(e,t){E.prototype[e]=t},E.defineDocExtension=function(e,t){to.prototype[e]=t},E.defineOption=Ai;var Pi=[];E.defineInitHook=function(e){Pi.push(e)};var Hi=E.helpers={};E.registerHelper=function(e,t,n){Hi.hasOwnProperty(e)||(Hi[e]=E[e]={_global:[]}),Hi[e][t]=n},E.registerGlobalHelper=function(e,t,n,r){E.registerHelper(e,t,r),Hi[e]._global.push({pred:n,val:r})};var Bi=E.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n},ji=E.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};E.innerMode=function(e,t){while(e.innerMode){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var Fi=E.commands={selectAll:function(e){e.setSelection(dt(e.firstLine(),0),dt(e.lastLine()),Jo)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Jo)},killLine:function(e){Ti(e,function(t){if(t.empty()){var n=oo(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:dt(t.head.line+1,0)}:{from:t.head,to:dt(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Ti(e,function(t){return{from:dt(t.from().line,0),to:qt(e.doc,dt(t.to().line+1,0))}})},delLineLeft:function(e){Ti(e,function(e){return{from:dt(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){Ti(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(e){Ti(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:r}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(dt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(dt(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return Vu(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return Ju(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return $u(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Qo)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Qo)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return r.ch<e.getLine(r.line).search(/\S/)?Ju(e,t.head):r},Qo)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){var t=[],n=e.listSelections(),r=e.options.tabSize;for(var i=0;i<n.length;i++){var s=n[i].from(),o=Yo(e.getLine(s.line),s.ch,r);t.push((new Array(r-o%r+1)).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){rr(e,function(){var t=e.listSelections(),n=[];for(var r=0;r<t.length;r++){var i=t[r].head,s=oo(e.doc,i.line).text;if(s){i.ch==s.length&&(i=new dt(i.line,i.ch-1));if(i.ch>0)i=new dt(i.line,i.ch+1),e.replaceRange(s.charAt(i.ch-1)+s.charAt(i.ch-2),dt(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var o=oo(e.doc,i.line-1).text;o&&e.replaceRange(s.charAt(0)+e.doc.lineSeparator()+o.charAt(o.length-1),dt(i.line-1,o.length-1),dt(i.line,1),"+transpose")}}n.push(new Bt(i,i))}e.setSelections(n)})},newlineAndIndent:function(e){rr(e,function(){var t=e.listSelections().length;for(var n=0;n<t;n++){var r=e.listSelections()[n];e.replaceRange(e.doc.lineSeparator(),r.anchor,r.head,"+input"),e.indentLine(r.from().line+1,null,!0),wi(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},Ii=E.keyMap={};Ii.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ii.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ii.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Ii.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Ii["default"]=d?Ii.macDefault:Ii.pcDefault,E.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if(r=="..."){delete e[n];continue}var i=su(n.split(" "),qi);for(var s=0;s<i.length;s++){var o,u;s==i.length-1?(u=i.join(" "),o=r):(u=i.slice(0,s+1).join(" "),o="...");var a=t[u];if(!a)t[u]=o;else if(a!=o)throw new Error("Inconsistent bindings for "+u)}delete e[n]}for(var f in t)e[f]=t[f];return e};var Ri=E.lookupKey=function(e,t,n,r){t=Wi(t);var i=t.call?t.call(e,r):t[e];if(i===!1)return"nothing";if(i==="...")return"multi";if(i!=null&&n(i))return"handled";if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]")return Ri(e,t.fallthrough,n,r);for(var s=0;s<t.fallthrough.length;s++){var o=Ri(e,t.fallthrough[s],n,r);if(o)return o}}},Ui=E.isModifierKey=function(e){var t=typeof e=="string"?e:qu[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"},zi=E.keyName=function(e,t){if(a&&e.keyCode==34&&e["char"])return!1;var n=qu[e.keyCode],r=n;return r==null||e.altGraphKey?!1:(e.altKey&&n!="Alt"&&(r="Alt-"+r),(g?e.metaKey:e.ctrlKey)&&n!="Ctrl"&&(r="Ctrl-"+r),(g?e.ctrlKey:e.metaKey)&&n!="Cmd"&&(r="Cmd-"+r),!t&&e.shiftKey&&n!="Shift"&&(r="Shift-"+r),r)};E.fromTextArea=function(e,t){function r(){e.value=a.getValue()}t=t?au(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder);if(t.autofocus==null){var n=Eu();t.autofocus=n==e||e.getAttribute("autofocus")!=null&&n==document.body}if(e.form){Bo(e.form,"submit",r);if(!t.leaveSubmitMethodAlone){var i=e.form,s=i.submit;try{var o=i.submit=function(){r(),i.submit=s,i.submit(),i.submit=o}}catch(u){}}}t.finishInit=function(t){t.save=r,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,r(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(jo(e.form,"submit",r),typeof e.form.submit=="function"&&(e.form.submit=s))}},e.style.display="none";var a=E(function(t){e.parentNode.insertBefore(t,e.nextSibling)},t);return a};var Xi=E.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Xi.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if(typeof e=="string")var n=t==e;else var n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){var t=this.pos;while(this.eat(e));return this.pos>t},eatSpace:function(){var e=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Yo(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Yo(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Yo(this.string,null,this.tabSize)-(this.lineStart?Yo(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if(typeof e!="string"){var s=this.string.slice(this.pos).match(e);return s&&s.index>0?null:(s&&t!==!1&&(this.pos+=s[0].length),s)}var r=function(e){return n?e.toLowerCase():e},i=this.string.substr(this.pos,e.length);if(r(i)==r(e))return t!==!1&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var Vi=0,$i=E.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++Vi};Xo($i),$i.prototype.clear=function(){if(this.explicitlyCleared)return;var e=this.doc.cm,t=e&&!e.curOp;t&&Jn(e);if(Wo(this,"clear")){var n=this.find();n&&qo(this,"clear",n.from,n.to)}var r=null,i=null;for(var s=0;s<this.lines.length;++s){var o=this.lines[s],u=ts(o.markedSpans,this);e&&!this.collapsed?lr(e,lo(o),"text"):e&&(u.to!=null&&(i=lo(o)),u.from!=null&&(r=lo(o))),o.markedSpans=ns(o.markedSpans,u),u.from==null&&this.collapsed&&!xs(this.doc,o)&&e&&fo(o,Wn(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var a=bs(this.lines[s]),f=_(a);f>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=f,e.display.maxLineChanged=!0)}r!=null&&e&&this.collapsed&&fr(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&en(e.doc)),e&&qo(e,"markerCleared",e,this),t&&Qn(e),this.parent&&this.parent.clear()},$i.prototype.find=function(e,t){e==null&&this.type=="bookmark"&&(e=1);var n,r;for(var i=0;i<this.lines.length;++i){var s=this.lines[i],o=ts(s.markedSpans,this);if(o.from!=null){n=dt(t?s:lo(s),o.from);if(e==-1)return n}if(o.to!=null){r=dt(t?s:lo(s),o.to);if(e==1)return r}}return n&&{from:n,to:r}},$i.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;if(!e||!n)return;rr(n,function(){var r=e.line,i=lo(e.line),s=xn(n,i);s&&(On(s),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0;if(!xs(t.doc,r)&&t.height!=null){var o=t.height;t.height=null;var u=ks(t)-o;u&&fo(r,r.height+u)}})},$i.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||iu(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},$i.prototype.detachLine=function(e){this.lines.splice(iu(this.lines,e),1);if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var Vi=0,Ki=E.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};Xo(Ki),Ki.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();qo(this,"clear")},Ki.prototype.find=function(e,t){return this.primary.find(e,t)};var Ns=E.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=e,this.node=t};Xo(Ns),Ns.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,r=lo(n);if(r==null||!t)return;for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var s=ks(this);fo(n,Math.max(0,n.height-s)),e&&rr(e,function(){Cs(e,n,-s),lr(e,r,"widget")})},Ns.prototype.changed=function(){var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var r=ks(this)-e;if(!r)return;fo(n,n.height+r),t&&rr(t,function(){t.curOp.forceUpdate=!0,Cs(t,n,r)})};var As=E.Line=function(e,t,n){this.text=e,cs(this,t),this.height=n?n(this):1};Xo(As),As.prototype.lineNo=function(){return lo(this)};var qs={},Rs={};Ys.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;n<r;++n){var i=this.lines[n];this.height-=i.height,Ms(i),qo(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},Zs.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(e<i){var s=Math.min(t,i-e),o=r.height;r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null);if((t-=s)==0)break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Ys))){var u=[];this.collapse(u),this.children=[new Ys(u)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],s=i.chunkSize();if(e<=s){i.insertInner(e,t,n);if(i.lines&&i.lines.length>50){while(i.lines.length>50){var o=i.lines.splice(i.lines.length-25,25),u=new Ys(o);i.height-=u.height,this.children.splice(r+1,0,u),u.parent=this}this.maybeSpill()}break}e-=s}},maybeSpill:function(){if(this.children.length<=10)return;var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Zs(t);if(!e.parent){var r=new Zs(e.children);r.parent=e,e.children=[r,n],e=r}else{e.size-=n.size,e.height-=n.height;var i=iu(e.parent.children,e);e.parent.children.splice(i+1,0,n)}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],s=i.chunkSize();if(e<s){var o=Math.min(t,s-e);if(i.iterN(e,o,n))return!0;if((t-=o)==0)break;e=0}else e-=s}}};var eo=0,to=E.Doc=function(e,t,n,r){if(!(this instanceof to))return new to(e,t,n,r);n==null&&(n=0),Zs.call(this,[new Ys([new As("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var i=dt(n,0);this.sel=Ft(i),this.history=new vo(null),this.id=++eo,this.modeOption=t,this.lineSep=r,typeof e=="string"&&(e=this.splitLines(e)),Gs(this,{from:i,to:i,text:e}),Gt(this,Ft(i),Jo)};to.prototype=uu(Zs.prototype,{constructor:to,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){var n=0;for(var r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=ao(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:or(function(e){var t=dt(this.first,0),n=this.first+this.size-1;ai(this,{from:t,to:dt(n,oo(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Gt(this,Ft(t))}),replaceRange:function(e,t,n,r){t=qt(this,t),n=n?qt(this,n):t,di(this,e,t,n,r)},getRange:function(e,t,n){var r=uo(this,qt(this,e),qt(this,t));return n===!1?r:r.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(Ut(this,e))return oo(this,e)},getLineNumber:function(e){return lo(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=oo(this,e)),bs(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return qt(this,e)},getCursor:function(e){var t=this.sel.primary(),n;return e==null||e=="head"?n=t.head:e=="anchor"?n=t.anchor:e=="end"||e=="to"||e===!1?n=t.to():n=t.from(),n},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:or(function(e,t,n){Jt(this,qt(this,typeof e=="number"?dt(e,t||0):e),null,n)}),setSelection:or(function(e,t,n){Jt(this,qt(this,e),qt(this,t||e),n)}),extendSelection:or(function(e,t,n){Xt(this,qt(this,e),t&&qt(this,t),n)}),extendSelections:or(function(e,t){Vt(this,zt(this,e,t))}),extendSelectionsBy:or(function(e,t){Vt(this,su(this.sel.ranges,e),t)}),setSelections:or(function(e,t,n){if(!e.length)return;for(var r=0,i=[];r<e.length;r++)i[r]=new Bt(qt(this,e[r].anchor),qt(this,e[r].head));t==null&&(t=Math.min(e.length-1,this.sel.primIndex)),Gt(this,jt(i,t),n)}),addSelection:or(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new Bt(qt(this,e),qt(this,t||e))),Gt(this,jt(r,r.length-1),n)}),getSelection:function(e){var t=this.sel.ranges,n;for(var r=0;r<t.length;r++){var i=uo(this,t[r].from(),t[r].to());n=n?n.concat(i):i}return e===!1?n:n.join(e||this.lineSeparator())},getSelections:function(e){var t=[],n=this.sel.ranges;for(var r=0;r<n.length;r++){var i=uo(this,n[r].from(),n[r].to());e!==!1&&(i=i.join(e||this.lineSeparator())),t[r]=i}return t},replaceSelection:function(e,t,n){var r=[];for(var i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:or(function(e,t,n){var r=[],i=this.sel;for(var s=0;s<i.ranges.length;s++){var o=i.ranges[s];r[s]={from:o.from(),to:o.to(),text:this.splitLines(e[s]),origin:n}}var u=t&&t!="end"&&oi(this,r,t);for(var s=r.length-1;s>=0;s--)ai(this,r[s]);u?Qt(this,u):this.cm&&wi(this.cm)}),undo:or(function(){li(this,"undo")}),redo:or(function(){li(this,"redo")}),undoSelection:or(function(){li(this,"undo",!0)}),redoSelection:or(function(){li(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){var e=this.history,t=0,n=0;for(var r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new vo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Co(this.history.done),undone:Co(this.history.undone)}},setHistory:function(e){var t=this.history=new vo(this.history.maxGeneration);t.done=Co(e.done.slice(0),null,!0),t.undone=Co(e.undone.slice(0),null,!0)},addLineClass:or(function(e,t,n){return xi(this,e,t=="gutter"?"gutter":"class",function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass";if(!e[r])e[r]=n;else{if(Su(n).test(e[r]))return!1;e[r]+=" "+n}return!0})}),removeLineClass:or(function(e,t,n){return xi(this,e,t=="gutter"?"gutter":"class",function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass",i=e[r];if(!i)return!1;if(n==null)e[r]=null;else{var s=i.match(Su(n));if(!s)return!1;var o=s.index+s[0].length;e[r]=i.slice(0,s.index)+(!s.index||o==i.length?"":" ")+i.slice(o)||null}return!0})}),addLineWidget:or(function(e,t,n){return Ls(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return Ji(this,qt(this,e),qt(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=qt(this,e),Ji(this,e,e,n,"bookmark")},findMarksAt:function(e){e=qt(this,e);var t=[],n=oo(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(i.from==null||i.from<=e.ch)&&(i.to==null||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=qt(this,e),t=qt(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,function(s){var o=s.markedSpans;if(o)for(var u=0;u<o.length;u++){var a=o[u];!(i==e.line&&e.ch>a.to||a.from==null&&i!=e.line||i==t.line&&a.from>t.ch)&&(!n||n(a.marker))&&r.push(a.marker.parent||a.marker)}++i}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)n[r].from!=null&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;if(i>e)return t=e,!0;e-=i,++n}),qt(this,dt(n,t))},indexFromPos:function(e){e=qt(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new to(ao(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<n&&(n=e.to);var r=new to(ao(this,t,n),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Yi(r,Gi(this)),r},unlinkDoc:function(e){e instanceof E&&(e=e.doc);if(this.linked)for(var t=0;t<this.linked.length;++t){var n=this.linked[t];if(n.doc!=e)continue;this.linked.splice(t,1),e.unlinkDoc(this),Zi(Gi(this));break}if(e.history==this.history){var r=[e.id];io(e,function(e){r.push(e.id)},!0),e.history=new vo(null),e.history.done=Co(this.history.done,r),e.history.undone=Co(this.history.undone,r)}},iterLinkedDocs:function(e){io(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Hu(e)},lineSeparator:function(){return this.lineSep||"\n"}}),to.prototype.eachLine=to.prototype.iter;var no="iter insert remove copy getEditor constructor".split(" ");for(var ro in to.prototype)to.prototype.hasOwnProperty(ro)&&iu(no,ro)<0&&(E.prototype[ro]=function(e){return function(){return e.apply(this.doc,arguments)}}(to.prototype[ro]));Xo(to);var Oo=E.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Mo=E.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Do=E.e_stop=function(e){Oo(e),Mo(e)},Bo=E.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}},jo=E.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}},Fo=E.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2);for(var i=0;i<n.length;++i)n[i].apply(null,r)},Io=null,Vo=30,$o=E.Pass={toString:function(){return"CodeMirror.Pass"}},Jo={scroll:!1},Ko={origin:"*mouse"},Qo={origin:"+move"};Go.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Yo=E.countColumn=function(e,t,n,r,i){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var s=r||0,o=i||0;;){var u=e.indexOf("	",s);if(u<0||u>=t)return o+(t-s);o+=u-s,o+=n-o%n,s=u+1}},Zo=E.findColumn=function(e,t,n){for(var r=0,i=0;;){var s=e.indexOf("	",r);s==-1&&(s=e.length);var o=s-r;if(s==e.length||i+o>=t)return r+Math.min(o,t-i);i+=s-r,i+=n-i%n,r=s+1;if(i>=t)return r}},eu=[""],ru=function(e){e.select()};h?ru=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:r&&(ru=function(e){try{e.select()}catch(t){}});var lu=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,cu=E.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||lu.test(e))},du=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,gu;document.createRange?gu=function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:gu=function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(i){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r};var wu=E.contains=function(e,t){t.nodeType==3&&(t=t.parentNode);if(e.contains)return e.contains(t);do{t.nodeType==11&&(t=t.host);if(t==e)return!0}while(t=t.parentNode)};r&&i<11&&(Eu=function(){try{return document.activeElement}catch(e){return document.body}});var xu=E.rmClass=function(e,t){var n=e.className,r=Su(t).exec(n);if(r){var i=n.slice(r.index+r[0].length);e.className=n.slice(0,r.index)+(i?r[1]+i:"")}},Tu=E.addClass=function(e,t){var n=e.className;Su(t).test(n)||(e.className+=(n?" ":"")+t)},ku=!1,Ou=function(){if(r&&i<9)return!1;var e=mu("div");return"draggable"in e||"dragDrop"in e}(),Mu,Du,Hu=E.splitLines="\n\nb".split(/\n/).length!=3?function(e){var t=0,n=[],r=e.length;while(t<=r){var i=e.indexOf("\n",t);i==-1&&(i=e.length);var s=e.slice(t,e.charAt(i-1)=="\r"?i-1:i),o=s.indexOf("\r");o!=-1?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},Bu=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},ju=function(){var e=mu("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Fu=null,qu=E.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};(function(){for(var e=0;e<10;e++)qu[e+48]=qu[e+96]=String(e);for(var e=65;e<=90;e++)qu[e]=String.fromCharCode(e);for(var e=1;e<=12;e++)qu[e+111]=qu[e+63235]="F"+e})();var Qu,ta=function(){function n(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1773?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":n==8204?"b":"L"}function f(e,t,n){this.level=e,this.from=t,this.to=n}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/,a="L";return function(e){if(!r.test(e))return!1;var t=e.length,l=[];for(var c=0,h;c<t;++c)l.push(h=n(e.charCodeAt(c)));for(var c=0,p=a;c<t;++c){var h=l[c];h=="m"?l[c]=p:p=h}for(var c=0,d=a;c<t;++c){var h=l[c];h=="1"&&d=="r"?l[c]="n":s.test(h)&&(d=h,h=="r"&&(l[c]="R"))}for(var c=1,p=l[0];c<t-1;++c){var h=l[c];h=="+"&&p=="1"&&l[c+1]=="1"?l[c]="1":h==","&&p==l[c+1]&&(p=="1"||p=="n")&&(l[c]=p),p=h}for(var c=0;c<t;++c){var h=l[c];if(h==",")l[c]="N";else if(h=="%"){for(var v=c+1;v<t&&l[v]=="%";++v);var m=c&&l[c-1]=="!"||v<t&&l[v]=="1"?"1":"N";for(var g=c;g<v;++g)l[g]=m;c=v-1}}for(var c=0,d=a;c<t;++c){var h=l[c];d=="L"&&h=="1"?l[c]="L":s.test(h)&&(d=h)}for(var c=0;c<t;++c)if(i.test(l[c])){for(var v=c+1;v<t&&i.test(l[v]);++v);var y=(c?l[c-1]:a)=="L",b=(v<t?l[v]:a)=="L",m=y||b?"L":"R";for(var g=c;g<v;++g)l[g]=m;c=v-1}var w=[],E;for(var c=0;c<t;)if(o.test(l[c])){var S=c;for(++c;c<t&&o.test(l[c]);++c);w.push(new f(0,S,c))}else{var x=c,T=w.length;for(++c;c<t&&l[c]!="L";++c);for(var g=x;g<c;)if(u.test(l[g])){x<g&&w.splice(T,0,new f(1,x,g));var N=g;for(++g;g<c&&u.test(l[g]);++g);w.splice(T,0,new f(2,N,g)),x=g}else++g;x<c&&w.splice(T,0,new f(1,x,c))}return w[0].level==1&&(E=e.match(/^\s+/))&&(w[0].from=E[0].length,w.unshift(new f(0,0,E[0].length))),nu(w).level==1&&(E=e.match(/\s+$/))&&(nu(w).to-=E[0].length,w.push(new f(0,t-E[0].length,t))),w[0].level==2&&w.unshift(new f(1,w[0].to,w[0].to)),w[0].level!=nu(w).level&&w.push(new f(w[0].level,t,t)),w}}();return E.version="5.7.0",E}),define("model/entity",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{name:"",type:"",config:{}}},getVersionedAttr:function(e){var t=this.get(e),n=this.get("version");return n&&n!="0.0.0.SNAPSHOT"?t+":"+n:t},url:function(){var t=e.result(this,"urlRoot")||e.result(this.collection,"url")||urlError();return this.isNew()?t:t+(t.charAt(t.length-1)==="/"?"":"/")+encodeURIComponent(this.get("symbolicName"))+"/"+encodeURIComponent(this.get("version"))},getConfigByName:function(e){if(e)return this.get("config")[e]},addConfig:function(e,t){if(e){var n=this.get("config");return n[e]=t,this.set("config",n),this.trigger("change"),this.trigger("change:config"),!0}return!1},removeConfig:function(e){if(e){var t=this.get("config");return delete t[e],this.set("config",t),this.trigger("change"),this.trigger("change:config"),!0}return!1}}),n.Collection=t.Collection.extend({model:n.Model,url:"entity-collection"}),n}),define("model/catalog-application",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{id:"",type:"",name:"",version:"",description:"",planYaml:"",iconUrl:""}}}),n.Collection=t.Collection.extend({model:n.Model,url:"/v1/catalog/applications",getDistinctApplications:function(){return this.groupBy("type")},getTypes:function(t){return e.uniq(this.chain().map(function(e){return e.get("type")}).value())},hasType:function(e){return this.where({type:e}).length>0},getVersions:function(e){return this.chain().filter(function(t){return t.get("type")===e}).map(function(e){return e.get("version")}).value()},getId:function(e){return this.find(function(t){return t.get("id")===e})}}),n}),define("text!tpl/app-add-wizard/modal-wizard.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">x</button>\n    <h3 id="step_title">Title placeholder</h3>\n\n    <p id="step_instructions">Instructions placeholder</p>\n</div>\n\n<div class="modal-body"></div>\n\n<div class="modal-footer">\n    <button id="prev_step" type="button button-previous" class="btn btn-mini btn-info">Back</button>\n    <button id="preview_step" type="button button-preview" class="btn btn-mini btn-info"\n        title="Go to the Composer view where the YAML code for the blueprint can be edited. If an item is selected the Composer will be pre-populated with its YAML.">YAML Composer</button>\n    <button id="next_step" type="button button-next" class="btn btn-mini btn-info"\n        title="Customize the blueprint further using the wizard view. (Only available for Wizard items. Templates can only be opened in the Composer.)">Next</button>\n    <button id="finish_step" type="button button-finish" class="btn btn-mini btn-info"\n        title="Instantiate this blueprint in the configured location or locations.">Deploy</button>\n</div>\n'}),define("text!tpl/app-add-wizard/create.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="info-message label-message hide">\n	<!-- default content, should not be used -->\n    Failure performing specified action\n</div>\n<div class="error-message label-message hide">\n    <div class="label-important">ERROR</div>  <span class="error-message-text">Failure performing specified action</span>\n</div>\n\n<div id="app-add-wizard-create-body">\n\n    <ul class="nav nav-tabs" id="app-add-wizard-create-tab">\n       <li class="text-filter pull-right"><input type="text"/></li>\n    </ul>\n\n <div class="tab-content-scroller">\n <div class="tab-content">\n \n  <div class="tab-pane active" id="templateTab">\n    <div id="catalog-applications-throbber"><img src="/assets/images/throbber.gif"/></div>\n    <!-- TODO: transform the menu to list -->\n    <div id="catalog-applications-empty" class="hide">\n      The applications catalog is empty.\n      <br/><br/><br/><br/>\n      <button id="catalog-add" type="button" class="btn btn-mini btn-info">Add to Catalog</button>\n      &nbsp;&nbsp;&nbsp;&nbsp;\n      <button id="catalog-yaml" type="button" class="btn btn-mini btn-info">YAML Blueprint</button>\n    </div>\n    <div id="create-step-template-entries"/>\n  </div>\n      \n </div></div>\n</div>\n'}),define("text!tpl/app-add-wizard/create-step-template-entry.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="template-lozenge frame" id="<%- id %>" data-type="<%- type %>" data-name="<%- name %>" data-yaml="<%- planYaml %>">\n    <% if (iconUrl) { %>\n    <div class="icon">\n        <img src="<%- iconUrl %>" alt="(icon)" />\n    </div>\n    <% } %>\n    <div class="blurb">\n        <div class="title"><%- name %></div>\n        <div class="description">\n            <%- description ? description : "" %>\n        </div>\n    </div>\n</div>\n'}),define("text!tpl/app-add-wizard/required-config-entry.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<tr class="controls app-add-wizard-config-entry">\n    <td><% if (data.label) { %><%= data.label %><% } else { %><%= data.name %><% } %>\n    <input id="key" type="text" class="input-medium" name="key" value="<%= data.name %>" style="display: none;">\n    &nbsp;&nbsp;&nbsp;\n    </td>\n    <td> \n    <% if (data.type==="java.lang.Boolean" || data.type==="boolean") { %>\n      <input id="checkboxValue" type="checkbox" class="input-medium" name="checkboxValue<%\n        if (data.defaultValue===true) { %>" checked="true<% } \n        %>">\n    <% } else if (data.type==="java.lang.Enum") { %>\n      <select id="value" class="input-medium" name="value" style="width: 250px">\n        <% var length = data.possibleValues.length,\n            element = null;\n        for (var i = 0; i < length; i++) {\n          element = data.possibleValues[i]; %>\n        <option value="<%= element.value %>"<% if (data.defaultValue == element.value) { %> selected="selected"<% } %>><%= element.description %></option>\n        <% } %>\n      </select>\n    <% } else { %>\n     <input id="value" type="text" class="input-medium" name="value" value="<% \n        if (typeof data.defaultValue !== "undefined") { %><%- data.defaultValue %><% } \n        %>" style="width: 250px">\n    <% } %>\n    </td>\n    <td></td>\n</tr>\n'}),define("text!tpl/app-add-wizard/edit-config-entry.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<tr class="controls app-add-wizard-config-entry">\n    <td><input id="key" type="text" class="input-medium" name="key" placeholder="key"></td> \n    <td><input id="value" type="text" class="input-medium" name="value" placeholder="value" style="width: 250px"></td>\n    \n    <td><button id="remove-config" class="btn btn-info btn-mini" type="button">\n        <i class="icon-minus-sign"></i>\n    </button></td>\n</tr>\n'}),define("text!tpl/app-add-wizard/deploy.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- New application wizard step 1: set name and locations -->\n<div class="deploy">\n\n    <div class="info-message label-message hide">\n        <!-- placeholder, details filled in later -->\n        <span class="label-important">Important</span> More information required \n    </div>\n    <div class="error-message label-message hide">\n        <!-- placeholder, details usually filled in later -->\n        <div class="label-important">ERROR</div>  <span class="error-message-text">Failure performing specified action</span>\n    </div>\n\n    <div id="app-versions" class="control-group">\n        <div class="deploy-label">Version</div>\n        <select class="select-version" style="margin:4px 0 4px 0; width:80%"></select>\n    </div>\n\n    <div id="app-locations" class="control-group">\n        <div class="deploy-label">Locations</div>\n        <div id="selector-container-location"></div>\n        <button id="add-selector-container" class="btn btn-info btn-mini">\n            Add Additional Location</button>\n    </div>\n\n    <div class="control-group">\n        <div class="application-name-label deploy-label">Name (optional)</div>\n        <div class="controls">\n            <input id="application-name" name="name" type="text"\n                style="width: 80%">\n        </div>\n    </div>\n\n    <div class="control-group">\n        <div class="app-add-wizard-create-entity-label-newline deploy-label">Configuration</div>\n        <div class="required-config-loading"><i>Loading...</i></div>\n        <table class="config-table controls" cellspacing="5">\n        </table>\n        <div>\n            <button id="add-config" class="btn btn-mini btn-info">\n             Add Configuration</button>\n        </div>\n    </div>\n\n</div>\n'}),define("text!tpl/app-add-wizard/deploy-version-option.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<option value="<%- version %>">\n    <span class="provider"><%- version %></span>\n</option>'}),define("text!tpl/app-add-wizard/deploy-location-row.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div id="location-row-<%= rowId %>" rowId="<%= rowId %>" initialValue="<%= initialValue %>" class="location-selector-row">\n    <select class="select-location" style="margin:4px 0 4px 0; width:80%"></select>\n    <% if (rowId > 0) { %>\n        <button id="remove-app-location" class="btn btn-info btn-mini" type="button"><i class="icon-minus-sign"></i></button>\n    <% } %>    \n</div>\n'}),define("text!tpl/app-add-wizard/deploy-location-option.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<option value="<%= typeof id !== \'undefined\' ? id : url /* both add app wizard and effector (eg addRegion) should now use id, but url left just in case */ %>">\n    <span class="provider"><%= name %></span>\n</option>'}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("codemirror")):typeof define=="function"&&define.amd?define("codemirror-mode-yaml",["codemirror"],e):e(CodeMirror)}(function(e){e.defineMode("yaml",function(){var e=["true","false","on","off","yes","no"],t=new RegExp("\\b(("+e.join(")|(")+"))$","i");return{token:function(e,n){var r=e.peek(),i=n.escaped;n.escaped=!1;if(r!="#"||e.pos!=0&&!/\s/.test(e.string.charAt(e.pos-1))){if(e.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(n.literal&&e.indentation()>n.keyCol)return e.skipToEnd(),"string";n.literal&&(n.literal=!1);if(e.sol()){n.keyCol=0,n.pair=!1,n.pairStart=!1;if(e.match(/---/))return"def";if(e.match(/\.\.\./))return"def";if(e.match(/\s*-\s+/))return"meta"}if(e.match(/^(\{|\}|\[|\])/))return r=="{"?n.inlinePairs++:r=="}"?n.inlinePairs--:r=="["?n.inlineList++:n.inlineList--,"meta";if(n.inlineList>0&&!i&&r==",")return e.next(),"meta";if(n.inlinePairs>0&&!i&&r==",")return n.keyCol=0,n.pair=!1,n.pairStart=!1,e.next(),"meta";if(n.pairStart){if(e.match(/^\s*(\||\>)\s*/))return n.literal=!0,"meta";if(e.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable-2";if(n.inlinePairs==0&&e.match(/^\s*-?[0-9\.\,]+\s?$/))return"number";if(n.inlinePairs>0&&e.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(e.match(t))return"keyword"}return!n.pair&&e.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(n.pair=!0,n.keyCol=e.indentation(),"atom"):n.pair&&e.match(/^:\s*/)?(n.pairStart=!0,"meta"):(n.pairStart=!1,n.escaped=r=="\\",e.next(),null)}return e.skipToEnd(),"comment"},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}}}}),e.defineMIME("text/x-yaml","yaml")}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("codemirror")):typeof define=="function"&&define.amd?define("codemirror-addon-show-hint",["codemirror"],e):e(CodeMirror)}(function(e){function r(e,t){this.cm=e,this.options=this.buildOptions(t),this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor(),this.startLen=this.cm.getLine(this.startPos.line).length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function o(e){return typeof e=="string"?e:e.text}function u(e,t){function s(e,r){var s;typeof r!="string"?s=function(e){return r(e,t)}:n.hasOwnProperty(r)?s=n[r]:s=r,i[e]=s}var n={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},r=e.options.customKeys,i=r?{}:n;if(r)for(var o in r)r.hasOwnProperty(o)&&s(o,r[o]);var u=e.options.extraKeys;if(u)for(var o in u)u.hasOwnProperty(o)&&s(o,u[o]);return i}function a(e,t){while(t&&t!=e){if(t.nodeName.toUpperCase()==="LI"&&t.parentNode==e)return t;t=t.parentNode}}function f(r,i){this.completion=r,this.data=i,this.picked=!1;var s=this,f=r.cm,l=this.hints=document.createElement("ul");l.className="CodeMirror-hints",this.selectedHint=i.selectedHint||0;var c=i.list;for(var h=0;h<c.length;++h){var p=l.appendChild(document.createElement("li")),d=c[h],v=t+(h!=this.selectedHint?"":" "+n);d.className!=null&&(v=d.className+" "+v),p.className=v,d.render?d.render(p,i,d):p.appendChild(document.createTextNode(d.displayText||o(d))),p.hintId=h}var m=f.cursorCoords(r.options.alignWithWord?i.from:null),g=m.left,y=m.bottom,b=!0;l.style.left=g+"px",l.style.top=y+"px";var w=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),E=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(r.options.container||document.body).appendChild(l);var S=l.getBoundingClientRect(),x=S.bottom-E;if(x>0){var T=S.bottom-S.top,N=m.top-(m.bottom-S.top);if(N-T>0)l.style.top=(y=m.top-T)+"px",b=!1;else if(T>E){l.style.height=E-5+"px",l.style.top=(y=m.bottom-S.top)+"px";var C=f.getCursor();i.from.ch!=C.ch&&(m=f.cursorCoords(C),l.style.left=(g=m.left)+"px",S=l.getBoundingClientRect())}}var k=S.right-w;k>0&&(S.right-S.left>w&&(l.style.width=w-5+"px",k-=S.right-S.left-w),l.style.left=(g=m.left-k)+"px"),f.addKeyMap(this.keyMap=u(r,{moveFocus:function(e,t){s.changeActive(s.selectedHint+e,t)},setFocus:function(e){s.changeActive(e)},menuSize:function(){return s.screenAmount()},length:c.length,close:function(){r.close()},pick:function(){s.pick()},data:i}));if(r.options.closeOnUnfocus){var L;f.on("blur",this.onBlur=function(){L=setTimeout(function(){r.close()},100)}),f.on("focus",this.onFocus=function(){clearTimeout(L)})}var A=f.getScrollInfo();return f.on("scroll",this.onScroll=function(){var e=f.getScrollInfo(),t=f.getWrapperElement().getBoundingClientRect(),n=y+A.top-e.top,i=n-(window.pageYOffset||(document.documentElement||document.body).scrollTop);b||(i+=l.offsetHeight);if(i<=t.top||i>=t.bottom)return r.close();l.style.top=n+"px",l.style.left=g+A.left-e.left+"px"}),e.on(l,"dblclick",function(e){var t=a(l,e.target||e.srcElement);t&&t.hintId!=null&&(s.changeActive(t.hintId),s.pick())}),e.on(l,"click",function(e){var t=a(l,e.target||e.srcElement);t&&t.hintId!=null&&(s.changeActive(t.hintId),r.options.completeOnSingleClick&&s.pick())}),e.on(l,"mousedown",function(){setTimeout(function(){f.focus()},20)}),e.signal(i,"select",c[0],l.firstChild),!0}var t="CodeMirror-hint",n="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var r={hint:t};if(n)for(var i in n)r[i]=n[i];return e.showHint(r)},e.defineExtension("showHint",function(t){if(this.listSelections().length>1||this.somethingSelected())return;this.state.completionActive&&this.state.completionActive.close();var n=this.state.completionActive=new r(this,t);if(!n.options.hint)return;e.signal(this,"startCompletion",this),n.update(!0)});var i=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},s=window.cancelAnimationFrame||clearTimeout;r.prototype={close:function(){if(!this.active())return;this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm)},active:function(){return this.cm.state.completionActive==this},pick:function(t,n){var r=t.list[n];r.hint?r.hint(this.cm,t,r):this.cm.replaceRange(o(r),r.from||t.from,r.to||t.to,"complete"),e.signal(t,"pick",r),this.close()},cursorActivity:function(){this.debounce&&(s(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=i(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(this.tick==null)return;if(!this.options.hint.async)this.finishUpdate(this.options.hint(this.cm,this.options),e);else{var t=++this.tick,n=this;this.options.hint(this.cm,function(r){n.tick==t&&n.finishUpdate(r,e)},this.options)}},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update"),t&&this.data&&e.cmpPos(t.from,this.data.from)&&(t=null),this.data=t;var r=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),t&&t.list.length&&(r&&t.list.length==1?this.pick(t,0):(this.widget=new f(this,t),e.signal(t,"shown")))},buildOptions:function(e){var t=this.cm.options.hintOptions,n={};for(var r in l)n[r]=l[r];if(t)for(var r in t)t[r]!==undefined&&(n[r]=t[r]);if(e)for(var r in e)e[r]!==undefined&&(n[r]=e[r]);return n}},f.prototype={close:function(){if(this.completion.widget!=this)return;this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,r){t>=this.data.list.length?t=r?this.data.list.length-1:0:t<0&&(t=r?0:this.data.list.length-1);if(this.selectedHint==t)return;var i=this.hints.childNodes[this.selectedHint];i.className=i.className.replace(" "+n,""),i=this.hints.childNodes[this.selectedHint=t],i.className+=" "+n,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],i)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",function(t,n){var r=t.getHelpers(t.getCursor(),"hint"),i;if(r.length)for(var s=0;s<r.length;s++){var o=r[s](t,n);if(o&&o.list.length)return o}else if(i=t.getHelper(t.getCursor(),"hintWords")){if(i)return e.hint.fromList(t,{words:i})}else if(e.hint.anyword)return e.hint.anyword(t,n)}),e.registerHelper("hint","fromList",function(t,n){var r=t.getCursor(),i=t.getTokenAt(r),s=e.Pos(r.line,i.end);if(i.string&&/\w/.test(i.string[i.string.length-1]))var o=i.string,u=e.Pos(r.line,i.start);else var o="",u=s;var a=[];for(var f=0;f<n.words.length;f++){var l=n.words[f];l.slice(0,o.length)==o&&a.push(l)}if(a.length)return{list:a,from:u,to:s}}),e.commands.autocomplete=e.showHint;var l={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!1,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("codemirror")):typeof define=="function"&&define.amd?define("codemirror-addon-anyword-hint",["codemirror"],e):e(CodeMirror)}(function(e){var t=/[\w$]+/,n=500;e.registerHelper("hint","anyword",function(r,i){var s=i&&i.word||t,o=i&&i.range||n,u=r.getCursor(),a=r.getLine(u.line),f=u.ch,l=f;while(l&&s.test(a.charAt(l-1)))--l;var c=l!=f&&a.slice(l,f),h=i&&i.list||[],p={},d=new RegExp(s.source,"g");for(var v=-1;v<=1;v+=2){var m=u.line,g=Math.min(Math.max(m+v*o,r.firstLine()),r.lastLine())+v;for(;m!=g;m+=v){var y=r.getLine(m),b;while(b=d.exec(y)){if(m==u.line&&b[0]===c)continue;(!c||b[0].lastIndexOf(c,0)==0)&&!Object.prototype.hasOwnProperty.call(p,b[0])&&(p[b[0]]=!0,h.push(b[0]))}}}return{list:h,from:e.Pos(u.line,l),to:e.Pos(u.line,f)}})}),function(e){typeof exports=="object"&&typeof module=="object"?e(require("codemirror")):typeof define=="function"&&define.amd?define("codemirror-addon-display-placeholder",["codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.className="CodeMirror-placeholder";var r=e.getOption("placeholder");typeof r=="string"&&(r=document.createTextNode(r)),n.appendChild(r),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function r(e){s(e)&&n(e)}function i(e){var r=e.getWrapperElement(),i=s(e);r.className=r.className.replace(" CodeMirror-empty","")+(i?" CodeMirror-empty":""),i?n(e):t(e)}function s(e){return e.lineCount()===1&&e.getLine(0)===""}e.defineOption("placeholder","",function(n,s,o){var u=o&&o!=e.Init;if(s&&!u)n.on("blur",r),n.on("change",i),i(n);else if(!s&&u){n.off("blur",r),n.off("change",i),t(n);var a=n.getWrapperElement();a.className=a.className.replace(" CodeMirror-empty","")}s&&!n.hasFocus()&&r(n)})}),!function(e){e(function(){e.support.transition=function(){function e(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}}()})}(window.jQuery),!function(e){var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(e){return e||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f=e.Event("slide");this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n);i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):typeof n=="string"||(n=s.slide)?i[n]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();e(i).collapse(s)})})}(window.jQuery),!function(e){function r(){e(t).parent().removeClass("open")}var t='[data-toggle="dropdown"]',n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),i,s,o;if(n.is(".disabled, :disabled"))return;return s=n.attr("data-target"),s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),i=e(s),i.length||(i=n.parent()),o=i.hasClass("open"),r(),o||i.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(function(){e("html").on("click.dropdown.data-api",r),e("body").on("click.dropdown",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle)})}(window.jQuery),!function(e){function n(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),r.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),r.call(t)})}function r(e){this.$element.hide().trigger("hidden"),i.call(this)}function i(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(s,this)):s.call(this)):t&&t()}function s(){this.$backdrop.remove(),this.$backdrop=null}function o(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,o.call(this),i.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(t){t&&t.preventDefault();var i=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),o.call(this),this.$element.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?n.call(this):r.call(this)}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({},i.data(),n.data());t.preventDefault(),i.modal(s)})})}(window.jQuery),!function(e){var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},isHTML:function(e){return typeof e!="string"||e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.isHTML(t)?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var t=this,n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(e){var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.isHTML(t)?"html":"text"](t),e.find(".popover-content > *")[this.isHTML(n)?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&n.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu")&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n=this,r,i;return this.query=this.$element.val(),this.query?(r=e.grep(this.source,function(e){return n.matcher(e)}),r=this.sorter(r),r.length?this.render(r.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keypress,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.type!="keydown")break;e.preventDefault(),this.prev();break;case 40:if(e.type!="keydown")break;e.preventDefault(),this.next()}e.stopPropagation()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery),define("bootstrap",["jquery"],function(){}),define("view/application-add-wizard",["underscore","jquery","backbone","brooklyn-utils","js-yaml","codemirror","model/entity","model/application","model/location","model/catalog-application","text!tpl/app-add-wizard/modal-wizard.html","text!tpl/app-add-wizard/create.html","text!tpl/app-add-wizard/create-step-template-entry.html","text!tpl/app-add-wizard/required-config-entry.html","text!tpl/app-add-wizard/edit-config-entry.html","text!tpl/app-add-wizard/deploy.html","text!tpl/app-add-wizard/deploy-version-option.html","text!tpl/app-add-wizard/deploy-location-row.html","text!tpl/app-add-wizard/deploy-location-option.html","codemirror-mode-yaml","codemirror-addon-show-hint","codemirror-addon-anyword-hint","codemirror-addon-display-placeholder","bootstrap"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){function w(e,t){t?e.show():e.hide()}function E(e,t){e.attr("disabled",!t)}function S(e){var t;if(e.type)t=[x({type:e.type,version:e.version,config:e.config})];else if(e.entities){t=[];var n=e.entities;for(var r=0;r<n.length;r++)t.push(x(n[r]))}var i={};return e.name&&(i.name=e.name),e.locations&&(e.locations.length>1?i.locations=e.locations:i.location=e.locations[0]),t&&(i.services=t),i}function x(t){var n={};return t.name&&(!options||!options.exclude_name)&&(n.name=t.name),t.type&&(n.type=t.type),t.type&&t.version&&(n.type+=":"+t.version),t.config&&e.size(t.config)&&(n["brooklyn.config"]=t.config),n}function T(e){try{return t.parseJSON(e)}catch(n){return e}}function N(e){k("/v1/editor/app/"+(typeof e=="string"?e:""))}function C(e){k("/v1/editor/app/_/"+encodeURIComponent(e))}function k(e){var r=t(".add-app #modal-container .modal");r.modal("hide"),r.fadeTo(500,1),n.history.navigate(e,{trigger:!0})}var b="__NONE__",L=n.View.extend({tagName:"div",className:"modal hide fade",events:{"click #prev_step":"prevStep","click #next_step":"nextStep","click #preview_step":"previewStep","click #finish_step":"finishStep"},template:e.template(l),initialize:function(){this.catalog={},this.catalog.applications={},this.model={},this.model.spec=new u.Spec,this.model.yaml="",this.currentStep=0,this.steps=[{step_id:"what-app",title:"Create Application",instructions:"Choose or build the application to deploy",view:new L.StepCreate({model:this.model,wizard:this,catalog:this.catalog})},{step_id:"name-and-locations",title:"<%= appName %>",instructions:"Specify the locations to deploy to and any additional configuration",view:new L.StepDeploy({model:this.model,catalog:this.catalog})}]},beforeClose:function(){e.each(this.steps,function(e){e.view.close()},this)},render:function(){return this.$el.html(this.template({})),this.renderCurrentStep(),this},renderCurrentStep:function(t){var n=this.model.name||"";this.title=this.$("h3#step_title"),this.instructions=this.$("p#step_instructions");var r=this.steps[this.currentStep];this.title.html(e.template(r.title)({appName:n})),this.instructions.html(r.instructions),this.currentView=r.view,this.currentView.render(),this.currentView.updateForState(),this.$(".modal-body").replaceWith(this.currentView.el),t&&t(this.currentView),this.updateButtonVisibility()},updateButtonVisibility:function(){var e=this.steps[this.currentStep];w(this.$("#prev_step"),this.currentStep>0);var t=!1,n=this.currentView&&this.currentView.selectedTemplate&&this.currentView.selectedTemplate.yaml;if(n)try{n=i.safeLoad(n),hasLocation=n.location||n.locations;if(!hasLocation){svcs=n.services;if(svcs)for(svcI in svcs)if(svcs[svcI].location||svcs[svcI].locations){hasLocation=!0;break}}t=hasLocation?!0:!1}catch(r){log("Warning: could not parse yaml template of selected item"),log(n)}w(this.$("#preview_step"),!0),E(this.$("#preview_step"),!0);var s=this.currentStep<1&&!this.isTemplate;w(this.$("#next_step"),s);var o=!0;this.currentStep==0&&e&&e.view&&(!e.view.selectedTemplate||t)&&(o=!1),s&&E(this.$("#next_step"),o);var u=this.currentStep>=1,a=u;w(this.$("#finish_step"),u),E(this.$("#finish_step"),a)},submitApplication:function(e){var n=this,r=t(".add-app #modal-container .modal");r.fadeTo(500,.5);var s;return this.model.spec.pruneLocations(),s=i.safeDump(S(this.model.spec.toJSON())),t.ajax({url:"/v1/applications",type:"post",contentType:"application/yaml",processData:!1,data:s,success:function(e){n.onSubmissionComplete(!0,e,r)},error:function(e){n.onSubmissionComplete(!1,e,r)}}),!1},onSubmissionComplete:function(e,t,n){var r=this;if(e)n.modal("hide"),n.fadeTo(500,1),r.options.callback&&r.options.callback();else{log("ERROR submitting application: "+t.responseText);var i,s="Server responded with an error";try{t.responseText&&(i=JSON.parse(t.responseText),i&&(s=i.message))}catch(o){s=t.responseText}r.$el.fadeTo(100,1).delay(200).fadeTo(200,.2).delay(200).fadeTo(200,1),r.steps[r.currentStep].view.showFailure(s)}},prevStep:function(){this.currentStep-=1,this.renderCurrentStep()},nextStep:function(){if(this.currentStep!=0)throw"Unexpected step: "+this.currentStep;this.currentView.validate()&&(this.currentStep+=1,this.renderCurrentStep())},previewStep:function(){if(this.currentStep==0)this.currentView.selectedTemplate&&this.currentView.selectedTemplate.id?N(this.currentView.selectedTemplate.id):N();else{this.model.spec.pruneLocations();var e=i.safeDump(S(this.model.spec.toJSON()));C(e)}},finishStep:function(){this.currentView.validate()&&this.submitApplication()}});return L.StepCreate=n.View.extend({className:"modal-body",events:{"click #remove-config":"removeConfigRow","click #add-config":"addConfigRow","click .template-lozenge":"templateClick","keyup .text-filter input":"applyFilter","change .text-filter input":"applyFilter","paste .text-filter input":"applyFilter",'shown a[data-toggle="tab"]':"onTabChange","click #templateTab #catalog-add":"switchToCatalogAdd","click #templateTab #catalog-yaml":"redirectToEditorTab"},template:e.template(c),wizard:null,initialize:function(){var n=this;n.catalogEntityIds=[],this.$el.html(this.template({})),t.get("/v1/catalog/entities",{},function(t){n.catalogEntityItems=t,n.catalogEntityIds=e.map(t,function(e){return e.id})}),this.options.catalog.applications=new f.Collection,this.options.catalog.applications.fetch({data:t.param({allVersions:!0}),success:function(e,r,i){t("#catalog-applications-throbber").hide(),t("#catalog-applications-empty").hide(),e.size()>0?n.addTemplateLozenges():t("#catalog-applications-empty").show()}})},renderConfiguredEntities:function(){var t=this.$("#entitiesAccordionish").empty(),n=this;this.model.spec.get("entities")&&this.model.spec.get("entities").length>0&&e.each(this.model.spec.get("entities"),function(e){n.addEntityHtml(t,e)})},updateForState:function(){},render:function(){return this.renderConfiguredEntities(),this.delegateEvents(),this},onTabChange:function(e){var n=t(e.target).text();n=="Catalog"?t("li.text-filter").show():t("li.text-filter").hide(),this.options.wizard&&this.options.wizard.updateButtonVisibility()},switchToCatalogAdd:function(){var e=t(".add-app #modal-container .modal");e.modal("hide"),window.location.href="#v1/catalog/new"},redirectToEditorTab:function(){N()},applyFilter:function(n){var r=t(n.currentTarget).val().toLowerCase();r?e.each(t(".template-lozenge"),function(e){var n=t(e).text().toLowerCase().indexOf(r)>=0;n?t(e).show():t(e).hide()}):t(".template-lozenge").show()},addTemplateLozenges:function(t){var n=this;e.each(this.options.catalog.applications.getDistinctApplications(),function(e){n.addTemplateLozenge(n,e[0])})},addTemplateLozenge:function(n,r){var i=e.template(h,{id:r.get("id"),type:r.get("type"),name:r.get("name")||r.get("id"),description:r.get("description"),planYaml:r.get("planYaml"),iconUrl:r.get("iconUrl")});t("#create-step-template-entries",n.$el).append(i)},templateClick:function(e){var n=t(e.target).closest(".template-lozenge"),r=n.hasClass("selected");t(".template-lozenge").removeClass("selected"),r?this.selectedTemplate=null:(n.addClass("selected"),this.selectedTemplate={id:n.attr("id"),type:n.data("type"),name:n.data("name"),yaml:n.data("yaml")}),this.options.wizard&&this.options.wizard.updateButtonVisibility()},getConfigMap:function(e){var n={};return t(".app-add-wizard-config-entry",e).each(function(e,r){var i=T(t("#value",r).val());i!==null&&(n[t("#key",r).val()]=i)}),n},saveTemplate:function(){if(!this.selectedTemplate)return!1;var e=this.selectedTemplate.type;return this.options.catalog.applications.hasType(e)?(this.model.spec.set("type",e),this.model.name=this.selectedTemplate.name,this.model.catalogEntityData="LOAD",!0):(t(".entity-info-message").show("slow").delay(2e3).hide("slow"),!1)},saveAppClass:function(){var e=this,n=t.find("#appClassTab"),r=t(n).find("#app-java-type").val();return this.options.catalog.applications.hasType(r)?(this.model.spec.set("type",r),!0):(t(".entity-info-message").show("slow").delay(2e3).hide("slow"),!1)},addEntityHtml:function(t,n){var r=e.template(CreateEntityEntryHtml,{}),i=this;t.append(r),t.children().last().find(".entity-type-input").typeahead({source:i.catalogEntityIds})},addConfigRow:function(n){var r=e.template(d,{});t(n.currentTarget).parent().prev().append(r)},removeConfigRow:function(e){t(e.currentTarget).parent().remove()},validate:function(){var e=this;return delete this.model.spec.attributes.id,this.saveTemplate()?(this.model.spec.set("entities",[]),!0):(this.showFailure("Invalid application type/spec"),!1)},showFailure:function(t){t||(t="Failure performing the specified action"),this.$("div.error-message .error-message-text").html(e.escape(t)),this.$("div.error-message").slideDown(250).delay(1e4).slideUp(500)}}),L.StepDeploy=n.View.extend({className:"modal-body",events:{"click #add-selector-container":"addLocation","click #remove-app-location":"removeLocation","change .select-version":"selectionVersion","change .select-location":"selectionLocation","blur #application-name":"updateName","click #remove-config":"removeConfigRow","click #add-config":"addConfigRow"},template:e.template(v),versionOptionTemplate:e.template(m),locationRowTemplate:e.template(g),locationOptionTemplate:e.template(y),initialize:function(){this.model.spec.on("change",this.render,this),this.$el.html(this.template()),this.locations=new a.Collection},beforeClose:function(){this.model.spec.off("change",this.render)},renderName:function(){this.$("#application-name").val(this.model.spec.get("name"))},renderVersions:function(){var e=this.versionOptionTemplate;select=this.$(".select-version"),container=this.$("#app-versions"),defaultVersion="0.0.0.SNAPSHOT",select.empty();var t=this.options.catalog.applications.getVersions(this.model.spec.get("type"));for(var n=0;n<t.length;n++){var r=t[n];select.append(e({version:r}))}t.length===1&&t[0]===defaultVersion?(this.model.spec.set("version",""),container.hide()):(this.model.spec.set("version",t[0]),container.show())},renderAddedLocations:function(){var e=this.locationRowTemplate,n=this.locationOptionTemplate,r=this.$("#selector-container-location");r.empty();for(var i=0;i<this.model.spec.get("locations").length;i++){var s=this.model.spec.get("locations")[i];r.append(e({initialValue:s,rowId:i}))}var o=r.find(".select-location"),u=this.locations.map(function(e){return n({id:e.getIdentifierName()||e.id||"",name:e.getPrettyName()})});o.append(u.join("")),o.each(function(e){var r=t(o[e]);r.val(r.parent().attr("initialValue")),r.find("option").length>0&&r.append("<option disabled>------</option>"),r.append(n({id:b,name:"None"}))})},render:function(){return this.delegateEvents(),this},updateForState:function(){var e=this;this.$("div.error-message").hide(),this.renderName(),this.renderVersions(),this.locations.fetch({success:function(){e.model.spec.get("locations").length==0?e.addLocation():e.renderAddedLocations()}}),this.model.catalogEntityData==null?this.renderStaticConfig(null):this.model.catalogEntityData=="LOAD"?(this.renderStaticConfig("LOADING"),t.get("/v1/catalog/entities/"+this.model.spec.get("type"),{},function(t){e.model.catalogEntityData=t,e.renderStaticConfig(e.model.catalogEntityData)})):this.renderStaticConfig(this.model.catalogEntityData)},addLocation:function(){this.locations.models.length>0?this.model.spec.addLocation(this.locations.models[0].getIdentifierName()):this.model.spec.addLocation(undefined),this.renderAddedLocations()},removeLocation:function(e){var n=t(e.currentTarget).parent().attr("rowId");this.model.spec.removeLocationIndex(n),this.renderAddedLocations()},addConfigRow:function(n){var r=e.template(d,{});t(n.currentTarget).parent().prev().append(r)},removeConfigRow:function(e){t(e.currentTarget).parent().parent().remove()},renderStaticConfig:function(t){this.$(".config-table").html("");if(t=="LOADING")this.$(".required-config-loading").show();else{var n=[];this.$(".required-config-loading").hide();if(t!=null&&t.config!=null){var r=this;e.each(t.config,function(t){if(t.priority!==undefined){var n=e.template(p,{data:t});r.$(".config-table").append(n)}})}}},getConfigMap:function(){var e={};return t(".app-add-wizard-config-entry").each(function(n,r){var i=t("#checkboxValue",r).length?t("#checkboxValue",r).is(":checked"):T(t("#value",r).val());i!==null&&(e[t("#key",r).val()]=i)}),e},selectionVersion:function(e){this.model.spec.set("version",t(e.currentTarget).val())},selectionLocation:function(e){var n=t(e.currentTarget).val(),r=n===b,i=r||this.locations.find(function(e){return e.getIdentifierName()==n});if(!i)log("invalid location "+n),this.showFailure("Invalid location "+n),this.model.spec.set("locations",[]);else{var s=t(e.currentTarget).parent().attr("rowId");this.model.spec.setLocationAtIndex(s,r?undefined:n)}},updateName:function(){var e=this.$("#application-name").val();e?this.model.spec.set("name",e):this.model.spec.set("name","")},validate:function(){return this.model.spec.set("config",this.getConfigMap()),this.model.spec.get("locations").length!==0?!0:(this.showFailure("A location is required"),!1)},showFailure:function(t){t||(t="Failure performing the specified action"),log("showing error: "+t),this.$("div.error-message .error-message-text").html(e.escape(t)),this.$("div.error-message").slideDown(250).delay(1e4).slideUp(500)}}),L}),define("text!tpl/location-wizard/modal.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">x</button>\n    <h3 class="location-wizard-title">Title placeholder</h3>\n    <p class="location-wizard-subtitle">Instructions placeholder</p>\n</div>\n\n<div class="error-message label-message hide">\n    <div class="label-important">ERROR</div>  <span class="error-message-text">Failure performing specified action</span>\n</div>\n\n<div class="modal-body"></div>\n\n<div class="modal-footer">\n    <button type="button button-previous" class="btn btn-mini btn-info location-wizard-previous">Back</button>\n    <button type="button button-next" class="btn btn-mini btn-info location-wizard-next location-wizard-action">Next</button>\n    <span class="location-wizard-actions"></span>\n</div>\n'}),define("text!tpl/location-wizard/location-type.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="tab-content">\n    <div class="location-type-container">\n        <div class="location-type" data-type="cloud" data-help="Provide details of a public or private cloud that Brooklyn should present as a target location for deployment">\n            <div>\n                <i class="fa fa-cloud"></i>\n                <p class="location-type-title">Cloud</p>\n            </div>\n        </div>\n        <div class="location-type" data-type="byon" data-help="Bring Your Own Nodes: define a set of machines by their IP addresses. This may be anything from physical servers in production to vagrant boxes in dev/test.">\n            <div>\n                <i class="fa fa-file-o"></i>\n                <p class="location-type-title">BYON</p>\n            </div>\n        </div>\n        <div class="location-type" data-type="advanced" data-help="Create a location by extending one you have defined or by referencing a known pre-defined Brooklyn location type">\n            <div>\n                <i class="fa fa-bolt"></i>\n                <p class="location-type-title">Advanced</p>\n            </div>\n        </div>\n    </div>\n    <p class="help-text muted"></p>\n</div>\n'}),define("text!tpl/location-wizard/location-configuration.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="tab-content"></div>\n'}),define("text!tpl/location-wizard/location-provisioning.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="tab-content">\n    <div class="entries-group"></div>\n    <button class="btn btn-mini btn-info add-entry">Add Configuration</button>\n</div>\n'}),define("text!tpl/location-wizard/location-provisioning-entry.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="control-group">\n    <input class="entry-key input-medium" type="text" placeholder="Key" />\n    <input class="entry-value input-medium" type="text" placeholder="Value" />\n    <button class="btn btn-info btn-mini remove-entry" type="button">\n        <i class="icon-minus-sign"></i>\n    </button>\n</div>'});var EasyAutocomplete=function(e){return e.Configuration=function(t){function r(){t.dataType==="xml"&&(t.getValue||(t.getValue=function(e){return $(e).text()}),t.list||(t.list={}),t.list.sort||(t.list.sort={}),t.list.sort.method=function(e,n){return e=t.getValue(e),n=t.getValue(n),e<n?-1:e>n?1:0},t.list.match||(t.list.match={}),t.list.match.method=function(e,n){return e=t.getValue(e),n=t.getValue(n),e===n?!0:!1});if(t.categories!==undefined&&t.categories instanceof Array){var e=[];for(var r=0,i=t.categories.length;r<i;r+=1){var s=t.categories[r];for(var o in n.categories[0])s[o]===undefined&&(s[o]=n.categories[0][o]);e.push(s)}t.categories=e}}function i(){function e(t,n){var r=t||{};for(var i in t)n[i]!==undefined&&n[i]!==null&&(typeof n[i]!="object"||n[i]instanceof Array?r[i]=n[i]:e(t[i],n[i]));return n.data!==undefined&&n.data!==null&&typeof n.data=="object"&&(r.data=n.data),r}n=e(n,t)}function s(){if(n.url!=="list-required"&&typeof n.url!="function"){var e=n.url;n.url=function(){return e}}if(n.ajaxSettings.url!==undefined&&typeof n.ajaxSettings.url!="function"){var e=n.ajaxSettings.url;n.ajaxSettings.url=function(){return e}}if(typeof n.listLocation=="string"){var r=n.listLocation;n.dataType.toUpperCase()==="XML"?n.listLocation=function(e){return $(e).find(r)}:n.listLocation=function(e){return e[r]}}if(typeof n.getValue=="string"){var i=n.getValue;n.getValue=function(e){return e[i]}}t.categories!==undefined&&(n.categoriesAssigned=!0)}function o(){t.ajaxSettings!==undefined&&typeof t.ajaxSettings=="object"?n.ajaxSettings=t.ajaxSettings:n.ajaxSettings={}}function u(e){return n[e]!==undefined&&n[e]!==null?!0:!1}function a(e,t){function r(t,n){for(var s in n)t[s]===undefined&&e.log("Property '"+s+"' does not exist in EasyAutocomplete options API."),typeof t[s]=="object"&&!i(s)&&r(t[s],n[s])}function i(e){var t=["ajaxSettings","template"];return Array.prototype.contains=function(e){var t=this.length;while(t--)if(this[t]===e)return!0;return!1},t.contains(e)}r(n,t)}var n={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(e,t){return e=n.getValue(e),t=n.getValue(t),e<t?-1:e>t?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(e,t){return e=n.getValue(e),t=n.getValue(t),e===t?!0:!1}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(e,t){return e},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]};this.get=function(e){return n[e]},this.equals=function(e,t){return u(e)&&n[e]===t?!0:!1},this.checkDataUrlProperties=function(){return n.url==="list-required"&&n.data==="list-required"?!1:!0},this.checkRequiredProperties=function(){for(var e in n)if(n[e]==="required")return logger.error("Option "+e+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(e,t){a(e,t)},r(),i(),n.loggerEnabled===!0&&a(console,t),o(),s()},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Logger=function(){this.error=function(e){console.log("ERROR: "+e)},this.warning=function(e){console.log("WARNING: "+e)}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Constans=function(){var t={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(e){return t[e]}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.ListBuilderService=function(t,n){function r(e,n){function s(){var r={},i;return e.xmlElementName!==undefined&&(r.xmlElementName=e.xmlElementName),e.listLocation!==undefined?i=e.listLocation:t.get("listLocation")!==undefined&&(i=t.get("listLocation")),i!==undefined?typeof i=="string"?r.data=$(n).find(i):typeof i=="function"&&(r.data=i(n)):r.data=n,r}function o(){var t={};return e.listLocation!==undefined?typeof e.listLocation=="string"?t.data=n[e.listLocation]:typeof e.listLocation=="function"&&(t.data=e.listLocation(n)):t.data=n,t}var r={};t.get("dataType").toUpperCase()==="XML"?r=s():r=o(),e.header!==undefined&&(r.header=e.header),e.maxNumberOfElements!==undefined&&(r.maxNumberOfElements=e.maxNumberOfElements),t.get("list").maxNumberOfElements!==undefined&&(r.maxListSize=t.get("list").maxNumberOfElements);if(e.getValue!==undefined)if(typeof e.getValue=="string"){var i=e.getValue;r.getValue=function(e){return e[i]}}else typeof e.getValue=="function"&&(r.getValue=e.getValue);else r.getValue=t.get("getValue");return r}function i(e){var n=[];return e.xmlElementName===undefined&&(e.xmlElementName=t.get("xmlElementName")),$(e.data).find(e.xmlElementName).each(function(){n.push(this)}),n}this.init=function(e){var n=[],r={};return r.data=t.get("listLocation")(e),r.getValue=t.get("getValue"),r.maxListSize=t.get("list").maxNumberOfElements,n.push(r),n},this.updateCategories=function(e,n){if(t.get("categoriesAssigned")){e=[];for(var i=0;i<t.get("categories").length;i+=1){var s=r(t.get("categories")[i],n);e.push(s)}}return e},this.convertXml=function(e){if(t.get("dataType").toUpperCase()==="XML")for(var n=0;n<e.length;n+=1)e[n].data=i(e[n]);return e},this.processData=function(e,r){for(var i=0,s=e.length;i<s;i+=1)e[i].data=n(t,e[i],r);return e},this.checkIfDataExists=function(e){for(var t=0,n=e.length;t<n;t+=1)if(e[t].data!==undefined&&e[t].data instanceof Array&&e[t].data.length>0)return!0;return!1}},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.proccess=function(t,n,r){function o(e,n){var r=[],i="";if(t.get("list").match.enabled)for(var s=0,o=e.length;s<o;s+=1)i=t.get("getValue")(e[s]),t.get("list").match.caseSensitive||(typeof i=="string"&&(i=i.toLowerCase()),n=n.toLowerCase()),i.search(n)>-1&&r.push(e[s]);else r=e;return r}function u(e){return n.maxNumberOfElements!==undefined&&e.length>n.maxNumberOfElements&&(e=e.slice(0,n.maxNumberOfElements)),e}function a(e){return t.get("list").sort.enabled&&e.sort(t.get("list").sort.method),e}var i=n.data,s=r;return i=o(i,s),i=u(i),i=a(i),i},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.Template=function(t){var n={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},r=function(e){var t=e.fields,r;return e.type==="description"?(r=n.description.method,typeof t.description=="string"?r=function(e,n){return e+" - <span>"+n[t.description]+"</span>"}:typeof t.description=="function"&&(r=function(e,n){return e+" - <span>"+t.description(n)+"</span>"}),r):e.type==="iconRight"?(typeof t.iconSrc=="string"?r=function(e,n){return e+"<img class='eac-icon' src='"+n[t.iconSrc]+"' />"}:typeof t.iconSrc=="function"&&(r=function(e,n){return e+"<img class='eac-icon' src='"+t.iconSrc(n)+"' />"}),r):e.type==="iconLeft"?(typeof t.iconSrc=="string"?r=function(e,n){return"<img class='eac-icon' src='"+n[t.iconSrc]+"' />"+e}:typeof t.iconSrc=="function"&&(r=function(e,n){return"<img class='eac-icon' src='"+t.iconSrc(n)+"' />"+e}),r):e.type==="links"?(typeof t.link=="string"?r=function(e,n){return"<a href='"+n[t.link]+"' >"+e+"</a>"}:typeof t.link=="function"&&(r=function(e,n){return"<a href='"+t.link(n)+"' >"+e+"</a>"}),r):e.type==="custom"?e.method:n.basic.method},i=function(e){return!e||!e.type?n.basic.method:e.type&&n[e.type]?r(e):n.basic.method},s=function(e){var t=function(){return""};return!e||!e.type?t:e.type&&n[e.type]?function(){var t=n[e.type].cssClass;return function(){return t}}():t};this.getTemplateClass=s(t),this.build=i(t)},e}(EasyAutocomplete||{}),EasyAutocomplete=function(e){return e.main=function(n,r){function m(){if(c.length===0){u.error("Input field doesn't exist.");return}if(!o.checkDataUrlProperties()){u.error("One of options variables 'data' or 'url' must be defined.");return}if(!o.checkRequiredProperties()){u.error("Will not work without mentioned properties.");return}g(),b()}function g(){function e(){var e=$("<div>"),n=s.getValue("WRAPPER_CSS_CLASS");o.get("theme")&&o.get("theme")!==""&&(n+=" eac-"+o.get("theme")),o.get("cssClasses")&&o.get("cssClasses")!==""&&(n+=" "+o.get("cssClasses")),a.getTemplateClass()!==""&&(n+=" "+a.getTemplateClass()),e.addClass(n),c.wrap(e),o.get("adjustWidth")===!0&&t()}function t(){var e=c.outerWidth();c.parent().css("width",e)}function n(){c.unwrap()}function r(){var e=$("<div>").addClass(s.getValue("CONTAINER_CLASS"));e.attr("id",y()).prepend($("<ul>")),function(){e.on("show.eac",function(){switch(o.get("list").showAnimation.type){case"slide":var t=o.get("list").showAnimation.time,n=o.get("list").showAnimation.callback;e.find("ul").slideDown(t,n);break;case"fade":var t=o.get("list").showAnimation.time,n=o.get("list").showAnimation.callback;e.find("ul").fadeIn(t),n;break;default:e.find("ul").show()}o.get("list").onShowListEvent()}).on("hide.eac",function(){switch(o.get("list").hideAnimation.type){case"slide":var t=o.get("list").hideAnimation.time,n=o.get("list").hideAnimation.callback;e.find("ul").slideUp(t,n);break;case"fade":var t=o.get("list").hideAnimation.time,n=o.get("list").hideAnimation.callback;e.find("ul").fadeOut(t,n);break;default:e.find("ul").hide()}o.get("list").onHideListEvent()}).on("selectElement.eac",function(){e.find("ul li").removeClass("selected"),e.find("ul li").eq(d).addClass("selected"),o.get("list").onSelectItemEvent()}).on("loadElements.eac",function(t,n,r){var i="",s=e.find("ul");s.empty().detach(),p=[];var f=0;for(var l=0,h=n.length;l<h;l+=1){var v=n[l].data;if(v.length===0)continue;n[l].header!==undefined&&n[l].header.length>0&&s.append("<div class='eac-category' >"+n[l].header+"</div>");for(var m=0,g=v.length;m<g&&f<n[l].maxListSize;m+=1)i=$("<li><div class='eac-item'></div></li>"),function(){var e=m,t=f,s=n[l].getValue(v[e]);i.find(" > div").on("click",function(){c.val(s).trigger("change"),d=t,S(t),o.get("list").onClickEvent(),o.get("list").onChooseEvent()}).mouseover(function(){d=t,S(t),o.get("list").onMouseOverEvent()}).mouseout(function(){o.get("list").onMouseOutEvent()}).html(a.build(u(s,r),v[e]))}(),s.append(i),p.push(v[m]),f+=1}e.append(s),o.get("list").onLoadEvent()})}(),c.after(e)}function i(){c.next("."+s.getValue("CONTAINER_CLASS")).remove()}function u(e,t){return o.get("highlightPhrase")&&t!==""?l(e,t):e}function f(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function l(e,t){var n=f(t);return(e+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}c.parent().hasClass(s.getValue("WRAPPER_CSS_CLASS"))&&(i(),n()),e(),r(),h=$("#"+y()),o.get("placeholder")&&c.attr("placeholder",o.get("placeholder"))}function y(){var e=c.attr("id");return e=s.getValue("CONTAINER_ID")+e,e}function b(){function e(){l("autocompleteOff",!0)&&a(),t(),n(),r(),i(),s()}function t(){c.off("keyup").keyup(function(e){function n(e){function i(){var e={},t=o.get("ajaxSettings")||{};for(var n in t)e[n]=t[n];return e}function s(e,t){return o.get("matchResponseProperty")!==!1?typeof o.get("matchResponseProperty")=="string"?t[o.get("matchResponseProperty")]===e:typeof o.get("matchResponseProperty")=="function"?o.get("matchResponseProperty")(t)===e:!0:!0}if(e.length<o.get("minCharNumber"))return;if(o.get("data")!=="list-required"){var t=o.get("data"),n=f.init(t);n=f.updateCategories(n,t),n=f.processData(n,e),x(n,e),c.parent().find("li").length>0?w():E()}var r=i();if(r.url===undefined||r.url==="")r.url=o.get("url");if(r.dataType===undefined||r.dataType==="")r.dataType=o.get("dataType");r.url!==undefined&&r.url!=="list-required"&&(r.url=r.url(e),r.data=o.get("preparePostData")(r.data,e),$.ajax(r).done(function(t){var n=f.init(t);n=f.updateCategories(n,t),n=f.convertXml(n),s(e,t)&&(n=f.processData(n,e),x(n,e)),f.checkIfDataExists(n)&&c.parent().find("li").length>0?w():E(),o.get("ajaxCallback")()}).fail(function(){u.warning("Fail to load response data")}).always(function(){}))}switch(e.keyCode){case 27:E(),T();break;case 38:e.preventDefault(),p.length>0&&d>0&&(d-=1,c.val(o.get("getValue")(p[d])),S(d));break;case 40:e.preventDefault(),p.length>0&&d<p.length-1&&(d+=1,c.val(o.get("getValue")(p[d])),S(d));break;default:if(e.keyCode>40||e.keyCode===8){var t=c.val();o.get("list").hideOnEmptyPhrase!==!0||e.keyCode!==8||t!==""?o.get("requestDelay")>0?(v!==undefined&&clearTimeout(v),v=setTimeout(function(){n(t)},o.get("requestDelay"))):n(t):E()}}})}function n(){c.on("keydown",function(e){e=e||window.event;var t=e.keyCode;if(t===38)return suppressKeypress=!0,!1}).keydown(function(e){e.keyCode===13&&d>-1&&(c.val(o.get("getValue")(p[d])),o.get("list").onKeyEnterEvent(),o.get("list").onChooseEvent(),d=-1,E(),e.preventDefault())})}function r(){c.off("keypress")}function i(){c.focus(function(){c.val()!==""&&p.length>0&&(d=-1,w())})}function s(){c.blur(function(){setTimeout(function(){d=-1,E()},250)})}function a(){c.attr("autocomplete","off")}e()}function w(){h.trigger("show.eac")}function E(){h.trigger("hide.eac")}function S(e){h.trigger("selectElement.eac",e)}function x(e,t){h.trigger("loadElements.eac",[e,t])}function T(){c.trigger("blur")}var i={name:"EasyAutocomplete",shortcut:"eac"},s=new e.Constans,o=new e.Configuration(r),u=new e.Logger,a=new e.Template(r.template),f=new e.ListBuilderService(o,e.proccess),l=o.equals,c=n,h="",p=[],d=-1,v;e.consts=s,this.getConstants=function(){return s},this.getConfiguration=function(){return o},this.getContainer=function(){return h},this.getSelectedItemIndex=function(){return d},this.getItemData=function(e){return p.length<e||p[e]===undefined?-1:p[e]},this.getSelectedItemData=function(){return this.getItemData(d)},this.build=function(){g()},this.init=function(){m()}},e.easyAutocompleteHandles=[],e.inputHasId=function(e){return $(e).attr("id")!==undefined&&$(e).attr("id").length>0?!0:!1},e.assignRandomId=function(t){var n="";do n="eac-"+Math.floor(Math.random()*1e4);while($("#"+n).length!==0);elementId=e.consts.getValue("CONTAINER_ID")+n,$(t).attr("id",n)},e}(EasyAutocomplete||{});$.fn.easyAutocomplete=function(e){return this.each(function(){var t=$(this),n=new EasyAutocomplete.main(t,e);EasyAutocomplete.inputHasId(t)||EasyAutocomplete.assignRandomId(t),n.init(),EasyAutocomplete.easyAutocompleteHandles[t.attr("id")]=n})},$.fn.getSelectedItemIndex=function(){var e=$(this).attr("id");return e!==undefined?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemIndex():-1},$.fn.getItemData=function(e){var t=$(this).attr("id");return t!==undefined&&e>-1?EasyAutocomplete.easyAutocompleteHandles[t].getItemData(e):-1},$.fn.getSelectedItemData=function(){var e=$(this).attr("id");return e!==undefined?EasyAutocomplete.easyAutocompleteHandles[e].getSelectedItemData():-1},define("jquery-easy-autocomplete",["jquery"],function(){}),define("view/location-wizard",["underscore","backbone","jquery","brooklyn-utils","model/location","text!tpl/location-wizard/modal.html","text!tpl/location-wizard/location-type.html","text!tpl/location-wizard/location-configuration.html","text!tpl/location-wizard/location-provisioning.html","text!tpl/location-wizard/location-provisioning-entry.html","jquery-easy-autocomplete"],function(e,t,n,r,i,s,o,u,a,f){var l=["brooklyn.catalog:","  version: 0.0.1","  items:"],c=t.View.extend({template:e.template(s),events:{"click .location-wizard-previous":"previousStep","click .location-wizard-next":"nextStep","click .location-wizard-edit":"edit","click .location-wizard-save":"save","click .location-wizard-save-and-reset":"saveAndReset"},initialize:function(){this.type="",this.step=0,this.location=new i.Model,this.onLocationCreated=e.isFunction(this.options.onLocationCreated)?this.options.onLocationCreated:undefined,this.onFinish=e.isFunction(this.options.onFinish)?this.options.onFinish:undefined,this.className=e.isBoolean(this.options.isModal)&&this.options.isModal?"modal hide fade":"",this.steps=[{title:"Location Type",subtitle:"Select the location type to make available for deployments",view:h},{title:"<%= type %> Location - Configuration",view:d},{title:"<%= type %> Location - Provisioning",subtitle:'In many target locations, additional configuration may be supported. Enter any such options here. For information on available options consult the <a href="https://brooklyn.apache.org/v/latest/ops/locations/">Brooklyn documentation</a>. Alternatively you can skip this step.',view:v}],this.actions=[{label:"Edit in YAML","class":"location-wizard-edit"},{label:"Save and Add Another","class":"location-wizard-save-and-reset"},{label:"Save","class":"location-wizard-save"}]},render:function(){return this.$el.addClass(this.className).html(this.template({})),this.renderStep(),this},renderStep:function(){var t=this.steps[this.step];this.$(".location-wizard-title").html(e.template(t.title)({type:this.capitalize(this.type)})),e.has(t,"subtitle")?this.$(".location-wizard-subtitle").html(e.template(t.subtitle)({type:this.type})).show():this.$(".location-wizard-subtitle").hide();var r=this.$(".location-wizard-actions").empty();(this.step===2||this.type==="byon"&&this.step===1)&&e.each(this.actions,function(e,t,i){r.append(n("<button>").addClass("btn btn-mini btn-info location-wizard-action "+e.class).html(e.label))}),this.currentView&&this.currentView.close(),e.isObject(t.view)&&(this.currentView=new t.view({wizard:this}),this.$(".modal-body").html(this.currentView.render().el));var i=this.$(".location-wizard-previous"),s=this.$(".location-wizard-next");this.step==0?i.hide():i.show(),this.step==this.steps.length-1?s.hide():this.step==this.steps.length-2&&this.type==="byon"?s.hide():s.show(),this.$("input").first().focus()},previousStep:function(){this.step>0&&(this.step--,this.renderStep())},nextStep:function(){this.step<this.steps.length-1&&(this.step++,this.renderStep())},enableNextAction:function(e){e?this.$(".location-wizard-action").removeAttr("disabled"):this.$(".location-wizard-action").attr("disabled","disabled")},capitalize:function(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)},edit:function(){this.currentView instanceof v&&this.currentView.setProvisioningProperties();var n="  ",r=[].concat(l);r.push(n+"- id: "+this.location.get("name")),n+="  ",r.push(n+"itemType: location"),r.push(n+"item:"),n+="  ",r.push(n+"type: "+this.location.get("spec"));var i=this.location.get("config");e.keys(i).length>0&&(r.push(n+"brooklyn.config:"),n+="  ",e.each(i,function(t,i){e.isArray(t)?(r.push(n+i+":"),e.each(t,function(e){r.push(n+"- "+e)})):e.isObject(t)?(r.push(n+i+":"),e.each(t,function(e,t){r.push(n+"  "+t+": "+e)})):r.push(n+i+": "+t)})),t.history.navigate("/v1/editor/catalog/_/"+encodeURIComponent(r.join("\n")),{trigger:!0})},save:function(t){var n=this;this.currentView instanceof v&&this.currentView.setProvisioningProperties(),this.location.save().done(function(r){e.isFunction(n.onLocationCreated)&&n.onLocationCreated(n,r),e.isFunction(t)?t():e.isFunction(n.onFinish)&&n.onFinish(n,r)}).fail(function(e){n.showFailure(r.extractError(e))})},saveAndReset:function(){var e=this;this.save(function(){e.step=0,e.type="",e.location=new i.Model,e.renderStep()})},showFailure:function(t){t||(t="Failure performing the specified action"),this.$("div.error-message .error-message-text").html(e.escape(t)),this.$("div.error-message").slideDown(250).delay(1e4).slideUp(500)}}),h=t.View.extend({className:"location-wizard-body",template:e.template(o),events:{"mouseenter .location-type":"onDisplayHelp","mouseleave .location-type":"onHideHelp","click .location-type":"onSelectType"},wizard:null,initialize:function(){this.wizard=this.options.wizard},render:function(){this.$el.html(this.template()),this.wizard.enableNextAction(!1);var e=this;return this.$(".location-type").each(function(){n(this).data("type")===e.wizard.type&&(n(this).addClass("selected"),e.wizard.enableNextAction(!0))}),this},onDisplayHelp:function(e){var t=this.$(e.currentTarget);this.$(".help-text").html(t.data("help")).show()},onHideHelp:function(e){this.$(".help-text").html("").hide()},onSelectType:function(e){var t=this.$(e.currentTarget),r=t.data("type");return t.toggleClass("selected"),this.wizard.type=t.hasClass("selected")?r:"",this.wizard.enableNextAction(this.wizard.type!==""),this.wizard.location.get("spec")!==this.wizard.type&&(this.wizard.location=new i.Model),this.$(".location-type").each(function(){n(this).data("type")!=r&&n(this).removeClass("selected")}),this}}),p={location_id:{id:"name",label:"Location ID",type:"text",help:"A label to identify this location in YAML. Typically this is lower case using hyphens and no spaces",require:!0},location_name:{id:"displayName",label:"Location Name",type:"text",help:"A display name to present this location to a user (optional)"}},d=t.View.extend({className:"location-wizard-body",template:e.template(u),events:{"blur input, textarea":"onChange","change select":"onChange"},fields:{cloud:[p.location_id,p.location_name,{id:"spec",label:"Cloud Provider",type:"select",values:{"jclouds:aws-ec2":"Amazon","jclouds:google-compute-engine":"Google","jclouds:openstack":"Openstack","jclouds:softlayer":"Softlayer",other:"Other (supply location spec string)"}},{id:"region",label:"Cloud Region",type:"text",help:"Public cloud providers often have multiple regions available. Enter the region to use if applicable (optional)",disable:{spec:["jclouds:openstack"]}},{id:"endpoint",label:"Cloud Endpoint",type:"text",help:"If using a private cloud, the URL to connect to it is required",require:{spec:["jclouds:openstack"]},disable:{spec:["jclouds:aws-ec2","jclouds:softlayer"]}},{id:"identity",label:"Cloud Identity",type:"text",help:"The account name or access key to log in to this cloud",require:!0},{id:"credential",label:"Cloud Credential",help:"The password or secret key for the Cloud Identity to log in to this cloud",type:"text",require:!0}],byon:[p.location_id,p.location_name,{id:"user",label:"User",type:"text",help:"The user to use to connect to the machines. One of the following two fields must also be supplied to connect"},{id:"password",label:"Password",type:"password",help:"The password to use to connect to the machines (if using password access)"},{id:"privateKeyFile",label:"Private Key Data",type:"textarea",help:"The contents of the private key file to use to connect to the machines (if using key access, where the corresponding public key is in the <code>.authorized_keys</code> file on the servers)"},{id:"privateKeyPassphrase",label:"Private Key Passphrase",type:"text",help:"The passphrase to unlock the private key specified above (if applicable)"},{id:"hosts",label:"Hosts",type:"textarea",help:"The IP addresses of the machines to include in this location definition, one per line",list:!0,require:!0}],advanced:[p.location_id,p.location_name,{id:"spec",label:"Parent Location",type:"text",help:"The identity or spec of the location which this location should extend",require:!0}]},wizard:null,initialize:function(){this.wizard=this.options.wizard,this.wizard.type==="byon"&&this.wizard.location.set("spec",this.wizard.type)},render:function(){this.$el.html(this.template()),this.wizard.enableNextAction(!1);var t=this,n=this.fields[this.wizard.type];return e.each(n,function(e,n){t.$(".tab-content").append(t.generateField(e))}),this.$("input,textarea").blur(),this.$("select").change(),this},generateField:function(t){var r=n("<input>").attr("type",t.type);t.type==="textarea"?r=n("<textarea>"):t.type==="select"&&(r=n("<select>"),e.each(t.values,function(e,t){r.append(n("<option>").attr("value",t).html(e))}),n("<input>").attr("name",t.id+"-other").insertAfter(r));var s="";e.contains(["name","spec"],t.id)?s=this.wizard.location.get(t.id):s=this.wizard.location.get("config")[t.id];var o=n("<div>").addClass("control-group").append(n("<label>").addClass("control-label deploy-label").attr("for",t.id).html(t.label)).append(r.val(s).data("list",e.isBoolean(t.list)?t.list:!1).data("require",e.isBoolean(t.require)?t.require:!1).data("require-deps",e.isObject(t.require)?t.require:undefined).data("disable-deps",e.isObject(t.disable)?t.disable:undefined).attr({id:t.id,name:t.id}));t.type==="select"&&e.has(t.values,"other")&&o.append(n("<input>").attr("name",t.id+"-other").addClass("location-other").hide()),e.has(t,"help")&&o.append(n("<p>").addClass("help-block").html(n("<small>").html(t.help)));if(t.type==="text"&&t.id==="spec"){var u=new i.Collection;u.fetch({success:function(t){r.easyAutocomplete({list:{match:{enabled:!0}},categories:[{listLocation:"catalog",header:"Catalog Locations"},{listLocation:"spec",header:"Spec"}],data:{catalog:e.map(t.models,function(e){return e.getIdentifierName()}),spec:["localhost"]},loggerEnabled:!1})}})}return o},onChange:function(t){var r=this,i=!0,s=this.$(t.currentTarget);s.attr("name")==="spec"&&(s.val()==="other"?this.$("input[name=spec-other]").show():this.$("input[name=spec-other]").hide());if(s.val()!=="")if(e.contains(["name","spec"],s.attr("name")))this.wizard.location.set(s.attr("name"),s.val());else if(s.attr("name")==="spec-other")this.wizard.location.set("spec",s.val());else{var o={};o[s.attr("name")]=s.data("list")?s.val().split("\n"):s.val(),this.wizard.location.set("config",e.extend(this.wizard.location.get("config"),o))}this.$("input, select, textarea").each(function(){if(e.isObject(n(this).data("require-deps"))){var t=!0;e.each(n(this).data("require-deps"),function(n,i){t=t&&e.contains(n,r.$("[name="+i+"]").val())}),n(this).data("require",t)}if(e.isObject(n(this).data("disable-deps"))){var s=!0;e.each(n(this).data("disable-deps"),function(t,n){s=s&&e.contains(t,r.$("[name="+n+"]").val())}),s?n(this).attr("disabled","disabled").val(""):n(this).removeAttr("disabled")}n(this).data("require")&&(i=i&&n(this).val()!==""),r.wizard.enableNextAction(i)})}}),v=t.View.extend({className:"location-wizard-body",template:e.template(a),events:{"click .remove-entry":"removeEntry","click .add-entry":"addEntry"},wizard:null,vmOptions:["minCore","minRam","osFamily","osVersionRegex","os64Bit","imageId","imageNameRegex","hardwareId","inboundPorts","securityGroups","domainName","userMetadata","machineCreateAttempts","destroyOnFailure"],osOptions:["user","password","loginUser","privateKeyFile","privateKeyPassphrase","publicKeyFile","openIptables","installDevUrandom","useJcloudsSshInit"],templateOptions:["subnetId","mapNewVolumeToDeviceName","securityGroupIds"],initialize:function(){this.wizard=this.options.wizard},render:function(){return this.$el.html(this.template()),this.wizard.enableNextAction(!0),this},setProvisioningProperties:function(){var t={};this.$(".control-group").each(function(){n(this).find("input.entry-key").val()!==""&&n(this).find("input.entry-value").val()!==""&&(t[n(this).find("input.entry-key").val()]=n(this).find("input.entry-value").val())}),this.wizard.location.set("config",e.extend(this.wizard.location.get("config"),t))},addEntry:function(t){var r=this,i=n(e.template(f,{}));n(t.currentTarget).prev().append(i),setTimeout(function(){i.find("input.entry-key").easyAutocomplete({list:{match:{enabled:!0}},categories:[{listLocation:"vmOptions",header:"VM Creation"},{listLocation:"osOptions",header:"OS Setup"},{listLocation:"templateOptions",header:"Template Options"}],data:{vmOptions:r.vmOptions,osOptions:r.osOptions,templateOptions:r.templateOptions},loggerEnabled:!1})},100)},removeEntry:function(e){n(e.currentTarget).parent().remove()}});return c}),function(e){function M(e,t){return function(n){return F(e.call(this,n),t)}}function _(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function D(){}function P(e){B(this,e)}function H(e){var t=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,r=e.weeks||e.week||e.w||0,i=e.days||e.day||e.d||0,s=e.hours||e.hour||e.h||0,o=e.minutes||e.minute||e.m||0,u=e.seconds||e.second||e.s||0,a=e.milliseconds||e.millisecond||e.ms||0;this._input=e,this._milliseconds=a+u*1e3+o*6e4+s*36e5,this._days=i+r*7,this._months=n+t*12,this._data={},this._bubble()}function B(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function j(e){return e<0?Math.ceil(e):Math.floor(e)}function F(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function I(e,n,r,i){var s=n._milliseconds,o=n._days,u=n._months,a,f,l;s&&e._d.setTime(+e._d+s*r);if(o||u)a=e.minute(),f=e.hour();o&&e.date(e.date()+o*r),u&&e.month(e.month()+u*r),s&&!i&&t.updateOffset(e);if(o||u)e.minute(a),e.hour(f)}function q(e){return Object.prototype.toString.call(e)==="[object Array]"}function R(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function U(e){return e?C[e]||e.toLowerCase().replace(/(.)s$/,"$1"):e}function z(e,t){return t.abbr=e,s[e]||(s[e]=new D),s[e].set(t),s[e]}function W(e){if(!e)return t.fn._lang;if(!s[e]&&o)try{require("./lang/"+e)}catch(n){return t.fn._lang}return s[e]}function X(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function V(e){var t=e.match(f),n,r;for(n=0,r=t.length;n<r;n++)O[t[n]]?t[n]=O[t[n]]:t[n]=X(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=t[n]instanceof Function?t[n].call(i,e):t[n];return s}}function $(e,t){function r(t){return e.lang().longDateFormat(t)||t}var n=5;while(n--&&l.test(t))t=t.replace(l,r);return k[t]||(k[t]=V(t)),k[t](e)}function J(e,t){switch(e){case"DDDD":return p;case"YYYY":return d;case"YYYYY":return v;case"S":case"SS":case"SSS":case"DDD":return h;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return m;case"a":case"A":return W(t._l)._meridiemParse;case"X":return b;case"Z":case"ZZ":return g;case"T":return y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return c;default:return new RegExp(e.replace("\\",""))}}function K(e){var t=(g.exec(e)||[])[0],n=(t+"").match(x)||["-",0,0],r=+(n[1]*60)+~~n[2];return n[0]==="+"?-r:r}function Q(e,t,n){var r,i=n._a;switch(e){case"M":case"MM":i[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":r=W(n._l).monthsParse(t),r!=null?i[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(i[2]=~~t);break;case"YY":i[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":i[0]=~~t;break;case"a":case"A":n._isPm=W(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"S":case"SS":case"SSS":i[6]=~~(("0."+t)*1e3);break;case"X":n._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=K(t)}t==null&&(n._isValid=!1)}function G(e){var t,n,r=[];if(e._d)return;for(t=0;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];r[3]+=~~((e._tzm||0)/60),r[4]+=~~((e._tzm||0)%60),n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}function Y(e){var t=e._f.match(f),n=e._i,r,i;e._a=[];for(r=0;r<t.length;r++)i=(J(t[r],e).exec(n)||[])[0],i&&(n=n.slice(n.indexOf(i)+i.length)),O[t[r]]&&Q(t[r],i,e);n&&(e._il=n),e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&e._a[3]===12&&(e._a[3]=0),G(e)}function Z(e){var t,n,r,i=99,s,o;for(s=0;s<e._f.length;s++)t=B({},e),t._f=e._f[s],Y(t),n=new P(t),o=R(t._a,n.toArray()),n._il&&(o+=n._il.length),o<i&&(i=o,r=n);B(e,r)}function et(e){var t,n=e._i,r=w.exec(n);if(r){e._f="YYYY-MM-DD"+(r[2]||" ");for(t=0;t<4;t++)if(S[t][1].exec(n)){e._f+=S[t][0];break}g.exec(n)&&(e._f+=" Z"),Y(e)}else e._d=new Date(n)}function tt(t){var n=t._i,r=u.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):typeof n=="string"?et(t):q(n)?(t._a=n.slice(0),G(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function nt(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function rt(e,t,n){var i=r(Math.abs(e)/1e3),s=r(i/60),o=r(s/60),u=r(o/24),a=r(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",r(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,nt.apply({},f)}function it(e,n,r){var i=r-n,s=r-e.day(),o;return s>i&&(s-=7),s<i-7&&(s+=7),o=t(e).add("d",s),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function st(e){var n=e._i,r=e._f;return n===null||n===""?null:(typeof n=="string"&&(e._i=n=W().preparse(n)),t.isMoment(n)?(e=B({},n),e._d=new Date(+n._d)):r?q(r)?Z(e):Y(e):tt(e),new P(e))}function ot(e,n){t.fn[e]=t.fn[e+"s"]=function(e){var r=this._isUTC?"UTC":"";return e!=null?(this._d["set"+r+n](e),t.updateOffset(this),this):this._d["get"+r+n]()}}function ut(e){t.duration.fn[e]=function(){return this._data[e]}}function at(e,n){t.duration.fn["as"+e]=function(){return+this/n}}var t,n="2.1.0",r=Math.round,i,s={},o=typeof module!="undefined"&&module.exports,u=/^\/?Date\((\-?\d+)/i,a=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,f=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,l=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,c=/\d\d?/,h=/\d{1,3}/,p=/\d{3}/,d=/\d{1,4}/,v=/[+\-]?\d{1,6}/,m=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,g=/Z|[\+\-]\d\d:?\d\d/i,y=/T/i,b=/[\+\-]?\d+(\.\d{1,3})?/,w=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,E="YYYY-MM-DDTHH:mm:ssZ",S=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],x=/([\+\-]|\d\d)/gi,T="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),N={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},C={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},k={},L="DDD w W M D d".split(" "),A="M D H h m s w W".split(" "),O={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return F(this.year()%100,2)},YYYY:function(){return F(this.year(),4)},YYYYY:function(){return F(this.year(),5)},gg:function(){return F(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return F(this.weekYear(),5)},GG:function(){return F(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return F(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return F(~~(this.milliseconds()/10),2)},SSS:function(){return F(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+F(~~(e/60),2)+":"+F(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+F(~~(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};while(L.length)i=L.pop(),O[i+"o"]=_(O[i],i);while(A.length)i=A.pop(),O[i+i]=M(O[i],2);O.DDDD=M(O.DDD,3),D.prototype={set:function(e){var t,n;for(n in e)t=e[n],typeof t=="function"?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var n,r,i;this._monthsParse||(this._monthsParse=[]);for(n=0;n<12;n++){this._monthsParse[n]||(r=t([2e3,n]),i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i"));if(this._monthsParse[n].test(e))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var n,r,i;this._weekdaysParse||(this._weekdaysParse=[]);for(n=0;n<7;n++){this._weekdaysParse[n]||(r=t([2e3,1]).day(n),i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i"));if(this._weekdaysParse[n].test(e))return n}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return(e+"").toLowerCase()[0]==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return typeof n=="function"?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return typeof i=="function"?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return typeof n=="function"?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return it(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},t=function(e,t,n){return st({_i:e,_f:t,_l:n,_isUTC:!1})},t.utc=function(e,t,n){return st({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=t.isDuration(e),i=typeof e=="number",s=r?e._input:i?{}:e,o=a.exec(e),u,f;return i?n?s[n]=e:s.milliseconds=e:o&&(u=o[1]==="-"?-1:1,s={y:0,d:~~o[2]*u,h:~~o[3]*u,m:~~o[4]*u,s:~~o[5]*u,ms:~~o[6]*u}),f=new H(s),r&&e.hasOwnProperty("_lang")&&(f._lang=e._lang),f},t.version=n,t.defaultFormat=E,t.updateOffset=function(){},t.lang=function(e,n){if(!e)return t.fn._lang._abbr;n?z(e,n):s[e]||W(e),t.duration.fn._lang=t.fn._lang=W(e)},t.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),W(e)},t.isMoment=function(e){return e instanceof P},t.isDuration=function(e){return e instanceof H},t.fn=P.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return $(t(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return this._isValid==null&&(this._a?this._isValid=!R(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var n=$(this,e||t.defaultFormat);return this.lang().postformat(n)},add:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),I(this,r,1),this},subtract:function(e,n){var r;return typeof e=="string"?r=t.duration(+n,e):r=t.duration(e,n),I(this,r,-1),this},diff:function(e,n,r){var i=this._isUTC?t(e).zone(this._offset||0):t(e).local(),s=(this.zone()-i.zone())*6e4,o,u;return n=U(n),n==="year"||n==="month"?(o=(this.daysInMonth()+i.daysInMonth())*432e5,u=(this.year()-i.year())*12+(this.month()-i.month()),u+=(this-t(this).startOf("month")-(i-t(i).startOf("month")))/o,u-=(this.zone()-t(this).startOf("month").zone()-(i.zone()-t(i).startOf("month").zone()))*6e4/o,n==="year"&&(u/=12)):(o=this-i,u=n==="second"?o/1e3:n==="minute"?o/6e4:n==="hour"?o/36e5:n==="day"?(o-s)/864e5:n==="week"?(o-s)/6048e5:o),r?u:j(u)},from:function(e,n){return t.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=this.diff(t().startOf("day"),"days",!0),n=e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){if(typeof e=="string"){e=this.lang().weekdaysParse(e);if(typeof e!="number")return this}return this.add({d:e-t})}return t},month:function(e){var n=this._isUTC?"UTC":"",r,i;if(e!=null){if(typeof e=="string"){e=this.lang().monthsParse(e);if(typeof e!="number")return this}return r=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(r,this.daysInMonth())),t.updateOffset(this),this}return this._d["get"+n+"Month"]()},startOf:function(e){e=U(e);switch(e){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return e==="week"&&this.weekday(0),this},endOf:function(e){return this.startOf(e).add(e,1).subtract("ms",1)},isAfter:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)>+t(e).startOf(n)},isBefore:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)<+t(e).startOf(n)},isSame:function(e,n){return n=typeof n!="undefined"?n:"millisecond",+this.clone().startOf(n)===+t(e).startOf(n)},min:function(e){return e=t.apply(null,arguments),e<this?this:e},max:function(e){return e=t.apply(null,arguments),e>this?this:e},zone:function(e){var n=this._offset||0;return e==null?this._isUTC?n:this._d.getTimezoneOffset():(typeof e=="string"&&(e=K(e)),Math.abs(e)<16&&(e*=60),this._offset=e,this._isUTC=!0,n!==e&&I(this,t.duration(n-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var n=r((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return e==null?n:this.add("d",e-n)},weekYear:function(e){var t=it(this,this.lang()._week.dow,this.lang()._week.doy).year;return e==null?t:this.add("y",e-t)},isoWeekYear:function(e){var t=it(this,1,4).year;return e==null?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return e==null?t:this.add("d",(e-t)*7)},isoWeek:function(e){var t=it(this,1,4).week;return e==null?t:this.add("d",(e-t)*7)},weekday:function(e){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return e==null?t:this.add("d",e-t)},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},lang:function(t){return t===e?this._lang:(this._lang=W(t),this)}};for(i=0;i<T.length;i++)ot(T[i].toLowerCase().replace(/s$/,""),T[i]);ot("year","FullYear"),t.fn.days=t.fn.day,t.fn.months=t.fn.month,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.fn.toJSON=t.fn.toISOString,t.duration.fn=H.prototype={_bubble:function(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,s,o,u;r.milliseconds=e%1e3,i=j(e/1e3),r.seconds=i%60,s=j(i/60),r.minutes=s%60,o=j(s/60),r.hours=o%24,t+=j(o/24),r.days=t%30,n+=j(t/30),r.months=n%12,u=j(n/12),r.years=u},weeks:function(){return j(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+~~(this._months/12)*31536e6},humanize:function(e){var t=+this,n=rt(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,n){var r=t.duration(e,n);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(e,n){var r=t.duration(e,n);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(e){return e=U(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=U(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:t.fn.lang};for(i in N)N.hasOwnProperty(i)&&(at(i,N[i]),ut(i.toLowerCase()));at("Weeks",6048e5),t.duration.fn.asMonths=function(){return(+this-this.years()*31536e6)/2592e6+this.years()*12},t.lang("en",{ordinal:function(e){var t=e%10,n=~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),o&&(module.exports=t),typeof ender=="undefined"&&(this.moment=t),typeof define=="function"&&define.amd&&define("moment",[],function(){return t})}.call(this),define("text!tpl/home/ha-summary.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<table class="table table-striped table-bordered table-condensed">\n    <thead>\n    <tr>\n        <th>Server</th>\n        <th>Status</th>\n        <th>Last seen</th>\n    </tr>\n    </thead>\n    <tbody class="ha-summary-table-body">\n        <tr><td colspan="3"><i>Loading...</i></td></tr>\n    </tbody>\n</table>'}),define("view/ha-summary",["jquery","underscore","backbone","moment","view/viewutils","model/server-extended-status","text!tpl/home/ha-summary.html"],function(e,t,n,r,i,s,o){var u=t.template(o),a=t.template("<tr><td><% if (nodeUri && !isTerminated) { %><a href='<%= nodeUri %>'><%= nodeId %></a><% } else { %><%= nodeId %><%    } %><% if (isSelf) { %><span class='pull-right badge badge-success'>this</span><% } %></td><td><% if (isPretendMaster) {%>EX-MASTER<%} else {%><%= status %><%} if (isStale) { %> (stale)<% } %></td><td><%= timestampDisplayPrefix %><span class='timestamp' data-timestamp='<%= timestamp %>'><%= timestampDisplay %><span><%= timestampDisplaySuffix %></td></tr>"),f="<tr><td colspan='3'><i>Failed to load data of servers</i></td></tr>",l="<tr><td colspan='3'><i>Waiting on detail for servers...</i></td></tr>",c=n.View.extend({initialize:function(){t.bindAll(this),this.updateTimestampCallback=setInterval(this.updateTimestamps,1e3),this.listenTo(s,"change",this.renderNodeStatus)},beforeClose:function(){clearInterval(this.updateTimestampCallback),this.stopListening()},updateNow:function(){s.fetch()},render:function(){return this.$el.html(u()),this.renderNodeStatus(),this},renderNodeStatus:function(){var e=this.$(".ha-summary-table-body");if(!s.loaded){e.html(l);return}var n=s.get("ha")||{},i=n.masterId,o=n.ownId,u=n.nodes;if(u==undefined||t.isEmpty(u)){e.html(f);return}e.empty();var c;t.each(u,function(e){e.nodeId==i&&e.remoteTimestamp&&(c=e.remoteTimestamp)}),t.each(u,function(n){var s=t.clone(n);s.timestampDisplayPrefix="",s.timestampDisplaySuffix="",s.remoteTimestamp?s.timestamp=s.remoteTimestamp:(s.timestamp=s.localTimestamp,s.timestampDisplaySuffix=" (local)"),s.timestamp>=r().utc()+1e4?(s.timestampDisplayPrefix="server clock in future by "+r.duration(r(s.timestamp).diff(r())).humanize(),s.timestamp="",s.timestampDisplay=""):(s.timestamp>=r().utc()&&(s.timestamp=r().utc()-1),s.timestampDisplay=r(s.timestamp).fromNow()),s.isSelf=s.nodeId==o,s.isMaster=o==i,s.status=="TERMINATED"?(s.isTerminated=!0,s.isPretendMaster=!1,s.isStale=!1):(s.isTerminated=!1,s.isPretendMaster=!s.isMaster&&s.status=="MASTER"&&i!=s.nodeId,s.isStale=c&&s.timestamp+3e4<c),e.append(a(s))})},updateTimestamps:function(){this.$(".timestamp").each(function(t,n){n=e(n);var i=n.data("timestamp");n.html(r(i).fromNow())})}});return c}),define("text!tpl/home/applications.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- Applications page template -->\n<div class="home-first-row container container-fluid">\n\n    <div class="row home-summaries-row"><!--  inserted by JS (templated by summaries.html)  --></div>\n\n</div>\n\n<div class="home-second-row"><div class="container container-fluid">\n\n    <div class="row home-widgets-row">\n            \n  <div class="map-container">\n    <div id="circles-map" class="circles-map">\n      <div id="circles-map-message" class="circles-map-message">(map loading)</div>\n    </div>\n  </div>\n\n  <div class="apps-summary-container">\n\n    <div id="applications">\n        <table class="table table-striped table-bordered table-condensed">\n            <thead>\n            <th>Application</th>\n            <th>Status</th>\n            </thead>\n            <tbody id="applications-table-body">\n            </tbody>\n        </table>\n    </div>\n\n    <div id="ha-summary"></div>\n\n    <dl class="dl-horizontal"></dl>\n    <div id="new-application-resource">\n        <button id="add-new-application" type="button" class="btn btn-info">\n            Add Application</button>\n    </div>\n    \n    <dl class="dl-horizontal"></dl>\n    <div id="reload-brooklyn-properties-resource">\n        <button id="reload-brooklyn-properties" type="button" class="btn btn-info">\n            Reload Properties</button>\n    </div>\n    <div id="reload-brooklyn-properties-indicator" class="throbber hide" style="float: right;">\n        <img src="/assets/images/throbber.gif"/>\n    </div>\n    \n    <dl class="dl-horizontal"></dl>\n    <div id="clear-ha-node-records-resource">\n        <button id="clear-ha-node-records" type="button" class="btn btn-info">\n            Clear HA Node Records</button>\n    </div>\n    <div id="clear-ha-node-records-indicator" class="throbber hide" style="float: right;">\n        <img src="/assets/images/throbber.gif"/>\n    </div>\n    \n  </div>\n  \n    </div>\n</div></div>\n\n<div class="add-app">\n    <div id="modal-container"></div>\n</div>\n'}),define("text!tpl/home/summaries.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n  <div class="roundedSummary"><div class="roundedSummaryText">\n    <span class="big" id="numApps"><%- apps.size() %></span> \n        app<%- apps.size()==1 ? "" : "s" %> running<br/>\n    <!-- in <span class="big">3</span> locations<br/>\n        with <span class="big">8</span> machines  -->\n  </div></div>\n  <!-- \n  <div class="roundedSummary"><div class="roundedSummaryText">\n    <span class="big">6</span> app and <span class="big">44</span> entity<br/>\n    templates available\n  </div></div>\n   -->\n  <% if (locations.size() > 0) { %>\n  <div class="roundedSummary"><div class="roundedSummaryText">\n    <span class="big"><%- locations.size() %></span> location<%- locations.size()==1 ? "" : "s" %> configured<br/>\n    <!-- with <span class="big">14</span> active machines  -->\n  </div></div>\n  <% } else { %>\n  <button class="addSummary addLocation roundedSummary" type="button">add location</button>\n  <% } %>\n\n  <button class="addSummary addApplication roundedSummary" type="button">add application</button>'}),define("text!tpl/home/app-entry.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- Application entry template inside the main application page -->\n<td><a href="#<%= link && link[0]==\'/\' ? link.substring(1) : link %>"><%= name %></a></td>\n<td><%= status %></td>\n'}),define("view/home",["jquery","underscore","backbone","view/viewutils","view/application-add-wizard","view/location-wizard","view/ha-summary","model/location","text!tpl/home/applications.html","text!tpl/home/summaries.html","text!tpl/home/app-entry.html","bootstrap","brooklyn-utils"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({tagName:"div",events:{"click #add-new-application":"createApplication","click #reload-brooklyn-properties":"reloadBrooklynProperties","click #clear-ha-node-records":"clearHaNodeRecords","click .addApplication":"createApplication","click .addLocation":"createLocation"},initialize:function(){var n=this;this.$el.html(t.template(a,{})),e(".nav1").removeClass("active"),e(".nav1_home").addClass("active"),this._appViews={},this.summariesView=new c.HomeSummariesView({applications:this.collection,locations:this.options.locations}),this.collection.on("reset",this.render,this),this.options.locations.on("reset",this.renderSummaries,this),r.fetchRepeatedlyWithDelay(this,this.collection,{fetchOptions:{reset:!0},doitnow:!0,backoffMaxPeriod:1e4}),r.fetchRepeatedlyWithDelay(this,this.options.locations,{fetchOptions:{reset:!0},doitnow:!0});var i=e(this.$el).find("#circles-map");this.options.offline?i.find("#circles-map-message").html("(map off in offline mode)"):requirejs(["googlemaps"],function(e){t.defer(function(){log("loading google maps");var t=e.addMapToCanvas(i[0],0,0,1),r=new u.UsageLocated;e.resetCircles(),n.updateCircles(n,r,e,t),n.callPeriodically("circles",function(){n.updateCircles(n,r,e,t)},1e4)})},function(e){i.find("#circles-map-message").html("(map not available)")})},updateCircles:function(e,t,n,r){t.fetch({success:function(){n.drawCircles(r,t.attributes)}})},beforeClose:function(){this.haSummaryView.close(),this.collection.off("reset",this.render),this.options.locations.off("reset",this.renderSummaries),t.invoke(this._appViews,"close"),this._appViews=null},render:function(){return this.renderSummaries(),this.renderCollection(),this.renderHighAvailabilitySummary(),this},renderSummaries:function(){this.$(".home-summaries-row").html(this.summariesView.render().el)},renderHighAvailabilitySummary:function(){this.haSummaryView||(this.haSummaryView=(new o({el:this.$("#ha-summary")})).render())},renderCollection:function(){var e=this.$("#applications-table-body").empty();this.collection==null?e.append("<tr><td colspan='3'><i>No data available</i></td></tr>"):this.collection.isEmpty()?e.append("<tr><td colspan='3'><i>No applications deployed</i></td></tr>"):this.collection.each(function(t){var n=new c.AppEntryView({model:t});this._appViews[t.cid]&&this._appViews[t.cid].close(),this._appViews[t.cid]=n,e.append(n.render().el)},this)},createApplication:function(){this._modal&&this._modal.close();var e=this;if(!(this.options.offline||this.options.cautionOverlay&&this.options.cautionOverlay.warningActive)){var t=new i({appRouter:this.options.appRouter});this._modal=t,this.$(".add-app #modal-container").html(t.render().el),this.$(".add-app #modal-container .modal").on("hidden",function(){t.close(),e.collection.fetch({reset:!0})}).modal("show")}},createLocation:function(){this._modal&&this._modal.close();var e=this;this.options.offline||this.options.cautionOverlay&&this.options.cautionOverlay.warningActive||(this._modal=new s({onLocationCreated:function(t,n){e.options.locations.fetch({reset:!0})},onFinish:function(t){e.$(".add-app #modal-container .modal").modal("hide")},isModal:!0}),this.$(".add-app #modal-container").html(this._modal.render().el),this.$(".add-app #modal-container .modal").on("hidden",function(){e._modal.close(),e.options.locations.fetch({reset:!0})}).modal("show"))},reloadBrooklynProperties:function(){var t=this;t.$("#reload-brooklyn-properties-indicator").show(),e.ajax({type:"POST",url:"/v1/server/properties/reload",contentType:"application/json",success:function(){console.log("reloaded brooklyn properties"),t.options.locations.fetch(),setTimeout(function(){t.$("#reload-brooklyn-properties-indicator").hide()},250)},error:function(e){t.$el.fadeTo(100,1).delay(200).fadeTo(200,.2).delay(200).fadeTo(200,1),t.$("#reload-brooklyn-properties-indicator").hide(),console.error("ERROR reloading brooklyn properties"),console.debug(e)}})},clearHaNodeRecords:function(){var t=this;t.$("#clear-ha-node-records-indicator").show(),e.ajax({type:"POST",url:"/v1/server/ha/states/clear",contentType:"application/json",success:function(){console.log("cleared HA node records"),t.haSummaryView.updateNow(),setTimeout(function(){t.$("#clear-ha-node-records-indicator").hide()},250)},error:function(e){t.$el.fadeTo(100,1).delay(200).fadeTo(200,.2).delay(200).fadeTo(200,1),t.$("#clear-ha-node-records-indicator").hide(),console.error("ERROR clearing HA nodes"),console.debug(e)}})}});return c.HomeSummariesView=n.View.extend({tagName:"div",template:t.template(f),render:function(){return this.$el.html(this.template({apps:this.options.applications,locations:this.options.locations})),this}}),c.AppEntryView=n.View.extend({tagName:"tr",template:t.template(l),initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return this.$el.html(this.template({cid:this.model.cid,link:this.model.getLinkByName("self"),name:this.model.getSpec().get("name"),status:this.model.get("status")})),this},beforeClose:function(){this.off("change",this.render),this.off("destroy",this.close)}}),c}),define("js-yaml-parser",["js-yaml"],function(e){function n(e,t,n){return{doc:e,parent:t,children:[],start:n.position}}function r(e,t){e.end=t.position,e.result=t.result,e.kind=t.kind}var t={};return t.parse=function(t){var i,s,o=function(e,o){if(e==="open")s=n(t,s,o);else if(e=="close"){r(s,o);if(s.parent)s.parent.children.push(s),s=s.parent;else{if(i!=null)throw"doc should have only one root node";i=s,s=null}}},u=e.safeLoad(t,{listener:o});return i},t}),define("brooklyn-yaml-completion-proposals",["backbone","js-yaml-parser","underscore"],function(e,r,i){function l(e,t){if(e.start<=t&&e.end>=t){for(var n in e.children){var r=e.children[n],i=l(r,t);if(i)return i}return e}return null}function c(e,t){if(!e||e.role)return;e.result===null?e.type="null":e.kind=="sequence"?(typeof e.result.length=="undefined"&&console.log("WARN: mismatch expected list but had no length",e),e.type="list"):e.kind=="mapping"?(typeof e.result.length!="undefined"&&console.log("WARN: mismatch expected map but had length",e),e.type="map"):(e.kind!="scalar"&&console.log("WARN: mismatch expected scalar/primitive",e),e.type="primitive");if(!e.parent)return e.role="root",e.depth=0,[e];var n=c(e.parent,t);e.depth=e.parent.depth+1,n.push(e);if(e.parent.type=="map"){var r;for(var i in e.parent.children){var s=e.parent.children[i];if(s===e||s.start>t)return e.role=i%2==0?"key":"value",e.index=(i-i%2)/2,e.role==="value"&&(e.key=r),n;r=s}throw console.log("not found",e,"in",e.parent.children),"did not find parse node in parent's children"}if(e.parent.type=="list"){e.role="entry";for(var i in e.children){var s=e.parent.children[i];if(s===e||s.start>t)return e.index=s,n}throw console.log("not found",e,"in",e.parent.children),"did not find parse node in parent's children"}return e.role="primitive",n}function h(e,t){return typeof e=="undefined"?null:t(e)?e:h(e.parent,t)}function p(e){return h(e,function(){return e.type==="map"})}function d(e){var t=e.start;while(t>0&&e.doc.charAt(t-1)!="\n")t--;return e.start-t}function v(e){var t="";while(e>0)t+=" ",e--;return t}var s={},o=e.Collection.extend({initialize:function(e,t){this.name=t.name;var n=this,r=this.model.extend({url:function(){return"/v1/"+n.name+"/"+this.id.split(":").join("/")}});i.bindAll(this),this.model=r},url:function(){return"/v1/"+this.name}}),u=new o(undefined,{name:"catalog/entities"}),a=new o(undefined,{name:"catalog/applications"}),f=new o(undefined,{name:"locations"});a.fetch(),u.fetch(),f.fetch();var m={getRootProposals:function(){return[{displayText:"brooklyn.catalog:",text:"brooklyn.catalog:\n  items:\n  - "}]},getProposals:function(e,t,n){var r=e[e.length-1],s=[],o;if(r.type=="list"&&r.key.result=="items")o=r.key;else if(r.type=e.length>2&&e[e.length-2].type=="list"&&e[e.length-2].key.result=="items")o=e[e.length-2].key;return o&&(s=s.concat(i.map(["id","name","itemType"],function(e){return{displayText:e,text:v(d(o)+2)+e+": "}})),s.push({displayText:"item",text:v(d(o)+2)+"item"+":\n"+v(d(r)+2)}),s=s.concat(i.map(["description","iconUrl"],function(e){return{displayText:e,text:v(d(o)+2)+e+": "}})),s.push({displayText:"items",text:v(d(o)+2)+"items"+":\n"+v(d(r))+"- "})),r.key&&r.key.result=="itemType"&&s.concat(["template","entity","location","policy"]),(r.depth==1||r.depth>1&&n.ch==0)&&s.concat([{displayText:"version",text:"  version:\n"},{displayText:"items",text:"  items:\n  - \n"}]),s}},g={getRootProposals:function(e){var t=[];if(!e||!e.name)t=t.concat({displayText:"name:",text:"name: "});if(!e||!e.services)t=t.concat({displayText:"services:",text:"services:\n- type: "});if(!e||!e.location&&!e.locations)t=t.concat({displayText:"location:",text:"location:\n  "});return t},getServiceTypes:function(e){var t=[];return u.fetch(),a.fetch(),t=t.concat(i.map(u.models,function(e){return e.get("symbolicName")})),t=t.concat(i.map(a.models,function(e){return e.get("symbolicName")})),t},getServiceKeys:function(e){return t=a.get(e)||u.get(e)||i.find(a.models,function(t){return t.get("symbolicName")==e})||i.find(u.models,function(t){return t.get("symbolicName")==e}),t?i.map(t.get("config"),function(e){return e.name}):[]},getServiceKeyProposals:function(e,n){t=a.get(e)||u.get(e)||i.find(a.models,function(t){return t.get("symbolicName")==e})||i.find(u.models,function(t){return t.get("symbolicName")==e});if(!t)return[];var r=i.find(t.get("config"),function(e){return e.name==n});if(!r)return[];var s=r.type;if(s.startsWith("java.lang.")||s.startsWith("java.util."))s=s.substring(10);var o=[{displayText:s+": "+r.description,text:"",className:"summary"}];return r.possibleValues&&i.each(r.possibleValues,function(e){o.push(e.value)}),o},getLocationTypes:function(){return f.fetch(),i.map(f.models,function(e){return e.get("name")})},getProposals:function(e,t,n){var r=e[e.length-1],s=[];while(r.role==="primitive")r=r.parent;var o;e[1].key&&(o=t<=e[1].end?e[1].doc.substring(t,e[1].end):e[1].doc.substring(e[1].end,t),o=o.trim());if(e[1].key&&e[1].key.result==="services"){var u=!0;if(r.depth==3&&r.role=="value"&&r.parent.role=="entry"){u=!1;if(r.key.result==="type")s=s.concat(i.map(this.getServiceTypes(r.parent),function(e){return e+"\n"}));else if(r.key.result==="location")s=s.concat(i.map(this.getLocationTypes(r.parent),function(e){return e+"\n"}));else{var a=e[2].result.type;s=s.concat(this.getServiceKeyProposals(a,r.key.result)||[{displayText:"No assistance available for key",className:"summary",text:""}])}}if(r.depth>=2&&r.role=="entry"&&e[2].result.type){var a=e[2].result.type;s=s.concat(i.map(this.getServiceKeys(a),function(t){return{displayText:t,text:v(d(e[2]))+t+": "}}))}r.depth>2,u&&o.length==0&&s.push({displayText:"Add a service",className:"summary",text:"\n- type: "})}return e[1].key&&e[1].key.result==="location"&&r.depth<=2&&(s=s.concat(i.map(this.getLocationTypes(r.parent),function(e){return e+"\n"}))),n.ch==0&&o&&o.length==0&&(s=s.concat(this.getRootProposals(e[0]?e[0].result:null))),s}};return s.getCompletionProposals=function(e,t){var s=e==="catalog"?m:g,o=t.getValue(),u=t.getCursor(),a=t.getRange({line:0,ch:0},u).length,f;try{f=r.parse(o);if(typeof f.result=="string")throw"primitive not supported, parse as empty and let completion apply"}catch(h){try{f=r.parse(o.substring(0,o.length-u.ch)+v(u.ch))}catch(h){return console.log("parse failed",h),[]}}try{var p;if(typeof f=="undefined")p=s.getRootProposals();else{n=l(f,a);if(!n)console.log("no parse node containing curpos"),p=s.getRootProposals();else{var d=c(n,a);n.role==="root"?p=s.getRootProposals(n.result):p=s.getProposals(d,a,u)}}var y="",b="",w=0;while(a>y.length){var E=o.charAt(a-y.length-1);if(E=="\n"||E==" "||E=="	")break;y=""+E+y}while(a>b.length){var E=o.charAt(a-b.length-1);if(E=="\n")break;b=""+E+b}return p=i.compact(i.map(p,function(e){var t;typeof e=="object"?(t=e,e=t.text):t={text:e,displayText:e};if(e[0]==" "){if(e.lastIndexOf(b,0)!=0){var n=e.replace(/( *)  /,"$1- ");if(n.lastIndexOf(b,0)!=0)return null;t.text=n}t.to=u,t.from={line:u.line,ch:0}}else{if(e.lastIndexOf(y,0)!=0)return null;t.to=u,t.from={line:u.line,ch:u.ch-y.length}}return t})),p}catch(h){return console.log("completion failed",h,h.stack),[]}},s}),define("text!tpl/editor/page.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div id="catalog-resource">\n    <div class="row row-fluid">\n        <div class="span12 composer" id="composer">\n            <div class="navbar_top">\n                <h3 style="margin-top: 6px;">Blueprint Composer</h3>\n                <div class="apps-tree-toolbar btn-toolbar" style="margin-top: -24px !important;">\n                    <span class="btn-group">\n                    <button id="button-example" class="btn btn-sm fa fa-file-text-o" title="Insert Example"></button>\n                    </span>\n                    \n                    <span class="btn-group">\n                    <button id="button-docs" class="btn btn-sm fa fa-book" title="Open Brooklyn Website Documentation"></button>\n                    </span>\n                    \n                    <!-- no need for this\n                    <span class="btn-group">\n                    <button id="button-delete" class="btn btn-danger btn-sm">Clear</button>\n                    </span>\n                    -->\n                    \n                    <span class="btn-group" role="group">\n                        <button id="button-switch-app" class="btn btn-sm">Application</button>\n                        <button id="button-switch-catalog" class="btn btn-sm">Catalog</button>\n                    </span>\n                    \n                    <!-- text will be changed by JS -->\n                    <span class="btn-group" style="width: 12em;">\n                            <button id="button-run" class="btn btn-success btn-sm" style="margin-left: 24px; float: right;">Go</button>\n                    </span>\n                </div>\n            </div>\n            <div class="error-message label-message hide">\n                <div class="label-important">ERROR</div>\n                <span class="error-message-text"></span>\n            </div>\n            <div class="navbar_main_wrapper">\n                <div class="navbar_main">\n                    <div class="composer-editor">\n                        <div class="composer-toolbar">\n                            <!-- the toolbar -->\n                        </div>\n                        <textarea id="yaml_code" mode="yaml" class="code-textarea" style="height:760px; width:98%"></textarea>\n                    </div>\n                    <div class="composer-editor-loading hide"><span>Loading item...</span></div>\n                </div>\n            </div>\n            <div class="navbar_main_wrapper" style="background-color: #f0f0f0 !important;">\n                <div class="apps-tree-toolbar btn-toolbar" style="margin: 9px 12px 6px 12px !important; float: none;">\n                    <span class="btn-group" style="float: left;">\n                        <button id="button-delete" class="btn btn-danger btn-sm">Clear</button>\n                    </span>\n                    \n                    <!-- text will be changed by JS -->\n                    <span class="btn-group" style="width: 12em;">\n                            <button id="button-run" class="btn btn-success btn-sm" style="margin-left: 24px; float: right;">Go</button>\n                    </span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("text!tpl/editor/location-alert.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div id="location-alert">\n    <div class="row row-fluid">\n        <div class="span12">\n            <div class="alert alert-block fade in">\n                <button type="button" class="close" data-dismiss="alert">&times;</button>\n                <p><strong>Warning!</strong> There is no location defined yet. You should create one before deploying a blueprint</p>\n                <p><button class="btn btn-warning add-location">Create a location</button></p>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="modal-location add-app">\n    <div id="modal-container"></div>\n</div>'}),function(e){e.fn.slideto=function(t){return t=_.extend({highlight:!0,slide_duration:"slow",highlight_duration:3e3,highlight_color:"#FFFF99"},t),this.each(function(){$target=e(this),e("body").animate({scrollTop:$target.offset().top},t.slide_duration,function(){t.highlight&&e.ui.version&&$target.effect("highlight",{color:t.highlight_color},t.highlight_duration)})})}}(jQuery),define("jquery-slideto",["jquery"],function(){}),jQuery.fn.wiggle=function(e){var t={speed:50,wiggles:3,travel:5,callback:null},e=jQuery.extend(t,e);return this.each(function(){var t=this,n=jQuery(this).wrap('<div class="wiggle-wrap"></div>').css("position","relative"),r=0;for(i=1;i<=e.wiggles;i++)jQuery(this).animate({left:"-="+e.travel},e.speed).animate({left:"+="+e.travel*2},e.speed*2).animate({left:"-="+e.travel},e.speed,function(){r++,jQuery(t).parent().hasClass("wiggle-wrap")&&jQuery(t).parent().replaceWith(t),r==e.wiggles&&jQuery.isFunction(e.callback)&&e.callback()})})},define("jquery-wiggle",["jquery"],function(){}),function(e,t){function N(e){return typeof e=="string"}function C(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}}function k(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}function L(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function A(r,o,a,f,l){var c,h,p,d,g;return f!==n?(p=a.match(r?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),g=p[3]||"",l===2&&N(f)?h=f.replace(r?S:E,""):(d=u(p[2]),f=N(f)?u[r?m:v](f):f,h=l===2?f:l===1?e.extend({},f,d):e.extend({},d,f),h=s(h),r&&(h=h.replace(x,i))),c=p[1]+(r?"#":h||!p[1]?"?":"")+h+g):c=o(a!==n?a:t[y][b]),c}function O(e,t,r){return t===n||typeof t=="boolean"?(r=t,t=s[e?m:v]()):t=N(t)?t.replace(e?S:E,""):t,u(t,r)}function M(t,r,i,o){return!N(i)&&typeof i!="object"&&(o=i,i=r,r=n),this.each(function(){var n=e(this),u=r||h()[(this.nodeName||"").toLowerCase()]||"",a=u&&n.attr(u)||"";n.attr(u,s[t](a,i,o))})}var n,r=Array.prototype.slice,i=decodeURIComponent,s=e.param,o,u,a,f=e.bbq=e.bbq||{},l,c,h,p=e.event.special,d="hashchange",v="querystring",m="fragment",g="elemUrlAttr",y="location",b="href",w="src",E=/^.*\?|#.*$/g,S=/^.*\#/,x,T={};s[v]=C(A,0,L),s[m]=o=C(A,1,k),o.noEscape=function(t){t=t||"";var n=e.map(t.split(""),encodeURIComponent);x=new RegExp(n.join("|"),"g")},o.noEscape(",/"),e.deparam=u=function(t,r){var s={},o={"true":!0,"false":!1,"null":null};return e.each(t.replace(/\+/g," ").split("&"),function(t,u){var a=u.split("="),f=i(a[0]),l,c=s,h=0,p=f.split("]["),d=p.length-1;/\[/.test(p[0])&&/\]$/.test(p[d])?(p[d]=p[d].replace(/\]$/,""),p=p.shift().split("[").concat(p),d=p.length-1):d=0;if(a.length===2){l=i(a[1]),r&&(l=l&&!isNaN(l)?+l:l==="undefined"?n:o[l]!==n?o[l]:l);if(d)for(;h<=d;h++)f=p[h]===""?c.length:p[h],c=c[f]=h<d?c[f]||(p[h+1]&&isNaN(p[h+1])?{}:[]):l;else e.isArray(s[f])?s[f].push(l):s[f]!==n?s[f]=[s[f],l]:s[f]=l}else f&&(s[f]=r?n:"")}),s},u[v]=C(O,0),u[m]=a=C(O,1),e[g]||(e[g]=function(t){return e.extend(T,t)})({a:b,base:b,iframe:w,img:w,input:w,form:"action",link:b,script:w}),h=e[g],e.fn[v]=C(M,v),e.fn[m]=C(M,m),f.pushState=l=function(e,r){N(e)&&/^#/.test(e)&&r===n&&(r=2);var i=e!==n,s=o(t[y][b],i?e:{},i?r:2);t[y][b]=s+(/#/.test(s)?"":"#")},f.getState=c=function(e,t){return e===n||typeof e=="boolean"?a(e):a(t)[e]},f.removeState=function(t){var r={};t!==n&&(r=c(),e.each(e.isArray(t)?t:arguments,function(e,t){delete r[t]})),l(r,2)},p[d]=e.extend(p[d],{add:function(t){function i(e){var t=e[m]=o();e.getState=function(e,r){return e===n||typeof e=="boolean"?u(t,e):u(t,r)[e]},r.apply(this,arguments)}var r;if(e.isFunction(t))return r=t,i;r=t.handler,t.handler=i}})}(jQuery,this),function(e,t,n){function h(e){return e=e||t[s][u],e.replace(/^[^#]*#?(.*)$/,"$1")}var r,i=e.event.special,s="location",o="hashchange",u="href",a=e.browser,f=document.documentMode,l=a.msie&&(f===n||f<8),c="on"+o in t&&!l;e[o+"Delay"]=100,i[o]=e.extend(i[o],{setup:function(){if(c)return!1;e(r.start)},teardown:function(){if(c)return!1;e(r.stop)}}),r=function(){function c(){a=f=function(e){return e},l&&(i=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,f=function(){return h(i.document[s][u])},a=function(e,t){if(e!==t){var n=i.document;n.open().close(),n[s].hash="#"+e}},a(h()))}var n={},r,i,a,f;return n.start=function(){if(r)return;var n=h();a||c(),function i(){var l=h(),c=f(n);l!==n?(a(n=l,c),e(t).trigger(o)):c!==n&&(t[s][u]=t[s][u].replace(/#.*/,"")+"#"+c),r=setTimeout(i,e[o+"Delay"])}()},n.stop=function(){i||(r&&clearTimeout(r),r=0)},n}()}(jQuery,this),define("jquery-ba-bbq",["jquery"],function(){}),this.Handlebars={},function(e){e.VERSION="1.0.rc.1",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";e.registerHelper("blockHelperMissing",function(r,i){var s=i.inverse||function(){},o=i.fn,u="",a=t.call(r);return a===n&&(r=r.call(this)),r===!0?o(this):r===!1||r==null?s(this):a==="[object Array]"?r.length>0?e.helpers.each(r,i):s(this):o(r)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var n=new e.K;return e.K.prototype=null,n},e.registerHelper("each",function(t,n){var r=n.fn,i=n.inverse,s="",o;n.data&&(o=e.createFrame(n.data));if(t&&t.length>0)for(var u=0,a=t.length;u<a;u++)o&&(o.index=u),s+=r(t[u],{data:o});else s=i(this);return s}),e.registerHelper("if",function(r,i){var s=t.call(r);return s===n&&(r=r.call(this)),!r||e.Utils.isEmpty(r)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){var r=n.fn,i=n.inverse;return n.fn=i,n.inverse=r,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)})}(this.Handlebars);var handlebars=function(){function n(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,DATA:27,param:28,STRING:29,INTEGER:30,BOOLEAN:31,hashSegments:32,hashSegment:33,ID:34,EQUALS:35,pathSegments:36,SEP:37,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",27:"DATA",29:"STRING",30:"INTEGER",31:"BOOLEAN",34:"ID",35:"EQUALS",37:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[17,1],[25,2],[25,1],[28,1],[28,1],[28,1],[28,1],[28,1],[26,1],[32,2],[32,1],[33,3],[33,3],[33,3],[33,3],[33,3],[21,1],[36,3],[36,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=new i.ProgramNode(o[a-2],o[a]);break;case 3:this.$=new i.ProgramNode(o[a]);break;case 4:this.$=new i.ProgramNode([]);break;case 5:this.$=[o[a]];break;case 6:o[a-1].push(o[a]),this.$=o[a-1];break;case 7:this.$=new i.BlockNode(o[a-2],o[a-1].inverse,o[a-1],o[a]);break;case 8:this.$=new i.BlockNode(o[a-2],o[a-1],o[a-1].inverse,o[a]);break;case 9:this.$=o[a];break;case 10:this.$=o[a];break;case 11:this.$=new i.ContentNode(o[a]);break;case 12:this.$=new i.CommentNode(o[a]);break;case 13:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 14:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 15:this.$=o[a-1];break;case 16:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 17:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],!0);break;case 18:this.$=new i.PartialNode(o[a-1]);break;case 19:this.$=new i.PartialNode(o[a-2],o[a-1]);break;case 20:break;case 21:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 22:this.$=[[o[a-1]].concat(o[a]),null];break;case 23:this.$=[[o[a-1]],o[a]];break;case 24:this.$=[[o[a]],null];break;case 25:this.$=[[new i.DataNode(o[a])],null];break;case 26:o[a-1].push(o[a]),this.$=o[a-1];break;case 27:this.$=[o[a]];break;case 28:this.$=o[a];break;case 29:this.$=new i.StringNode(o[a]);break;case 30:this.$=new i.IntegerNode(o[a]);break;case 31:this.$=new i.BooleanNode(o[a]);break;case 32:this.$=new i.DataNode(o[a]);break;case 33:this.$=new i.HashNode(o[a]);break;case 34:o[a-1].push(o[a]),this.$=o[a-1];break;case 35:this.$=[o[a]];break;case 36:this.$=[o[a-2],o[a]];break;case 37:this.$=[o[a-2],new i.StringNode(o[a])];break;case 38:this.$=[o[a-2],new i.IntegerNode(o[a])];break;case 39:this.$=[o[a-2],new i.BooleanNode(o[a])];break;case 40:this.$=[o[a-2],new i.DataNode(o[a])];break;case 41:this.$=new i.IdNode(o[a]);break;case 42:o[a-2].push(o[a]),this.$=o[a-2];break;case 43:this.$=[o[a]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,27:[1,24],34:[1,26],36:25},{17:27,21:23,27:[1,24],34:[1,26],36:25},{17:28,21:23,27:[1,24],34:[1,26],36:25},{17:29,21:23,27:[1,24],34:[1,26],36:25},{21:30,34:[1,26],36:25},{1:[2,1]},{6:31,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,32],21:23,27:[1,24],34:[1,26],36:25},{10:33,20:[1,34]},{10:35,20:[1,34]},{18:[1,36]},{18:[2,24],21:41,25:37,26:38,27:[1,45],28:39,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,25]},{18:[2,41],27:[2,41],29:[2,41],30:[2,41],31:[2,41],34:[2,41],37:[1,48]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],37:[2,43]},{18:[1,49]},{18:[1,50]},{18:[1,51]},{18:[1,52],21:53,34:[1,26],36:25},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:54,34:[1,26],36:25},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:41,26:55,27:[1,45],28:56,29:[1,42],30:[1,43],31:[1,44],32:40,33:46,34:[1,47],36:25},{18:[2,23]},{18:[2,27],27:[2,27],29:[2,27],30:[2,27],31:[2,27],34:[2,27]},{18:[2,33],33:57,34:[1,58]},{18:[2,28],27:[2,28],29:[2,28],30:[2,28],31:[2,28],34:[2,28]},{18:[2,29],27:[2,29],29:[2,29],30:[2,29],31:[2,29],34:[2,29]},{18:[2,30],27:[2,30],29:[2,30],30:[2,30],31:[2,30],34:[2,30]},{18:[2,31],27:[2,31],29:[2,31],30:[2,31],31:[2,31],34:[2,31]},{18:[2,32],27:[2,32],29:[2,32],30:[2,32],31:[2,32],34:[2,32]},{18:[2,35],34:[2,35]},{18:[2,43],27:[2,43],29:[2,43],30:[2,43],31:[2,43],34:[2,43],35:[1,59],37:[2,43]},{34:[1,60]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,61]},{18:[1,62]},{18:[2,21]},{18:[2,26],27:[2,26],29:[2,26],30:[2,26],31:[2,26],34:[2,26]},{18:[2,34],34:[2,34]},{35:[1,59]},{21:63,27:[1,67],29:[1,64],30:[1,65],31:[1,66],34:[1,26],36:25},{18:[2,42],27:[2,42],29:[2,42],30:[2,42],31:[2,42],34:[2,42],37:[2,42]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,36],34:[2,36]},{18:[2,37],34:[2,37]},{18:[2,38],34:[2,38]},{18:[2,39],34:[2,39]},{18:[2,40],34:[2,40]}],defaultActions:{16:[2,1],24:[2,25],38:[2,23],55:[2,21]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:n.yytext.slice(-1)!=="\\"&&this.begin("mu"),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1),this.begin("emu"));if(n.yytext)return 14;break;case 1:return 14;case 2:return n.yytext.slice(-1)!=="\\"&&this.popState(),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1)),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return n.yytext=n.yytext.substr(3,n.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 35;case 13:return 34;case 14:return 34;case 15:return 37;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\"/g,'"'),29;case 20:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\"/g,'"'),29;case 21:return n.yytext=n.yytext.substr(1),27;case 22:return 31;case 23:return 31;case 24:return 30;case 25:return 34;case 26:return n.yytext=n.yytext.substr(1,n.yyleng-2),34;case 27:return"INVALID";case 28:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,28],inclusive:!0}},e}();return e.lexer=t,n.prototype=e,e.Parser=n,new n}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=handlebars,exports.Parser=handlebars.Parser,exports.parse=function(){return handlebars.parse.apply(handlebars,arguments)},exports.main=function(t){if(!t[1])throw new Error("Usage: "+t[0]+" FILE");var n,r;return typeof process!="undefined"?n=require("fs").readFileSync(require("path").resolve(t[1]),"utf8"):n=require("file").path(require("file").cwd()).join(t[1]).read({charset:"utf-8"}),exports.parser.parse(n)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args)),Handlebars.Parser=handlebars,Handlebars.parse=function(e){return Handlebars.Parser.yy=Handlebars.AST,Handlebars.Parser.parse(e)},Handlebars.print=function(e){return(new Handlebars.PrintVisitor).accept(e)},Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){}},Handlebars.log=function(e,t){Handlebars.logger.log(e,t)},function(){Handlebars.AST={},Handlebars.AST.ProgramNode=function(e,t){this.type="program",this.statements=e,t&&(this.inverse=new Handlebars.AST.ProgramNode(t))},Handlebars.AST.MustacheNode=function(e,t,n){this.type="mustache",this.escaped=!n,this.hash=t;var r=this.id=e[0],i=this.params=e.slice(1),s=this.eligibleHelper=r.isSimple;this.isHelper=s&&(i.length||t)},Handlebars.AST.PartialNode=function(e,t){this.type="partial",this.id=e,this.context=t};var e=function(e,t){if(e.original!==t.original)throw new Handlebars.Exception(e.original+" doesn't match "+t.original)};Handlebars.AST.BlockNode=function(t,n,r,i){e(t.id,i),this.type="block",this.mustache=t,this.program=n,this.inverse=r,this.inverse&&!this.program&&(this.isInverse=!0)},Handlebars.AST.ContentNode=function(e){this.type="content",this.string=e},Handlebars.AST.HashNode=function(e){this.type="hash",this.pairs=e},Handlebars.AST.IdNode=function(e){this.type="ID",this.original=e.join(".");var t=[],n=0;for(var r=0,i=e.length;r<i;r++){var s=e[r];s===".."?n++:s==="."||s==="this"?this.isScoped=!0:t.push(s)}this.parts=t,this.string=t.join("."),this.depth=n,this.isSimple=e.length===1&&!this.isScoped&&n===0},Handlebars.AST.DataNode=function(e){this.type="DATA",this.id=e},Handlebars.AST.StringNode=function(e){this.type="STRING",this.string=e},Handlebars.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e},Handlebars.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e},Handlebars.AST.CommentNode=function(e){this.type="comment",this.comment=e}}(),Handlebars.Exception=function(e){var t=Error.prototype.constructor.apply(this,arguments);for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);this.message=t.message},Handlebars.Exception.prototype=new Error,Handlebars.SafeString=function(e){this.string=e},Handlebars.SafeString.prototype.toString=function(){return this.string.toString()},function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},t=/[&<>"'`]/g,n=/[&<>"'`]/,r=function(t){return e[t]||"&amp;"};Handlebars.Utils={escapeExpression:function(e){return e instanceof Handlebars.SafeString?e.toString():e==null||e===!1?"":n.test(e)?e.replace(t,r):e},isEmpty:function(e){return typeof e=="undefined"?!0:e===null?!0:e===!1?!0:Object.prototype.toString.call(e)==="[object Array]"&&e.length===0?!0:!1}}}(),Handlebars.Compiler=function(){},Handlebars.JavaScriptCompiler=function(){},function(e,t){e.prototype={compiler:e,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t=e.statements,n;this.opcodes=[];for(var r=0,i=t.length;r<i;r++)n=t[r],this[n.type](n);return this.isSimple=i===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=this.classifyMustache(t);i==="helper"?this.helperMustache(t,n,r):i==="simple"?(this.simpleMustache(t),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("pushLiteral","{}"),this.opcode("blockValue")):(this.ambiguousMustache(t,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("pushLiteral","{}"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("push","{}");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.accept(r),this.opcode("assignToHash",n[0])},partial:function(e){var t=e.id;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.original),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,n=this.classifyMustache(e);n==="simple"?this.simpleMustache(e):n==="helper"?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,n){var r=e.id,i=r.parts[0];this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i)},simpleMustache:function(e,t,n){var r=e.id;r.type==="DATA"?this.DATA(r):r.parts.length?this.ID(r):(this.addDepth(r.depth),this.opcode("getContext",r.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,n){var r=this.setupFullMustacheParams(e,t,n),i=e.id.parts[0];if(this.options.knownHelpers[i])this.opcode("invokeKnownHelper",r.length,i);else{if(this.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+i);this.opcode("invokeHelper",r.length,i)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id)},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifyMustache:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.string)):this[n.type](n)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),t},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("pushLiteral","{}"),r}};var n=function(e){this.value=e};t.prototype={nameLookup:function(e,n,r){return/^[0-9]+$/.test(n)?e+"["+n+"]":t.isValidJavaScriptVariableName(n)?e+"."+n:e+"['"+n+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":"buffer += "+e+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t||{},Handlebars.log(Handlebars.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.compileChildren(e,t);var i=e.opcodes,s;this.i=0;for(o=i.length;this.i<o;this.i++)s=i[this.i],s.opcode==="DECLARE"?this[s.name]=s.value:this[s.opcode].apply(this,s.args);return this.createFunctionContext(r)},nextOpcode:function(){var e=this.environment.opcodes,t=e[this.i+1];return e[this.i+1]},eat:function(e){this.i=this.i+1},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(n=n+" partials = partials || "+t+".partials;"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", "));if(!this.isChild){var n=[];for(var r in this.context.aliases)this.source[1]=this.source[1]+", "+r+"="+this.context.aliases[r]}this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");var i=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var s=0,o=this.environment.depths.list.length;s<o;s++)i.push("depth"+this.environment.depths.list[s]);if(e)return i.push(this.source.join("\n  ")),Function.apply(this,i);var u="function "+(this.name||"")+"("+i.join(",")+") {\n  "+this.source.join("\n  ")+"}";return Handlebars.log(Handlebars.logger.DEBUG,u+"\n\n"),u},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),t+" = blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var e=this.nextOpcode(),t="";this.context.aliases.escapeExpression="this.escapeExpression",e&&e.opcode==="appendContent"&&(t=" + "+this.quotedString(e.args[0]),this.eat(e)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+t))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.pushStack(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+"() : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.pushStack(this.nameLookup("data",e,"data"))},pushStringParam:function(e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e)},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){this.pushStack(e)},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var n=this.lastHelper=this.setupHelper(e,t);this.register("foundHelper",n.name),this.pushStack("foundHelper ? foundHelper.call("+n.callParams+") "+": helperMissing.call("+n.helperMissingParams+")")},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.pushStack(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var t=this.setupHelper(0,e),n=this.lastHelper=this.nameLookup("helpers",e,"helper");this.register("foundHelper",n);var r=this.nameLookup("depth"+this.lastContext,e,"context"),i=this.nextStack();this.source.push("if (foundHelper) { "+i+" = foundHelper.call("+t.callParams+"); }"),this.source.push("else { "+i+" = "+r+"; "+i+" = typeof "+i+" === functionType ? "+i+"() : "+i+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.pushStack("self.invokePartial("+t.join(", ")+");")},assignToHash:function(e){var t=this.popStack(),n=this.topStack();this.source.push(n+"['"+e+"'] = "+t+";")},compiler:t,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler,this.context.programs.push("");var u=this.context.programs.length;r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context)}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return n.length===0?"self.program("+i.join(", ")+")":(i.shift(),"self.programWithDepth("+i.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.compileStack.push(new n(e)),e},pushStack:function(e){return this.source.push(this.incrStack()+" = "+e+";"),this.compileStack.push("stack"+this.stackSlot),"stack"+this.stackSlot},replaceStack:function(e){var t=e.call(this,this.topStack());return this.source.push(this.topStack()+" = "+t+";"),"stack"+this.stackSlot},nextStack:function(e){var t=this.incrStack();return this.compileStack.push("stack"+this.stackSlot),t},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){var e=this.compileStack.pop();return e instanceof n?e.value:(this.stackSlot--,e)},topStack:function(){var e=this.compileStack[this.compileStack.length-1];return e instanceof n?e.value:e},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(e,t){var n=[];this.setupParams(e,n);var r=this.nameLookup("helpers",t,"helper");return{params:n,name:r,callParams:["depth0"].concat(n).join(", "),helperMissingParams:["depth0",this.quotedString(t)].concat(n).join(", ")}},setupParams:function(e,t){var n=[],r=[],i,s,o;n.push("hash:"+this.popStack()),s=this.popStack(),o=this.popStack();if(o||s)o||(this.context.aliases.self="this",o="self.noop"),s||(this.context.aliases.self="this",s="self.noop"),n.push("inverse:"+s),n.push("fn:"+o);for(var u=0;u<e;u++)i=this.popStack(),t.push(i),this.options.stringParams&&r.push(this.popStack());return this.options.stringParams&&n.push("contexts:["+r.join(",")+"]"),this.options.data&&n.push("data:data"),t.push("{"+n.join(",")+"}"),t.join(", ")}};var r="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),i=t.RESERVED_WORDS={};for(var s=0,o=r.length;s<o;s++)i[r[s]]=!0;t.isValidJavaScriptVariableName=function(e){return!t.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1}}(Handlebars.Compiler,Handlebars.JavaScriptCompiler),Handlebars.precompile=function(e,t){t=t||{};var n=Handlebars.parse(e),r=(new Handlebars.Compiler).compile(n,t);return(new Handlebars.JavaScriptCompiler).compile(r,t)},Handlebars.compile=function(e,t){function r(){var n=Handlebars.parse(e),r=(new Handlebars.Compiler).compile(n,t),i=(new Handlebars.JavaScriptCompiler).compile(r,t,undefined,!0);return Handlebars.template(i)}t=t||{};var n;return function(e,t){return n||(n=r()),n.call(this,e,t)}},Handlebars.VM={template:function(e){var t={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(e,t,n){var r=this.programs[e];return n?Handlebars.VM.program(t,n):r?r:(r=this.programs[e]=Handlebars.VM.program(t),r)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(n,r){return r=r||{},e.call(t,Handlebars,n,r.helpers,r.partials,r.data)}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,2);return function(n,i){return i=i||{},e.apply(this,[n,i.data||t].concat(r))}},program:function(e,t){return function(n,r){return r=r||{},e(n,r.data||t)}},noop:function(){return""},invokePartial:function(e,t,n,r,i,s){var o={helpers:r,partials:i,data:s};if(e===undefined)throw new Handlebars.Exception("The partial "+t+" could not be found");if(e instanceof Function)return e(n,o);if(!Handlebars.compile)throw new Handlebars.Exception("The partial "+t+" could not be compiled when running in runtime-only mode");return i[t]=Handlebars.compile(e,{data:s!==undefined}),i[t](n,o)}},Handlebars.template=Handlebars.VM.template,define("handlebars",["jquery"],function(){}),define("view/editor",["underscore","jquery","backbone","model/catalog-application","model/location","view/location-wizard","view/viewutils","js-yaml","brooklyn-yaml-completion-proposals","codemirror","text!tpl/editor/page.html","text!tpl/editor/location-alert.html","jquery-slideto","jquery-wiggle","jquery-ba-bbq","handlebars","bootstrap"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h="name: Sample Blueprint\ndescription: runs `sleep` for sixty seconds then stops triggering ON_FIRE in Brooklyn\nlocation: localhost\nservices:\n- type: org.apache.brooklyn.entity.software.base.VanillaSoftwareProcess\n  launch.command: |\n    echo hello world\n    nohup sleep 60 &\n    echo $! > ${PID_FILE:-pid.txt}\n",p="brooklyn.catalog:\n  version: 0.0.1\n  items:\n  - id: example\n    description: This is an example catalog application\n    itemType: template\n    item:\n      name: Sample Blueprint Template\n      services:\n      - type: <your service here>\n      location: <your cloud here>\n",d="app",v="catalog",m=n.View.extend({tagName:"div",className:"container container-fluid",events:{"click #button-run":"runBlueprint","click #button-delete":"removeBlueprint","click #button-switch-app":"switchModeApp","click #button-switch-catalog":"switchModeCatalog","click #button-example":"populateExampleBlueprint","click #button-docs":"openDocumentation","click .add-location":"createLocation"},editorTemplate:e.template(l),editor:null,initialize:function(){!this.options.type||this.options.type===d?this.setMode(d):this.options.type===v?this.setMode(v):(console.log("unknown mode '"+this.options.type+"'; using '"+d+"'"),this.setMode(d)),this.options.catalog=new r.Collection,this.options.locations.on("reset",this.renderLocationAlert,this),o.fetchRepeatedlyWithDelay(this,this.options.locations,{fetchOptions:{reset:!0},doitnow:!0})},setMode:function(e){if(this.mode===e)return;this.mode=e,this.refresh()},beforeClose:function(){this.options.locations.off("reset",this.renderLocationAlert)},render:function(t){this.$el.append(e.template(c,{locations:this.options.locations})).append(e.template(l)).find("#location-alert").hide(),this.loadEditor(),this.refresh();var n=this;return setTimeout(function(){n.initializeEditor()},10),this},renderLocationAlert:function(e){e.size()===0?this.$("#location-alert").show():this.$("#location-alert").hide()},refresh:function(){t("#button-run",this.$el).html(this.mode==v?"Add to Catalog":"Deploy"),this.mode==v?(t("#button-switch-catalog",this.$el).addClass("active"),t("#button-switch-app",this.$el).removeClass("active")):(t("#button-switch-app",this.$el).addClass("active"),t("#button-switch-catalog",this.$el).removeClass("active")),this.refreshOnMinorChange()},refreshOnMinorChange:function(){var e=this.editor&&this.editor.getValue(),n=this.parse();e?(t("#button-run",this.$el).attr("disabled",!1),t("#button-delete",this.$el).attr("disabled",!1),t("#button-example",this.$el).hide()):(t("#button-run",this.$el).attr("disabled","disabled"),t("#button-delete",this.$el).attr("disabled","disabled"),t("#button-example",this.$el).show())},initializeEditor:function(){var e=this,n=this.editor,r=this.$(".composer-editor-loading");if(typeof n!="undefined"){var i="";this.options.typeId==="_"?i=this.options.content:(this.options.content&&console.log("ignoring content when typeId is not _; given:",this.options.type,this.options.typeId,this.options.content),this.options.typeId&&(n.setOption("readOnly","nocursor"),r.show(),this.options.catalog.fetch({data:t.param({allVersions:!0}),success:function(){var t=e.options.catalog.getId(e.options.typeId),r="# unknown type - this is an example blueprint that would reference it\nservices:\n- type: "+e.options.typeId+"\n";t&&(r=t.attributes.planYaml),n.getDoc().setValue(r)},error:function(){e.showFailure("Could not load the item: "+e.options.typeId)}}).done(function(){n.setOption("readOnly",!1),n.refresh(),r.fadeOut()}))),n.getDoc().setValue(i),!i,n.refresh()}},loadEditor:function(){if(this.editor==null){this.editor=f.fromTextArea(this.$("#yaml_code")[0],{lineNumbers:!0,viewportMargin:Infinity,extraKeys:{"Ctrl-Space":"autocomplete"},mode:{name:"yaml",globalVars:!0},hintOptions:{completeSingle:!1},placeholder:"How to use it?\n- Enter blueprint yaml here\n- Drag & drop text files here\n\nPress Ctrl+Space for completion."});var e=f.hint.yaml,t=this;f.hint.yaml=function(e){var n={from:e.getCursor(),to:e.getCursor(),list:[]};return n.list=a.getCompletionProposals(t.mode,e),n.list||(n=f.hint.anyword(e)),n};var t=this;this.editor.on("changes",function(e,n){t.refreshOnMinorChange()})}},parse:function(e){if(!e&&this.lastParse&&this.lastParse.input===this.editor.getValue())return this.lastParse;if(!this.editor)this.lastParse={problem:"no editor yet"};else{this.lastParse={input:this.editor.getValue()};try{this.lastParse.result=u.safeLoad(this.editor.getValue())}catch(t){this.lastParse.problem=t}}return this.lastParse},validate:function(){var e=this.editor.getValue();try{var t=this.parse(!0);if(t.problem)throw t.problem;if(this.mode!=v&&t.result["brooklyn.catalog"]&&!t.result.services)throw console.log("This document is using brooklyn.catalog syntax but you are attempting to deploy it."),"This document is using brooklyn.catalog syntax but you are attempting to deploy it.";return!0}catch(n){return this.showFailure(n.message||n),!1}},convertBlueprintToCatalog:function(){if(this.mode===d&&this.lastParse&&!this.lastParse.problems&&this.lastParse.result&&this.lastParse.result.services){var e="brooklyn.catalog:\n  version: 0.0.1\n  items:\n  - id: TODO_identifier_for_this_item \n    description: Some text to display about this\n    iconUrl: http://www.apache.org/foundation/press/kit/poweredBy/Apache_PoweredBy.png\n    itemType: template\n    item:\n"+this.editor.getValue().replace(/^(.*$)/gm,"      $1");this.mode=v,this.editor.setValue(e),this.refresh()}},runBlueprint:function(){this.validate()&&(this.mode===v?this.submitCatalog():this.submitApplication())},removeBlueprint:function(){this.initializeEditor()},switchMode:function(){this.setMode(this.mode==v?d:v)},switchModeApp:function(){this.setMode(d)},switchModeCatalog:function(){var e=this.parse().result;e&&e.services?this.convertBlueprintToCatalog():this.setMode(v)},populateExampleBlueprint:function(){this.editor.setValue(this.mode==v?p:h)},openDocumentation:function(){window.open(this.mode==v?"https://brooklyn.apache.org/v/latest/ops/catalog/":"https://brooklyn.apache.org/v/latest/yaml/yaml-reference.html","_blank")},onSubmissionComplete:function(e,t,r){var i=this;if(e)log("Submit [succeeded] ... redirecting back to "+r),r&&r==="catalog"?n.history.navigate("v1/catalog",{trigger:!0}):n.history.navigate("v1/home",{trigger:!0});else{log("Submit [failed] ... "+t.responseText);var s,o="Server responded with an error";try{t.responseText&&(s=JSON.parse(t.responseText),s&&(o=s.message))}catch(u){o=t.responseText}i.showFailure(o)}},submitApplication:function(){var e=this;return t.ajax({url:"/v1/applications",type:"post",contentType:"application/yaml",processData:!1,data:e.editor.getValue(),success:function(t){e.onSubmissionComplete(!0,t)},error:function(t){e.onSubmissionComplete(!1,t)}}),!1},submitCatalog:function(){var e=this;return t.ajax({url:"/v1/catalog",type:"post",contentType:"application/yaml",processData:!1,data:e.editor.getValue(),success:function(t){e.onSubmissionComplete(!0,t,"catalog")},error:function(t){e.onSubmissionComplete(!1,t,"catalog")}}),!1},showFailure:function(t){var n=t||"Failure performing the specified action";log("showing error: "+n),this.$("div.error-message .error-message-text").html(e.escape(n)),this.$("div.error-message").slideDown(250).delay(1e4).slideUp(500)},createLocation:function(){this._modal&&this._modal.close();var e=this;this._modal=new s({onLocationCreated:function(t,n){e.options.locations.fetch({reset:!0})},onFinish:function(t){e.$(".add-app #modal-container .modal").modal("hide")},isModal:!0}),this.$(".modal-location #modal-container").html(this._modal.render().el),this.$(".modal-location #modal-container .modal").on("hidden",function(){e._modal.close(),e.options.locations.fetch({reset:!0})}).modal("show")}});return m}),define("model/entity-summary",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{id:"",name:"",type:"",catalogItemId:"",links:{}}},getLinkByName:function(e){if(e)return this.get("links")[e]},getDisplayName:function(){var e=this.get("name");if(e)return e;var t=this.get("type"),n=this.getLinkByName("self");if(t&&n)return t.slice(t.lastIndexOf(".")+1)+":"+n.slice(n.lastIndexOf("/")+1)},getSensorUpdateUrl:function(){return this.getLinkByName("self")+"/sensors/current-state"},getConfigUpdateUrl:function(){return this.getLinkByName("self")+"/config/current-state"}}),n.Collection=t.Collection.extend({model:n.Model,url:"entity-summary-collection",findByDisplayName:function(e){if(e)return this.filter(function(t){return t.getDisplayName()===e})}}),n}),define("text!tpl/apps/tree-item.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<%\n    var isLoaded = (model ? true : false);\n    var isApp = (parentId ? false : true);\n\n    // Only emphasise applications at the top level, not as indirect references.\n    isApp &= !indirect;\n\n    if (!isLoaded) {\n%>\n        <i>Loading... (<%= id %>)</i>\n<%  } else {\n        var hasChildren = model.hasChildren() || model.hasMembers();\n        var iconUrl = model.get(\'iconUrl\');\n\n        var entityIconSize = isApp ? 40 : 30;\n        var statusIconSize = isApp ? 24 : 16;\n\n        var chevronLeft = (isApp ? 5.5 : 1.5);\n        var minHeight = hasChildren && statusIconUrl ? entityIconSize : 24;\n        var statusColumnWidth = hasChildren || statusIconUrl || (!isApp && !iconUrl /* for children, insert space so things line up */) ? statusIconSize : 0;\n%>\n\n  <span class="entity_tree_node name entity" id="span-<%= id %>" \n        data-entity-id="<%= id %>" data-entity-type="<%= model.get(\'type\') %>" data-parent-id="<%= parentId %>" data-app-id="<%= model.get(\'applicationId\') %>">\n    <a href="#v1/applications/<%= model.get(\'applicationId\') %>/entities/<%= id %>">\n\n      <div style="min-width: <%= statusColumnWidth + (iconUrl ? entityIconSize : 6)%>px; min-height: <%= minHeight %>px; max-height: 40px; display: inline-block; margin-right: 4px; vertical-align: middle;">\n        <% if (statusIconUrl) { %>\n        <div style="position: absolute; left: 0px; margin: auto; top: <%= isApp && hasChildren ? 3 : 2 %>px;<% if (!hasChildren) { %> bottom: 0px;<% } %>">\n            <img src="<%= statusIconUrl %>" style="max-width: <%= statusIconSize %>px; max-height: <%= statusIconSize %>px; margin: auto; position: absolute; top: -1px;<% if (!hasChildren) { %> bottom: 0px;<% } %>">\n        </div>\n        <% } %>\n\n        <% if (hasChildren) { %>\n        <div style="position: absolute; left: <%= chevronLeft %>px; margin: auto; <%= statusIconUrl ? "bottom: -1px;" : isApp ? "top: 6px;" : "top: 6px;" %>">\n            <div class="toggler-icon icon-chevron-right tree-node-state tree-change">\n                <div class="light-popup">\n                    <div class="light-popup-body">\n                        <div class="light-popup-menu-item tree-change tr-toggle tr-default">Toggle Children</div>\n                        <div class="light-popup-menu-item tree-change tr-expand">Expand</div>\n                        <div class="light-popup-menu-item tree-change tr-expand-all">Expand All</div>\n                        <div class="light-popup-menu-item tree-change tr-collapse">Collapse</div>\n                        <div class="light-popup-menu-item tree-change tr-collapse-all">Collapse All</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <% } %>\n\n        <% if (iconUrl) { %>\n            <img src="<%= iconUrl %>" style="max-width: <%= entityIconSize %>px; max-height: <%= entityIconSize %>px; position: absolute; padding-left: 5px; left: <%= statusColumnWidth %>px; top: 0; bottom: 0; margin: auto;">\n        <% } %>\n      </div>\n\n      <% if (indirect) { %>\n        <i class="indirection-icon icon-share-alt"></i>\n      <% } %>\n      <span style="max-height: 18px; padding-right: 6px; position: relative; margin: auto; top: 2px; bottom: 0;"><%= model.get(\'name\') %></span>\n\n    </a>\n  </span>\n\n<% } %>'}),define("text!tpl/apps/tree-empty.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="navbar_main_wrapper">\n    <div class="navbar_main">\n        <div style="padding-left: 12px; padding-top: 12px; padding-bottom: 300px;">\n            <i>No applications</i>\n        </div>\n    </div>\n</div>\n'}),define("view/application-tree",["underscore","jquery","backbone","view/viewutils","model/app-tree","text!tpl/apps/tree-item.html","text!tpl/apps/tree-empty.html"],function(e,t,n,r,i,s,o){var u=e.template(o),a=e.template(s),f=function(e,n){return t('.tree-box[data-entity-id="'+e+'"]',n)},l=function(e,n){return t(".lozenge-app-tree-wrapper",n).children('.tree-box[data-entity-id="'+e+'"]',this.$el)},c=function(e,t){return t.children(".node-children").children('.tree-box[data-entity-id="'+e+'"]')},h=function(e,n){return t('.tree-box[data-entity-id="'+e+'"]:not(.indirect)',n)},p=function(e,t){return(t?t.toLowerCase():"~~~")+"     "+e.toLowerCase()},d=function(e){return p(e.id,e.get("name"))},v=function(e,n){var r=!1,i=t(".toggler-group",n).first(),s=e.data("sort-key");while(i.length&&!r){var o=i.data("sort-key");s<o?(i.before(e),r=!0):i=i.next(".toggler-group",n)}return r||n.append(e),e},m=function(e,n,r,i,s){var o=p(e,n),u=t('<div data-entity-id="'+e+'" data-sort-key="'+o+'" data-depth="'+i+'" '+'class="tree-box toggler-group'+(s?" indirect":"")+(i==0?" outer":" inner "+(i%2?" depth-odd":" depth-even")+(i==1?" depth-first":""))+'">'+'<div class="entity_tree_node_wrapper"></div>'+'<div class="node-children toggler-target hide"></div>'+"</div>");return v(u,r)},g=function(e,n,r,i){i||(i=r.$el);var s=l(e,i);if(!s.length){var o=t(".lozenge-app-tree-wrapper",i);o.length||(r.$el.html('<div class="navbar_main_wrapper treeloz"><div id="tree-list" class="navbar_main treeloz"><div class="lozenge-app-tree-wrapper"></div></div></div>'),o=t(".lozenge-app-tree-wrapper",i)),s=m(e,n,o,0,!1)}return s},y=function(e,t,n,r){var i=c(e,r);return i.length||(i=m(e,t,r.children(".node-children"),r.data("depth")+1,n)),i},b=function(e,n,i){oldSortKey=n.data("sort-key"),newSortKey=d(e);var s=t(i.template({id:e.get("id"),parentId:e.get("parentId"),model:e,statusIconUrl:r.computeStatusIconInfo(e.get("serviceUp"),e.get("serviceState")).url,indirect:n.hasClass("indirect")})),o=n.children(".entity_tree_node_wrapper");o.find(".tree-node-state").hasClass("icon-chevron-down")&&s.find(".tree-node-state").removeClass("icon-chevron-right").addClass("icon-chevron-down"),o.html(s),w(n,i),newSortKey!==oldSortKey&&(n.data("sort-key",newSortKey),$parent=n.parent(),n.detach(),v(n,$parent))},w=function(e,n){t(".light-popup",e).parent().parent().hover(function(e){n.cancelHoverTimer(),n.hoverTimer=setTimeout(function(){var n=t(e.currentTarget).find(".light-popup");n.show()},500)},function(e){n.cancelHoverTimer(),t(".light-popup").hide()})},E=function(e,t){if(!e.length)return!1;if(e.is(":visible"))return!0;var n=e.parent().closest(".tree-box");return n.length?n==e?!1:E(n,t)?(t.showChildrenOf(n,!1),!0):!1:!0},S=function(e,n,r){r.requestedEntityId=e,t(".entity_tree_node_wrapper",r.$el).removeClass("active"),n.children(".entity_tree_node_wrapper").addClass("active");var i=r.collection.get(e);return i?E(n,r)?(r.selectedEntityId=e,r.requestedEntityId=null,r.trigger("entitySelected",i),!0):!1:!1};return n.View.extend({template:a,hoverTimer:null,events:{"click span.entity_tree_node .tree-change":"treeChange","click span.entity_tree_node":"nodeClicked"},initialize:function(){this.collection.on("add",this.entityAdded,this),this.collection.on("change",this.entityChanged,this),this.collection.on("remove",this.entityRemoved,this),this.collection.on("reset",this.renderFull,this),e.bindAll(this)},beforeClose:function(){this.collection.off("reset",this.renderFull)},entityAdded:function(e){var t,n=e.get("parentId");if(!n)t=g(e.id,e.get("name"),this),!this.selectedEntityId&&!this.requestedEntityId&&S(e.id,t,this);else{var r=this.collection.get(n);if(!r)return null;$parentTreebox=this.entityAdded(r);if($parentTreebox==null)return null;t=y(e.id,e.name,$parentTreebox.hasClass("indirect"),$parentTreebox)}return this.entityChanged(e),t},entityChanged:function(n){var r=this;f(n.id).each(function(){t(this).children(".node-children").is(":visible")&&r.collection.includeEntities(e.union(n.get("children"),n.get("members")))&&r.collection.fetch(),b(n,t(this),r)})},entityRemoved:function(e){f(e.id,this.$el).remove(),this.collection.getApplications().length==0&&this.renderFull()},nodeClicked:function(e){var n=t(e.currentTarget).closest(".tree-box"),r=n.data("entityId");return S(r,n,this),!1},selectEntity:function(e){var t=h(e,this.$el);return S(e,t,this)},getTreebox:function(e){return h(e,this.$el)},renderFull:function(){var t=this;this.$el.empty();if(this.collection.getApplications().length==0)this.$el.append(u());else{e.each(this.collection.getApplications(),function(e){var n=t.collection.get(e),r=g(n.id,n.name,t);b(n,r,t)});var n=this.selectedEntityId;n||(n=this.requestedEntityId);if(n){var r=this.collection.get(n);r&&(this.initialRender=!0,this.entityAdded(r),this.selectEntity(n),this.initialRender=!1)}}return this},cancelHoverTimer:function(){this.hoverTimer!=null&&(clearTimeout(this.hoverTimer),this.hoverTimer=null)},treeChange:function(e){var n=t(e.currentTarget),r=n.closest(".tree-box");return n.hasClass("tr-expand")?this.showChildrenOf(r,!1):n.hasClass("tr-expand-all")?this.showChildrenOf(r,!0):n.hasClass("tr-collapse")?this.hideChildrenOf(r,!1):n.hasClass("tr-collapse-all")?this.hideChildrenOf(r,!0):r.children(".node-children").is(":visible")?this.hideChildrenOf(r,!1):this.showChildrenOf(r,!1),this.cancelHoverTimer(),t(".light-popup").hide(),!1},showChildrenOf:function(n,r,i){i=i||[];var s=n.data("entityId"),o=n.children(".entity_tree_node_wrapper"),u=n.children(".node-children"),a=this.collection.get(s);if(a==null)return;var f=this,l=a.get("children"),c=n.hasClass("indirect");e.each(l,function(e){var t=y(e.id,e.name,c,n),r=f.collection.get(e.id);r&&b(r,t,f)});var h=a.get("members");e.each(h,function(e){var t=y(e.id,e.name,!0,n),r=f.collection.get(e.id);r&&b(r,t,f)});var p=function(t,n,i){if(t.hasClass("indirect")){var s=t.data("entityId");if(e.contains(n,s))return;n.push(s)}var o=function(){f.showChildrenOf(t,r,n)};i?e.defer(o):o()};this.collection.includeEntities(e.union(l,h))&&this.collection.fetch({success:function(){r&&u.children(".tree-box").each(function(){p(t(this),i,!0)})}}),u.slideDown(this.initialRender?0:300),o.find(".tree-node-state").removeClass("icon-chevron-right").addClass("icon-chevron-down"),r&&u.children(".tree-box").each(function(){p(t(this),i,!1)})},hideChildrenOf:function(e,n){var r=e.children(".entity_tree_node_wrapper"),i=e.children(".node-children");if(n){var s=this;i.children(".tree-box").each(function(){s.hideChildrenOf(t(this),n)})}i.slideUp(300),r.find(".tree-node-state").removeClass("icon-chevron-down").addClass("icon-chevron-right")}})}),define("text!tpl/apps/summary.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="app-summary">\n\n <div id="title-and-info-row" style="white-space: nowrap;">\n  <% if (entity.getLinkByName(\'iconUrl\')) { %>\n  <div style="display: inline-block; vertical-align: bottom; padding-top: 12px; padding-bottom: 18px;">\n    <img src="<%= entity.getLinkByName(\'iconUrl\') %>"\n        style="max-width: 128px; max-height: 128px;"/>\n  </div>\n  <% } %>\n\n  <div style="display: inline-block; vertical-align: bottom;">\n  \n   <div class="name" style="margin-bottom: 12px; padding-right: 12px;">\n     <h2><%= entity.get(\'name\') %></h2>\n   </div>\n\n  </div>\n </div>\n\n <div class="toggler-region">\n  <div class="toggler-header">\n    <div class="toggler-icon icon-chevron-down"></div>\n    <div><b>Status</b></div>\n  </div>\n  <div class="inforow" style="position: relative;">\n     \n    <div style="display: inline-block; padding-left: 8px; padding-right: 24px; padding-top: 6px;">\n        <div class="info-name-value status hide">\n            <div class="name">Status</div>\n            <div class="value"><i>Loading...</i></div>\n        </div>\n        <div class="info-name-value serviceUp hide">\n            <div class="name">Service Up</div>\n            <div class="value"><i>Loading...</i></div>\n        </div>\n        <div class="info-name-value url hide" style="margin-top: 12px;">\n            <div class="name">URL</div>\n            <div class="value"><i>Loading...</i></div>\n        </div>\n        \n        <div class="info-name-value type" style="margin-top: 12px;">\n            <div class="name">Type</div>\n            <div class="value"><%= entity.get(\'type\') %></div>\n        </div>\n        <div class="info-name-value id">\n            <div class="name">ID</div>\n            <div class="value"><%= entity.get(\'id\') %></div>\n        </div>\n        <div class="info-name-value catalogItemId hide">\n            <div class="name">Catalog Item</div>\n            <div class="value"><a href="#v1/catalog/<%= (isApp ? "applications" : "entities") %>/<%= entity.get(\'catalogItemId\') %>"><%= entity.get(\'catalogItemId\') %></a></div>\n        </div>\n\n        <div class="additional-info-on-problem hide" style="margin-top: 12px;">\n        </div>\n\n        <div id="status-icon" style="display: inline-block; padding-top: 12px; padding-bottom: 18px; padding-right: 8px; position: absolute; right: 0; top: 0;"></div>\n\n   </div>\n  </div>\n </div>\n \n <div id="entity-spec-yaml-toggler" class="toggler-region region-config hide" style="margin-top: 18px;">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Blueprint</b></div>\n    </div>\n    <div id="entity-spec-yaml" class="for-textarea hide">\n      <textarea readonly="readonly" class="code-textarea"/>\n    </div>\n </div>\n\n  <div class="toggler-region region-config" style="margin-top: 18px;">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Config</b></div>\n    </div>\n    <div id="advanced-config" class="hide"/>\n  </div>\n\n  <!-- TODO would like to show more info here, nicely; e.g.\n         children, members (above? new section here ?)\n         active tasks (new section here)\n         locations / map (new section here ?)\n  -->\n\n</div>'}),function(e){function P(e){return e.replace(/,/g,".").replace(/[^0-9\.]/g,"")}function H(e){return parseFloat(P(e))>=10}var t,n={bridge:null,version:"0.0.0",disabled:null,outdated:null,ready:null},r={},i=0,s={},o=0,u={},a=null,f=null,l=function(){var e,t,n,r,i="ZeroClipboard.swf";if(!document.currentScript||!(r=document.currentScript.src)){var s=document.getElementsByTagName("script");if("readyState"in s[0]){for(e=s.length;e--;)if(s[e].readyState==="interactive"&&(r=s[e].src))break}else if(document.readyState==="loading")r=s[s.length-1].src;else{for(e=s.length;e--;){n=s[e].src;if(!n){t=null;break}n=n.split("#")[0].split("?")[0],n=n.slice(0,n.lastIndexOf("/")+1);if(t==null)t=n;else if(t!==n){t=null;break}}t!==null&&(r=t)}}return r&&(r=r.split("#")[0].split("?")[0],i=r.slice(0,r.lastIndexOf("/")+1)+i),i}(),c=function(){var e=/\-([a-z])/g,t=function(e,t){return t.toUpperCase()};return function(n){return n.replace(e,t)}}(),h=function(t,n){var r,i,s,o,u,a;e.getComputedStyle?r=e.getComputedStyle(t,null).getPropertyValue(n):(i=c(n),t.currentStyle?r=t.currentStyle[i]:r=t.style[i]);if(n==="cursor")if(!r||r==="auto"){s=t.tagName.toLowerCase();if(s==="a")return"pointer"}return r},p=function(t){t||(t=e.event);var n;this!==e?n=this:t.target?n=t.target:t.srcElement&&(n=t.srcElement),B.activate(n)},d=function(e,t,n){if(!e||e.nodeType!==1)return;e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},v=function(e,t,n){if(!e||e.nodeType!==1)return;e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},m=function(e,t){if(!e||e.nodeType!==1)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&typeof t=="string"){var n=(t||"").split(/\s+/);if(e.nodeType===1)if(!e.className)e.className=t;else{var r=" "+e.className+" ",i=e.className;for(var s=0,o=n.length;s<o;s++)r.indexOf(" "+n[s]+" ")<0&&(i+=" "+n[s]);e.className=i.replace(/^\s+|\s+$/g,"")}}return e},g=function(e,t){if(!e||e.nodeType!==1)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if(t&&typeof t=="string"||t===undefined){var n=(t||"").split(/\s+/);if(e.nodeType===1&&e.className)if(t){var r=(" "+e.className+" ").replace(/[\n\t]/g," ");for(var i=0,s=n.length;i<s;i++)r=r.replace(" "+n[i]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}else e.className=""}return e},y=function(){var e,t,n,r=1;return typeof document.body.getBoundingClientRect=="function"&&(e=document.body.getBoundingClientRect(),t=e.right-e.left,n=document.body.offsetWidth,r=Math.round(t/n*100)/100),r},b=function(t,n){var r={left:0,top:0,width:0,height:0,zIndex:N(n)-1};if(t.getBoundingClientRect){var i=t.getBoundingClientRect(),s,o,u;"pageXOffset"in e&&"pageYOffset"in e?(s=e.pageXOffset,o=e.pageYOffset):(u=y(),s=Math.round(document.documentElement.scrollLeft/u),o=Math.round(document.documentElement.scrollTop/u));var a=document.documentElement.clientLeft||0,f=document.documentElement.clientTop||0;r.left=i.left+s-a,r.top=i.top+o-f,r.width="width"in i?i.width:i.right-i.left,r.height="height"in i?i.height:i.bottom-i.top}return r},w=function(e,t){var n=t==null||t&&t.cacheBust===!0&&t.useNoCache===!0;return n?(e.indexOf("?")===-1?"?":"&")+"noCache="+(new Date).getTime():""},E=function(t){var n,r,i,s=[],o=[],u=[];t.trustedOrigins&&(typeof t.trustedOrigins=="string"?o.push(t.trustedOrigins):typeof t.trustedOrigins=="object"&&"length"in t.trustedOrigins&&(o=o.concat(t.trustedOrigins))),t.trustedDomains&&(typeof t.trustedDomains=="string"?o.push(t.trustedDomains):typeof t.trustedDomains=="object"&&"length"in t.trustedDomains&&(o=o.concat(t.trustedDomains)));if(o.length)for(n=0,r=o.length;n<r;n++)if(o.hasOwnProperty(n)&&o[n]&&typeof o[n]=="string"){i=L(o[n]);if(!i)continue;if(i==="*"){u=[i];break}u.push.apply(u,[i,"//"+i,e.location.protocol+"//"+i])}return u.length&&s.push("trustedOrigins="+encodeURIComponent(u.join(","))),typeof t.jsModuleId=="string"&&t.jsModuleId&&s.push("jsModuleId="+encodeURIComponent(t.jsModuleId)),s.join("&")},S=function(e,t,n){if(typeof t.indexOf=="function")return t.indexOf(e,n);var r,i=t.length;typeof n=="undefined"?n=0:n<0&&(n=i+n);for(r=n;r<i;r++)if(t.hasOwnProperty(r)&&t[r]===e)return r;return-1},x=function(e){if(typeof e=="string")throw new TypeError("ZeroClipboard doesn't accept query strings.");return e.length?e:[e]},T=function(t,n,r,i){i?e.setTimeout(function(){t.apply(n,r)},0):t.apply(n,r)},N=function(e){var t,n;return e&&(typeof e=="number"&&e>0?t=e:typeof e=="string"&&(n=parseInt(e,10))&&!isNaN(n)&&n>0&&(t=n)),t||(typeof I.zIndex=="number"&&I.zIndex>0?t=I.zIndex:typeof I.zIndex=="string"&&(n=parseInt(I.zIndex,10))&&!isNaN(n)&&n>0&&(t=n)),t||0},C=function(e,t){if(e&&t!==!1&&typeof console!="undefined"&&console&&(console.warn||console.log)){var n="`"+e+"` is deprecated. See docs for more info:\n"+"    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations";console.warn?console.warn(n):console.log(n)}},k=function(){var e,t,n,r,i,s,o=arguments[0]||{};for(e=1,t=arguments.length;e<t;e++)if((n=arguments[e])!=null)for(r in n)if(n.hasOwnProperty(r)){i=o[r],s=n[r];if(o===s)continue;s!==undefined&&(o[r]=s)}return o},L=function(e){if(e==null||e==="")return null;e=e.replace(/^\s+|\s+$/g,"");if(e==="")return null;var t=e.indexOf("//");e=t===-1?e:e.slice(t+2);var n=e.indexOf("/");return e=n===-1?e:t===-1||n===0?null:e.slice(0,n),e&&e.slice(-4).toLowerCase()===".swf"?null:e||null},A=function(){var e=function(e,t){var n,r,i;if(e!=null&&t[0]!=="*"){typeof e=="string"&&(e=[e]);if(typeof e=="object"&&"length"in e)for(n=0,r=e.length;n<r;n++)if(e.hasOwnProperty(n)){i=L(e[n]);if(i){if(i==="*"){t.length=0,t.push("*");break}S(i,t)===-1&&t.push(i)}}}},t={always:"always",samedomain:"sameDomain",never:"never"};return function(n,r){var i,s=r.allowScriptAccess;if(typeof s=="string"&&(i=s.toLowerCase())&&/^always|samedomain|never$/.test(i))return t[i];var o=L(r.moviePath);o===null&&(o=n);var u=[];e(r.trustedOrigins,u),e(r.trustedDomains,u);var a=u.length;if(a>0){if(a===1&&u[0]==="*")return"always";if(S(n,u)!==-1)return a===1&&n===o?"sameDomain":"always"}return"never"}}(),O=function(e){if(e==null)return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},M=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&delete e[t];return e},_=function(){try{return document.activeElement}catch(e){}return null},D=function(){var e=!1;if(typeof n.disabled=="boolean")e=n.disabled===!1;else{if(typeof ActiveXObject=="function")try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(t){}!e&&navigator.mimeTypes["application/x-shockwave-flash"]&&(e=!0)}return e},B=function(e,t){if(!(this instanceof B))return new B(e,t);this.id=""+i++,s[this.id]={instance:this,elements:[],handlers:{}},e&&this.clip(e),typeof t!="undefined"&&(C("new ZeroClipboard(elements, options)",I.debug),B.config(t)),this.options=B.config(),typeof n.disabled!="boolean"&&(n.disabled=!D()),n.disabled===!1&&n.outdated!==!0&&n.bridge===null&&(n.outdated=!1,n.ready=!1,q())};B.prototype.setText=function(e){return e&&e!==""&&(r["text/plain"]=e,n.ready===!0&&n.bridge&&typeof n.bridge.setText=="function"?n.bridge.setText(e):n.ready=!1),this},B.prototype.setSize=function(e,t){return n.ready===!0&&n.bridge&&typeof n.bridge.setSize=="function"?n.bridge.setSize(e,t):n.ready=!1,this};var j=function(e){n.ready===!0&&n.bridge&&typeof n.bridge.setHandCursor=="function"?n.bridge.setHandCursor(e):n.ready=!1};B.prototype.destroy=function(){this.unclip(),this.off(),delete s[this.id]};var F=function(){var e,t,n,r=[],i=O(s);for(e=0,t=i.length;e<t;e++)n=s[i[e]].instance,n&&n instanceof B&&r.push(n);return r};B.version="1.3.5";var I={swfPath:l,trustedDomains:e.location.host?[e.location.host]:[],cacheBust:!0,forceHandCursor:!1,zIndex:999999999,debug:!0,title:null,autoActivate:!0};B.config=function(e){typeof e=="object"&&e!==null&&k(I,e);if(typeof e=="string"&&e){if(I.hasOwnProperty(e))return I[e];return}var t={};for(var n in I)I.hasOwnProperty(n)&&(typeof I[n]=="object"&&I[n]!==null?"length"in I[n]?t[n]=I[n].slice(0):t[n]=k({},I[n]):t[n]=I[n]);return t},B.destroy=function(){B.deactivate();for(var e in s)if(s.hasOwnProperty(e)&&s[e]){var t=s[e].instance;t&&typeof t.destroy=="function"&&t.destroy()}var r=R(n.bridge);r&&r.parentNode&&(r.parentNode.removeChild(r),n.ready=null,n.bridge=null)},B.activate=function(e){t&&(g(t,I.hoverClass),g(t,I.activeClass)),t=e,m(e,I.hoverClass),U();var r=I.title||e.getAttribute("title");if(r){var i=R(n.bridge);i&&i.setAttribute("title",r)}var s=I.forceHandCursor===!0||h(e,"cursor")==="pointer";j(s)},B.deactivate=function(){var e=R(n.bridge);e&&(e.style.left="0px",e.style.top="-9999px",e.removeAttribute("title")),t&&(g(t,I.hoverClass),g(t,I.activeClass),t=null)};var q=function(){var t,r,i=document.getElementById("global-zeroclipboard-html-bridge");if(!i){var s=B.config();s.jsModuleId=typeof a=="string"&&a||typeof f=="string"&&f||null;var o=A(e.location.host,I),u=E(s),l=I.moviePath+w(I.moviePath,I),c='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+l+'"/>         <param name="allowScriptAccess" value="'+o+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+u+'"/>         <embed src="'+l+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="'+o+'"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+u+'"           scale="exactfit">         </embed>       </object>';i=document.createElement("div"),i.id="global-zeroclipboard-html-bridge",i.setAttribute("class","global-zeroclipboard-container"),i.style.position="absolute",i.style.left="0px",i.style.top="-9999px",i.style.width="15px",i.style.height="15px",i.style.zIndex=""+N(I.zIndex),document.body.appendChild(i),i.innerHTML=c}t=document["global-zeroclipboard-flash-bridge"],t&&(r=t.length)&&(t=t[r-1]),n.bridge=t||i.children[0].lastElementChild},R=function(e){var t=/^OBJECT|EMBED$/,n=e&&e.parentNode;while(n&&t.test(n.nodeName)&&n.parentNode)n=n.parentNode;return n||null},U=function(){if(t){var e=b(t,I.zIndex),r=R(n.bridge);r&&(r.style.top=e.top+"px",r.style.left=e.left+"px",r.style.width=e.width+"px",r.style.height=e.height+"px",r.style.zIndex=e.zIndex+1),n.ready===!0&&n.bridge&&typeof n.bridge.setSize=="function"?n.bridge.setSize(e.width,e.height):n.ready=!1}return this};B.prototype.on=function(e,t){var r,i,o,u={},a=s[this.id]&&s[this.id].handlers;if(typeof e=="string"&&e)o=e.toLowerCase().split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(r in e)e.hasOwnProperty(r)&&typeof r=="string"&&r&&typeof e[r]=="function"&&this.on(r,e[r]);if(o&&o.length){for(r=0,i=o.length;r<i;r++)e=o[r].replace(/^on/,""),u[e]=!0,a[e]||(a[e]=[]),a[e].push(t);u.noflash&&n.disabled&&X.call(this,"noflash",{}),u.wrongflash&&n.outdated&&X.call(this,"wrongflash",{flashVersion:n.version}),u.load&&n.ready&&X.call(this,"load",{flashVersion:n.version})}return this},B.prototype.off=function(e,t){var n,r,i,o,u,a=s[this.id]&&s[this.id].handlers;if(arguments.length===0)o=O(a);else if(typeof e=="string"&&e)o=e.split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(n in e)e.hasOwnProperty(n)&&typeof n=="string"&&n&&typeof e[n]=="function"&&this.off(n,e[n]);if(o&&o.length)for(n=0,r=o.length;n<r;n++){e=o[n].toLowerCase().replace(/^on/,""),u=a[e];if(u&&u.length)if(t){i=S(t,u);while(i!==-1)u.splice(i,1),i=S(t,u,i)}else a[e].length=0}return this},B.prototype.handlers=function(e){var t,n=null,r=s[this.id]&&s[this.id].handlers;if(r){if(typeof e=="string"&&e)return r[e]?r[e].slice(0):null;n={};for(t in r)r.hasOwnProperty(t)&&r[t]&&(n[t]=r[t].slice(0))}return n};var z=function(t,n,r,i){var o=s[this.id]&&s[this.id].handlers[t];if(o&&o.length){var u,a,f,l=n||this;for(u=0,a=o.length;u<a;u++)f=o[u],n=l,typeof f=="string"&&typeof e[f]=="function"&&(f=e[f]),typeof f=="object"&&f&&typeof f.handleEvent=="function"&&(n=f,f=f.handleEvent),typeof f=="function"&&T(f,n,r,i)}return this};B.prototype.clip=function(e){e=x(e);for(var t=0;t<e.length;t++)if(e.hasOwnProperty(t)&&e[t]&&e[t].nodeType===1){e[t].zcClippingId?S(this.id,u[e[t].zcClippingId])===-1&&u[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+o++,u[e[t].zcClippingId]=[this.id],I.autoActivate===!0&&d(e[t],"mouseover",p));var n=s[this.id].elements;S(e[t],n)===-1&&n.push(e[t])}return this},B.prototype.unclip=function(e){var t=s[this.id];if(t){var n=t.elements,r;typeof e=="undefined"?e=n.slice(0):e=x(e);for(var i=e.length;i--;)if(e.hasOwnProperty(i)&&e[i]&&e[i].nodeType===1){r=0;while((r=S(e[i],n,r))!==-1)n.splice(r,1);var o=u[e[i].zcClippingId];if(o){r=0;while((r=S(this.id,o,r))!==-1)o.splice(r,1);o.length===0&&(I.autoActivate===!0&&v(e[i],"mouseover",p),delete e[i].zcClippingId)}}}return this},B.prototype.elements=function(){var e=s[this.id];return e&&e.elements?e.elements.slice(0):[]};var W=function(e){var t,n,r,i,o,a=[];if(e&&e.nodeType===1&&(t=e.zcClippingId)&&u.hasOwnProperty(t)){n=u[t];if(n&&n.length)for(r=0,i=n.length;r<i;r++)o=s[n[r]].instance,o&&o instanceof B&&a.push(o)}return a};I.hoverClass="zeroclipboard-is-hover",I.activeClass="zeroclipboard-is-active",I.trustedOrigins=null,I.allowScriptAccess=null,I.useNoCache=!0,I.moviePath="ZeroClipboard.swf",B.detectFlashSupport=function(){return C("ZeroClipboard.detectFlashSupport",I.debug),D()},B.dispatch=function(e,n){if(typeof e=="string"&&e){var r=e.toLowerCase().replace(/^on/,"");if(r){var i=t&&I.autoActivate===!0?W(t):F();for(var s=0,o=i.length;s<o;s++)X.call(i[s],r,n)}}},B.prototype.setHandCursor=function(e){return C("ZeroClipboard.prototype.setHandCursor",I.debug),e=typeof e=="boolean"?e:!!e,j(e),I.forceHandCursor=e,this},B.prototype.reposition=function(){return C("ZeroClipboard.prototype.reposition",I.debug),U()},B.prototype.receiveEvent=function(e,t){C("ZeroClipboard.prototype.receiveEvent",I.debug);if(typeof e=="string"&&e){var n=e.toLowerCase().replace(/^on/,"");n&&X.call(this,n,t)}},B.prototype.setCurrent=function(e){return C("ZeroClipboard.prototype.setCurrent",I.debug),B.activate(e),this},B.prototype.resetBridge=function(){return C("ZeroClipboard.prototype.resetBridge",I.debug),B.deactivate(),this},B.prototype.setTitle=function(e){C("ZeroClipboard.prototype.setTitle",I.debug),e=e||I.title||t&&t.getAttribute("title");if(e){var r=R(n.bridge);r&&r.setAttribute("title",e)}return this},B.setDefaults=function(e){C("ZeroClipboard.setDefaults",I.debug),B.config(e)},B.prototype.addEventListener=function(e,t){return C("ZeroClipboard.prototype.addEventListener",I.debug),this.on(e,t)},B.prototype.removeEventListener=function(e,t){return C("ZeroClipboard.prototype.removeEventListener",I.debug),this.off(e,t)},B.prototype.ready=function(){return C("ZeroClipboard.prototype.ready",I.debug),n.ready===!0};var X=function(e,i){e=e.toLowerCase().replace(/^on/,"");var s=i&&i.flashVersion&&P(i.flashVersion)||null,o=t,u=!0;switch(e){case"load":if(s){if(!H(s)){X.call(this,"onWrongFlash",{flashVersion:s});return}n.outdated=!1,n.ready=!0,n.version=s}break;case"wrongflash":s&&!H(s)&&(n.outdated=!0,n.ready=!1,n.version=s);break;case"mouseover":m(o,I.hoverClass);break;case"mouseout":I.autoActivate===!0&&B.deactivate();break;case"mousedown":m(o,I.activeClass);break;case"mouseup":g(o,I.activeClass);break;case"datarequested":if(o){var a=o.getAttribute("data-clipboard-target"),f=a?document.getElementById(a):null;if(f){var l=f.value||f.textContent||f.innerText;l&&this.setText(l)}else{var c=o.getAttribute("data-clipboard-text");c&&this.setText(c)}}u=!1;break;case"complete":M(r),o&&o!==_()&&o.focus&&o.focus()}var h=o,p=[this,i];return z.call(this,e,h,p,u)};typeof define=="function"&&define.amd?define("zeroclipboard",["require","exports","module"],function(e,t,n){return a=n&&n.id||null,B}):typeof module=="object"&&module&&typeof module.exports=="object"&&module.exports&&typeof e.require=="function"?(f=module.id||null,module.exports=B):e.ZeroClipboard=B}(function(){return this}()),define("model/config-summary",["jquery","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{name:"",type:"",description:"",links:{}}},getLinkByName:function(e){if(e)return this.get("links")[e]}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("text!tpl/apps/config.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="table-scroll-wrapper" style="overflow: visible;">\n<table id="config-table" width="100%">\n    <thead>\n    <tr>\n        <th>ID</th>\n        <th>Name</th>\n        <th>Value</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n<div style="height: 30px;"></div>\n</div>\n'}),define("text!tpl/apps/config-name.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<% if (description || type) { %>\n<span class="config-name" rel="tooltip" data-placement="left"\n    title="<% \n         if (description) { %><b><%- description %></b><br/><% } \n         if (type) { %>(<% \n           if (type.startsWith("java.lang.") || type.startsWith("java.util.")) type = type.substring(10);\n         %><%- type %>)<% } %>">\n    <%- name %>\n</span>\n<% } else { %>\n<span class="config-name">\n    <%- name %>\n</span>\n<% } %>'}),function(window,document,undefined){(function(e){typeof define=="function"&&define.amd?define("jquery-datatables",["jquery"],e):jQuery&&!jQuery.fn.dataTable&&e(jQuery)})(function($){var DataTable=function(oInit){function _fnAddColumn(e,t){var n=DataTable.defaults.columns,r=e.aoColumns.length,i=$.extend({},DataTable.models.oColumn,n,{sSortingClass:e.oClasses.sSortable,sSortingClassJUI:e.oClasses.sSortJUI,nTh:t?t:document.createElement("th"),sTitle:n.sTitle?n.sTitle:t?t.innerHTML:"",aDataSort:n.aDataSort?n.aDataSort:[r],mData:n.mData?n.oDefaults:r});e.aoColumns.push(i);if(e.aoPreSearchCols[r]===undefined||e.aoPreSearchCols[r]===null)e.aoPreSearchCols[r]=$.extend({},DataTable.models.oSearch);else{var s=e.aoPreSearchCols[r];s.bRegex===undefined&&(s.bRegex=!0),s.bSmart===undefined&&(s.bSmart=!0),s.bCaseInsensitive===undefined&&(s.bCaseInsensitive=!0)}_fnColumnOptions(e,r,null)}function _fnColumnOptions(e,t,n){var r=e.aoColumns[t];n!==undefined&&n!==null&&(n.mDataProp&&!n.mData&&(n.mData=n.mDataProp),n.sType!==undefined&&(r.sType=n.sType,r._bAutoType=!1),$.extend(r,n),_fnMap(r,n,"sWidth","sWidthOrig"),n.iDataSort!==undefined&&(r.aDataSort=[n.iDataSort]),_fnMap(r,n,"aDataSort"));var i=r.mRender?_fnGetObjectDataFn(r.mRender):null,s=_fnGetObjectDataFn(r.mData);r.fnGetData=function(e,t){var n=s(e,t);return r.mRender&&t&&t!==""?i(n,t,e):n},r.fnSetData=_fnSetObjectDataFn(r.mData),e.oFeatures.bSort||(r.bSortable=!1),!r.bSortable||$.inArray("asc",r.asSorting)==-1&&$.inArray("desc",r.asSorting)==-1?(r.sSortingClass=e.oClasses.sSortableNone,r.sSortingClassJUI=""):$.inArray("asc",r.asSorting)==-1&&$.inArray("desc",r.asSorting)==-1?(r.sSortingClass=e.oClasses.sSortable,r.sSortingClassJUI=e.oClasses.sSortJUI):$.inArray("asc",r.asSorting)!=-1&&$.inArray("desc",r.asSorting)==-1?(r.sSortingClass=e.oClasses.sSortableAsc,r.sSortingClassJUI=e.oClasses.sSortJUIAscAllowed):$.inArray("asc",r.asSorting)==-1&&$.inArray("desc",r.asSorting)!=-1&&(r.sSortingClass=e.oClasses.sSortableDesc,r.sSortingClassJUI=e.oClasses.sSortJUIDescAllowed)}function _fnAdjustColumnSizing(e){if(e.oFeatures.bAutoWidth===!1)return!1;_fnCalculateColumnWidths(e);for(var t=0,n=e.aoColumns.length;t<n;t++)e.aoColumns[t].nTh.style.width=e.aoColumns[t].sWidth}function _fnVisibleToColumnIndex(e,t){var n=_fnGetColumns(e,"bVisible");return typeof n[t]=="number"?n[t]:null}function _fnColumnIndexToVisible(e,t){var n=_fnGetColumns(e,"bVisible"),r=$.inArray(t,n);return r!==-1?r:null}function _fnVisbleColumns(e){return _fnGetColumns(e,"bVisible").length}function _fnGetColumns(e,t){var n=[];return $.map(e.aoColumns,function(e,r){e[t]&&n.push(r)}),n}function _fnDetectType(e){var t=DataTable.ext.aTypes,n=t.length;for(var r=0;r<n;r++){var i=t[r](e);if(i!==null)return i}return"string"}function _fnReOrderIndex(e,t){var n=t.split(","),r=[];for(var i=0,s=e.aoColumns.length;i<s;i++)for(var o=0;o<s;o++)if(e.aoColumns[i].sName==n[o]){r.push(o);break}return r}function _fnColumnOrdering(e){var t="";for(var n=0,r=e.aoColumns.length;n<r;n++)t+=e.aoColumns[n].sName+",";return t.length==r?"":t.slice(0,-1)}function _fnApplyColumnDefs(e,t,n,r){var i,s,o,u,a,f;if(t)for(i=t.length-1;i>=0;i--){var l=t[i].aTargets;$.isArray(l)||_fnLog(e,1,"aTargets must be an array of targets, not a "+typeof l);for(o=0,u=l.length;o<u;o++)if(typeof l[o]=="number"&&l[o]>=0){while(e.aoColumns.length<=l[o])_fnAddColumn(e);r(l[o],t[i])}else if(typeof l[o]=="number"&&l[o]<0)r(e.aoColumns.length+l[o],t[i]);else if(typeof l[o]=="string")for(a=0,f=e.aoColumns.length;a<f;a++)(l[o]=="_all"||$(e.aoColumns[a].nTh).hasClass(l[o]))&&r(a,t[i])}if(n)for(i=0,s=n.length;i<s;i++)r(i,n[i])}function _fnAddData(e,t){var n,r=$.isArray(t)?t.slice():$.extend(!0,{},t),i=e.aoData.length,s=$.extend(!0,{},DataTable.models.oRow);s._aData=r,e.aoData.push(s);var o,u;for(var a=0,f=e.aoColumns.length;a<f;a++){n=e.aoColumns[a],typeof n.fnRender=="function"&&n.bUseRendered&&n.mData!==null?_fnSetCellData(e,i,a,_fnRender(e,i,a)):_fnSetCellData(e,i,a,_fnGetCellData(e,i,a));if(n._bAutoType&&n.sType!="string"){var l=_fnGetCellData(e,i,a,"type");l!==null&&l!==""&&(u=_fnDetectType(l),n.sType===null?n.sType=u:n.sType!=u&&n.sType!="html"&&(n.sType="string"))}}return e.aiDisplayMaster.push(i),e.oFeatures.bDeferRender||_fnCreateTr(e,i),i}function _fnGatherData(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;if(e.bDeferLoading||e.sAjaxSource===null){l=e.nTBody.firstChild;while(l){if(l.nodeName.toUpperCase()=="TR"){h=e.aoData.length,l._DT_RowIndex=h,e.aoData.push($.extend(!0,{},DataTable.models.oRow,{nTr:l})),e.aiDisplayMaster.push(h),f=l.firstChild,o=0;while(f){g=f.nodeName.toUpperCase();if(g=="TD"||g=="TH")_fnSetCellData(e,h,o,$.trim(f.innerHTML)),o++;f=f.nextSibling}}l=l.nextSibling}}a=_fnGetTrNodes(e),u=[];for(n=0,r=a.length;n<r;n++){f=a[n].firstChild;while(f)g=f.nodeName.toUpperCase(),(g=="TD"||g=="TH")&&u.push(f),f=f.nextSibling}for(v=0,m=e.aoColumns.length;v<m;v++){y=e.aoColumns[v],y.sTitle===null&&(y.sTitle=y.nTh.innerHTML);var w=y._bAutoType,E=typeof y.fnRender=="function",S=y.sClass!==null,x=y.bVisible,T,N,C,k;if(w||E||S||!x)for(p=0,d=e.aoData.length;p<d;p++)b=e.aoData[p],T=u[p*m+v],w&&y.sType!="string"&&(k=_fnGetCellData(e,p,v,"type"),k!==""&&(N=_fnDetectType(k),y.sType===null?y.sType=N:y.sType!=N&&y.sType!="html"&&(y.sType="string"))),y.mRender?T.innerHTML=_fnGetCellData(e,p,v,"display"):y.mData!==v&&(T.innerHTML=_fnGetCellData(e,p,v,"display")),E&&(C=_fnRender(e,p,v),T.innerHTML=C,y.bUseRendered&&_fnSetCellData(e,p,v,C)),S&&(T.className+=" "+y.sClass),x?b._anHidden[v]=null:(b._anHidden[v]=T,T.parentNode.removeChild(T)),y.fnCreatedCell&&y.fnCreatedCell.call(e.oInstance,T,_fnGetCellData(e,p,v,"display"),b._aData,p,v)}if(e.aoRowCreatedCallback.length!==0)for(n=0,r=e.aoData.length;n<r;n++)b=e.aoData[n],_fnCallbackFire(e,"aoRowCreatedCallback",null,[b.nTr,b._aData,n])}function _fnNodeToDataIndex(e,t){return t._DT_RowIndex!==undefined?t._DT_RowIndex:null}function _fnNodeToColumnIndex(e,t,n){var r=_fnGetTdNodes(e,t);for(var i=0,s=e.aoColumns.length;i<s;i++)if(r[i]===n)return i;return-1}function _fnGetRowData(e,t,n,r){var i=[];for(var s=0,o=r.length;s<o;s++)i.push(_fnGetCellData(e,t,r[s],n));return i}function _fnGetCellData(e,t,n,r){var i,s=e.aoColumns[n],o=e.aoData[t]._aData;if((i=s.fnGetData(o,r))===undefined)return e.iDrawError!=e.iDraw&&s.sDefaultContent===null&&(_fnLog(e,0,"Requested unknown parameter "+(typeof s.mData=="function"?"{mData function}":"'"+s.mData+"'")+" from the data source for row "+t),e.iDrawError=e.iDraw),s.sDefaultContent;if(i===null&&s.sDefaultContent!==null)i=s.sDefaultContent;else if(typeof i=="function")return i();return r=="display"&&i===null?"":i}function _fnSetCellData(e,t,n,r){var i=e.aoColumns[n],s=e.aoData[t]._aData;i.fnSetData(s,r)}function _fnGetObjectDataFn(e){if(e===null)return function(e,t){return null};if(typeof e=="function")return function(t,n,r){return e(t,n,r)};if(typeof e!="string"||e.indexOf(".")===-1&&e.indexOf("[")===-1)return function(t,n){return t[e]};var t=function(e,n,r){var i=r.split("."),s,o,u;if(r!=="")for(var a=0,f=i.length;a<f;a++){s=i[a].match(__reArray);if(s){i[a]=i[a].replace(__reArray,""),i[a]!==""&&(e=e[i[a]]),o=[],i.splice(0,a+1),u=i.join(".");for(var l=0,c=e.length;l<c;l++)o.push(t(e[l],n,u));var h=s[0].substring(1,s[0].length-1);e=h===""?o:o.join(h);break}if(e===null||e[i[a]]===undefined)return undefined;e=e[i[a]]}return e};return function(n,r){return t(n,r,e)}}function _fnSetObjectDataFn(e){if(e===null)return function(e,t){};if(typeof e=="function")return function(t,n){e(t,"set",n)};if(typeof e!="string"||e.indexOf(".")===-1&&e.indexOf("[")===-1)return function(t,n){t[e]=n};var t=function(e,n,r){var i=r.split("."),s,o,u,a;for(var f=0,l=i.length-1;f<l;f++){o=i[f].match(__reArray);if(o){i[f]=i[f].replace(__reArray,""),e[i[f]]=[],s=i.slice(),s.splice(0,f+1),a=s.join(".");for(var c=0,h=n.length;c<h;c++)u={},t(u,n[c],a),e[i[f]].push(u);return}if(e[i[f]]===null||e[i[f]]===undefined)e[i[f]]={};e=e[i[f]]}e[i[i.length-1].replace(__reArray,"")]=n};return function(n,r){return t(n,r,e)}}function _fnGetDataMaster(e){var t=[],n=e.aoData.length;for(var r=0;r<n;r++)t.push(e.aoData[r]._aData);return t}function _fnClearTable(e){e.aoData.splice(0,e.aoData.length),e.aiDisplayMaster.splice(0,e.aiDisplayMaster.length),e.aiDisplay.splice(0,e.aiDisplay.length),_fnCalculateEnd(e)}function _fnDeleteIndex(e,t){var n=-1;for(var r=0,i=e.length;r<i;r++)e[r]==t?n=r:e[r]>t&&e[r]--;n!=-1&&e.splice(n,1)}function _fnRender(e,t,n){var r=e.aoColumns[n];return r.fnRender({iDataRow:t,iDataColumn:n,oSettings:e,aData:e.aoData[t]._aData,mDataProp:r.mData},_fnGetCellData(e,t,n,"display"))}function _fnCreateTr(e,t){var n=e.aoData[t],r;if(n.nTr===null){n.nTr=document.createElement("tr"),n.nTr._DT_RowIndex=t,n._aData.DT_RowId&&(n.nTr.id=n._aData.DT_RowId),n._aData.DT_RowClass&&(n.nTr.className=n._aData.DT_RowClass);for(var i=0,s=e.aoColumns.length;i<s;i++){var o=e.aoColumns[i];r=document.createElement(o.sCellType),r.innerHTML=typeof o.fnRender!="function"||!!o.bUseRendered&&o.mData!==null?_fnGetCellData(e,t,i,"display"):_fnRender(e,t,i),o.sClass!==null&&(r.className=o.sClass),o.bVisible?(n.nTr.appendChild(r),n._anHidden[i]=null):n._anHidden[i]=r,o.fnCreatedCell&&o.fnCreatedCell.call(e.oInstance,r,_fnGetCellData(e,t,i,"display"),n._aData,t,i)}_fnCallbackFire(e,"aoRowCreatedCallback",null,[n.nTr,n._aData,t])}}function _fnBuildHead(e){var t,n,r,i,s,o=$("th, td",e.nTHead).length,u=0,a;if(o!==0)for(t=0,r=e.aoColumns.length;t<r;t++)n=e.aoColumns[t].nTh,n.setAttribute("role","columnheader"),e.aoColumns[t].bSortable&&(n.setAttribute("tabindex",e.iTabIndex),n.setAttribute("aria-controls",e.sTableId)),e.aoColumns[t].sClass!==null&&$(n).addClass(e.aoColumns[t].sClass),e.aoColumns[t].sTitle!=n.innerHTML&&(n.innerHTML=e.aoColumns[t].sTitle);else{var f=document.createElement("tr");for(t=0,r=e.aoColumns.length;t<r;t++)n=e.aoColumns[t].nTh,n.innerHTML=e.aoColumns[t].sTitle,n.setAttribute("tabindex","0"),e.aoColumns[t].sClass!==null&&$(n).addClass(e.aoColumns[t].sClass),f.appendChild(n);$(e.nTHead).html("")[0].appendChild(f),_fnDetectHeader(e.aoHeader,e.nTHead)}$(e.nTHead).children("tr").attr("role","row");if(e.bJUI)for(t=0,r=e.aoColumns.length;t<r;t++){n=e.aoColumns[t].nTh;var l=document.createElement("div");l.className=e.oClasses.sSortJUIWrapper,$(n).contents().appendTo(l);var c=document.createElement("span");c.className=e.oClasses.sSortIcon,l.appendChild(c),n.appendChild(l)}if(e.oFeatures.bSort)for(t=0;t<e.aoColumns.length;t++)e.aoColumns[t].bSortable!==!1?_fnSortAttachListener(e,e.aoColumns[t].nTh,t):$(e.aoColumns[t].nTh).addClass(e.oClasses.sSortableNone);e.oClasses.sFooterTH!==""&&$(e.nTFoot).children("tr").children("th").addClass(e.oClasses.sFooterTH);if(e.nTFoot!==null){var h=_fnGetUniqueThs(e,null,e.aoFooter);for(t=0,r=e.aoColumns.length;t<r;t++)h[t]&&(e.aoColumns[t].nTf=h[t],e.aoColumns[t].sClass&&$(h[t]).addClass(e.aoColumns[t].sClass))}}function _fnDrawHead(e,t,n){var r,i,s,o,u,a,f,l,c=[],h=[],p=e.aoColumns.length,d,v;n===undefined&&(n=!1);for(r=0,i=t.length;r<i;r++){c[r]=t[r].slice(),c[r].nTr=t[r].nTr;for(s=p-1;s>=0;s--)!e.aoColumns[s].bVisible&&!n&&c[r].splice(s,1);h.push([])}for(r=0,i=c.length;r<i;r++){l=c[r].nTr;if(l)while(f=l.firstChild)l.removeChild(f);for(s=0,o=c[r].length;s<o;s++){d=1,v=1;if(h[r][s]===undefined){l.appendChild(c[r][s].cell),h[r][s]=1;while(c[r+d]!==undefined&&c[r][s].cell==c[r+d][s].cell)h[r+d][s]=1,d++;while(c[r][s+v]!==undefined&&c[r][s].cell==c[r][s+v].cell){for(u=0;u<d;u++)h[r+u][s+v]=1;v++}c[r][s].cell.rowSpan=d,c[r][s].cell.colSpan=v}}}}function _fnDraw(e){var t=_fnCallbackFire(e,"aoPreDrawCallback","preDraw",[e]);if($.inArray(!1,t)!==-1){_fnProcessingDisplay(e,!1);return}var n,r,i,s=[],o=0,u=e.asStripeClasses.length,a=e.aoOpenRows.length;e.bDrawing=!0,e.iInitDisplayStart!==undefined&&e.iInitDisplayStart!=-1&&(e.oFeatures.bServerSide?e._iDisplayStart=e.iInitDisplayStart:e._iDisplayStart=e.iInitDisplayStart>=e.fnRecordsDisplay()?0:e.iInitDisplayStart,e.iInitDisplayStart=-1,_fnCalculateEnd(e));if(e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++;else if(!e.oFeatures.bServerSide)e.iDraw++;else if(!e.bDestroying&&!_fnAjaxUpdate(e))return;if(e.aiDisplay.length!==0){var f=e._iDisplayStart,l=e._iDisplayEnd;e.oFeatures.bServerSide&&(f=0,l=e.aoData.length);for(var c=f;c<l;c++){var h=e.aoData[e.aiDisplay[c]];h.nTr===null&&_fnCreateTr(e,e.aiDisplay[c]);var p=h.nTr;if(u!==0){var d=e.asStripeClasses[o%u];h._sRowStripe!=d&&($(p).removeClass(h._sRowStripe).addClass(d),h._sRowStripe=d)}_fnCallbackFire(e,"aoRowCallback",null,[p,e.aoData[e.aiDisplay[c]]._aData,o,c]),s.push(p),o++;if(a!==0)for(var v=0;v<a;v++)if(p==e.aoOpenRows[v].nParent){s.push(e.aoOpenRows[v].nTr);break}}}else{s[0]=document.createElement("tr"),e.asStripeClasses[0]&&(s[0].className=e.asStripeClasses[0]);var m=e.oLanguage,g=m.sZeroRecords;e.iDraw==1&&e.sAjaxSource!==null&&!e.oFeatures.bServerSide?g=m.sLoadingRecords:m.sEmptyTable&&e.fnRecordsTotal()===0&&(g=m.sEmptyTable);var y=document.createElement("td");y.setAttribute("valign","top"),y.colSpan=_fnVisbleColumns(e),y.className=e.oClasses.sRowEmpty,y.innerHTML=_fnInfoMacros(e,g),s[o].appendChild(y)}_fnCallbackFire(e,"aoHeaderCallback","header",[$(e.nTHead).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]),_fnCallbackFire(e,"aoFooterCallback","footer",[$(e.nTFoot).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]);var b=document.createDocumentFragment(),w=document.createDocumentFragment(),E,S;if(e.nTBody){E=e.nTBody.parentNode,w.appendChild(e.nTBody);if(!e.oScroll.bInfinite||!e._bInitComplete||e.bSorted||e.bFiltered)while(i=e.nTBody.firstChild)e.nTBody.removeChild(i);for(n=0,r=s.length;n<r;n++)b.appendChild(s[n]);e.nTBody.appendChild(b),E!==null&&E.appendChild(e.nTBody)}_fnCallbackFire(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1,e.oFeatures.bServerSide&&(_fnProcessingDisplay(e,!1),e._bInitComplete||_fnInitComplete(e))}function _fnReDraw(e){e.oFeatures.bSort?_fnSort(e,e.oPreviousSearch):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(_fnCalculateEnd(e),_fnDraw(e))}function _fnAddOptionsHtml(e){var t=$("<div></div>")[0];e.nTable.parentNode.insertBefore(t,e.nTable),e.nTableWrapper=$('<div id="'+e.sTableId+'_wrapper" class="'+e.oClasses.sWrapper+'" role="grid"></div>')[0],e.nTableReinsertBefore=e.nTable.nextSibling;var n=e.nTableWrapper,r=e.sDom.split(""),i,s,o,u,a,f,l;for(var c=0;c<r.length;c++){s=0,o=r[c];if(o=="<"){u=$("<div></div>")[0],a=r[c+1];if(a=="'"||a=='"'){f="",l=2;while(r[c+l]!=a)f+=r[c+l],l++;f=="H"?f=e.oClasses.sJUIHeader:f=="F"&&(f=e.oClasses.sJUIFooter);if(f.indexOf(".")!=-1){var h=f.split(".");u.id=h[0].substr(1,h[0].length-1),u.className=h[1]}else f.charAt(0)=="#"?u.id=f.substr(1,f.length-1):u.className=f;c+=l}n.appendChild(u),n=u}else if(o==">")n=n.parentNode;else if(o=="l"&&e.oFeatures.bPaginate&&e.oFeatures.bLengthChange)i=_fnFeatureHtmlLength(e),s=1;else if(o=="f"&&e.oFeatures.bFilter)i=_fnFeatureHtmlFilter(e),s=1;else if(o=="r"&&e.oFeatures.bProcessing)i=_fnFeatureHtmlProcessing(e),s=1;else if(o=="t")i=_fnFeatureHtmlTable(e),s=1;else if(o=="i"&&e.oFeatures.bInfo)i=_fnFeatureHtmlInfo(e),s=1;else if(o=="p"&&e.oFeatures.bPaginate)i=_fnFeatureHtmlPaginate(e),s=1;else if(DataTable.ext.aoFeatures.length!==0){var p=DataTable.ext.aoFeatures;for(var d=0,v=p.length;d<v;d++)if(o==p[d].cFeature){i=p[d].fnInit(e),i&&(s=1);break}}s==1&&i!==null&&(typeof e.aanFeatures[o]!="object"&&(e.aanFeatures[o]=[]),e.aanFeatures[o].push(i),n.appendChild(i))}t.parentNode.replaceChild(e.nTableWrapper,t)}function _fnDetectHeader(e,t){var n=$(t).children("tr"),r,i,s,o,u,a,f,l,c,h,p,d,v=function(e,t,n){var r=e[t];while(r[n])n++;return n};e.splice(0,e.length);for(s=0,a=n.length;s<a;s++)e.push([]);for(s=0,a=n.length;s<a;s++){r=n[s],c=0,i=r.firstChild;while(i){if(i.nodeName.toUpperCase()=="TD"||i.nodeName.toUpperCase()=="TH"){h=i.getAttribute("colspan")*1,p=i.getAttribute("rowspan")*1,h=!h||h===0||h===1?1:h,p=!p||p===0||p===1?1:p,l=v(e,s,c),d=h===1?!0:!1;for(u=0;u<h;u++)for(o=0;o<p;o++)e[s+o][l+u]={cell:i,unique:d},e[s+o].nTr=r}i=i.nextSibling}}}function _fnGetUniqueThs(e,t,n){var r=[];n||(n=e.aoHeader,t&&(n=[],_fnDetectHeader(n,t)));for(var i=0,s=n.length;i<s;i++)for(var o=0,u=n[i].length;o<u;o++)n[i][o].unique&&(!r[o]||!e.bSortCellsTop)&&(r[o]=n[i][o].cell);return r}function _fnAjaxUpdate(e){if(e.bAjaxDataGet){e.iDraw++,_fnProcessingDisplay(e,!0);var t=e.aoColumns.length,n=_fnAjaxParameters(e);return _fnServerParams(e,n),e.fnServerData.call(e.oInstance,e.sAjaxSource,n,function(t){_fnAjaxUpdateDraw(e,t)},e),!1}return!0}function _fnAjaxParameters(e){var t=e.aoColumns.length,n=[],r,i,s,o,u;n.push({name:"sEcho",value:e.iDraw}),n.push({name:"iColumns",value:t}),n.push({name:"sColumns",value:_fnColumnOrdering(e)}),n.push({name:"iDisplayStart",value:e._iDisplayStart}),n.push({name:"iDisplayLength",value:e.oFeatures.bPaginate!==!1?e._iDisplayLength:-1});for(o=0;o<t;o++)r=e.aoColumns[o].mData,n.push({name:"mDataProp_"+o,value:typeof r=="function"?"function":r});if(e.oFeatures.bFilter!==!1){n.push({name:"sSearch",value:e.oPreviousSearch.sSearch}),n.push({name:"bRegex",value:e.oPreviousSearch.bRegex});for(o=0;o<t;o++)n.push({name:"sSearch_"+o,value:e.aoPreSearchCols[o].sSearch}),n.push({name:"bRegex_"+o,value:e.aoPreSearchCols[o].bRegex}),n.push({name:"bSearchable_"+o,value:e.aoColumns[o].bSearchable})}if(e.oFeatures.bSort!==!1){var a=0;i=e.aaSortingFixed!==null?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice();for(o=0;o<i.length;o++){s=e.aoColumns[i[o][0]].aDataSort;for(u=0;u<s.length;u++)n.push({name:"iSortCol_"+a,value:s[u]}),n.push({name:"sSortDir_"+a,value:i[o][1]}),a++}n.push({name:"iSortingCols",value:a});for(o=0;o<t;o++)n.push({name:"bSortable_"+o,value:e.aoColumns[o].bSortable})}return n}function _fnServerParams(e,t){_fnCallbackFire(e,"aoServerParams","serverParams",[t])}function _fnAjaxUpdateDraw(e,t){if(t.sEcho!==undefined){if(t.sEcho*1<e.iDraw)return;e.iDraw=t.sEcho*1}(!e.oScroll.bInfinite||e.oScroll.bInfinite&&(e.bSorted||e.bFiltered))&&_fnClearTable(e),e._iRecordsTotal=parseInt(t.iTotalRecords,10),e._iRecordsDisplay=parseInt(t.iTotalDisplayRecords,10);var n=_fnColumnOrdering(e),r=t.sColumns!==undefined&&n!==""&&t.sColumns!=n,i;r&&(i=_fnReOrderIndex(e,t.sColumns));var s=_fnGetObjectDataFn(e.sAjaxDataProp)(t);for(var o=0,u=s.length;o<u;o++)if(r){var a=[];for(var f=0,l=e.aoColumns.length;f<l;f++)a.push(s[o][i[f]]);_fnAddData(e,a)}else _fnAddData(e,s[o]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,_fnDraw(e),e.bAjaxDataGet=!0,_fnProcessingDisplay(e,!1)}function _fnFeatureHtmlFilter(e){var t=e.oPreviousSearch,n=e.oLanguage.sSearch;n=n.indexOf("_INPUT_")!==-1?n.replace("_INPUT_",'<input type="text" />'):n===""?'<input type="text" />':n+' <input type="text" />';var r=document.createElement("div");r.className=e.oClasses.sFilter,r.innerHTML="<label>"+n+"</label>",e.aanFeatures.f||(r.id=e.sTableId+"_filter");var i=$('input[type="text"]',r);return r._DT_Input=i[0],i.val(t.sSearch.replace('"',"&quot;")),i.bind("keyup.DT",function(n){var r=e.aanFeatures.f,i=this.value===""?"":this.value;for(var s=0,o=r.length;s<o;s++)r[s]!=$(this).parents("div.dataTables_filter")[0]&&$(r[s]._DT_Input).val(i);i!=t.sSearch&&_fnFilterComplete(e,{sSearch:i,bRegex:t.bRegex,bSmart:t.bSmart,bCaseInsensitive:t.bCaseInsensitive})}),i.attr("aria-controls",e.sTableId).bind("keypress.DT",function(e){if(e.keyCode==13)return!1}),r}function _fnFilterComplete(e,t,n){var r=e.oPreviousSearch,i=e.aoPreSearchCols,s=function(e){r.sSearch=e.sSearch,r.bRegex=e.bRegex,r.bSmart=e.bSmart,r.bCaseInsensitive=e.bCaseInsensitive};if(!e.oFeatures.bServerSide){_fnFilter(e,t.sSearch,n,t.bRegex,t.bSmart,t.bCaseInsensitive),s(t);for(var o=0;o<e.aoPreSearchCols.length;o++)_fnFilterColumn(e,i[o].sSearch,o,i[o].bRegex,i[o].bSmart,i[o].bCaseInsensitive);_fnFilterCustom(e)}else s(t);e.bFiltered=!0,$(e.oInstance).trigger("filter",e),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e),_fnBuildSearchArray(e,0)}function _fnFilterCustom(e){var t=DataTable.ext.afnFiltering,n=_fnGetColumns(e,"bSearchable");for(var r=0,i=t.length;r<i;r++){var s=0;for(var o=0,u=e.aiDisplay.length;o<u;o++){var a=e.aiDisplay[o-s],f=t[r](e,_fnGetRowData(e,a,"filter",n),a);f||(e.aiDisplay.splice(o-s,1),s++)}}}function _fnFilterColumn(e,t,n,r,i,s){if(t==="")return;var o=0,u=_fnFilterCreateSearch(t,r,i,s);for(var a=e.aiDisplay.length-1;a>=0;a--){var f=_fnDataToSearch(_fnGetCellData(e,e.aiDisplay[a],n,"filter"),e.aoColumns[n].sType);u.test(f)||(e.aiDisplay.splice(a,1),o++)}}function _fnFilter(e,t,n,r,i,s){var o,u=_fnFilterCreateSearch(t,r,i,s),a=e.oPreviousSearch;n||(n=0),DataTable.ext.afnFiltering.length!==0&&(n=1);if(t.length<=0)e.aiDisplay.splice(0,e.aiDisplay.length),e.aiDisplay=e.aiDisplayMaster.slice();else if(e.aiDisplay.length==e.aiDisplayMaster.length||a.sSearch.length>t.length||n==1||t.indexOf(a.sSearch)!==0){e.aiDisplay.splice(0,e.aiDisplay.length),_fnBuildSearchArray(e,1);for(o=0;o<e.aiDisplayMaster.length;o++)u.test(e.asDataSearch[o])&&e.aiDisplay.push(e.aiDisplayMaster[o])}else{var f=0;for(o=0;o<e.asDataSearch.length;o++)u.test(e.asDataSearch[o])||(e.aiDisplay.splice(o-f,1),f++)}}function _fnBuildSearchArray(e,t){if(!e.oFeatures.bServerSide){e.asDataSearch=[];var n=_fnGetColumns(e,"bSearchable"),r=t===1?e.aiDisplayMaster:e.aiDisplay;for(var i=0,s=r.length;i<s;i++)e.asDataSearch[i]=_fnBuildSearchRow(e,_fnGetRowData(e,r[i],"filter",n))}}function _fnBuildSearchRow(e,t){var n=t.join("  ");return n.indexOf("&")!==-1&&(n=$("<div>").html(n).text()),n.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(e,t,n,r){var i,s;return n?(i=t?e.split(" "):_fnEscapeRegex(e).split(" "),s="^(?=.*?"+i.join(")(?=.*?")+").*$",new RegExp(s,r?"i":"")):(e=t?e:_fnEscapeRegex(e),new RegExp(e,r?"i":""))}function _fnDataToSearch(e,t){return typeof DataTable.ext.ofnSearch[t]=="function"?DataTable.ext.ofnSearch[t](e):e===null?"":t=="html"?e.replace(/[\r\n]/g," ").replace(/<.*?>/g,""):typeof e=="string"?e.replace(/[\r\n]/g," "):e}function _fnEscapeRegex(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"],n=new RegExp("(\\"+t.join("|\\")+")","g");return e.replace(n,"\\$1")}function _fnFeatureHtmlInfo(e){var t=document.createElement("div");return t.className=e.oClasses.sInfo,e.aanFeatures.i||(e.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),t.id=e.sTableId+"_info"),e.nTable.setAttribute("aria-describedby",e.sTableId+"_info"),t}function _fnUpdateInfo(e){if(!e.oFeatures.bInfo||e.aanFeatures.i.length===0)return;var t=e.oLanguage,n=e._iDisplayStart+1,r=e.fnDisplayEnd(),i=e.fnRecordsTotal(),s=e.fnRecordsDisplay(),o;s===0?o=t.sInfoEmpty:o=t.sInfo,s!=i&&(o+=" "+t.sInfoFiltered),o+=t.sInfoPostFix,o=_fnInfoMacros(e,o),t.fnInfoCallback!==null&&(o=t.fnInfoCallback.call(e.oInstance,e,n,r,i,s,o));var u=e.aanFeatures.i;for(var a=0,f=u.length;a<f;a++)$(u[a]).html(o)}function _fnInfoMacros(e,t){var n=e._iDisplayStart+1,r=e.fnFormatNumber(n),i=e.fnDisplayEnd(),s=e.fnFormatNumber(i),o=e.fnRecordsDisplay(),u=e.fnFormatNumber(o),a=e.fnRecordsTotal(),f=e.fnFormatNumber(a);return e.oScroll.bInfinite&&(r=e.fnFormatNumber(1)),t.replace(/_START_/g,r).replace(/_END_/g,s).replace(/_TOTAL_/g,u).replace(/_MAX_/g,f)}function _fnInitialise(e){var t,n,r=e.iInitDisplayStart;if(e.bInitialised===!1){setTimeout(function(){_fnInitialise(e)},200);return}_fnAddOptionsHtml(e),_fnBuildHead(e),_fnDrawHead(e,e.aoHeader),e.nTFoot&&_fnDrawHead(e,e.aoFooter),_fnProcessingDisplay(e,!0),e.oFeatures.bAutoWidth&&_fnCalculateColumnWidths(e);for(t=0,n=e.aoColumns.length;t<n;t++)e.aoColumns[t].sWidth!==null&&(e.aoColumns[t].nTh.style.width=_fnStringToCss(e.aoColumns[t].sWidth));e.oFeatures.bSort?_fnSort(e):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e));if(e.sAjaxSource!==null&&!e.oFeatures.bServerSide){var i=[];_fnServerParams(e,i),e.fnServerData.call(e.oInstance,e.sAjaxSource,i,function(n){var i=e.sAjaxDataProp!==""?_fnGetObjectDataFn(e.sAjaxDataProp)(n):n;for(t=0;t<i.length;t++)_fnAddData(e,i[t]);e.iInitDisplayStart=r,e.oFeatures.bSort?_fnSort(e):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),_fnProcessingDisplay(e,!1),_fnInitComplete(e,n)},e);return}e.oFeatures.bServerSide||(_fnProcessingDisplay(e,!1),_fnInitComplete(e))}function _fnInitComplete(e,t){e._bInitComplete=!0,_fnCallbackFire(e,"aoInitComplete","init",[e,t])}function _fnLanguageCompat(e){var t=DataTable.defaults.oLanguage;!e.sEmptyTable&&e.sZeroRecords&&t.sEmptyTable==="No data available in table"&&_fnMap(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&e.sZeroRecords&&t.sLoadingRecords==="Loading..."&&_fnMap(e,e,"sZeroRecords","sLoadingRecords")}function _fnFeatureHtmlLength(e){if(e.oScroll.bInfinite)return null;var t='name="'+e.sTableId+'_length"',n='<select size="1" '+t+">",r,i,s=e.aLengthMenu;if(s.length==2&&typeof s[0]=="object"&&typeof s[1]=="object")for(r=0,i=s[0].length;r<i;r++)n+='<option value="'+s[0][r]+'">'+s[1][r]+"</option>";else for(r=0,i=s.length;r<i;r++)n+='<option value="'+s[r]+'">'+s[r]+"</option>";n+="</select>";var o=document.createElement("div");return e.aanFeatures.l||(o.id=e.sTableId+"_length"),o.className=e.oClasses.sLength,o.innerHTML="<label>"+e.oLanguage.sLengthMenu.replace("_MENU_",n)+"</label>",$('select option[value="'+e._iDisplayLength+'"]',o).attr("selected",!0),$("select",o).bind("change.DT",function(t){var n=$(this).val(),s=e.aanFeatures.l;for(r=0,i=s.length;r<i;r++)s[r]!=this.parentNode&&$("select",s[r]).val(n);e._iDisplayLength=parseInt(n,10),_fnCalculateEnd(e),e.fnDisplayEnd()==e.fnRecordsDisplay()&&(e._iDisplayStart=e.fnDisplayEnd()-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),e._iDisplayLength==-1&&(e._iDisplayStart=0),_fnDraw(e)}),$("select",o).attr("aria-controls",e.sTableId),o}function _fnCalculateEnd(e){e.oFeatures.bPaginate===!1?e._iDisplayEnd=e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength>e.aiDisplay.length||e._iDisplayLength==-1?e._iDisplayEnd=e.aiDisplay.length:e._iDisplayEnd=e._iDisplayStart+e._iDisplayLength}function _fnFeatureHtmlPaginate(e){if(e.oScroll.bInfinite)return null;var t=document.createElement("div");return t.className=e.oClasses.sPaging+e.sPaginationType,DataTable.ext.oPagination[e.sPaginationType].fnInit(e,t,function(e){_fnCalculateEnd(e),_fnDraw(e)}),e.aanFeatures.p||e.aoDrawCallback.push({fn:function(e){DataTable.ext.oPagination[e.sPaginationType].fnUpdate(e,function(e){_fnCalculateEnd(e),_fnDraw(e)})},sName:"pagination"}),t}function _fnPageChange(e,t){var n=e._iDisplayStart;if(typeof t=="number")e._iDisplayStart=t*e._iDisplayLength,e._iDisplayStart>e.fnRecordsDisplay()&&(e._iDisplayStart=0);else if(t=="first")e._iDisplayStart=0;else if(t=="previous")e._iDisplayStart=e._iDisplayLength>=0?e._iDisplayStart-e._iDisplayLength:0,e._iDisplayStart<0&&(e._iDisplayStart=0);else if(t=="next")e._iDisplayLength>=0?e._iDisplayStart+e._iDisplayLength<e.fnRecordsDisplay()&&(e._iDisplayStart+=e._iDisplayLength):e._iDisplayStart=0;else if(t=="last")if(e._iDisplayLength>=0){var r=parseInt((e.fnRecordsDisplay()-1)/e._iDisplayLength,10)+1;e._iDisplayStart=(r-1)*e._iDisplayLength}else e._iDisplayStart=0;else _fnLog(e,0,"Unknown paging action: "+t);return $(e.oInstance).trigger("page",e),n!=e._iDisplayStart}function _fnFeatureHtmlProcessing(e){var t=document.createElement("div");return e.aanFeatures.r||(t.id=e.sTableId+"_processing"),t.innerHTML=e.oLanguage.sProcessing,t.className=e.oClasses.sProcessing,e.nTable.parentNode.insertBefore(t,e.nTable),t}function _fnProcessingDisplay(e,t){if(e.oFeatures.bProcessing){var n=e.aanFeatures.r;for(var r=0,i=n.length;r<i;r++)n[r].style.visibility=t?"visible":"hidden"}$(e.oInstance).trigger("processing",[e,t])}function _fnFeatureHtmlTable(e){if(e.oScroll.sX===""&&e.oScroll.sY==="")return e.nTable;var t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),u=e.nTable.cloneNode(!1),a=e.nTable.cloneNode(!1),f=e.nTable.getElementsByTagName("thead")[0],l=e.nTable.getElementsByTagName("tfoot").length===0?null:e.nTable.getElementsByTagName("tfoot")[0],c=e.oClasses;n.appendChild(r),s.appendChild(o),i.appendChild(e.nTable),t.appendChild(n),t.appendChild(i),r.appendChild(u),u.appendChild(f),l!==null&&(t.appendChild(s),o.appendChild(a),a.appendChild(l)),t.className=c.sScrollWrapper,n.className=c.sScrollHead,r.className=c.sScrollHeadInner,i.className=c.sScrollBody,s.className=c.sScrollFoot,o.className=c.sScrollFootInner,e.oScroll.bAutoCss&&(n.style.overflow="hidden",n.style.position="relative",s.style.overflow="hidden",i.style.overflow="auto"),n.style.border="0",n.style.width="100%",s.style.border="0",r.style.width=e.oScroll.sXInner!==""?e.oScroll.sXInner:"100%",u.removeAttribute("id"),u.style.marginLeft="0",e.nTable.style.marginLeft="0",l!==null&&(a.removeAttribute("id"),a.style.marginLeft="0");var h=$(e.nTable).children("caption");return h.length>0&&(h=h[0],h._captionSide==="top"?u.appendChild(h):h._captionSide==="bottom"&&l&&a.appendChild(h)),e.oScroll.sX!==""&&(n.style.width=_fnStringToCss(e.oScroll.sX),i.style.width=_fnStringToCss(e.oScroll.sX),l!==null&&(s.style.width=_fnStringToCss(e.oScroll.sX)),$(i).scroll(function(e){n.scrollLeft=this.scrollLeft,l!==null&&(s.scrollLeft=this.scrollLeft)})),e.oScroll.sY!==""&&(i.style.height=_fnStringToCss(e.oScroll.sY)),e.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),e.oScroll.bInfinite&&$(i).scroll(function(){!e.bDrawing&&$(this).scrollTop()!==0&&$(this).scrollTop()+$(this).height()>$(e.nTable).height()-e.oScroll.iLoadGap&&e.fnDisplayEnd()<e.fnRecordsDisplay()&&(_fnPageChange(e,"next"),_fnCalculateEnd(e),_fnDraw(e))}),e.nScrollHead=n,e.nScrollFoot=s,t}function _fnScrollDraw(e){var t=e.nScrollHead.getElementsByTagName("div")[0],n=t.getElementsByTagName("table")[0],r=e.nTable.parentNode,i,s,o,u,a,f,l,c,h,p,d,v,m,g=[],y=[],b,w=e.nTFoot!==null?e.nScrollFoot.getElementsByTagName("div")[0]:null,E=e.nTFoot!==null?w.getElementsByTagName("table")[0]:null,S=e.oBrowser.bScrollOversize,x=function(e){h=e.style,h.paddingTop="0",h.paddingBottom="0",h.borderTopWidth="0",h.borderBottomWidth="0",h.height=0};$(e.nTable).children("thead, tfoot").remove(),d=$(e.nTHead).clone()[0],e.nTable.insertBefore(d,e.nTable.childNodes[0]),a=e.nTHead.getElementsByTagName("tr"),f=d.getElementsByTagName("tr"),e.nTFoot!==null&&(v=$(e.nTFoot).clone()[0],e.nTable.insertBefore(v,e.nTable.childNodes[1]),c=e.nTFoot.getElementsByTagName("tr"),l=v.getElementsByTagName("tr")),e.oScroll.sX===""&&(r.style.width="100%",t.parentNode.style.width="100%");var T=_fnGetUniqueThs(e,d);for(i=0,s=T.length;i<s;i++)p=_fnVisibleToColumnIndex(e,i),T[i].style.width=e.aoColumns[p].sWidth;e.nTFoot!==null&&_fnApplyToChildren(function(e){e.style.width=""},l),e.oScroll.bCollapse&&e.oScroll.sY!==""&&(r.style.height=r.offsetHeight+e.nTHead.offsetHeight+"px"),b=$(e.nTable).outerWidth(),e.oScroll.sX===""?(e.nTable.style.width="100%",S&&($("tbody",r).height()>r.offsetHeight||$(r).css("overflow-y")=="scroll")&&(e.nTable.style.width=_fnStringToCss($(e.nTable).outerWidth()-e.oScroll.iBarWidth))):e.oScroll.sXInner!==""?e.nTable.style.width=_fnStringToCss(e.oScroll.sXInner):b==$(r).width()&&$(r).height()<$(e.nTable).height()?(e.nTable.style.width=_fnStringToCss(b-e.oScroll.iBarWidth),$(e.nTable).outerWidth()>b-e.oScroll.iBarWidth&&(e.nTable.style.width=_fnStringToCss(b))):e.nTable.style.width=_fnStringToCss(b),b=$(e.nTable).outerWidth(),_fnApplyToChildren(x,f),_fnApplyToChildren(function(e){g.push(_fnStringToCss($(e).width()))},f),_fnApplyToChildren(function(e,t){e.style.width=g[t]},a),$(f).height(0),e.nTFoot!==null&&(_fnApplyToChildren(x,l),_fnApplyToChildren(function(e){y.push(_fnStringToCss($(e).width()))},l),_fnApplyToChildren(function(e,t){e.style.width=y[t]},c),$(l).height(0)),_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=g[t]},f),e.nTFoot!==null&&_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=y[t]},l);if($(e.nTable).outerWidth()<b){var N=r.scrollHeight>r.offsetHeight||$(r).css("overflow-y")=="scroll"?b+e.oScroll.iBarWidth:b;S&&(r.scrollHeight>r.offsetHeight||$(r).css("overflow-y")=="scroll")&&(e.nTable.style.width=_fnStringToCss(N-e.oScroll.iBarWidth)),r.style.width=_fnStringToCss(N),e.nScrollHead.style.width=_fnStringToCss(N),e.nTFoot!==null&&(e.nScrollFoot.style.width=_fnStringToCss(N)),e.oScroll.sX===""?_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):e.oScroll.sXInner!==""&&_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}else r.style.width=_fnStringToCss("100%"),e.nScrollHead.style.width=_fnStringToCss("100%"),e.nTFoot!==null&&(e.nScrollFoot.style.width=_fnStringToCss("100%"));e.oScroll.sY===""&&S&&(r.style.height=_fnStringToCss(e.nTable.offsetHeight+e.oScroll.iBarWidth));if(e.oScroll.sY!==""&&e.oScroll.bCollapse){r.style.height=_fnStringToCss(e.oScroll.sY);var C=e.oScroll.sX!==""&&e.nTable.offsetWidth>r.offsetWidth?e.oScroll.iBarWidth:0;e.nTable.offsetHeight<r.offsetHeight&&(r.style.height=_fnStringToCss(e.nTable.offsetHeight+C))}var k=$(e.nTable).outerWidth();n.style.width=_fnStringToCss(k),t.style.width=_fnStringToCss(k);var L=$(e.nTable).height()>r.clientHeight||$(r).css("overflow-y")=="scroll";t.style.paddingRight=L?e.oScroll.iBarWidth+"px":"0px",e.nTFoot!==null&&(E.style.width=_fnStringToCss(k),w.style.width=_fnStringToCss(k),w.style.paddingRight=L?e.oScroll.iBarWidth+"px":"0px"),$(r).scroll();if(e.bSorted||e.bFiltered)r.scrollTop=0}function _fnApplyToChildren(e,t,n){var r=0,i=0,s=t.length,o,u;while(i<s){o=t[i].firstChild,u=n?n[i].firstChild:null;while(o)o.nodeType===1&&(n?e(o,u,r):e(o,r),r++),o=o.nextSibling,u=n?u.nextSibling:null;i++}}function _fnConvertToWidth(e,t){if(!e||e===null||e==="")return 0;t||(t=document.body);var n,r=document.createElement("div");return r.style.width=_fnStringToCss(e),t.appendChild(r),n=r.offsetWidth,t.removeChild(r),n}function _fnCalculateColumnWidths(e){var t=e.nTable.offsetWidth,n=0,r,i=0,s=e.aoColumns.length,o,u,a,f,l=$("th",e.nTHead),c=e.nTable.getAttribute("width"),h=e.nTable.parentNode;for(o=0;o<s;o++)e.aoColumns[o].bVisible&&(i++,e.aoColumns[o].sWidth!==null&&(r=_fnConvertToWidth(e.aoColumns[o].sWidthOrig,h),r!==null&&(e.aoColumns[o].sWidth=_fnStringToCss(r)),n++));if(s==l.length&&n===0&&i==s&&e.oScroll.sX===""&&e.oScroll.sY==="")for(o=0;o<e.aoColumns.length;o++)r=$(l[o]).width(),r!==null&&(e.aoColumns[o].sWidth=_fnStringToCss(r));else{var p=e.nTable.cloneNode(!1),d=e.nTHead.cloneNode(!0),v=document.createElement("tbody"),m=document.createElement("tr"),g;p.removeAttribute("id"),p.appendChild(d),e.nTFoot!==null&&(p.appendChild(e.nTFoot.cloneNode(!0)),_fnApplyToChildren(function(e){e.style.width=""},p.getElementsByTagName("tr"))),p.appendChild(v),v.appendChild(m);var y=$("thead th",p);y.length===0&&(y=$("tbody tr:eq(0)>td",p));var b=_fnGetUniqueThs(e,d);a=0;for(o=0;o<s;o++){var w=e.aoColumns[o];w.bVisible&&w.sWidthOrig!==null&&w.sWidthOrig!==""?b[o-a].style.width=_fnStringToCss(w.sWidthOrig):w.bVisible?b[o-a].style.width="":a++}for(o=0;o<s;o++)if(e.aoColumns[o].bVisible){var E=_fnGetWidestNode(e,o);E!==null&&(E=E.cloneNode(!0),e.aoColumns[o].sContentPadding!==""&&(E.innerHTML+=e.aoColumns[o].sContentPadding),m.appendChild(E))}h.appendChild(p),e.oScroll.sX!==""&&e.oScroll.sXInner!==""?p.style.width=_fnStringToCss(e.oScroll.sXInner):e.oScroll.sX!==""?(p.style.width="",$(p).width()<h.offsetWidth&&(p.style.width=_fnStringToCss(h.offsetWidth))):e.oScroll.sY!==""?p.style.width=_fnStringToCss(h.offsetWidth):c&&(p.style.width=_fnStringToCss(c)),p.style.visibility="hidden",_fnScrollingWidthAdjust(e,p);var S=$("tbody tr:eq(0)",p).children();S.length===0&&(S=_fnGetUniqueThs(e,$("thead",p)[0]));if(e.oScroll.sX!==""){var x=0;a=0;for(o=0;o<e.aoColumns.length;o++)e.aoColumns[o].bVisible&&(e.aoColumns[o].sWidthOrig===null?x+=$(S[a]).outerWidth():x+=parseInt(e.aoColumns[o].sWidth.replace("px",""),10)+($(S[a]).outerWidth()-$(S[a]).width()),a++);p.style.width=_fnStringToCss(x),e.nTable.style.width=_fnStringToCss(x)}a=0;for(o=0;o<e.aoColumns.length;o++)e.aoColumns[o].bVisible&&(f=$(S[a]).width(),f!==null&&f>0&&(e.aoColumns[o].sWidth=_fnStringToCss(f)),a++);var T=$(p).css("width");e.nTable.style.width=T.indexOf("%")!==-1?T:_fnStringToCss($(p).outerWidth()),p.parentNode.removeChild(p)}c&&(e.nTable.style.width=_fnStringToCss(c))}function _fnScrollingWidthAdjust(e,t){if(e.oScroll.sX===""&&e.oScroll.sY!==""){var n=$(t).width();t.style.width=_fnStringToCss($(t).outerWidth()-e.oScroll.iBarWidth)}else e.oScroll.sX!==""&&(t.style.width=_fnStringToCss($(t).outerWidth()))}function _fnGetWidestNode(e,t){var n=_fnGetMaxLenString(e,t);if(n<0)return null;if(e.aoData[n].nTr===null){var r=document.createElement("td");return r.innerHTML=_fnGetCellData(e,n,t,""),r}return _fnGetTdNodes(e,n)[t]}function _fnGetMaxLenString(e,t){var n=-1,r=-1;for(var i=0;i<e.aoData.length;i++){var s=_fnGetCellData(e,i,t,"display")+"";s=s.replace(/<.*?>/g,""),s.length>n&&(n=s.length,r=i)}return r}function _fnStringToCss(e){if(e===null)return"0px";if(typeof e=="number")return e<0?"0px":e+"px";var t=e.charCodeAt(e.length-1);return t<48||t>57?e:e+"px"}function _fnScrollBarWidth(){var e=document.createElement("p"),t=e.style;t.width="100%",t.height="200px",t.padding="0px";var n=document.createElement("div");t=n.style,t.position="absolute",t.top="0px",t.left="0px",t.visibility="hidden",t.width="200px",t.height="150px",t.padding="0px",t.overflow="hidden",n.appendChild(e),document.body.appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var i=e.offsetWidth;return r==i&&(i=n.clientWidth),document.body.removeChild(n),r-i}function _fnSort(e,t){var n,r,i,s,o,u,a,f,l=[],c=[],h=DataTable.ext.oSort,p=e.aoData,d=e.aoColumns,v=e.oLanguage.oAria;if(!e.oFeatures.bServerSide&&(e.aaSorting.length!==0||e.aaSortingFixed!==null)){l=e.aaSortingFixed!==null?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice();for(n=0;n<l.length;n++){var m=l[n][0],g=_fnColumnIndexToVisible(e,m);a=e.aoColumns[m].sSortDataType;if(DataTable.ext.afnSortData[a]){var y=DataTable.ext.afnSortData[a].call(e.oInstance,e,m,g);if(y.length===p.length)for(i=0,s=p.length;i<s;i++)_fnSetCellData(e,i,m,y[i]);else _fnLog(e,0,"Returned data sort array (col "+m+") is the wrong length")}}for(n=0,r=e.aiDisplayMaster.length;n<r;n++)c[e.aiDisplayMaster[n]]=n;var b=l.length,w,E;for(n=0,r=p.length;n<r;n++)for(i=0;i<b;i++){E=d[l[i][0]].aDataSort;for(o=0,u=E.length;o<u;o++)a=d[E[o]].sType,w=h[(a?a:"string")+"-pre"],p[n]._aSortData[E[o]]=w?w(_fnGetCellData(e,n,E[o],"sort")):_fnGetCellData(e,n,E[o],"sort")}e.aiDisplayMaster.sort(function(e,t){var n,r,i,s,o,u;for(n=0;n<b;n++){o=d[l[n][0]].aDataSort;for(r=0,i=o.length;r<i;r++){u=d[o[r]].sType,s=h[(u?u:"string")+"-"+l[n][1]](p[e]._aSortData[o[r]],p[t]._aSortData[o[r]]);if(s!==0)return s}}return h["numeric-asc"](c[e],c[t])})}(t===undefined||t)&&!e.oFeatures.bDeferRender&&_fnSortingClasses(e);for(n=0,r=e.aoColumns.length;n<r;n++){var S=d[n].sTitle.replace(/<.*?>/g,"");f=d[n].nTh,f.removeAttribute("aria-sort"),f.removeAttribute("aria-label");if(d[n].bSortable)if(l.length>0&&l[0][0]==n){f.setAttribute("aria-sort",l[0][1]=="asc"?"ascending":"descending");var x=d[n].asSorting[l[0][2]+1]?d[n].asSorting[l[0][2]+1]:d[n].asSorting[0];f.setAttribute("aria-label",S+(x=="asc"?v.sSortAscending:v.sSortDescending))}else f.setAttribute("aria-label",S+(d[n].asSorting[0]=="asc"?v.sSortAscending:v.sSortDescending));else f.setAttribute("aria-label",S)}e.bSorted=!0,$(e.oInstance).trigger("sort",e),e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch,1):(e.aiDisplay=e.aiDisplayMaster.slice(),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e))}function _fnSortAttachListener(e,t,n,r){_fnBindAction(t,{},function(t){if(e.aoColumns[n].bSortable===!1)return;var i=function(){var r,i;if(t.shiftKey){var s=!1;for(var o=0;o<e.aaSorting.length;o++)if(e.aaSorting[o][0]==n){s=!0,r=e.aaSorting[o][0],i=e.aaSorting[o][2]+1,e.aoColumns[r].asSorting[i]?(e.aaSorting[o][1]=e.aoColumns[r].asSorting[i],e.aaSorting[o][2]=i):e.aaSorting.splice(o,1);break}s===!1&&e.aaSorting.push([n,e.aoColumns[n].asSorting[0],0])}else e.aaSorting.length==1&&e.aaSorting[0][0]==n?(r=e.aaSorting[0][0],i=e.aaSorting[0][2]+1,e.aoColumns[r].asSorting[i]||(i=0),e.aaSorting[0][1]=e.aoColumns[r].asSorting[i],e.aaSorting[0][2]=i):(e.aaSorting.splice(0,e.aaSorting.length),e.aaSorting.push([n,e.aoColumns[n].asSorting[0],0]));_fnSort(e)};e.oFeatures.bProcessing?(_fnProcessingDisplay(e,!0),setTimeout(function(){i(),e.oFeatures.bServerSide||_fnProcessingDisplay(e,!1)},0)):i(),typeof r=="function"&&r(e)})}function _fnSortingClasses(e){var t,n,r,i,s,o,u,a=e.aoColumns.length,f=e.oClasses;for(t=0;t<a;t++)e.aoColumns[t].bSortable&&$(e.aoColumns[t].nTh).removeClass(f.sSortAsc+" "+f.sSortDesc+" "+e.aoColumns[t].sSortingClass);e.aaSortingFixed!==null?o=e.aaSortingFixed.concat(e.aaSorting):o=e.aaSorting.slice();for(t=0;t<e.aoColumns.length;t++)if(e.aoColumns[t].bSortable){u=e.aoColumns[t].sSortingClass,s=-1;for(r=0;r<o.length;r++)if(o[r][0]==t){u=o[r][1]=="asc"?f.sSortAsc:f.sSortDesc,s=r;break}$(e.aoColumns[t].nTh).addClass(u);if(e.bJUI){var l=$("span."+f.sSortIcon,e.aoColumns[t].nTh);l.removeClass(f.sSortJUIAsc+" "+f.sSortJUIDesc+" "+f.sSortJUI+" "+f.sSortJUIAscAllowed+" "+f.sSortJUIDescAllowed);var c;s==-1?c=e.aoColumns[t].sSortingClassJUI:o[s][1]=="asc"?c=f.sSortJUIAsc:c=f.sSortJUIDesc,l.addClass(c)}}else $(e.aoColumns[t].nTh).addClass(e.aoColumns[t].sSortingClass);u=f.sSortColumn;if(e.oFeatures.bSort&&e.oFeatures.bSortClasses){var h=_fnGetTdNodes(e),p,d,v=[];for(t=0;t<a;t++)v.push("");for(t=0,p=1;t<o.length;t++)d=parseInt(o[t][0],10),v[d]=u+p,p<3&&p++;var m=new RegExp(u+"[123]"),g,y,b;for(t=0,n=h.length;t<n;t++)d=t%a,y=h[t].className,b=v[d],g=y.replace(m,b),g!=y?h[t].className=$.trim(g):b.length>0&&y.indexOf(b)==-1&&(h[t].className=y+" "+b)}}function _fnSaveState(e){if(!e.oFeatures.bStateSave||e.bDestroying)return;var t,n,r=e.oScroll.bInfinite,i={iCreate:(new Date).getTime(),iStart:r?0:e._iDisplayStart,iEnd:r?e._iDisplayLength:e._iDisplayEnd,iLength:e._iDisplayLength,aaSorting:$.extend(!0,[],e.aaSorting),oSearch:$.extend(!0,{},e.oPreviousSearch),aoSearchCols:$.extend(!0,[],e.aoPreSearchCols),abVisCols:[]};for(t=0,n=e.aoColumns.length;t<n;t++)i.abVisCols.push(e.aoColumns[t].bVisible);_fnCallbackFire(e,"aoStateSaveParams","stateSaveParams",[e,i]),e.fnStateSave.call(e.oInstance,e,i)}function _fnLoadState(e,t){if(!e.oFeatures.bStateSave)return;var n=e.fnStateLoad.call(e.oInstance,e);if(!n)return;var r=_fnCallbackFire(e,"aoStateLoadParams","stateLoadParams",[e,n]);if($.inArray(!1,r)!==-1)return;e.oLoadedState=$.extend(!0,{},n),e._iDisplayStart=n.iStart,e.iInitDisplayStart=n.iStart,e._iDisplayEnd=n.iEnd,e._iDisplayLength=n.iLength,e.aaSorting=n.aaSorting.slice(),e.saved_aaSorting=n.aaSorting.slice(),$.extend(e.oPreviousSearch,n.oSearch),$.extend(!0,e.aoPreSearchCols,n.aoSearchCols),t.saved_aoColumns=[];for(var i=0;i<n.abVisCols.length;i++)t.saved_aoColumns[i]={},t.saved_aoColumns[i].bVisible=n.abVisCols[i];_fnCallbackFire(e,"aoStateLoaded","stateLoaded",[e,n])}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date;date.setTime(date.getTime()+iSecs*1e3);var aParts=window.location.pathname.split("/"),sNameFile=sName+"_"+aParts.pop().replace(/[\/:]/g,"").toLowerCase(),sFullCookie,oData;fnCallback!==null?(oData=typeof $.parseJSON=="function"?$.parseJSON(sValue):eval("("+sValue+")"),sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join("/")+"/")):sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join("/")+"/";var aCookies=document.cookie.split(";"),iNewCookieLen=sFullCookie.split(";")[0].length,aOldCookies=[];if(iNewCookieLen+document.cookie.length+10>4096){for(var i=0,iLen=aCookies.length;i<iLen;i++)if(aCookies[i].indexOf(sBaseName)!=-1){var aSplitCookie=aCookies[i].split("=");try{oData=eval("("+decodeURIComponent(aSplitCookie[1])+")"),oData&&oData.iCreate&&aOldCookies.push({name:aSplitCookie[0],time:oData.iCreate})}catch(e){}}aOldCookies.sort(function(e,t){return t.time-e.time});while(iNewCookieLen+document.cookie.length+10>4096){if(aOldCookies.length===0)return;var old=aOldCookies.pop();document.cookie=old.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join("/")+"/"}}document.cookie=sFullCookie}function _fnReadCookie(e){var t=window.location.pathname.split("/"),n=e+"_"+t[t.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",r=document.cookie.split(";");for(var i=0;i<r.length;i++){var s=r[i];while(s.charAt(0)==" ")s=s.substring(1,s.length);if(s.indexOf(n)===0)return decodeURIComponent(s.substring(n.length,s.length))}return null}function _fnSettingsFromNode(e){for(var t=0;t<DataTable.settings.length;t++)if(DataTable.settings[t].nTable===e)return DataTable.settings[t];return null}function _fnGetTrNodes(e){var t=[],n=e.aoData;for(var r=0,i=n.length;r<i;r++)n[r].nTr!==null&&t.push(n[r].nTr);return t}function _fnGetTdNodes(e,t){var n=[],r,i,s,o,u=e.aoData.length,a,f,l,c,h=0,p=u;t!==undefined&&(h=t,p=t+1);for(o=h;o<p;o++){l=e.aoData[o];if(l.nTr!==null){i=[],s=l.nTr.firstChild;while(s)c=s.nodeName.toLowerCase(),(c=="td"||c=="th")&&i.push(s),s=s.nextSibling;r=0;for(a=0,f=e.aoColumns.length;a<f;a++)e.aoColumns[a].bVisible?n.push(i[a-r]):(n.push(l._anHidden[a]),r++)}}return n}function _fnLog(e,t,n){var r=e===null?"DataTables warning: "+n:"DataTables warning (table id = '"+e.sTableId+"'): "+n;if(t===0){if(DataTable.ext.sErrMode!="alert")throw new Error(r);alert(r);return}window.console&&console.log&&console.log(r)}function _fnMap(e,t,n,r){r===undefined&&(r=n),t[n]!==undefined&&(e[r]=t[n])}function _fnExtend(e,t){var n;for(var r in t)t.hasOwnProperty(r)&&(n=t[r],typeof oInit[r]=="object"&&n!==null&&$.isArray(n)===!1?$.extend(!0,e[r],n):e[r]=n);return e}function _fnBindAction(e,t,n){$(e).bind("click.DT",t,function(t){e.blur(),n(t)}).bind("keypress.DT",t,function(e){e.which===13&&n(e)}).bind("selectstart.DT",function(){return!1})}function _fnCallbackReg(e,t,n,r){n&&e[t].push({fn:n,sName:r})}function _fnCallbackFire(e,t,n,r){var i=e[t],s=[];for(var o=i.length-1;o>=0;o--)s.push(i[o].fn.apply(e.oInstance,r));return n!==null&&$(e.oInstance).trigger(n,r),s}function _fnBrowserDetect(e){var t=$('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];document.body.appendChild(t),e.oBrowser.bScrollOversize=$("#DT_BrowserTest",t)[0].offsetWidth===100?!0:!1,document.body.removeChild(t)}function _fnExternApiFunc(e){return function(){var t=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.oApi[e].apply(this,t)}}var __reArray=/\[.*?\]$/,_fnJsonString=window.JSON?JSON.stringify:function(e){var t=typeof e;if(t!=="object"||e===null)return t==="string"&&(e='"'+e+'"'),e+"";var n,r,i=[],s=$.isArray(e);for(n in e)r=e[n],t=typeof r,t==="string"?r='"'+r+'"':t==="object"&&r!==null&&(r=_fnJsonString(r)),i.push((s?"":'"'+n+'":')+r);return(s?"[":"{")+i+(s?"]":"}")};this.$=function(e,t){var n,r,i=[],s,o=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),u=o.aoData,a=o.aiDisplay,f=o.aiDisplayMaster;t||(t={}),t=$.extend({},{filter:"none",order:"current",page:"all"},t);if(t.page=="current")for(n=o._iDisplayStart,r=o.fnDisplayEnd();n<r;n++)s=u[a[n]].nTr,s&&i.push(s);else if(t.order=="current"&&t.filter=="none")for(n=0,r=f.length;n<r;n++)s=u[f[n]].nTr,s&&i.push(s);else if(t.order=="current"&&t.filter=="applied")for(n=0,r=a.length;n<r;n++)s=u[a[n]].nTr,s&&i.push(s);else if(t.order=="original"&&t.filter=="none")for(n=0,r=u.length;n<r;n++)s=u[n].nTr,s&&i.push(s);else if(t.order=="original"&&t.filter=="applied")for(n=0,r=u.length;n<r;n++)s=u[n].nTr,$.inArray(n,a)!==-1&&s&&i.push(s);else _fnLog(o,1,"Unknown selection options");var l=$(i),c=l.filter(e),h=l.find(e);return $([].concat($.makeArray(c),$.makeArray(h)))},this._=function(e,t){var n=[],r,i,s,o=this.$(e,t);for(r=0,i=o.length;r<i;r++)n.push(this.fnGetData(o[r]));return n},this.fnAddData=function(e,t){if(e.length===0)return[];var n=[],r,i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(typeof e[0]=="object"&&e[0]!==null)for(var s=0;s<e.length;s++){r=_fnAddData(i,e[s]);if(r==-1)return n;n.push(r)}else{r=_fnAddData(i,e);if(r==-1)return n;n.push(r)}return i.aiDisplay=i.aiDisplayMaster.slice(),(t===undefined||t)&&_fnReDraw(i),n},this.fnAdjustColumnSizing=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnAdjustColumnSizing(t),e===undefined||e?this.fnDraw(!1):(t.oScroll.sX!==""||t.oScroll.sY!=="")&&this.oApi._fnScrollDraw(t)},this.fnClearTable=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnClearTable(t),(e===undefined||e)&&_fnDraw(t)},this.fnClose=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);for(var n=0;n<t.aoOpenRows.length;n++)if(t.aoOpenRows[n].nParent==e){var r=t.aoOpenRows[n].nTr.parentNode;return r&&r.removeChild(t.aoOpenRows[n].nTr),t.aoOpenRows.splice(n,1),0}return 1},this.fnDeleteRow=function(e,t,n){var r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i,s,o;o=typeof e=="object"?_fnNodeToDataIndex(r,e):e;var u=r.aoData.splice(o,1);for(i=0,s=r.aoData.length;i<s;i++)r.aoData[i].nTr!==null&&(r.aoData[i].nTr._DT_RowIndex=i);var a=$.inArray(o,r.aiDisplay);r.asDataSearch.splice(a,1),_fnDeleteIndex(r.aiDisplayMaster,o),_fnDeleteIndex(r.aiDisplay,o),typeof t=="function"&&t.call(this,r,u),r._iDisplayStart>=r.fnRecordsDisplay()&&(r._iDisplayStart-=r._iDisplayLength,r._iDisplayStart<0&&(r._iDisplayStart=0));if(n===undefined||n)_fnCalculateEnd(r),_fnDraw(r);return u},this.fnDestroy=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=t.nTableWrapper.parentNode,r=t.nTBody,i,s;e=e===undefined?!1:e,t.bDestroying=!0,_fnCallbackFire(t,"aoDestroyCallback","destroy",[t]);if(!e)for(i=0,s=t.aoColumns.length;i<s;i++)t.aoColumns[i].bVisible===!1&&this.fnSetColumnVis(i,!0);$(t.nTableWrapper).find("*").andSelf().unbind(".DT"),$("tbody>tr>td."+t.oClasses.sRowEmpty,t.nTable).parent().remove(),t.nTable!=t.nTHead.parentNode&&($(t.nTable).children("thead").remove(),t.nTable.appendChild(t.nTHead)),t.nTFoot&&t.nTable!=t.nTFoot.parentNode&&($(t.nTable).children("tfoot").remove(),t.nTable.appendChild(t.nTFoot)),t.nTable.parentNode.removeChild(t.nTable),$(t.nTableWrapper).remove(),t.aaSorting=[],t.aaSortingFixed=[],_fnSortingClasses(t),$(_fnGetTrNodes(t)).removeClass(t.asStripeClasses.join(" ")),$("th, td",t.nTHead).removeClass([t.oClasses.sSortable,t.oClasses.sSortableAsc,t.oClasses.sSortableDesc,t.oClasses.sSortableNone].join(" ")),t.bJUI&&($("th span."+t.oClasses.sSortIcon+", td span."+t.oClasses.sSortIcon,t.nTHead).remove(),$("th, td",t.nTHead).each(function(){var e=$("div."+t.oClasses.sSortJUIWrapper,this),n=e.contents();$(this).append(n),e.remove()})),!e&&t.nTableReinsertBefore?n.insertBefore(t.nTable,t.nTableReinsertBefore):e||n.appendChild(t.nTable);for(i=0,s=t.aoData.length;i<s;i++)t.aoData[i].nTr!==null&&r.appendChild(t.aoData[i].nTr);t.oFeatures.bAutoWidth===!0&&(t.nTable.style.width=_fnStringToCss(t.sDestroyWidth)),s=t.asDestroyStripes.length;if(s){var o=$(r).children("tr");for(i=0;i<s;i++)o.filter(":nth-child("+s+"n + "+i+")").addClass(t.asDestroyStripes[i])}for(i=0,s=DataTable.settings.length;i<s;i++)DataTable.settings[i]==t&&DataTable.settings.splice(i,1);t=null,oInit=null},this.fnDraw=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);e===!1?(_fnCalculateEnd(t),_fnDraw(t)):_fnReDraw(t)},this.fnFilter=function(e,t,n,r,i,s){var o=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(!o.oFeatures.bFilter)return;if(n===undefined||n===null)n=!1;if(r===undefined||r===null)r=!0;if(i===undefined||i===null)i=!0;if(s===undefined||s===null)s=!0;if(t===undefined||t===null){_fnFilterComplete(o,{sSearch:e+"",bRegex:n,bSmart:r,bCaseInsensitive:s},1);if(i&&o.aanFeatures.f){var u=o.aanFeatures.f;for(var a=0,f=u.length;a<f;a++)try{u[a]._DT_Input!=document.activeElement&&$(u[a]._DT_Input).val(e)}catch(l){$(u[a]._DT_Input).val(e)}}}else $.extend(o.aoPreSearchCols[t],{sSearch:e+"",bRegex:n,bSmart:r,bCaseInsensitive:s}),_fnFilterComplete(o,o.oPreviousSearch,1)},this.fnGetData=function(e,t){var n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(e!==undefined){var r=e;if(typeof e=="object"){var i=e.nodeName.toLowerCase();i==="tr"?r=_fnNodeToDataIndex(n,e):i==="td"&&(r=_fnNodeToDataIndex(n,e.parentNode),t=_fnNodeToColumnIndex(n,r,e))}return t!==undefined?_fnGetCellData(n,r,t,""):n.aoData[r]!==undefined?n.aoData[r]._aData:null}return _fnGetDataMaster(n)},this.fnGetNodes=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);return e!==undefined?t.aoData[e]!==undefined?t.aoData[e].nTr:null:_fnGetTrNodes(t)},this.fnGetPosition=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=e.nodeName.toUpperCase();if(n=="TR")return _fnNodeToDataIndex(t,e);if(n=="TD"||n=="TH"){var r=_fnNodeToDataIndex(t,e.parentNode),i=_fnNodeToColumnIndex(t,r,e);return[r,_fnColumnIndexToVisible(t,i),i]}return null},this.fnIsOpen=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=t.aoOpenRows;for(var r=0;r<t.aoOpenRows.length;r++)if(t.aoOpenRows[r].nParent==e)return!0;return!1},this.fnOpen=function(e,t,n){var r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=_fnGetTrNodes(r);if($.inArray(e,i)===-1)return;this.fnClose(e);var s=document.createElement("tr"),o=document.createElement("td");s.appendChild(o),o.className=n,o.colSpan=_fnVisbleColumns(r),typeof t=="string"?o.innerHTML=t:$(o).html(t);var u=$("tr",r.nTBody);return $.inArray(e,u)!=-1&&$(s).insertAfter(e),r.aoOpenRows.push({nTr:s,nParent:e}),s},this.fnPageChange=function(e,t){var n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnPageChange(n,e),_fnCalculateEnd(n),(t===undefined||t)&&_fnDraw(n)},this.fnSetColumnVis=function(e,t,n){var r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i,s,o=r.aoColumns,u=r.aoData,a,f,l;if(o[e].bVisible==t)return;if(t){var c=0;for(i=0;i<e;i++)o[i].bVisible&&c++;f=c>=_fnVisbleColumns(r);if(!f)for(i=e;i<o.length;i++)if(o[i].bVisible){l=i;break}for(i=0,s=u.length;i<s;i++)u[i].nTr!==null&&(f?u[i].nTr.appendChild(u[i]._anHidden[e]):u[i].nTr.insertBefore(u[i]._anHidden[e],_fnGetTdNodes(r,i)[l]))}else for(i=0,s=u.length;i<s;i++)u[i].nTr!==null&&(a=_fnGetTdNodes(r,i)[e],u[i]._anHidden[e]=a,a.parentNode.removeChild(a));o[e].bVisible=t,_fnDrawHead(r,r.aoHeader),r.nTFoot&&_fnDrawHead(r,r.aoFooter);for(i=0,s=r.aoOpenRows.length;i<s;i++)r.aoOpenRows[i].nTr.colSpan=_fnVisbleColumns(r);if(n===undefined||n)_fnAdjustColumnSizing(r),_fnDraw(r);_fnSaveState(r)},this.fnSettings=function(){return _fnSettingsFromNode(this[DataTable.ext.iApiIndex])},this.fnSort=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);t.aaSorting=e,_fnSort(t)},this.fnSortListener=function(e,t,n){_fnSortAttachListener(_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),e,t,n)},this.fnUpdate=function(e,t,n,r,i){var s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),o,u,a,f=typeof t=="object"?_fnNodeToDataIndex(s,t):t;if($.isArray(e)&&n===undefined){s.aoData[f]._aData=e.slice();for(o=0;o<s.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(s,f,o),f,o,!1,!1)}else if($.isPlainObject(e)&&n===undefined){s.aoData[f]._aData=$.extend(!0,{},e);for(o=0;o<s.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(s,f,o),f,o,!1,!1)}else{_fnSetCellData(s,f,n,e),a=_fnGetCellData(s,f,n,"display");var l=s.aoColumns[n];l.fnRender!==null&&(a=_fnRender(s,f,n),l.bUseRendered&&_fnSetCellData(s,f,n,a)),s.aoData[f].nTr!==null&&(_fnGetTdNodes(s,f)[n].innerHTML=a)}var c=$.inArray(f,s.aiDisplay);return s.asDataSearch[c]=_fnBuildSearchRow(s,_fnGetRowData(s,f,"filter",_fnGetColumns(s,"bSearchable"))),(i===undefined||i)&&_fnAdjustColumnSizing(s),(r===undefined||r)&&_fnReDraw(s),0},this.fnVersionCheck=DataTable.ext.fnVersionCheck,this.oApi={_fnExternApiFunc:_fnExternApiFunc,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLanguageCompat:_fnLanguageCompat,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAddData:_fnAddData,_fnCreateTr:_fnCreateTr,_fnGatherData:_fnGatherData,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnServerParams:_fnServerParams,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnBuildSearchArray:_fnBuildSearchArray,_fnBuildSearchRow:_fnBuildSearchRow,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnDataToSearch:_fnDataToSearch,_fnSort:_fnSort,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnVisbleColumns:_fnVisbleColumns,_fnCalculateEnd:_fnCalculateEnd,_fnConvertToWidth:_fnConvertToWidth,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnDetectType:_fnDetectType,_fnSettingsFromNode:_fnSettingsFromNode,_fnGetDataMaster:_fnGetDataMaster,_fnGetTrNodes:_fnGetTrNodes,_fnGetTdNodes:_fnGetTdNodes,_fnEscapeRegex:_fnEscapeRegex,_fnDeleteIndex:_fnDeleteIndex,_fnReOrderIndex:_fnReOrderIndex,_fnColumnOrdering:_fnColumnOrdering,_fnLog:_fnLog,_fnClearTable:_fnClearTable,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnCreateCookie:_fnCreateCookie,_fnReadCookie:_fnReadCookie,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnScrollBarWidth:_fnScrollBarWidth,_fnApplyToChildren:_fnApplyToChildren,_fnMap:_fnMap,_fnGetRowData:_fnGetRowData,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnBindAction:_fnBindAction,_fnExtend:_fnExtend,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnJsonString:_fnJsonString,_fnRender:_fnRender,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnInfoMacros:_fnInfoMacros,_fnBrowserDetect:_fnBrowserDetect,_fnGetColumns:_fnGetColumns},$.extend(DataTable.ext.oApi,this.oApi);for(var sFunc in DataTable.ext.oApi)sFunc&&(this[sFunc]=_fnExternApiFunc(sFunc));var _that=this;return this.each(function(){var e=0,t,n,r,i,s,o=this.getAttribute("id"),u=!1,a=!1;if(this.nodeName.toLowerCase()!="table"){_fnLog(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);return}for(e=0,t=DataTable.settings.length;e<t;e++){if(DataTable.settings[e].nTable==this){if(oInit===undefined||oInit.bRetrieve)return DataTable.settings[e].oInstance;if(oInit.bDestroy){DataTable.settings[e].oInstance.fnDestroy();break}_fnLog(DataTable.settings[e],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy");return}if(DataTable.settings[e].sTableId==this.id){DataTable.settings.splice(e,1);break}}if(o===null||o==="")o="DataTables_Table_"+DataTable.ext._oExternConfig.iNextUnique++,this.id=o;var f=$.extend(!0,{},DataTable.models.oSettings,{nTable:this,oApi:_that.oApi,oInit:oInit,sDestroyWidth:$(this).width(),sInstance:o,sTableId:o});DataTable.settings.push(f),f.oInstance=_that.length===1?_that:$(this).dataTable(),oInit||(oInit={}),oInit.oLanguage&&_fnLanguageCompat(oInit.oLanguage),oInit=_fnExtend($.extend(!0,{},DataTable.defaults),oInit),_fnMap(f.oFeatures,oInit,"bPaginate"),_fnMap(f.oFeatures,oInit,"bLengthChange"),_fnMap(f.oFeatures,oInit,"bFilter"),_fnMap(f.oFeatures,oInit,"bSort"),_fnMap(f.oFeatures,oInit,"bInfo"),_fnMap(f.oFeatures,oInit,"bProcessing"),_fnMap(f.oFeatures,oInit,"bAutoWidth"),_fnMap(f.oFeatures,oInit,"bSortClasses"),_fnMap(f.oFeatures,oInit,"bServerSide"),_fnMap(f.oFeatures,oInit,"bDeferRender"),_fnMap(f.oScroll,oInit,"sScrollX","sX"),_fnMap(f.oScroll,oInit,"sScrollXInner","sXInner"),_fnMap(f.oScroll,oInit,"sScrollY","sY"),_fnMap(f.oScroll,oInit,"bScrollCollapse","bCollapse"),_fnMap(f.oScroll,oInit,"bScrollInfinite","bInfinite"),_fnMap(f.oScroll,oInit,"iScrollLoadGap","iLoadGap"),_fnMap(f.oScroll,oInit,"bScrollAutoCss","bAutoCss"),_fnMap(f,oInit,"asStripeClasses"),_fnMap(f,oInit,"asStripClasses","asStripeClasses"),_fnMap(f,oInit,"fnServerData"),_fnMap(f,oInit,"fnFormatNumber"),_fnMap(f,oInit,"sServerMethod"),_fnMap(f,oInit,"aaSorting"),_fnMap(f,oInit,"aaSortingFixed"),_fnMap(f,oInit,"aLengthMenu"),_fnMap(f,oInit,"sPaginationType"),_fnMap(f,oInit,"sAjaxSource"),_fnMap(f,oInit,"sAjaxDataProp"),_fnMap(f,oInit,"iCookieDuration"),_fnMap(f,oInit,"sCookiePrefix"),_fnMap(f,oInit,"sDom"),_fnMap(f,oInit,"bSortCellsTop"),_fnMap(f,oInit,"iTabIndex"),_fnMap(f,oInit,"oSearch","oPreviousSearch"),_fnMap(f,oInit,"aoSearchCols","aoPreSearchCols"),_fnMap(f,oInit,"iDisplayLength","_iDisplayLength"),_fnMap(f,oInit,"bJQueryUI","bJUI"),_fnMap(f,oInit,"fnCookieCallback"),_fnMap(f,oInit,"fnStateLoad"),_fnMap(f,oInit,"fnStateSave"),_fnMap(f.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(f,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(f,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(f,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(f,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(f,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(f,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(f,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(f,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(f,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(f,"aoInitComplete",oInit.fnInitComplete,"user"),_fnCallbackReg(f,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user"),f.oFeatures.bServerSide&&f.oFeatures.bSort&&f.oFeatures.bSortClasses?_fnCallbackReg(f,"aoDrawCallback",_fnSortingClasses,"server_side_sort_classes"):f.oFeatures.bDeferRender&&_fnCallbackReg(f,"aoDrawCallback",_fnSortingClasses,"defer_sort_classes"),oInit.bJQueryUI?($.extend(f.oClasses,DataTable.ext.oJUIClasses),oInit.sDom===DataTable.defaults.sDom&&DataTable.defaults.sDom==="lfrtip"&&(f.sDom='<"H"lfr>t<"F"ip>')):$.extend(f.oClasses,DataTable.ext.oStdClasses),$(this).addClass(f.oClasses.sTable);if(f.oScroll.sX!==""||f.oScroll.sY!=="")f.oScroll.iBarWidth=_fnScrollBarWidth();f.iInitDisplayStart===undefined&&(f.iInitDisplayStart=oInit.iDisplayStart,f._iDisplayStart=oInit.iDisplayStart),oInit.bStateSave&&(f.oFeatures.bStateSave=!0,_fnLoadState(f,oInit),_fnCallbackReg(f,"aoDrawCallback",_fnSaveState,"state_save"));if(oInit.iDeferLoading!==null){f.bDeferLoading=!0;var l=$.isArray(oInit.iDeferLoading);f._iRecordsDisplay=l?oInit.iDeferLoading[0]:oInit.iDeferLoading,f._iRecordsTotal=l?oInit.iDeferLoading[1]:oInit.iDeferLoading}oInit.aaData!==null&&(a=!0),oInit.oLanguage.sUrl!==""?(f.oLanguage.sUrl=oInit.oLanguage.sUrl,$.getJSON(f.oLanguage.sUrl,null,function(e){_fnLanguageCompat(e),$.extend(!0,f.oLanguage,oInit.oLanguage,e),_fnInitialise(f)}),u=!0):$.extend(!0,f.oLanguage,oInit.oLanguage),oInit.asStripeClasses===null&&(f.asStripeClasses=[f.oClasses.sStripeOdd,f.oClasses.sStripeEven]),t=f.asStripeClasses.length,f.asDestroyStripes=[];if(t){var c=!1,h=$(this).children("tbody").children("tr:lt("+t+")");for(e=0;e<t;e++)h.hasClass(f.asStripeClasses[e])&&(c=!0,f.asDestroyStripes.push(f.asStripeClasses[e]));c&&h.removeClass(f.asStripeClasses.join(" "))}var p=[],d,v=this.getElementsByTagName("thead");v.length!==0&&(_fnDetectHeader(f.aoHeader,v[0]),p=_fnGetUniqueThs(f));if(oInit.aoColumns===null){d=[];for(e=0,t=p.length;e<t;e++)d.push(null)}else d=oInit.aoColumns;for(e=0,t=d.length;e<t;e++)oInit.saved_aoColumns!==undefined&&oInit.saved_aoColumns.length==t&&(d[e]===null&&(d[e]={}),d[e].bVisible=oInit.saved_aoColumns[e].bVisible),_fnAddColumn(f,p?p[e]:null);_fnApplyColumnDefs(f,oInit.aoColumnDefs,d,function(e,t){_fnColumnOptions(f,e,t)});for(e=0,t=f.aaSorting.length;e<t;e++){f.aaSorting[e][0]>=f.aoColumns.length&&(f.aaSorting[e][0]=0);var m=f.aoColumns[f.aaSorting[e][0]];f.aaSorting[e][2]===undefined&&(f.aaSorting[e][2]=0),oInit.aaSorting===undefined&&f.saved_aaSorting===undefined&&(f.aaSorting[e][1]=m.asSorting[0]);for(n=0,r=m.asSorting.length;n<r;n++)if(f.aaSorting[e][1]==m.asSorting[n]){f.aaSorting[e][2]=n;break}}_fnSortingClasses(f),_fnBrowserDetect(f);var g=$(this).children("caption").each(function(){this._captionSide=$(this).css("caption-side")}),y=$(this).children("thead");y.length===0&&(y=[document.createElement("thead")],this.appendChild(y[0])),f.nTHead=y[0];var b=$(this).children("tbody");b.length===0&&(b=[document.createElement("tbody")],this.appendChild(b[0])),f.nTBody=b[0],f.nTBody.setAttribute("role","alert"),f.nTBody.setAttribute("aria-live","polite"),f.nTBody.setAttribute("aria-relevant","all");var w=$(this).children("tfoot");w.length===0&&g.length>0&&(f.oScroll.sX!==""||f.oScroll.sY!=="")&&(w=[document.createElement("tfoot")],this.appendChild(w[0])),w.length>0&&(f.nTFoot=w[0],_fnDetectHeader(f.aoFooter,f.nTFoot));if(a)for(e=0;e<oInit.aaData.length;e++)_fnAddData(f,oInit.aaData[e]);else _fnGatherData(f);f.aiDisplay=f.aiDisplayMaster.slice(),f.bInitialised=!0,u===!1&&_fnInitialise(f)}),_that=null,this};DataTable.fnVersionCheck=function(e){var t=function(e,t){while(e.length<t)e+="0";return e},n=DataTable.ext.sVersion.split("."),r=e.split("."),i="",s="";for(var o=0,u=r.length;o<u;o++)i+=t(n[o],3),s+=t(r[o],3);return parseInt(i,10)>=parseInt(s,10)},DataTable.fnIsDataTable=function(e){var t=DataTable.settings;for(var n=0;n<t.length;n++)if(t[n].nTable===e||t[n].nScrollHead===e||t[n].nScrollFoot===e)return!0;return!1},DataTable.fnTables=function(e){var t=[];return jQuery.each(DataTable.settings,function(n,r){(!e||e===!0&&$(r.nTable).is(":visible"))&&t.push(r.nTable)}),t},DataTable.version="1.9.4",DataTable.settings=[],DataTable.models={},DataTable.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:DataTable.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""},DataTable.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){if(e<1e3)return e;var t=e+"",n=t.split(""),r="",i=t.length;for(var s=0;s<i;s++)s%3===0&&s!==0&&(r=this.oLanguage.sInfoThousands+r),r=n[i-s-1]+r;return r},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(e,t,n,r){r.jqXHR=$.ajax({url:e,data:t,success:function(e){e.sError&&r.oApi._fnLog(r,0,e.sError),$(r.oInstance).trigger("xhr",[r,e]),n(e)},dataType:"json",cache:!1,type:r.sServerMethod,error:function(e,t,n){t=="parsererror"&&r.oApi._fnLog(r,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},fnServerParams:null,fnStateLoad:function(oSettings){var sData=this.oApi._fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance),oData;try{oData=typeof $.parseJSON=="function"?$.parseJSON(sData):eval("("+sData+")")}catch(e){oData=null}return oData},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(e,t){this.oApi._fnCreateCookie(e.sCookiePrefix+e.sInstance,this.oApi._fnJsonString(t),e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"},DataTable.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},fnDisplayEnd:function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||this._iDisplayLength==-1?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null},DataTable.ext=$.extend(!0,{},DataTable.models.ext),$.extend(DataTable.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""}),$.extend(DataTable.ext.oJUIClasses,DataTable.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"}),$.extend(DataTable.ext.oPagination,{two_button:{fnInit:function(e,t,n){var r=e.oLanguage.oPaginate,i=e.oClasses,s=function(t){e.oApi._fnPageChange(e,t.data.action)&&n(e)},o=e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a>'+'<a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>':'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+r.sPrevious+"</a>"+'<a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+r.sNext+"</a>";$(t).append(o);var u=$("a",t),a=u[0],f=u[1];e.oApi._fnBindAction(a,{action:"previous"},s),e.oApi._fnBindAction(f,{action:"next"},s),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",a.id=e.sTableId+"_previous",f.id=e.sTableId+"_next",a.setAttribute("aria-controls",e.sTableId),f.setAttribute("aria-controls",e.sTableId))},fnUpdate:function(e,t){if(!e.aanFeatures.p)return;var n=e.oClasses,r=e.aanFeatures.p,i;for(var s=0,o=r.length;s<o;s++)i=r[s].firstChild,i&&(i.className=e._iDisplayStart===0?n.sPagePrevDisabled:n.sPagePrevEnabled,i=i.nextSibling,i.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?n.sPageNextDisabled:n.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,t,n){var r=e.oLanguage.oPaginate,i=e.oClasses,s=function(t){e.oApi._fnPageChange(e,t.data.action)&&n(e)};$(t).append('<a  tabindex="'+e.iTabIndex+'" class="'+i.sPageButton+" "+i.sPageFirst+'">'+r.sFirst+"</a>"+'<a  tabindex="'+e.iTabIndex+'" class="'+i.sPageButton+" "+i.sPagePrevious+'">'+r.sPrevious+"</a>"+"<span></span>"+'<a tabindex="'+e.iTabIndex+'" class="'+i.sPageButton+" "+i.sPageNext+'">'+r.sNext+"</a>"+'<a tabindex="'+e.iTabIndex+'" class="'+i.sPageButton+" "+i.sPageLast+'">'+r.sLast+"</a>");var o=$("a",t),u=o[0],a=o[1],f=o[2],l=o[3];e.oApi._fnBindAction(u,{action:"first"},s),e.oApi._fnBindAction(a,{action:"previous"},s),e.oApi._fnBindAction(f,{action:"next"},s),e.oApi._fnBindAction(l,{action:"last"},s),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",u.id=e.sTableId+"_first",a.id=e.sTableId+"_previous",f.id=e.sTableId+"_next",l.id=e.sTableId+"_last")},fnUpdate:function(e,t){if(!e.aanFeatures.p)return;var n=DataTable.ext.oPagination.iFullNumbersShowPages,r=Math.floor(n/2),i=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),s=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,o="",u,a,f,l,c=e.oClasses,h,p,d,v,m=e.aanFeatures.p,g=function(n){e.oApi._fnBindAction(this,{page:n+u-1},function(n){e.oApi._fnPageChange(e,n.data.page),t(e),n.preventDefault()})};e._iDisplayLength===-1?(u=1,a=1,s=1):i<n?(u=1,a=i):s<=r?(u=1,a=n):s>=i-r?(u=i-n+1,a=i):(u=s-Math.ceil(n/2)+1,a=u+n-1);for(f=u;f<=a;f++)o+=s!==f?'<a tabindex="'+e.iTabIndex+'" class="'+c.sPageButton+'">'+e.fnFormatNumber(f)+"</a>":'<a tabindex="'+e.iTabIndex+'" class="'+c.sPageButtonActive+'">'+e.fnFormatNumber(f)+"</a>";for(f=0,l=m.length;f<l;f++){v=m[f];if(!v.hasChildNodes())continue;$("span:eq(0)",v).html(o).children("a").each(g),h=v.getElementsByTagName("a"),p=[h[0],h[1],h[h.length-2],h[h.length-1]],$(p).removeClass(c.sPageButton+" "+c.sPageButtonActive+" "+c.sPageButtonStaticDisabled),$([p[0],p[1]]).addClass(s==1?c.sPageButtonStaticDisabled:c.sPageButton),$([p[2],p[3]]).addClass(i===0||s===i||e._iDisplayLength===-1?c.sPageButtonStaticDisabled:c.sPageButton)}}}}),$.extend(DataTable.ext.oSort,{"string-pre":function(e){return typeof e!="string"&&(e=e!==null&&e.toString?e.toString():""),e.toLowerCase()},"string-asc":function(e,t){return e<t?-1:e>t?1:0},"string-desc":function(e,t){return e<t?1:e>t?-1:0},"html-pre":function(e){return e.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(e,t){return e<t?-1:e>t?1:0},"html-desc":function(e,t){return e<t?1:e>t?-1:0},"date-pre":function(e){var t=Date.parse(e);if(isNaN(t)||t==="")t=Date.parse("01/01/1970 00:00:00");return t},"date-asc":function(e,t){return e-t},"date-desc":function(e,t){return t-e},"numeric-pre":function(e){return e=="-"||e===""?0:e*1},"numeric-asc":function(e,t){return e-t},"numeric-desc":function(e,t){return t-e}}),$.extend(DataTable.ext.aTypes,[function(e){if(typeof e=="number")return"numeric";if(typeof e!="string")return null;var t="0123456789-",n="0123456789.",r,i=!1;r=e.charAt(0);if(t.indexOf(r)==-1)return null;for(var s=1;s<e.length;s++){r=e.charAt(s);if(n.indexOf(r)==-1)return null;if(r=="."){if(i)return null;i=!0}}return"numeric"},function(e){var t=Date.parse(e);return t!==null&&!isNaN(t)||typeof e=="string"&&e.length===0?"date":null},function(e){return typeof e=="string"&&e.indexOf("<")!=-1&&e.indexOf(">")!=-1?"html":null}]),$.fn.DataTable=DataTable,$.fn.dataTable=DataTable,$.fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext})}(window,document),define("datatables-extensions",["jquery","jquery-datatables"],function(e,t){e.fn.dataTableExt.oApi.fnStandingRedraw=function(e){if(e.oFeatures.bServerSide===!1){var t=e._iDisplayStart;e.oApi._fnReDraw(e),e._iDisplayStart=t,e.oApi._fnCalculateEnd(e)}e.oApi._fnDraw(e)},jQuery.fn.dataTableExt.oApi.fnProcessingIndicator=function(e,t){typeof t=="undefined"&&(t=!0),this.oApi._fnProcessingDisplay(e,t)}}),define("view/entity-config",["underscore","jquery","backbone","brooklyn-utils","zeroclipboard","view/viewutils","model/config-summary","text!tpl/apps/config.html","text!tpl/apps/config-name.html","jquery-datatables","datatables-extensions"],function(e,t,n,r,i,s,o,u,a){i.config({moviePath:"/assets/img/zeroclipboard/ZeroClipboard.swf"});var f=e.template(u),l=e.template(a),c=n.View.extend({template:f,configMetadata:{},refreshActive:!0,zeroClipboard:null,events:{"click .refresh":"updateConfigNow","click .filterEmpty":"toggleFilterEmpty","click .toggleAutoRefresh":"toggleAutoRefresh","click #config-table div.secret-info":"toggleSecrecyVisibility","mouseup .valueOpen":"valueOpen","mouseover #config-table tbody tr":"noteFloatMenuActive","mouseout #config-table tbody tr":"noteFloatMenuSeemsInactive","mouseover .floatGroup":"noteFloatMenuActive","mouseout .floatGroup":"noteFloatMenuSeemsInactive","mouseover .clipboard-item":"noteFloatMenuActiveCI","mouseout .clipboard-item":"noteFloatMenuSeemsInactiveCI","mouseover .hasFloatLeft":"showFloatLeft","mouseover .hasFloatDown":"enterFloatDown","mouseout .hasFloatDown":"exitFloatDown","mouseup .light-popup-menu-item":"closeFloatMenuNow"},initialize:function(){e.bindAll(this),this.$el.html(this.template());var n=this,o=this.$("#config-table");return n.table=s.myDataTable(o,{fnRowCallback:function(e,n,r,i){return t(e).attr("id",n[0]),t("td",e).each(function(e,n){e==1&&t(n).attr("class","config-value")}),e},aoColumnDefs:[{mRender:function(t,r,i){var s=n.getConfigActions(t.name),o=e.extend(t,{description:t.description,type:t.type});return l(o)},aTargets:[1]},{mRender:function(e,i,s){var o=r.toDisplayString(e);if(i!="display")return o;var u=o!=null&&(""+o).length>0;configName=s[0],actions=n.getConfigActions(configName);var a=t('tr[id="'+configName+'"]'),f="<span class='value'>"+(u?o:"")+"</span>",l=r.isSecret(configName);l&&(f+="<span class='secret-indicator'>(hidden)</span>"),actions.open&&(f="<a href='"+actions.open+"'>"+f+"</a>");if(o==null||o.length<3)f+="&nbsp;&nbsp;&nbsp;&nbsp;";var c=a.find(".dynamic-contents"),h=actions.json?(new URI(actions.json)).resolve(new URI(window.location.href)).toString():null;if(c.length>0&&n.checkFloatMenuUpToDate(a,actions.open,".actions-open","open-target")&&n.checkFloatMenuUpToDate(a,o,".actions-copy")&&n.checkFloatMenuUpToDate(a,actions.json,".actions-json-open","open-target")&&n.checkFloatMenuUpToDate(a,h,".actions-json-copy","copy-value"))return c.html(f),a.find("td.config-value").html();var p="";return actions.open&&(p+="<div class='light-popup-menu-item valueOpen actions-open' open-target='"+actions.open+"'>"+"Open</div>"),u&&(p+="<div class='light-popup-menu-item handy valueCopy actions-copy clipboard-item'>Copy Value</div>"),actions.json&&(p+="<div class='light-popup-menu-item handy valueOpen actions-json-open' open-target='"+actions.json+"'>"+"Open REST Link</div>"),actions.json&&u&&(p+="<div class='light-popup-menu-item handy valueCopy actions-json-copy clipboard-item' copy-value='"+h+"'>Copy REST Link</div>"),p==""&&(p+="<div class='light-popup-menu-item'>(no actions)</div>"),p="<div class='floatDown'><div class='light-popup'><div class='light-popup-body'>"+p+"</div></div></div>",f="<span class='hasFloatLeft dynamic-contents'>"+f+"</span>"+"<div class='floatLeft'><span class='icon-chevron-down hasFloatDown'></span>"+p+"</div>",f="<div class='floatGroup"+(l?" secret-info":"")+"'>"+f+"</div>",f},aTargets:[2]},{bVisible:!1,aTargets:[0]}]}),this.zeroClipboard=new i,this.zeroClipboard.on("dataRequested",function(e){try{if(!t(this).closest("#config-table").length)return;var n=t(this).attr("copy-value");n||(n=t(this).closest(".floatGroup").find(".value").text()),e.setText(n);var i=t(this),s=i.html();i.html("<b>Copied!</b>"),setTimeout(function(){i.html(s)},600)}catch(o){log("Zeroclipboard failure; falling back to prompt mechanism"),log(o),r.promptCopyToClipboard(n)}}),this.zeroClipboard.on("mouseover",function(){n.noteFloatMenuZeroClipboardItem(!0,this)}),this.zeroClipboard.on("mouseout",function(){n.noteFloatMenuZeroClipboardItem(!1,this)}),this.zeroClipboard.on("mouseup",function(){n.closeFloatMenuNow()}),s.addFilterEmptyButton(this.table),s.addAutoRefreshButton(this.table),s.addRefreshButton(this.table),this.loadConfigMetadata(),this.updateConfigPeriodically(),this.toggleFilterEmpty(),this},beforeClose:function(){this.zeroClipboard&&this.zeroClipboard.destroy()},floatMenuActive:!1,lastFloatMenuRowId:null,lastFloatFocusInTextForEventUnmangling:null,updateFloatMenus:function(){t('#config-table *[rel="tooltip"]').tooltip(),this.zeroClipboard.clip(t(".valueCopy"))},showFloatLeft:function(e){this.noteFloatMenuFocusChange(!0,e,"show-left"),this.showFloatLeftOf(t(e.currentTarget))},showFloatLeftOf:function(e){e.next(".floatLeft").show()},enterFloatDown:function(e){this.noteFloatMenuFocusChange(!0,e,"show-down");var n=t(e.currentTarget);this.floatDownFocus=n;var r=this;setTimeout(function(){r.showFloatDownOf(n)},200)},exitFloatDown:function(e){this.floatDownFocus=null},showFloatDownOf:function(e){if(e!=this.floatDownFocus)return;var n=e.next(".floatDown");n.show(),t(".light-popup",n).show(2e3)},noteFloatMenuActive:function(e){this.noteFloatMenuFocusChange(!0,e,"menu");if(!e.toElement||!t(e.toElement).hasClass("clipboard-item")){var n=t(e.target).closest(".floatGroup").find("div.zeroclipboard-is-hover");n.removeClass("zeroclipboard-is-hover")}},noteFloatMenuSeemsInactive:function(e){this.noteFloatMenuFocusChange(!1,e,"menu")},noteFloatMenuActiveCI:function(e){this.noteFloatMenuFocusChange(!0,e,"menu-clip-item")},noteFloatMenuSeemsInactiveCI:function(e){this.noteFloatMenuFocusChange(!1,e,"menu-clip-item")},noteFloatMenuZeroClipboardItem:function(e,n){this.noteFloatMenuFocusChange(e,n,"clipboard"),e?t(n).closest("tr").addClass("zeroclipboard-is-hover"):t(n).removeClass("zeroclipboard-is-hover")},noteFloatMenuFocusChange:function(e,n,r){var i=!0,s=null,o=null;if(n){o=n.target?n.target:n;if(e){this.lastFloatFocusInTextForEventUnmangling=t(o).text(),s=n.target?t(n.target).closest("tr").attr("id"):t(n).closest("tr").attr("id");if(this.floatMenuActive&&s==this.lastFloatMenuRowId)return}else{s=n.toElement?t(n.toElement).closest("tr").attr("id"):null;if(s==this.lastFloatMenuRowId)return;if(t(o).text()!=this.lastFloatFocusInTextForEventUnmangling)return;if(n.toElement){if(t(n.toElement).hasClass("global-zeroclipboard-container"))return;if(n.toElement.name&&n.toElement.name=="global-zeroclipboard-flash-bridge")return}}}e&&s&&(this.lastFloatMenuRowId!=s&&this.lastFloatMenuRowId&&this.closeFloatMenuNow(),o?(this.showFloatLeftOf(t(o).closest("tr").find(".hasFloatLeft")),this.lastFloatMenuRowId=s):this.lastFloatMenuRowId=null),this.floatMenuActive=e,e||this.scheduleCheckFloatMenuNeedsHiding(i)},scheduleCheckFloatMenuNeedsHiding:function(e){e?(this.checkTime=(new Date).getTime()+299,setTimeout(this.checkFloatMenuNeedsHiding,300)):(this.checkTime=(new Date).getTime()-1,this.checkFloatMenuNeedsHiding())},closeFloatMenuNow:function(){this.checkTime=(new Date).getTime()-1,this.floatMenuActive=!1,this.checkFloatMenuNeedsHiding()},checkFloatMenuNeedsHiding:function(){if((new Date).getTime()<=this.checkTime)return;this.floatMenuActive||(t(".floatLeft").hide(),t(".floatDown").hide(),t(".zeroclipboard-is-hover").removeClass("zeroclipboard-is-hover"),lastFloatMenuRowId=null)},valueOpen:function(e){window.open(t(e.target).attr("open-target"),"_blank")},render:function(){return this},checkFloatMenuUpToDate:function(e,t,n,r){if(typeof t=="undefined"||t==null||t==""){if(e.find(n).length==0)return!0}else if(r){if(e.find(n).attr(r)==t)return!0}else if(e.find(n).length>0)return!0;return!1},getConfigActions:function(e){var t=this.configMetadata||{},n=t[e]||{};return n.actions||{}},toggleFilterEmpty:function(){return s.toggleFilterEmpty(this.$("#config-table"),2),this},toggleAutoRefresh:function(){return s.toggleAutoRefresh(this),this},enableAutoRefresh:function(e){return this.refreshActive=e,this},toggleSecrecyVisibility:function(e){t(e.target).closest(".secret-info").toggleClass("secret-revealed")},isRefreshActive:function(){return this.refreshActive},updateConfigNow:function(){var e=this;s.get(e,e.model.getConfigUpdateUrl(),e.updateWithData,{enablement:e.isRefreshActive})},updateConfigPeriodically:function(){var e=this;s.getRepeatedlyWithDelay(e,e.model.getConfigUpdateUrl(),function(t){e.updateWithData(t)},{enablement:e.isRefreshActive})},updateWithData:function(e){var t=this;$table=t.$("#config-table");var n={};t.fullRedraw&&(n.refreshAllRows=!0,t.fullRedraw=!1),s.updateMyDataTable($table,e,function(e,n){var r=t.configMetadata[n];return r==null&&(r={name:n},t.configMetadata[n]=r,t.loadConfigMetadataIfStale(n,1e4)),[n,r,e]},n),t.updateFloatMenus()},loadConfigMetadata:function(){var n=this.model.getLinkByName("config"),r=this;return r.lastConfigMetadataLoadTime=(new Date).getTime(),t.get(n,function(t){e.each(t,function(t){var n={};e.each(t.links,function(e,t){t.slice(0,7)=="action:"&&(n[t.slice(7)]=e)}),r.configMetadata[t.name]={name:t.name,description:t.description,actions:n,type:t.type}}),r.fullRedraw=!0,r.updateConfigNow(),r.table.find('*[rel="tooltip"]').tooltip()}),this},loadConfigMetadataIfStale:function(e,t){var n=this;(!n.lastConfigMetadataLoadTime||n.lastConfigMetadataLoadTime+t<(new Date).getTime())&&n.loadConfigMetadata()}});return c}),define("view/entity-summary",["underscore","jquery","backbone","brooklyn","brooklyn-utils","view/viewutils","text!tpl/apps/summary.html","view/entity-config"],function(e,t,n,r,i,s,o,u){var a=n.View.extend({events:{"click a.open-tab":"tabSelected"},template:e.template(o),initialize:function(){e.bindAll(this);var t=this;this.$el.html(this.template({entity:this.model,application:this.options.application,isApp:this.isApp()})),this.model.get("catalogItemId")?this.$("div.catalogItemId").show():this.$("div.catalogItemId").hide(),this.options.tabView.configView=new u({model:this.options.model,tabView:this.options.tabView}),this.$("div#advanced-config").html(this.options.tabView.configView.render().el),s.attachToggler(this.$el),s.getRepeatedlyWithDelay(this,this.model.getSensorUpdateUrl(),function(e){t.updateWithData(e)}),this.loadSpec()},isApp:function(){var e=this.model.get("id"),t=this.model.get("links").self;return t.indexOf("/applications/"+e)!=-1},render:function(){return this},revealIfHasValue:function(n,r,i,s){var o=this;i||(i=function(t){return e.escape(t)});if(s){var u=s[n];u||u===!1?(t(".value",r).html(i(u)),r.show()):r.hide()}else t.ajax({url:o.model.getLinkByName("sensors")+"/"+n,contentType:"application/json",success:function(e){e||e===!1?(t(".value",r).html(i(e)),r.show()):r.hide(),o.updateStatusIcon()}})},updateWithData:function(t){this.revealIfHasValue("service.state",this.$(".status"),null,t),this.revealIfHasValue("service.isUp",this.$(".serviceUp"),null,t);var n=function(t){return"<a href='"+e.escape(t)+"'>"+e.escape(t)+"</a>"};this.revealIfHasValue("main.uri",this.$(".url"),n,t);var r=this.updateStatusIcon();this.updateCachedProblemIndicator(t),r.problem?this.updateAddlInfoForProblem():this.$(".additional-info-on-problem").html("").hide()},updateStatusIcon:function(){var e=s.computeStatusIconInfo(this.$(".serviceUp .value").html(),this.$(".status .value").html());return e.url?this.$("#status-icon").html('<img src="'+e.url+'" '+'style="max-width: 64px; max-height: 64px;"/>'):this.$("#status-icon").html(""),e},updateCachedProblemIndicator:function(t){if(!t)return;this.problemIndicators=t["service.problems"];if(!this.problemIndicators||!e.size(this.problemIndicators))this.problemIndicators=t["service.notUp.indicators"];if(!this.problemIndicators||!e.size(this.problemIndicators))this.problemIndicators=null},updateAddlInfoForProblem:function(t){if(!this.options.tasks)return;var n="",r=null,i=this;this.options.tasks.each(function(e){e.isError()&&e.isLocalTopLevel()&&(!r||e.attributes.endTimeUtc<r.attributes.endTimeUtc)&&(r=e)});if(this.problemIndicators){var o=e.values(this.problemIndicators);for(var u in o)n&&(n+="<br style='line-height: 24px;'>"),n+=e.escape(o[u])}if(r){var a="activities/subtask/"+r.id,f=this.model.getLinkByName("self");n&&(n+="<br style='line-height: 24px;'>"),n=n+"<b>"+e.escape("Failure running task ")+"<a class='open-tab' tab-target='"+a+"'"+"href='#"+f+"/"+a+"'>"+"<i>"+e.escape(r.attributes.displayName)+"</i> "+"("+r.id+")</a>: </b>"+e.escape(r.attributes.result)}!i.problemTasksLoaded&&this.options.tasks&&(n||(n="<i>Loading problem details...</i>"),s.get(this,this.options.tasks.url,function(){i.problemTasksLoaded=!0,i.updateAddlInfoForProblem()}));if(n)this.$(".additional-info-on-problem").html(n).show();else{var f=this.model.getLinkByName("self");this.$(".additional-info-on-problem").html("The entity appears to have failed externally. <br style='line-height: 24px;'>No Brooklyn-managed task failures reported. For more information, investigate <a class='open-tab' tab-target='sensors' href='#"+f+"/sensors'>sensors</a> and "+"streams on recent "+"<a class='open-tab' tab-target='activities' href='#"+f+"/activities'>activity</a>, "+"as well as external systems and logs where necessary.").show()}},tabSelected:function(e){if(e.metaKey||e.shiftKey)return;var n=t(e.currentTarget).attr("tab-target");return this.options.tabView.openTab(n),e.preventDefault(),!1},loadSpec:function(e){if(!e&&this.spec){this.renderSpec(this.spec);return}s.get(this,this.model.get("links").spec,this.renderSpec)},renderSpec:function(e){e||(e=this.spec),e?(s.updateTextareaWithData(t("#entity-spec-yaml",this.$el),e,!0,!1,150,400),this.$("#entity-spec-yaml-toggler").show()):this.$("#entity-spec-yaml-toggler").hide()}});return a}),define("model/sensor-summary",["jquery","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{name:"",type:"",description:"",links:{}}},getLinkByName:function(e){if(e)return this.get("links")[e]}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("text!tpl/apps/sensors.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="table-scroll-wrapper" style="overflow: visible;">\n<table id="sensors-table" width="100%">\n    <thead>\n    <tr>\n        <th>ID</th>\n        <th>Name</th>\n        <th>Value</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n<div style="height: 30px;"></div>\n</div>'}),define("text!tpl/apps/sensor-name.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<% if (description || type) { %>\n<span class="sensor-name" rel="tooltip" data-placement="left"\n    title="<% \n         if (description) { %><b><%- description %></b><br/><% } \n         if (type) { %>(<% \n           if (type.startsWith("java.lang.") || type.startsWith("java.util.")) type = type.substring(10);\n         %><%- type %>)<% } %>">\n    <%- name %>\n</span>\n<% } else { %>\n<span class="sensor-name">\n    <%- name %>\n</span>\n<% } %>\n'}),URI.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),this.path&&(e+=this.path),this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},function(){function e(e,t){var n=/^(.*)\//;return e.authority&&!e.path?"/"+t:e.path.match(n)[0]+t}function n(e){if(!e)return"";var n=e.replace(/\/\.\//g,"/");n=n.replace(/\/\.$/,"/");while(n.match(t))n=n.replace(t,"/");n=n.replace(/\/([^\/]*)\/\.\.$/,"/");while(n.match(/\/\.\.\//))n=n.replace(/\/\.\.\//,"/");return n}var t=/\/((?!\.\.\/)[^\/]*)\/\.\.\//;URI.prototype.resolve=function(t){var r=new URI;return this.scheme?(r.scheme=this.scheme,r.authority=this.authority,r.path=n(this.path),r.query=this.query):(this.authority?(r.authority=this.authority,r.path=n(this.path),r.query=this.query):(this.path?(this.path.charAt(0)==="/"?r.path=n(this.path):(r.path=e(t,this.path),r.path=n(r.path)),r.query=this.query):(r.path=t.path,this.query?r.query=this.query:r.query=t.query),r.authority=t.authority),r.scheme=t.scheme),r.fragment=this.fragment,r}}(),define("uri",function(){}),define("view/entity-sensors",["underscore","jquery","backbone","brooklyn-utils","zeroclipboard","view/viewutils","model/sensor-summary","text!tpl/apps/sensors.html","text!tpl/apps/sensor-name.html","jquery-datatables","datatables-extensions","underscore","jquery","backbone","uri"],function(e,t,n,r,i,s,o,u,a){i.config({moviePath:"/assets/img/zeroclipboard/ZeroClipboard.swf"});var f=e.template(u),l=e.template(a),c=n.View.extend({template:f,sensorMetadata:{},refreshActive:!0,zeroClipboard:null,events:{"click .refresh":"updateSensorsNow","click .filterEmpty":"toggleFilterEmpty","click .toggleAutoRefresh":"toggleAutoRefresh","click #sensors-table div.secret-info":"toggleSecrecyVisibility","mouseup .valueOpen":"valueOpen","mouseover #sensors-table tbody tr":"noteFloatMenuActive","mouseout #sensors-table tbody tr":"noteFloatMenuSeemsInactive","mouseover .floatGroup":"noteFloatMenuActive","mouseout .floatGroup":"noteFloatMenuSeemsInactive","mouseover .clipboard-item":"noteFloatMenuActiveCI","mouseout .clipboard-item":"noteFloatMenuSeemsInactiveCI","mouseover .hasFloatLeft":"showFloatLeft","mouseover .hasFloatDown":"enterFloatDown","mouseout .hasFloatDown":"exitFloatDown","mouseup .light-popup-menu-item":"closeFloatMenuNow"},initialize:function(){e.bindAll(this),this.$el.html(this.template());var n=this.$("#sensors-table"),o=this;return this.table=s.myDataTable(n,{fnRowCallback:function(e,n,r,i){return t(e).attr("id",n[0]),t("td",e).each(function(e,n){e==1&&t(n).attr("class","sensor-value")}),e},aoColumnDefs:[{mRender:function(t,n,r){var i=o.getSensorActions(t.name),s=e.extend(t,{description:t.description,type:t.type});return l(s)},aTargets:[1]},{mRender:function(e,n,i){var s=r.toDisplayString(e);if(n!="display")return s;var u=s!=null&&(""+s).length>0;sensorName=i[0],actions=o.getSensorActions(sensorName);var a=t('tr[id="'+sensorName+'"]'),f="<span class='value'>"+(u?s:"")+"</span>",l=r.isSecret(sensorName);l&&(f+="<span class='secret-indicator'>(hidden)</span>"),actions.open&&(f="<a href='"+actions.open+"'>"+f+"</a>");if(s==null||s.length<3)f+="&nbsp;&nbsp;&nbsp;&nbsp;";var c=a.find(".dynamic-contents"),h=actions.json?(new URI(actions.json)).resolve(new URI(window.location.href)).toString():null;if(c.length>0&&o.checkFloatMenuUpToDate(a,actions.open,".actions-open","open-target")&&o.checkFloatMenuUpToDate(a,s,".actions-copy")&&o.checkFloatMenuUpToDate(a,actions.json,".actions-json-open","open-target")&&o.checkFloatMenuUpToDate(a,h,".actions-json-copy","copy-value"))return c.html(f),a.find("td.sensor-value").html();var p="";return actions.open&&(p+="<div class='light-popup-menu-item valueOpen actions-open' open-target='"+actions.open+"'>"+"Open</div>"),u&&(p+="<div class='light-popup-menu-item handy valueCopy actions-copy clipboard-item'>Copy Value</div>"),actions.json&&(p+="<div class='light-popup-menu-item handy valueOpen actions-json-open' open-target='"+actions.json+"'>"+"Open REST Link</div>"),actions.json&&u&&(p+="<div class='light-popup-menu-item handy valueCopy actions-json-copy clipboard-item' copy-value='"+h+"'>Copy REST Link</div>"),p==""&&(p+="<div class='light-popup-menu-item'>(no actions)</div>"),p="<div class='floatDown'><div class='light-popup'><div class='light-popup-body'>"+p+"</div></div></div>",f="<span class='hasFloatLeft dynamic-contents'>"+f+"</span>"+"<div class='floatLeft'><span class='icon-chevron-down hasFloatDown'></span>"+p+"</div>",f="<div class='floatGroup"+(l?" secret-info":"")+"'>"+f+"</div>",f},aTargets:[2]},{bVisible:!1,aTargets:[0]}]}),this.zeroClipboard=new i,this.zeroClipboard.on("dataRequested",function(e){try{if(!t(this).closest("#sensors-table").length)return;var n=t(this).attr("copy-value");n||(n=t(this).closest(".floatGroup").find(".value").text()),e.setText(n);var i=t(this),s=i.html();i.html("<b>Copied!</b>"),setTimeout(function(){i.html(s)},600)}catch(o){log("Zeroclipboard failure; falling back to prompt mechanism"),log(o),r.promptCopyToClipboard(n)}}),this.zeroClipboard.on("mouseover",function(){o.noteFloatMenuZeroClipboardItem(!0,this)}),this.zeroClipboard.on("mouseout",function(){o.noteFloatMenuZeroClipboardItem(!1,this)}),this.zeroClipboard.on("mouseup",function(){o.closeFloatMenuNow()}),s.addFilterEmptyButton(this.table),s.addAutoRefreshButton(this.table),s.addRefreshButton(this.table),this.loadSensorMetadata(),this.updateSensorsPeriodically(),this.toggleFilterEmpty(),this},beforeClose:function(){this.zeroClipboard&&this.zeroClipboard.destroy()},floatMenuActive:!1,lastFloatMenuRowId:null,lastFloatFocusInTextForEventUnmangling:null,updateFloatMenus:function(){t('#sensors-table *[rel="tooltip"]').tooltip(),this.zeroClipboard.clip(t(".valueCopy"))},showFloatLeft:function(e){this.noteFloatMenuFocusChange(!0,e,"show-left"),this.showFloatLeftOf(t(e.currentTarget))},showFloatLeftOf:function(e){e.next(".floatLeft").show()},enterFloatDown:function(e){this.noteFloatMenuFocusChange(!0,e,"show-down");var n=t(e.currentTarget);this.floatDownFocus=n;var r=this;setTimeout(function(){r.showFloatDownOf(n)},200)},exitFloatDown:function(e){this.floatDownFocus=null},showFloatDownOf:function(e){if(e!=this.floatDownFocus)return;var n=e.next(".floatDown");n.show(),t(".light-popup",n).show(2e3)},noteFloatMenuActive:function(e){this.noteFloatMenuFocusChange(!0,e,"menu");if(!e.toElement||!t(e.toElement).hasClass("clipboard-item")){var n=t(e.target).closest(".floatGroup").find("div.zeroclipboard-is-hover");n.removeClass("zeroclipboard-is-hover")}},noteFloatMenuSeemsInactive:function(e){this.noteFloatMenuFocusChange(!1,e,"menu")},noteFloatMenuActiveCI:function(e){this.noteFloatMenuFocusChange(!0,e,"menu-clip-item")},noteFloatMenuSeemsInactiveCI:function(e){this.noteFloatMenuFocusChange(!1,e,"menu-clip-item")},noteFloatMenuZeroClipboardItem:function(e,n){this.noteFloatMenuFocusChange(e,n,"clipboard"),e?t(n).closest("tr").addClass("zeroclipboard-is-hover"):t(n).removeClass("zeroclipboard-is-hover")},noteFloatMenuFocusChange:function(e,n,r){var i=!0,s=null,o=null;if(n){o=n.target?n.target:n;if(e){this.lastFloatFocusInTextForEventUnmangling=t(o).text(),s=n.target?t(n.target).closest("tr").attr("id"):t(n).closest("tr").attr("id");if(this.floatMenuActive&&s==this.lastFloatMenuRowId)return}else{s=n.toElement?t(n.toElement).closest("tr").attr("id"):null;if(s==this.lastFloatMenuRowId)return;if(t(o).text()!=this.lastFloatFocusInTextForEventUnmangling)return;if(n.toElement){if(t(n.toElement).hasClass("global-zeroclipboard-container"))return;if(n.toElement.name&&n.toElement.name=="global-zeroclipboard-flash-bridge")return}}}e&&s&&(this.lastFloatMenuRowId!=s&&this.lastFloatMenuRowId&&this.closeFloatMenuNow(),o?(this.showFloatLeftOf(t(o).closest("tr").find(".hasFloatLeft")),this.lastFloatMenuRowId=s):this.lastFloatMenuRowId=null),this.floatMenuActive=e,e||this.scheduleCheckFloatMenuNeedsHiding(i)},scheduleCheckFloatMenuNeedsHiding:function(e){e?(this.checkTime=(new Date).getTime()+299,setTimeout(this.checkFloatMenuNeedsHiding,300)):(this.checkTime=(new Date).getTime()-1,this.checkFloatMenuNeedsHiding())},closeFloatMenuNow:function(){this.checkTime=(new Date).getTime()-1,this.floatMenuActive=!1,this.checkFloatMenuNeedsHiding()},checkFloatMenuNeedsHiding:function(){if((new Date).getTime()<=this.checkTime)return;this.floatMenuActive||(t(".floatLeft").hide(),t(".floatDown").hide(),t(".zeroclipboard-is-hover").removeClass("zeroclipboard-is-hover"),lastFloatMenuRowId=null)},valueOpen:function(e){window.open(t(e.target).attr("open-target"),"_blank")},render:function(){return this},checkFloatMenuUpToDate:function(e,t,n,r){if(typeof t=="undefined"||t==null||t==""){if(e.find(n).length==0)return!0}else if(r){if(e.find(n).attr(r)==t)return!0}else if(e.find(n).length>0)return!0;return!1},getSensorActions:function(e){var t=this.sensorMetadata||{},n=t[e]||{};return n.actions||{}},toggleFilterEmpty:function(){return s.toggleFilterEmpty(this.$("#sensors-table"),2),this},toggleAutoRefresh:function(){return s.toggleAutoRefresh(this),this},enableAutoRefresh:function(e){return this.refreshActive=e,this},toggleSecrecyVisibility:function(e){t(e.target).closest(".secret-info").toggleClass("secret-revealed")},isRefreshActive:function(){return this.refreshActive},updateSensorsNow:function(){var e=this;s.get(e,e.model.getSensorUpdateUrl(),e.updateWithData,{enablement:e.isRefreshActive})},updateSensorsPeriodically:function(){var e=this;s.getRepeatedlyWithDelay(e,e.model.getSensorUpdateUrl(),function(t){e.updateWithData(t)},{enablement:e.isRefreshActive})},updateWithData:function(e){var t=this;$table=t.$("#sensors-table");var n={};t.fullRedraw&&(n.refreshAllRows=!0,t.fullRedraw=!1),s.updateMyDataTable($table,e,function(e,n){var r=t.sensorMetadata[n];return r==null&&(r={name:n},t.sensorMetadata[n]=r,t.loadSensorMetadataIfStale(n,1e4)),[n,r,e]},n),t.updateFloatMenus()},loadSensorMetadata:function(){var n=this.model.getLinkByName("sensors"),r=this;return r.lastSensorMetadataLoadTime=(new Date).getTime(),t.get(n,function(t){e.each(t,function(t){var n={};e.each(t.links,function(e,t){t.slice(0,7)=="action:"&&(n[t.slice(7)]=e)}),r.sensorMetadata[t.name]={name:t.name,description:t.description,actions:n,type:t.type}}),r.fullRedraw=!0,r.updateSensorsNow(),r.table.find('*[rel="tooltip"]').tooltip()}),this},loadSensorMetadataIfStale:function(e,t){var n=this;(!n.lastSensorMetadataLoadTime||n.lastSensorMetadataLoadTime+t<(new Date).getTime())&&n.loadSensorMetadata()}});return c}),define("model/effector-summary",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({idAttribute:"name",defaults:function(){return{name:"",description:"",returnType:"",parameters:[],links:{self:"",entity:"",application:""}}},getParameterByName:function(t){if(t)return e.find(this.get("parameters"),function(e){return e.name==t})},getLinkByName:function(e){if(e)return this.get("links")[e]}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("text!tpl/apps/effector-modal.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- modal to render effector-->\n\n<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n    <h3><%= entityName %> <%= name %></h3>\n\n    <p><%= description %></p>\n</div>\n\n<div class="modal-body">\n    <p><i>No arguments required</i></p>\n</div>\n\n<div class="modal-footer">\n    <button type="button" class="btn btn-info btn-mini" data-dismiss="modal">Cancel</button>\n    <button type="button" class="btn btn-danger btn-mini invoke-effector">Invoke</button>\n</div>'}),define("text!tpl/apps/param.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!--effector param template -->\n<tr class="effector-param" rel="tooltip" title="<%= description %></b><br><br><%= type %>" data-placement="left">\n    <td class="param-name"><%= name %></td>\n    <!-- TODO: for now this just looks at the name of the parameter which is poor (and @Beta !). \n    Better will be to use a strongly-typed LocationCollection or (significantly better) supply a generic \n    server-side mechanism for populating options in some situations. -->\n    <% if (name == \'locations\' || name == \'location\') { %>\n    <td><div id="selector-container" class="input-medium param-value"></div></td>\n    <% } else if (type == \'java.lang.Boolean\') { %>\n    <td>\n        <% if (defaultValue) { %>\n        <input type="checkbox" class="param-value" checked>\n        <% } else { %>\n        <input type="checkbox" class="param-value">\n        <% } %>\n    </td>\n    <% } else { %>\n    <td><!--  use 1 line textarea so it can be resized -->\n      <textarea class="input-medium param-value"><%- defaultValue %></textarea>\n    </td>\n    <% } %>    \n</tr>\n'}),define("text!tpl/apps/param-list.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- effector param list template -->\n<table id="params" class="table table-striped table-condensed">\n    <thead>\n    <tr>\n        <th>Name</th>\n        <th>Value</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>'}),define("view/effector-invoke",["underscore","jquery","backbone","model/location","text!tpl/apps/effector-modal.html","text!tpl/app-add-wizard/deploy-location-row.html","text!tpl/app-add-wizard/deploy-location-option.html","text!tpl/apps/param.html","text!tpl/apps/param-list.html","bootstrap"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({template:e.template(i),locationRowTemplate:e.template(s),locationOptionTemplate:e.template(o),effectorParam:e.template(u),effectorParamList:e.template(a),events:{"click .invoke-effector":"invokeEffector",shown:"onShow",hide:"onHide"},initialize:function(){this.locations=this.options.locations||new r.Collection},onShow:function(){this.delegateEvents(),this.$el.fadeTo(500,1)},onHide:function(){this.undelegateEvents()},render:function(){var n=this,r=this.model.get("parameters");this.$el.html(this.template({name:this.model.get("name"),entityName:this.options.entity.get("name"),description:this.model.get("description")?this.model.get("description"):""}));if(r.length!==0){this.$(".modal-body").html(this.effectorParamList({}));var i=this.$("tbody");e(r).each(function(e){i.append(n.effectorParam({name:e.name,type:e.type,description:e.description?e.description:"",defaultValue:e.defaultValue}))});var s=this.$("#selector-container");if(s.length){this.locations.fetch({async:!1}),s.empty();var o=this.locations[0];s.append(n.locationRowTemplate({initialValue:o,rowId:0}));var u=s.find(".select-location").append(this.locationOptionTemplate({id:"",name:"None"})).append("<option disabled>------</option>");this.locations.each(function(e){var t=n.locationOptionTemplate({id:e.id,url:e.getLinkByName("self"),name:e.getPrettyName()});u.append(t)}),u.each(function(e){var n=t(u[e]).parent().attr("initialValue");t(u[e]).val(n)})}}return this.$(".modal-body").find('*[rel="tooltip"]').tooltip(),this},extractParamsFromTable:function(){var e={};return this.$(".effector-param").each(function(n){var r=t(this).find(".param-name").text(),i=t(this).find(".param-value"),s;i.attr("id")=="selector-container"?s=t(this).find(".param-value option:selected").attr("value"):i.is(":checkbox")?s="checked"==i.attr("checked")?"true":"false":s=i.val(),s!==""&&(e[r]=s)}),e},invokeEffector:function(){var e=this,n=this.model.getLinkByName("self"),r=this.extractParamsFromTable();this.$el.fadeTo(500,.5),t.ajax({type:"POST",url:n+"?timeout=0",data:JSON.stringify(r),contentType:"application/json",success:function(t){e.$el.modal("hide"),e.$el.fadeTo(500,1),e.options.openTask&&e.options.tabView.openTab("activities/subtask/"+t.id)},error:function(t){e.$el.fadeTo(100,1).delay(200).fadeTo(200,.2).delay(200).fadeTo(200,1),console.error("ERROR invoking effector"),console.debug(t)}}),this.undelegateEvents()}});return f}),define("text!tpl/apps/effector.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<table id="effectors-table" class="table table-striped table-condensed nonDatatables" style="width: 100%;">\n    <thead>\n    <tr>\n        <th>Name</th>\n        <th>Description</th>\n        <th>Action</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n<div class="has-no-effectors for-empty-table hide">\n    <i>No effectors available on this entity</i>\n</div>\n<div id="effector-modal" class="modal hide fade"></div>\n'}),define("text!tpl/apps/effector-row.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<tr>\n    <td class="effector-name"><%= name %></td>\n    <td><%= description %></td>\n    <td class="effector-action">\n        <button class="btn btn-info btn-mini show-effector-modal" id="<%=cid%>">Invoke</button>\n    </td>\n</tr>'}),define("view/entity-effectors",["underscore","jquery","backbone","view/viewutils","model/effector-summary","view/effector-invoke","text!tpl/apps/effector.html","text!tpl/apps/effector-row.html","bootstrap"],function(e,t,n,r,i,s,o,u){var a=n.View.extend({template:e.template(o),effectorRow:e.template(u),events:{"click .show-effector-modal":"showEffectorModal"},initialize:function(){this.$el.html(this.template({}));var e=this;this._effectors=new i.Collection,this._effectors.url=this.model.getLinkByName("effectors"),e.loadedData=!1,r.fadeToIndicateInitialLoad(this.$("#effectors-table")),this.$(".has-no-effectors").hide(),this._effectors.fetch({success:function(){e.loadedData=!0,e.render(),r.cancelFadeOnceLoaded(e.$("#effectors-table"))}}),r.fetchRepeatedlyWithDelay(this,this._effectors,{period:1e4})},render:function(){if(this.viewIsClosed)return;var e=this,t=this.$("#effectors-table tbody").empty();return this._effectors.length==0?e.loadedData&&this.$(".has-no-effectors").show():(this.$(".has-no-effectors").hide(),this._effectors.each(function(n){t.append(e.effectorRow({name:n.get("name"),description:n.get("description"),cid:n.id}))})),this},showEffectorModal:function(e){var n=t(e.currentTarget).attr("id"),r=this._effectors.get(n),i=new s({el:"#effector-modal",model:r,entity:this.model,tabView:this.options.tabView,openTask:!0});i.render().$el.modal("show")}});return a}),define("model/policy-summary",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{id:"",name:"",state:"",links:{self:"",config:"",start:"",stop:"",destroy:"",entity:"",application:""}}},getLinkByName:function(e){if(e)return this.get("links")[e]},getPolicyConfigUpdateUrl:function(){return this.getLinkByName("self")+"/config/current-state"}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("model/policy-config-summary",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{name:"",type:"",description:"",defaultValue:"",value:"",reconfigurable:"",links:{self:"",application:"",entity:"",policy:"",edit:""}}},getLinkByName:function(e){if(e)return this.get("links")[e]}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("text!tpl/apps/policy-parameter-config.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<p>\n    <strong>Update the value for <%= name %></strong>\n</p>\n<p>\n    <%= description %>\n</p>\n<input id="policy-config-value" type="text" class="input-xlarge" name="value" value="<%= value %>" autofocus />\n\n<div class="hide alert alert-error policy-add-error-container" style="margin-top: 9px; margin-bottom: 0;">\n    <strong>Error</strong>\n    <span class="policy-add-error-message"></span>\n</div>\n'}),define("view/policy-config-invoke",["underscore","jquery","backbone","text!tpl/apps/policy-parameter-config.html","bootstrap"],function(e,t,n,r){var i=n.View.extend({template:e.template(r),initialize:function(){e.bindAll(this)},render:function(){return this.$el.html(this.template({name:this.model.get("name"),description:this.model.get("description"),type:this.model.get("type"),value:this.options.currentValue||"",policyName:this.options.policy.get("name")})),this},onSubmit:function(){var e=this,n=e.model.getLinkByName("self"),r=e.$("#policy-config-value").val();try{JSON.parse(r)}catch(i){r=JSON.stringify(r)}return t.ajax({type:"POST",url:n,contentType:"application/json",data:r}).fail(function(t){var n=JSON.parse(t.responseText).message;e.showError(n)})},showError:function(e){this.$(".policy-add-error-container").removeClass("hide"),this.$(".policy-add-error-message").html(e)},title:function(){return"Reconfigure "+this.options.policy.get("name")}});return i}),define("text!tpl/apps/policy-new.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<form style="margin-bottom: 0;">\n    <h4 style="margin-bottom: 9px;">Policy Type</h4>\n    <input id="policy-add-type" class="input-xlarge" type="text" name="policy-type" placeholder="Type"/>\n    <p>Enter the full type of the policy</p>\n\n    <h4 style="margin-bottom: 9px; margin-top: 5px">Config Keys</h4>\n    <div class="policy-add-config-keys"></div>\n    <p>\n        Enter the full name of the config key and its value. Values will be coerced to the\n        appropriate type automatically. Blank keys and values will cause the property\n        to be ignored. Last key wins if any key is duplicated.\n    </p>\n\n    <div class="hide alert alert-error policy-add-error-container" style="margin-top: 9px;">\n        <strong>Error</strong>\n        <span class="policy-add-error-message"></span>\n    </div>\n\n</form>\n'}),define("view/policy-new",["jquery","underscore","backbone","brooklyn","text!tpl/apps/policy-new.html"],function(e,t,n,r,i){return n.View.extend({template:t.template(i),initialize:function(){if(!this.options.entity)throw new Error("NewPolicy view requires entity to know where to post result");this.title="Attach New Policy to "+this.options.entity.get("name")},render:function(){return this.$el.html(this.template),this.configKeyView=new r.view.ConfigKeyInputPairList,this.$(".policy-add-config-keys").html(this.configKeyView.render().$el),this},beforeClose:function(){this.configKeyView&&this.configKeyView.close()},onSubmit:function(n){var r=this.$("#policy-add-type").val(),i=this.configKeyView.getConfigKeys();console.log("type",r,"config",i),t.isEmpty(i)&&(i.___d_dummy="dummyval");var s=this.options.entity.get("links").policies+"/?type="+r,o=this,u=e.ajax({url:s,type:"post",data:JSON.stringify(i),contentType:"application/json"}).fail(function(e){var t=JSON.parse(e.responseText).message;o.showError(t)});return t.isFunction(this.options.onSave)&&u.done(this.options.onSave),u},showError:function(e){this.$(".policy-add-error-container").removeClass("hide"),this.$(".policy-add-error-message").html(e)}})}),define("text!tpl/apps/policy.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<table id="policies-table" class="table table-striped table-condensed nonDatatables">\n    <thead>\n    <tr>\n        <th width="50%">Name</th>\n        <th width="25%">State</th>\n        <th width="25%">Action</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n\n<div class="has-no-policies for-empty-table hide">\n    <i>No policies are attached to this entity</i>\n</div>\n\n<div id="policy-config" class="hide">\n  <div class="table-scroll-wrapper">\n    <table id="policy-config-table" style="width: 554px;">\n        <thead>\n        <tr>\n            <th width="35%">Name</th>\n            <th width="55%">Value</th>\n            <th width="10%">Edit</th>\n        </tr>\n        </thead>\n        <tbody></tbody>\n    </table>\n    <div class="has-no-policy-config for-empty-table hide">\n        <i>No configuration is available on this policy</i>\n    </div>\n  </div>\n</div>\n\n<div id="policy-config-none-selected">\n    <i>Select a policy above to view or edit configuration.</i>\n</div>\n\n<button class="btn add-new-policy pull-right">Attach New Policy</button>\n'}),define("text!tpl/apps/policy-row.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<tr class="policy-row" id="<%= cid %>">\n    <td class="policy-name"><%= name %></td>\n    <td><%= state %></td>\n    <td class="policy-action">\n        <% if (state == "RUNNING") { %>\n        <button class="btn btn-info btn-mini policy-stop" link="<%= summary.getLinkByName(\'stop\') %>">Suspend</button>\n        <% } else if (state == "STOPPED") { %>\n        <button class="btn btn-info btn-mini policy-start" link="<%= summary.getLinkByName(\'start\') %>">Resume</button>\n        <button class="btn btn-info btn-mini policy-destroy" link="<%= summary.getLinkByName(\'destroy\') %>">Destroy</button>\n        <% } %> \n    </td>\n</tr>'}),define("text!tpl/apps/policy-config-row.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<tr class="policy-config-row">\n    <td class="policy-config-name"><span\n        rel="tooltip" title="<b><%= description %></b><br/>(<%= type %>)" data-placement="left"\n        ><%= name %></span></td>\n    <td class="policy-config-value"><%= value %></td>\n    <td class="policy-config-action">\n        <% if (reconfigurable) { %>\n        <button class="btn btn-info btn-mini show-policy-config-modal" id="<%= cid %>">Edit</button>\n        <% } %> \n    </td>\n</tr>'}),define("view/entity-policies",["underscore","jquery","backbone","brooklyn","model/policy-summary","model/policy-config-summary","view/viewutils","view/policy-config-invoke","view/policy-new","text!tpl/apps/policy.html","text!tpl/apps/policy-row.html","text!tpl/apps/policy-config-row.html","jquery-datatables","datatables-extensions"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({template:e.template(f),policyRow:e.template(l),events:{"click .refresh":"refreshPolicyConfigNow","click .filterEmpty":"toggleFilterEmpty","click #policies-table tr":"rowClick","click .policy-start":"callStart","click .policy-stop":"callStop","click .policy-destroy":"callDestroy","click .show-policy-config-modal":"showPolicyConfigModal","click .add-new-policy":"showNewPolicyModal"},initialize:function(){e.bindAll(this),this.$el.html(this.template({}));var t=this;t._policies=new i.Collection,t._policies.url=t.model.getLinkByName("policies"),this.loadedData=!1,o.fadeToIndicateInitialLoad(this.$("#policies-table")),t.render(),this._policies.on("all",this.render,this),o.fetchRepeatedlyWithDelay(this,this._policies,{doitnow:!0,success:function(){t.loadedData=!0,o.cancelFadeOnceLoaded(t.$("#policies-table"))}})},render:function(){if(this.viewIsClosed)return;var e=this,t=this.$("#policies-table tbody").empty();return e._policies.length==0?(this.loadedData&&this.$(".has-no-policies").show(),this.$("#policy-config").hide(),this.$("#policy-config-none-selected").hide()):(this.$(".has-no-policies").hide(),e._policies.each(function(n){t.append(e.policyRow({cid:n.get("id"),name:n.get("name"),state:n.get("state"),summary:n})),e.activePolicy?(e.$("#policies-table tr[id='"+e.activePolicy+"']").addClass("selected"),e.showPolicyConfig(e.activePolicy),e.refreshPolicyConfig()):(e.$("#policy-config").hide(),e.$("#policy-config-none-selected").show())})),e},toggleFilterEmpty:function(){o.toggleFilterEmpty(t("#policy-config-table"),2)},refreshPolicyConfigNow:function(){this.refreshPolicyConfig()},rowClick:function(e){e.stopPropagation();var n=t(e.currentTarget).closest("tr"),r=n.attr("id"),i=this._policies.get(r);t("#policies-table tr").removeClass("selected");if(this.activePolicy==r)this.activePolicy=null,this._config=null,t("#policy-config-table").dataTable().fnDestroy(),t("#policy-config").slideUp(100),t("#policy-config-none-selected").slideDown(100);else{n.addClass("selected"),this._config=new s.Collection,this._config.url=i.getLinkByName("config"),o.fadeToIndicateInitialLoad(t("#policy-config-table")),this.showPolicyConfig(r);var u=this;this._config.fetch().done(function(){u.showPolicyConfig(r),o.cancelFadeOnceLoaded(t("#policy-config-table"))})}},showPolicyConfig:function(n){var r=this;if(n!=null&&r.activePolicy!=n){var i=t("#policy-config-table"),s=i.find("tbody");i.dataTable().fnClearTable(),t("#policy-config-none-selected").slideUp(100);if(r._config.length==0)t(".has-no-policy-config").show();else{t(".has-no-policy-config").hide(),r.activePolicy=n;var u=e.template(c);r._config.each(function(e){s.append(u({cid:e.cid,name:e.get("name"),description:e.get("description"),type:e.get("type"),reconfigurable:e.get("reconfigurable"),link:e.getLinkByName("self"),value:e.get("defaultValue")})),s.find('*[rel="tooltip"]').tooltip()}),r.currentStateUrl=r._policies.get(r.activePolicy).getLinkByName("config")+"/current-state",t("#policy-config").slideDown(100),i.slideDown(100),o.myDataTable(i,{bAutoWidth:!1,aoColumns:[{sWidth:"220px"},{sWidth:"240px"},{sWidth:"25px"}]}),i.dataTable().fnAdjustColumnSizing()}}r.refreshPolicyConfig()},refreshPolicyConfig:function(){var n=this;if(n.viewIsClosed||!n.currentStateUrl)return;var r=n.$("#policy-config-table").dataTable(),i=n.$("tr.policy-config-row");t.get(n.currentStateUrl,function(s){if(n.viewIsClosed)return;i.each(function(n,i){var o=t(this).find(".policy-config-name").text(),u=s[o];u!==undefined&&r.fnUpdate(e.escape(u),i,1,!1)})}),r.dataTable().fnStandingRedraw()},showPolicyConfigModal:function(e){var n=t(e.currentTarget).attr("id"),i=t(e.currentTarget).parent().parent().find(".policy-config-value").text();r.view.showModalWith(new u({model:this._config.get(n),policy:this.model,currentValue:i}))},showNewPolicyModal:function(){var e=this;r.view.showModalWith(new a({entity:this.model,onSave:function(t){console.log("New policy",t),e._policies.add(t)}}))},callStart:function(e){this.doPost(e,"start")},callStop:function(e){this.doPost(e,"stop")},callDestroy:function(e){this.doPost(e,"destroy")},doPost:function(e,n){e.stopPropagation();var r=this,i=t(e.currentTarget).attr("link");t.ajax({type:"POST",url:i,success:function(){r._policies.fetch()}})}});return h}),define("model/task-summary",["underscore","backbone"],function(e,t){var n={};return n.Model=t.Model.extend({defaults:function(){return{id:"",links:{},displayName:"",description:"",entityId:"",entityDisplayName:"",tags:{},submitTimeUtc:null,startTimeUtc:null,endTimeUtc:null,currentStatus:"",result:null,isError:null,isCancelled:null,children:[],detailedStatus:"",blockingTask:null,blockingDetails:null}},getTagByName:function(e){if(e)return this.get("tags")[e]},isError:function(){return this.attributes.isError==1},isGlobalTopLevel:function(){return this.attributes.submittedByTask==null},isLocalTopLevel:function(){var e=this.attributes.submittedByTask;return e==null||e.metadata&&e.metadata.id!=this.id},parse:function(t){return e.forEach(e.keys(this.attributes),function(e){t[e]===undefined&&(t[e]=null)}),t}}),n.Collection=t.Collection.extend({model:n.Model}),n}),define("text!tpl/apps/activity-details.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="subpanel-header-row">\n    <div>\n     <div style="float: left;"><i class="backDrillDown icon-chevron-left handy" rel="tooltip" title="Back up one level" style="margin-top: 3px;"></i>&nbsp;</div>\n     <div style="margin-bottom: 6px;">\n      <span style="font-weight: 400;" class="ifField-entityDisplayName hide"><span class="updateField-entityDisplayName"/>:</span>\n      <div style="display: inline-block;" class="updateField-displayName">Loading...</div>\n     </div>\n     <% for (crumb in breadcrumbs) { %>\n     <div style="margin-right: 20px; font-weight: 400; font-size: 80%; text-align: right; line-height: 14px;">\n        <%= breadcrumbs[crumb] %></span>\n     </div>\n     <% } %>\n    </div>\n</div>\n\n<div class="activity-details-section activity-description">\n    <span class="updateField-description"/>\n</div>\n<div class="activity-details-section activity-status">\n    <b><span class="updateField-currentStatus"/></b>\n    <span class="ifField-blockingDetails hide">- <span class="updateField-blockingDetails"/></span>\n    <span class="ifField-blockingTask hide"> (blocked on <span class="updateField-blockingTask"/>)</span>\n    <span class="updateField-result activity-detail-results"/>\n</div>\n\n  <div class="toggler-region task-summary">\n    <div class="toggler-header">\n      <div class="toggler-icon icon-chevron-down"></div>\n      <div><b>Summary</b></div>\n    </div>\n    <div>\n\n<div class="activity-details-section activity-name-and-id">\n    <span class="activity-label">Name:</span> <span class="updateField-displayName">Loading...</span> <br/>\n    <span class="activity-label">ID:</span> <span class="updateField-id"><%= taskId %></span>\n</div>\n<div class="activity-details-section activity-time">\n    <!-- these are dynamic -->\n    <div class="ifField-submitTimeUtc"><span class="activity-label">Submitted:</span> \n        <span class="updateField-submitTimeUtc"/></div>\n    <div class="ifField-startTimeUtc"><span class="activity-label">Started:</span>\n        <span class="updateField-startTimeUtc"/></div>\n    <div class="ifField-endTimeUtc"><span class="activity-label">Finished:</span>\n        <span class="updateField-endTimeUtc"/></div>\n</div>\n<div class="ifField-submittedByTask">\n  <div class="activity-details-section activity-tags">\n    <span class="activity-label">Submitted by:</span> \n        <span class="updateField-submittedByTask"/>\n  </div>\n</div>\n\n    </div>\n  </div>\n    \n  <div class="toggler-region tasks-streams ifField-streams">\n    <div class="toggler-header">\n      <div class="toggler-icon icon-chevron-down"></div>\n      <div><b>Available Streams</b></div>\n    </div>\n    <div class="activity-details-section updateField-streams">\n    </div>\n  </div>\n    \n  <div class="toggler-region tasks-children">\n    <div class="toggler-header">\n      <div class="toggler-icon icon-chevron-down"></div>\n      <div><b>Children Tasks</b></div>\n    </div>\n    <div class="activity-details-section activity-tasks-children">\n      <div id="activities-children-table" class="table-scroll-wrapper">\n      </div>\n    </div>\n  </div>\n    \n  <div class="toggler-region tasks-submitted">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Background Tasks</b></div>\n    </div>\n    <div class="activity-details-section activity-tasks-submitted hide">\n      <div id="activities-submitted-table" class="table-scroll-wrapper">\n      </div>\n    </div>\n  </div>\n\n  <div class="ifField-tags toggler-region task-tags">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Tags</b></div>\n    </div>\n    <div class="activity-details-section activity-tags hide">\n        <span class="updateField-tags"></span>\n    </div>\n  </div>\n\n  <div class="toggler-region task-detail">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Detailed Status</b></div>\n    </div>\n    <div class="activity-details-section activity-detailStatus hide">\n     <div class="for-textarea">\n      <textarea id="detailStatus-textrea" readonly="readonly" style="width: 100%;"></textarea>\n     </div>\n    </div>\n  </div>\n        \n  <div class="toggler-region task-json">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>JSON</b></div>\n    </div>\n    <div class="activity-details-section activity-json hide">\n     <div class="for-textarea">\n      <textarea id="json-textrea" readonly="readonly" style="width: 100%;"></textarea>\n     </div>\n    </div>     \n  </div>\n    \n</div>'}),define("text!tpl/apps/activity-table.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<table class="activity-table" width="569">\n    <thead>\n    <tr>\n        <th width="0%"></th>\n        <th width="40%">Task</th>\n        <th width="30%">Submitted</th>\n        <th width="30%">Status</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n'}),define("view/activity-details",["underscore","jquery","backbone","brooklyn-utils","view/viewutils","moment","model/task-summary","text!tpl/apps/activity-details.html","text!tpl/apps/activity-table.html","bootstrap","jquery-datatables","datatables-extensions"],function(e,t,n,r,i,s,o,u,a){function c(n){n.html(e.template(a));var s=t(".activity-table",n);return s.attr("width",557),i.myDataTable(s,{fnRowCallback:function(e,n,r,i){t(e).attr("id",n[0]),t(e).addClass("activity-row")},aoColumnDefs:[{mRender:function(e,t,n){return r.escape(e)},aTargets:[1,2,3]},{bVisible:!1,aTargets:[0]}],aaSorting:[]})}var f=e.template(a),l=e.template(u),h=n.View.extend({template:l,taskLink:"",task:null,childrenTable:null,subtasksTable:null,children:null,breadcrumbs:[],firstLoad:!0,events:{"click #activities-children-table .activity-table tr":"childrenRowClick","click #activities-submitted-table .activity-table tr":"submittedRowClick","click .showDrillDownSubmittedByAnchor":"showDrillDownSubmittedByAnchor","click .showDrillDownBlockerOfAnchor":"showDrillDownBlockerOfAnchor","click .backDrillDown":"backDrillDown"},initialize:function(){var e=this;this.taskLink=this.options.taskLink,this.taskId=this.options.taskId,this.options.task?this.task=this.options.task:this.options.tabView&&(this.task=this.options.tabView.collection.get(this.taskId)),!this.taskLink&&this.task&&(this.taskLink=this.task.get("links").self),!this.taskLink&&this.taskId&&(this.taskLink="v1/activities/"+this.taskId),this.tabView=this.options.tabView||null,this.options.breadcrumbs&&(this.breadcrumbs=this.options.breadcrumbs),this.$el.html(this.template({taskLink:this.taskLink,taskId:this.taskId,task:this.task,breadcrumbs:this.breadcrumbs})),this.$el.addClass("activity-detail-panel"),this.childrenTable=c(this.$("#activities-children-table")),this.subtasksTable=c(this.$("#activities-submitted-table")),i.attachToggler(this.$el),this.task?(this.renderTask(),this.setUpPolling()):(i.fadeToIndicateInitialLoad(this.$el),this.$el.css("cursor","wait"),t.get(this.taskLink,function(t){i.cancelFadeOnceLoaded(e.$el),e.task=new o.Model(t),e.renderTask(),e.setUpPolling()}).fail(function(){log("unable to load "+e.taskLink)})),this.renderSubtasks()},refreshNow:function(e){var n=this;t.get(this.taskLink,function(t){n.task=new o.Model(t),n.renderTask(),e&&n.setUpPolling()})},renderTask:function(){var t=this,n=this.firstLoad;this.firstLoad=!1;if(n&&this.task&&this.task.get("isError")){var o=this.$(".toggler-region.task-detail .toggler-header");i.showTogglerClickElement(o)}this.updateFields("displayName","entityDisplayName","id","description","currentStatus","blockingDetails"),this.updateFieldWith("blockingTask",function(n){return"<a class='showDrillDownBlockerOfAnchor handy' link='"+e.escape(n.link)+"' id='"+n.metadata.id+"'>"+t.displayTextForLinkedTask(n)+"</a>"}),this.updateFieldWith("result",function(e){var t=r.toDisplayString(e);return t.trim().length==0?" (empty result)":t.length<20&&!/\r|\n/.exec(e)?" with result: <span class='result-literal'>"+t+"</span>":"<div class='result-literal'>"+t.replace(/\n+/g,"<br>")+"</div>"}),this.updateFieldWith("tags",function(e){var t="";for(var n in e)t+="<div class='activity-tag-giftlabel'>"+r.toDisplayString(e[n])+"</div>";return t});var u=this.updateFieldWith("submitTimeUtc",function(e){return e<=0?"-":s(e).format("D MMM YYYY H:mm:ss.SSS")+" &nbsp; <i>"+s(e).fromNow()+"</i>"}),a=this.updateFieldWith("startTimeUtc",function(e){return e<=0?"-":s(e).format("D MMM YYYY H:mm:ss.SSS")+" &nbsp; <i>"+s(e).fromNow()+"</i>"});this.updateFieldWith("endTimeUtc",function(e){return e<=0?"-":s(e).format("D MMM YYYY H:mm:ss.SSS")+" &nbsp; <i>"+s(e).from(a,!0)+" later</i>"}),i.updateTextareaWithData(this.$(".task-json .for-textarea"),r.toTextAreaString(this.task),!1,!1,150,400),i.updateTextareaWithData(this.$(".task-detail .for-textarea"),this.task.get("detailedStatus"),!1,!1,30,250),this.updateFieldWith("streams",function(t){var n=e.keys(t);n.sort();var r="";for(var i=0;i<n.length;i++){var s=n[i],o=t[s];r+="<div class='activity-stream-div'><span class='activity-label'>"+e.escape(s)+"</span><span>"+"<a href='"+o.link+"'>download</a>"+(o.metadata.sizeText?" ("+e.escape(o.metadata.sizeText)+")":"")+"</span></div>"}return r}),this.updateFieldWith("submittedByTask",function(n){return"<a class='showDrillDownSubmittedByAnchor handy' link='"+e.escape(n.link)+"' id='"+n.metadata.id+"'>"+t.displayTextForLinkedTask(n)+"</a>"}),this.task.get("children").length==0&&this.$(".toggler-region.tasks-children").hide()},setUpPolling:function(){var e=this;this.$el.css("cursor","auto"),this.task.url=this.taskLink,this.task.on("all",this.renderTask,this),i.get(this,this.taskLink,function(t){i.fetchRepeatedlyWithDelay(e,e.task,{doitnow:!0}),e.children=new o.Collection,e.children.url=e.task.get("links").children,e.children.on("reset",e.renderChildren,e),i.fetchRepeatedlyWithDelay(e,e.children,{fetchOptions:{reset:!0},doitnow:!0,fadeTarget:e.$(".tasks-children")})}).fail(function(){e.$(".toggler-region.tasks-children").hide()}),t.get(this.task.get("links").entity,function(t){e.collection==null||t.links.activities!=e.collection.url?(e.collection=new o.Collection,e.collection.url=t.links.activities,e.collection.on("reset",e.renderSubtasks,e),i.fetchRepeatedlyWithDelay(e,e.collection,{fetchOptions:{reset:!0},doitnow:!0,fadeTarget:e.$(".tasks-submitted")})):(e.collection.on("reset",e.renderSubtasks,e),e.collection.fetch({reset:!0}))})},renderChildren:function(){var e=this,t=this.children;i.updateMyDataTable(this.childrenTable,t,function(t,n){return[t.get("id"),(t.get("entityId")&&t.get("entityId")!=e.task.get("entityId")?t.get("entityDisplayName")+": ":"")+t.get("displayName"),t.get("submitTimeUtc")<=0?"-":s(t.get("submitTimeUtc")).calendar(),t.get("currentStatus")]}),t&&t.length>0?this.$(".toggler-region.tasks-children").show():this.$(".toggler-region.tasks-children").hide()},renderSubtasks:function(){var e=this,t=this.taskId||(this.task?this.task.id:null);if(!this.collection){this.$(".toggler-region.tasks-submitted").hide();return}if(!t)return;var n=[];for(var r in this.collection.models){var o=this.collection.models[r],u=o.get("submittedByTask");u!=null&&u.metadata!=null&&u.metadata["id"]==t&&(!this.children||this.children.get(o.id)==null)&&n.push(o)}i.updateMyDataTable(this.subtasksTable,n,function(t,n){return[t.get("id"),(t.get("entityId")&&(!e.task||t.get("entityId")!=e.task.get("entityId"))?t.get("entityDisplayName")+": ":"")+t.get("displayName"),t.get("submitTimeUtc")<=0?"-":s(t.get("submitTimeUtc")).calendar(),t.get("currentStatus")]}),n&&n.length>0?this.$(".toggler-region.tasks-submitted").show():this.$(".toggler-region.tasks-submitted").hide()},displayTextForLinkedTask:function(t){return t.metadata.taskName?t.metadata.entityDisplayName?e.escape(t.metadata.entityDisplayName)+" <b>"+e.escape(t.metadata.taskName)+"</b>":e.escape(t.metadata.taskName):t.metadata.taskId?e.escape(t.metadata.taskId):e.escape(t.link)},updateField:function(t){return this.updateFieldWith(t,e.escape)},updateFields:function(){e.map(arguments,this.updateField,this)},updateFieldWith:function(t,n){var r=this.task.get(t);return r!==undefined&&r!=null&&(typeof r!="object"||e.size(r)>0)?(this.$(".updateField-"+t,this.$el).html(n(r)),this.$(".ifField-"+t,this.$el).show()):(this.$(".updateField-"+t).empty(),this.$(".ifField-"+t).hide()),r},childrenRowClick:function(e){var n=t(e.currentTarget).closest("tr"),r=n.attr("id");this.showDrillDownTask("subtask of",this.children.get(r).get("links").self,r,this.children.get(r))},submittedRowClick:function(e){var n=t(e.currentTarget).closest("tr"),r=n.attr("id");this.showDrillDownTask("subtask of",this.collection.get(r).get("links").self,r)},showDrillDownSubmittedByAnchor:function(e){var n=t(e.target).closest("a");this.showDrillDownTask("submitter of",n.attr("link"),n.attr("id"))},showDrillDownBlockerOfAnchor:function(e){var n=t(e.target).closest("a");this.showDrillDownTask("blocker of",n.attr("link"),n.attr("id"))},showDrillDownTask:function(e,t,n,r){var i=this,s=[e+" "+this.task.get("entityDisplayName")+" "+this.task.get("displayName")].concat(this.breadcrumbs),o=new h({taskLink:t,taskId:n,task:r,tabView:i.tabView,collection:this.collection,breadcrumbs:s});o.addToView(this.$el)},addToView:function(e){this.parent&&(log("WARN: adding details to view when already added"),this.parent=e),n.history&&(!this.tabView||!this.tabView.openingQueuedTasks)&&n.history.navigate(n.history.fragment+"/"+"subtask"+"/"+this.taskId);var t=e.closest(".slide-panel"),r=t.after("<div>").next();r.addClass("slide-panel"),r.html(this.render().el);var i=!this.tabView||!this.tabView.openingQueuedTasks?300:0;t.animate({left:-600},i,function(){t.hide()}),r.show().css({left:600,top:0}).animate({left:0},i)},backDrillDown:function(e){var t=this,r=this.$el.closest(".slide-panel"),i=r.prev();if(n.history){var s=n.history.fragment,o=s.indexOf("/subtask/"+this.taskId);o>=0&&n.history.navigate(s.substring(0,o))}r.animate({left:569},300,function(){t.$el.empty(),r.remove(),t.remove()}),i.show().css({left:-600}).animate({left:0},300)}});return h}),define("text!tpl/apps/activities.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div id="activities-table-group" class="slide-panel-group">\n    <div id="activities-root" class="table-scroll-wrapper slide-panel" width="569">\n    </div>\n</div>\n\n<div>&nbsp;</div>\n\n<div id="activity-details">\n</div>\n\n'}),define("text!tpl/apps/activity-row-details.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="opened-row-details <% if (!updateOnly) { %> hide<% } %>">\n<% if (task == null) { %> <i>No information available</i> <% } else { %>\n  <div>\n    <div class="expansion-header">\n      <div style="float: right;" class="toolbar-row">\n        <!--  <a class="handy icon-book toggleLog"></a> -->\n        <a href="<%= link %>"><i class="handy icon-file showJson" rel="tooltip" title="JSON direct link"></i></a>\n        <i class="handy icon-inbox toggleFullDetail" rel="tooltip" title="Show even more detail"></i>\n        <i class="handy icon-chevron-right showDrillDown" rel="tooltip" title="Drill into sub-tasks"></i>\n      </div>\n      <b><i><span class="task-description"><%= task.description %></span></i></b>\n    </div>\n    <div class="expansion-main">\n    </div>\n    <div class="expansion-footer">\n    </div>\n  </div>\n<% } %>\n</div>\n'}),define("text!tpl/apps/activity-row-details-main.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n    <% if (task.startTimeUtc) { %>started <%= moment(task.startTimeUtc).fromNow() %><% \n        if (task.submitTimeUtc != task.startTimeUtc) { %> (submitted <%= moment(task.submitTimeUtc).from(task.startTimeUtc, true) %> earlier)<% } \n        if (task.endTimeUtc) { %>, finished after <%= moment(task.endTimeUtc).from(task.startTimeUtc, true) %> \n        <% } else { %>, in progress\n        <% } %>\n    <% } else { %>\n       submitted <%= moment(task.submitTimeUtc).fromNow() %>, waiting\n    <% } %>\n'}),define("text!tpl/apps/activity-full-details.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="for-activity-textarea">\n    <textarea readonly="readonly" rows="1" style="width:100%;"><%= \n        task.attributes.detailedStatus \n    %></textarea>\n</div>\n'}),define("view/entity-activities",["underscore","jquery","backbone","brooklyn-utils","view/viewutils","view/activity-details","text!tpl/apps/activities.html","text!tpl/apps/activity-table.html","text!tpl/apps/activity-row-details.html","text!tpl/apps/activity-row-details-main.html","text!tpl/apps/activity-full-details.html","bootstrap","jquery-datatables","datatables-extensions","moment"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({template:e.template(o),table:null,refreshActive:!0,selectedId:null,selectedRow:null,events:{"click #activities-root .activity-table tr":"rowClick","click #activities-root .refresh":"refreshNow","click #activities-root .toggleAutoRefresh":"toggleAutoRefresh","click #activities-root .showDrillDown":"showDrillDown","click #activities-root .toggleFullDetail":"toggleFullDetail"},initialize:function(){e.bindAll(this),this.$el.html(this.template({})),this.$("#activities-root").html(e.template(u));var n=this,s=n.$("#activities-root .activity-table");n.collection.url=n.model.getLinkByName("activities"),n.table=i.myDataTable(s,{fnRowCallback:function(e,n,r,i){t(e).attr("id",n[0]),t(e).addClass("activity-row")},aaSorting:[[2,"desc"]],aoColumnDefs:[{mRender:function(e,t,n){return r.escape(e)},aTargets:[1,3]},{mRender:function(e,t,n){return t==="display"&&(e=moment(e).calendar()),r.escape(e)},aTargets:[2]},{bVisible:!1,aTargets:[0]}]}),i.addAutoRefreshButton(n.table),i.addRefreshButton(n.table),i.fadeToIndicateInitialLoad(s),n.collection.on("reset",n.renderOnLoad,n),i.fetchRepeatedlyWithDelay(this,this.collection,{fetchOptions:{reset:!0},doitnow:!0,enablement:function(){return n.refreshActive}})},refreshNow:function(){this.collection.fetch({reset:!0})},render:function(){this.updateActivitiesNow();var e=this.options.tabView?this.options.tabView.options.preselectTabDetails:null;return e&&e!=this.lastPreselectTabDetails&&(this.lastPreselectTabDetails=e,this.queuedTasksToOpen=e.split("/")),this.tryOpenQueuedTasks(),this},tryOpenQueuedTasks:function(){if(!this.queuedTasksToOpen||this.tryingOpenQueuedTasks)return;this.openingQueuedTasks=!0;var e=null;for(;;){var t=this.queuedTasksToOpen.shift();if(t==undefined){this.openingQueuedTasks=!1;return}if(t=="subtask"){var n=this.queuedTasksToOpen.shift();e=this.showDrillDownTask(n,e)}else log("unknown queued task for activities panel: "+t)}},beforeClose:function(){this.collection.off("reset",this.renderOnLoad)},renderOnLoad:function(){this.loaded=!0,this.render(),i.cancelFadeOnceLoaded(this.table)},toggleAutoRefresh:function(){i.toggleAutoRefresh(this)},enableAutoRefresh:function(e){this.refreshActive=e},refreshNow:function(){this.collection.fetch(),this.table.fnAdjustColumnSizing()},updateActivitiesNow:function(){var e=this;if(this.table!=null&&this.collection.length!=0&&!this.viewIsClosed){var t=[];for(taskI in this.collection.models){var n=this.collection.models[taskI],r=n.get("submittedByTask");(r==null||r!=null&&this.collection.get(r.metadata.id)==null)&&t.push(n)}i.updateMyDataTable(e.table,t,function(e,t){return[e.get("id"),e.get("displayName"),e.get("submitTimeUtc"),e.get("currentStatus")]}),this.showDetailRow(!0)}return this},rowClick:function(e){var n=t(e.currentTarget).closest("tr"),r=n.attr("id");if(r==null)return;this.showDrillDownTask(r);return},showDrillDown:function(e){this.showDrillDownTask(t(e.currentTarget).closest("td.row-expansion").attr("id"))},showDrillDownTask:function(e,t){var n=this,r=new s({taskId:e,tabView:n,collection:this.collection,breadcrumbs:""});return r.addToView(t||this.$(".activity-table")),r.$el},showDetailRow:function(n){var i=this.selectedId,s=this;if(i==null)return;var o=this.collection.get(i);if(o==null)return;if(!n){var u=e.template(a,{task:o==null?null:o.attributes,link:s.model.getLinkByName("activities")+"/"+i,updateOnly:n});t("tr#"+i).next().find("td.row-expansion").html(u),t("tr#"+i).next().find("td.row-expansion").attr("id",i)}else t("tr#"+i).next().find(".task-description").html(r.escape(o.attributes.description));var u=e.template(f,{task:o==null?null:o.attributes,link:s.model.getLinkByName("activities")+"/"+i,updateOnly:n});t("tr#"+i).next().find(".expansion-main").html(u),n||(t("tr#"+i).next().find(".row-expansion .opened-row-details").hide(),t("tr#"+i).next().find(".row-expansion .opened-row-details").slideDown(300))},toggleFullDetail:function(e){var n=t(".toggleFullDetail"),r=n.closest("td.row-expansion").attr("id");n.toggleClass("active"),n.hasClass("active")?this.showFullActivity(r):this.hideFullActivity(r)},showFullActivity:function(n){n=this.selectedId;var r=t("td.row-expansion#"+n+" .expansion-footer"),s=this.collection.get(n),o=e.template(l,{task:s});r.html(o),r.slideDown(100),e.defer(function(){i.setHeightAutomatically(t("textarea",r),30,200)})},hideFullActivity:function(e){e=this.selectedId;var n=t("td.row-expansion#"+e+" .expansion-footer");n.slideUp(100)}});return c}),define("text!tpl/apps/advanced.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div id="advanced-summary">\n  <button id="change-name" class="btn pull-right">Change Name</button>\n  <h3><span id="entity-name">Entity</span></h3>\n\n<div style="text-align: center; padding-top: 24px;">\n  <button id="add-child" class="btn">Add Child</button>\n  <button id="add-new-policy" class="btn">Attach New Policy</button>\n  <button id="reset-problems" class="btn">Reset Problems</button>\n<!-- TODO:\n  <button id="set-config" class="btn">Set Config</button>\n  <button id="edit-sensor" class="btn">Set Sensor</button>\n -->\n  <button id="expunge" class="btn">Expunge</button>\n  <button id="unmanage" class="btn">Unmanage</button>\n</div>\n\n<div id="change-name-modal" class="modal hide fade"></div>\n<div id="add-child-modal" class="modal hide fade"></div>\n<div id="policy-modal" class="modal hide fade"></div>\n\n<div id="advanced-tab-error-section" class="hide" style="margin-top: 36px; color: red;">\n  <div id="advanced-tab-error-closer" style="float: right;"><button type="button" class="close" data-dismiss="modal">x</button></div>\n  <div id="advanced-tab-error-message"></div>\n</div>\n\n  <div class="toggler-region region-config" style="margin-top: 18px;">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Tags</b></div>\n    </div>\n    <div id="advanced-entity-tags" class="hide">Tags not loaded</div>\n  </div>\n\n  <!-- TODO persistence -->\n  \n  <div class="toggler-region region-config" style="margin-top: 18px;">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Entity Resource JSON</b></div>\n    </div>\n    <div id="advanced-entity-json" class="for-textarea hide">\n      <textarea readonly="readonly" class="code-textarea"/>\n    </div>\n  </div>\n\n  <div class="toggler-region region-config" style="margin-top: 18px;">\n    <div class="toggler-header user-hidden">\n      <div class="toggler-icon icon-chevron-left"></div>\n      <div><b>Locations JSON</b></div>\n    </div>\n    <div id="advanced-locations" class="for-textarea hide">\n      <!-- TODO a nicer view than just the JSON -->\n      <textarea readonly="readonly" class="code-textarea"/>\n    </div>\n  </div>\n'}),define("text!tpl/apps/change-name-modal.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n    <h4 style="margin-bottom: 9px;">New Name</h4>\n    <p>Change the display name of an entity</p>\n\n    <input type="text" id="new-name" style="width: 100%;" value="<%= name %>"></input>\n\n    <div class="hide alert alert-error change-name-error-container" style="margin-top: 9px;">\n        <strong>Error</strong>\n        <span class="change-name-error-message"></span>\n    </div>\n'}),define("view/change-name-invoke",["underscore","jquery","backbone","brooklyn-utils","text!tpl/apps/change-name-modal.html"],function(e,t,n,r,i){return n.View.extend({template:e.template(i),initialize:function(){this.title="Change Name of "+this.options.entity.get("name")},render:function(){return this.$el.html(this.template({name:this.options.entity.get("name")})),this},onSubmit:function(){var e=this,n=this.$("#new-name").val(),i=this.options.entity.get("links").rename+"?name="+encodeURIComponent(n),s=t.ajax({type:"POST",url:i,contentType:"application/json",success:function(){e.options.target.reload()},error:function(t){e.showError(r.extractError(t,"Error contacting server",i))}});return s},showError:function(e){this.$(".change-name-error-container").removeClass("hide"),this.$(".change-name-error-message").html(e)}})}),define("text!tpl/apps/add-child-modal.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- modal to render effector-->\n\n    <h4 style="margin-bottom: 9px;">YAML Specification</h4>\n    <p>Add a child or children to this entity by providing a YAML blueprint</p>\n\n    <div class="for-textarea">\n      <textarea id="child-spec" class="code-textarea" style="height: 120px;"/>\n    </div>\n    \n    <label><input type="checkbox" id="child-autostart" checked="checked"/> Auto-start </label>\n\n    <div class="hide alert alert-error child-add-error-container" style="margin-top: 9px;">\n        <strong>Error</strong>\n        <span class="child-add-error-message"></span>\n    </div>\n'}),define("view/add-child-invoke",["underscore","jquery","backbone","brooklyn","brooklyn-utils","view/viewutils","text!tpl/apps/add-child-modal.html"],function(e,t,n,r,i,s,o){return n.View.extend({template:e.template(o),initialize:function(){this.title="Add Child to "+this.options.entity.get("name")},render:function(){return this.$el.html(this.template(this.options.entity.attributes)),this},onSubmit:function(e){var n=this,r=this.$("#child-spec").val(),s=this.$("#child-autostart").is(":checked"),o=this.options.entity.get("links").children+(s?"":"?start=false"),u=t.ajax({type:"POST",url:o,data:r,contentType:"application/yaml",success:function(){n.options.target.reload()},error:function(e){n.showError(i.extractError(e,"Error contacting server",o))}});return u},showError:function(e){this.$(".child-add-error-container").removeClass("hide"),this.$(".child-add-error-message").html(e)}})}),define("view/entity-advanced",["underscore","jquery","backbone","brooklyn","brooklyn-utils","view/viewutils","text!tpl/apps/advanced.html","view/change-name-invoke","view/add-child-invoke","view/policy-new"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({events:{"click button#change-name":"showChangeNameModal","click button#add-child":"showAddChildModal","click button#add-new-policy":"showNewPolicyModal","click button#reset-problems":"confirmResetProblems","click button#expunge":"confirmExpunge","click button#unmanage":"confirmUnmanage","click #advanced-tab-error-closer":"closeAdvancedTabError"},template:e.template(o),initialize:function(){e.bindAll(this),this.$el.html(this.template()),this.model.on("change",this.modelChange,this),this.modelChange(),s.getRepeatedlyWithDelay(this,this.model.get("links").locations,this.renderLocationData),s.get(this,this.model.get("links").tags,this.renderTags),s.attachToggler(this.$el)},modelChange:function(){this.$("#entity-name").html(i.toDisplayString(this.model.get("name"))),s.updateTextareaWithData(t("#advanced-entity-json",this.$el),i.toTextAreaString(this.model),!0,!1,250,600)},renderLocationData:function(e){s.updateTextareaWithData(t("#advanced-locations",this.$el),i.toTextAreaString(e),!0,!1,250,600)},renderTags:function(e){var t="";for(tag in e)t+="<div class='activity-tag-giftlabel'>"+i.toDisplayString(e[tag])+"</div>";t||(t="No tags"),this.$("#advanced-entity-tags").html(t)},reload:function(){this.model.fetch()},showModal:function(e){this.activeModal&&this.activeModal.close(),this.activeModal=e,r.view.showModalWith(e)},showChangeNameModal:function(){this.showModal(new u({entity:this.model,target:this}))},showAddChildModal:function(){this.showModal(new a({entity:this.model,target:this}))},showNewPolicyModal:function(){this.showModal(new f({entity:this.model}))},confirmResetProblems:function(){var e=this.model.get("name"),t="Confirm the reset of problem indicators in "+e,n="<p>Are you sure you want to reset the problem indicators for this entity?</p><p>If a problem has been fixed externally, but the fix is not being detected, this will clear problems. If the problem is not actually fixed, many feeds and enrichers will re-detect it, but note that some may not, and the entity may show as healthy when it is not.</p>";r.view.requestConfirmation(n,t).done(this.doResetProblems)},doResetProblems:function(){this.post(this.model.get("links").sensors+"/"+"service.notUp.indicators",{}),this.post(this.model.get("links").sensors+"/"+"service.problems",{})},post:function(e,n){var r=this;t.ajax({type:"POST",url:e,data:JSON.stringify(n),contentType:"application/json",success:function(){r.reload()},error:function(t){r.showAdvancedTabError(i.extractError(t,"Error contacting server",e))}})},confirmExpunge:function(){var e=this.model.get("name"),t="Confirm the expunging of "+e,n="<p>Are you certain you want to expunge this entity?</p><p>When possible, Brooklyn will delete all of its resources.</p><p><span class='label label-important'>Important</span> <b>This action is irreversible</b></p>";this.unmanageAndOrExpunge(n,t,!0)},confirmUnmanage:function(){var e=this.model.get("name"),t="Confirm the unmanagement of "+e,n="<p>Are you certain you want to unmanage this entity?</p><p>Its resources will be left running.</p><p><span class='label label-important'>Important</span> <b>This action is irreversible</b></p>";this.unmanageAndOrExpunge(n,t,!1)},unmanageAndOrExpunge:function(e,n,i){var s=this;r.view.requestConfirmation(e,n).done(function(){return t.ajax({type:"POST",url:s.model.get("links").expunge+"?release="+i+"&timeout=0",contentType:"application/json"}).done(function(){s.trigger("entity.expunged")}).fail(function(){s.showAdvancedTabError("Error connecting to Brooklyn server"),log("ERROR unmanaging/expunging"),log(data)})})},showAdvancedTabError:function(t){self.$("#advanced-tab-error-message").html(e.escape(t)),self.$("#advanced-tab-error-section").removeClass("hide")},closeAdvancedTabError:function(){self.$("#advanced-tab-error-section").addClass("hide")},beforeClose:function(){this.activeModal&&this.activeModal.close(),this.options.tabView.configView.close(),this.model.off()}});return l}),define("text!tpl/apps/details.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="tabbable">\n    <ul class="nav nav-tabs entity-tabs">\n        <li><a data-target="#summary" data-toggle="tab">Summary</a></li>\n        <li><a data-target="#sensors" data-toggle="tab">Sensors</a></li>\n        <li><a data-target="#effectors" data-toggle="tab">Effectors</a></li>\n        <li><a data-target="#policies" data-toggle="tab">Policies</a></li>\n        <li><a data-target="#activities" data-toggle="tab">Activity</a></li>\n        <li><a data-target="#advanced" data-toggle="tab">Advanced</a></li>\n    </ul>\n    <div class="tab-content">\n        <div class="tab-pane" id="summary"><i>Nothing selected</i></div>\n        <div class="tab-pane" id="sensors"><i>Nothing selected</i></div>\n        <div class="tab-pane" id="effectors"><i>Nothing selected</i></div>\n        <div class="tab-pane" id="policies"><i>Nothing selected</i></div>\n        <div class="tab-pane" id="activities"><i>Nothing selected</i></div>\n        <div class="tab-pane" id="advanced"><i>Nothing selected</i></div>\n    </div>\n</div>'}),define("view/entity-details",["underscore","jquery","backbone","./entity-summary","./entity-sensors","./entity-effectors","./entity-policies","./entity-activities","./entity-advanced","model/task-summary","text!tpl/apps/details.html"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({template:e.template(l),events:{"click .entity-tabs a":"tabSelected"},initialize:function(){var e=this,t=new f.Collection;this.$el.html(this.template({})),this.sensorsView=new i({model:this.model,tabView:this}),this.effectorsView=new s({model:this.model,tabView:this}),this.policiesView=new o({model:this.model,tabView:this}),this.activitiesView=new u({model:this.model,tabView:this,collection:t}),this.summaryView=new r({model:this.model,tabView:this,application:this.options.application,tasks:t}),this.advancedView=new a({model:this.model,tabView:this,application:this.options.application}),this.advancedView.on("entity.expunged",function(){e.trigger("entity.expunged")}),this.$("#summary").html(this.summaryView.render().el),this.$("#sensors").html(this.sensorsView.render().el),this.$("#effectors").html(this.effectorsView.render().el),this.$("#policies").html(this.policiesView.render().el),this.$("#activities").html(this.activitiesView.render().el),this.$("#advanced").html(this.advancedView.render().el)},beforeClose:function(){this.summaryView.close(),this.sensorsView.close(),this.effectorsView.close(),this.policiesView.close(),this.activitiesView.close(),this.advancedView.close()},getEntityHref:function(){return t("#app-tree .entity_tree_node_wrapper.active a").attr("href")},render:function(n){this.summaryView.render(),this.sensorsView.render(),this.effectorsView.render(),this.policiesView.render(),this.activitiesView.render(),this.advancedView.render(),n&&n.html(this.el);var r=this.getEntityHref();r&&t("a[data-toggle='tab']").each(function(e,n){t(n).attr("href",r+"/"+t(n).attr("data-target").slice(1))});if(this.options.preselectTab){var i=this.$('a[data-target="#'+this.options.preselectTab+'"]'),s=function(){i.tab("show",{duration:0})};n?s():e.defer(s)}return this},tabSelected:function(e){e.preventDefault();var r=t(e.currentTarget).attr("data-target").slice(1);this.options.preselectTab=r,this.options.preselectTabDetails=null;var i=this.getTab(r);i&&(i[0]=="#"&&(i=i.substring(1)),n.history.navigate(i))},getTab:function(e,t,n){return n||(t?(n=this.getEntityHref(),n.endsWith(t)||(lastSlash=n.lastIndexOf("/"),lastSlash>=0?n=n.substring(0,lastSlash+1)+"/"+t:(log("malformed entityHref when opening tab: "+n),n=this.getEntityHref()))):n=this.getEntityHref()),n&&e?n+"/"+e:null},openTab:function(e,t,r){var i=this.getTab(e,t,r);if(!i)return;i[0]=="#"&&(i=i.substring(1)),n.history.navigate(i),tabPaths=e.split("/");if(!tabPaths)return;var s=tabPaths.shift();s||(s=tabPaths.shift());if(!s)return;this.options.preselectTab=s,tabPaths&&(this.options.preselectTabDetails=tabPaths.join("/")),this.render()}});return c}),define("text!tpl/apps/entity-not-found.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="padded-div">\n    <p>Failed to load entity <strong><%= id %></strong>. Does it exist?</p>\n    <p>Try <a class="handy application-tree-refresh">reloading the applications list</a> or refreshing the page.</p>\n</div>'}),define("text!tpl/apps/page.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="row row-fluid">\n    <div class="span4" id="tree">\n        <div class="navbar_top">\n            <h3>Applications</h3>\n            <div class="apps-tree-toolbar">\n                <i id="add-new-application" class="icon-br-plus-sign handy" />\n                &nbsp;\n                <i class="icon-br-refresh application-tree-refresh handy" />\n            </div>\n        </div>\n        <div id="app-tree"></div>\n    </div>\n\n    <div class="span8" id="details"></div>\n</div>\n<div class="add-app">\n    <div id="modal-container"></div>\n</div>\n'}),define("view/application-explorer",["underscore","jquery","backbone","view/viewutils","./application-add-wizard","model/application","model/entity-summary","model/app-tree","./application-tree","./entity-details","text!tpl/apps/details.html","text!tpl/apps/entity-not-found.html","text!tpl/apps/page.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({tagName:"div",className:"container container-fluid",id:"application-explorer",template:e.template(h),notFoundTemplate:e.template(c),events:{"click .application-tree-refresh":"refreshApplicationsInPlace","click #add-new-application":"createApplication","click .delete":"deleteApplication"},initialize:function(){this.$el.html(this.template({})),t(".nav1").removeClass("active"),t(".nav1_apps").addClass("active"),this.treeView=new a({collection:this.collection,appRouter:this.options.appRouter}),this.options.initialTrail&&this.show(this.options.initialTrail,!0),this.treeView.on("entitySelected",function(e){this.displayEntityId(e.id,e.get("applicationId"),!1)},this),this.$("div#app-tree").html(this.treeView.renderFull().el),this.$("div#details").html(l),r.fetchRepeatedlyWithDelay(this,this.collection)},refreshApplicationsInPlace:function(){this.collection.fetch()},beforeClose:function(){this.collection.off("reset",this.render),this.treeView.close(),this.detailsView&&this.detailsView.close()},show:function(e,t){var n="",r="";if(e){e[0]=="/"&&(e=e.substring(1));var i=e.indexOf("/");i>0&&(n=e.substring(i+1),e=e.substring(0,i))}if(n){var i=n.indexOf("/");i>0&&(r=n.substring(i+1),n=n.substring(0,i)),this.preselectTab(n,r)}this.treeView.selectEntity(e)||t||this.displayEntityId(e)},showDefaultSelection:function(){if(!this.treeView.selectedEntityId&&!this.treeView.requestedEntityId){var t=e.first(this.collection.getApplications());t&&this.treeView.selectEntity(t)}},createApplication:function(){var e=this;this._modal&&this._modal.close();var t=new i({appRouter:e.options.appRouter,callback:function(){e.refreshApplicationsInPlace()}});this._modal=t,this.$(".add-app #modal-container").html(t.render().el),this.$(".add-app #modal-container .modal").on("hidden",function(){t.close()}).modal("show")},deleteApplication:function(e){this.collection.get(e.currentTarget.id).destroy({wait:!0})},preselectTab:function(e,t){this.currentTab=e,this.currentTabDetails=t},showDetails:function(e,n){var i=this;r.cancelFadeOnceLoaded(t("div#details")),this.detailsView&&(this.detailsView.model&&this.detailsView.model.id&&this.detailsView.model.id!=n.id&&(this.detailsView.options.preselectTabDetails=null),this.preselectTab(this.detailsView.options.preselectTab,this.detailsView.options.preselectTabDetails),this.detailsView.close()),this.currentTab||this.preselectTab("summary"),this.detailsView=new f({model:n,application:e,appRouter:this.options.appRouter,preselectTab:this.currentTab,preselectTabDetails:this.currentTabDetails}),this.detailsView.on("entity.expunged",function(){i.preselectTab("summary");var e=i.selectedEntityId,t=i.collection.get(e);t&&t.get("parentId")?i.displayEntityId(t.get("parentId")):i.collection?i.displayEntityId(i.collection.first().id):e?i.displayEntityNotFound(e):i.displayEntityNotFound("?"),i.collection.fetch()}),this.detailsView.render(t("div#details")),this.detailsView.openTab(this.currentTab+(this.currentTabDetails?"/"+this.currentTabDetails:""))},displayEntityId:function(n,i,u){var a=this,f=function(){return a.displayEntityNotFound(n)};if(i===undefined){var l=a.treeView.getTreebox(n);i=l.children(".entity_tree_node_wrapper").children(".entity_tree_node").data("app-id")}if(i===undefined){if(!u){this.collection.includeEntities([n]),this.collection.fetch({success:function(){e.defer(function(){a.displayEntityId(n,i,!0)})},error:function(){e.defer(function(){a.displayEntityId(n,i,!0)})}}),r.fadeToIndicateInitialLoad(t("div#details"));return}f();return}var c=new s.Model,h=new o.Model;c.url="/v1/applications/"+i,h.url="/v1/applications/"+i+"/entities/"+n,n!==this.treeView.selectedEntityId&&this.treeView.selectEntity(n),r.fadeToIndicateInitialLoad(t("div#details")),t.when(c.fetch(),h.fetch()).done(function(){a.showDetails(c,h)}).fail(f)},displayEntityNotFound:function(e){t("div#details").html(this.notFoundTemplate({id:e})),r.cancelFadeOnceLoaded(t("div#details"))}});return p}),define("text!tpl/catalog/page.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div id="catalog-resource">\n    <div class="row row-fluid">\n        <div class="span4" id="accord">\n            <div class="navbar_top">\n                <h3>Catalog</h3>\n                <div class="apps-tree-toolbar">\n                    <i id="add-new-thing" class="icon-br-plus-sign handy"></i>\n                    &nbsp;\n                    <i class="icon-br-refresh refresh handy"></i>\n                </div>\n            </div>\n            <div class="navbar_main_wrapper">\n                <div class="catalog-accordion-parent catalog-accordion-wrapper"></div>\n            </div>\n        </div>\n\n        <div class="span8" id="details"></div>\n    </div>\n</div>\n'}),define("text!tpl/catalog/details-entity.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="catalog-details">\n\n    <div class="float-right">\n        <button data-name="<%= model.id %>" class="btn composer"\n            title="Open this blueprint in the Composer where the YAML can be edited and deployed.">YAML Composer</button>\n        <button data-name="<%= model.id %>" class="btn btn-danger delete">Delete</button>\n    </div>\n\n    <% if (model.get("name") != model.get("symbolicName")) { %>\n        <h2><%- model.get("name") %></h2>\n        <p><%- model.getVersionedAttr("symbolicName") %></p>\n    <% } else { %>\n        <h2><%- model.getVersionedAttr("symbolicName") %></h2>\n    <% } %>\n    <% if (model.get("description")) { %>\n        <p><%- model.get("description") %></p>\n    <% } %>\n\n    <div id="catalog-details-accordion" class="accordion">\n      <% if (model.get("planYaml")) { %>\n        <div class="accordion-group">\n            <div class="accordion-heading">\n                <a class="accordion-toggle" data-toggle="collapse" data-parent="#catalog-details-accordion" href="#collapseYaml">\n                    Plan\n                </a>\n            </div>\n            <div id="collapseYaml" class="accordion-body collapse">\n                <div class="accordion-inner">\n                    <textarea rows="15" readonly><%- model.get("planYaml") %></textarea>\n                </div>\n            </div>\n        </div>\n      <% } %>\n        <% if (viewName != "policies") { %>\n        <div class="accordion-group">\n            <div class="accordion-heading">\n                <a class="accordion-toggle" data-toggle="collapse" data-parent="#catalog-details-accordion" href="#collapseConfiguration">\n                    Configuration\n                </a>\n            </div>\n            <div id="collapseConfiguration" class="accordion-body collapse">\n                <div class="accordion-inner">\n                    <% if (model.error) { %>\n                    <p><i class="icon-exclamation-sign"></i> Could not load configuration</p>\n                    <% } else if (!model.get("config")) { %>\n                        <p>Loading...</p>\n                    <% } else if (_.isEmpty(model.get("config"))) { %>\n                        <p>No configuration</p>\n                    <% } else { %>\n                        <% var skip = [\n                            \'name\',\n                            \'description\',\n                            \'label\',\n                            \'priority\',\n                            \'reconfigurable\'\n                        ]; %>\n                        <% _.each(model.get("config"), function(object, index) { %>\n                        <div style="padding-bottom: 12px;">\n                        <p><strong><%- object.name %></strong>: <%- object.description %></p>\n                        <div style="margin-left: 24px;">\n                        <table class="table table-striped table-condensed nonDatatables">\n                            <tbody>\n                            <% _.each(object, function(value, key) { %>\n                            <% if (!_.contains(skip, key)) { %>\n                            <tr>\n                                <td><%- key %></td>\n                                <td><%- typeof value === "string" ? value : JSON.stringify(value) %></td>\n                            </tr>\n                            <% } %>\n                            <% }); %>\n                            </tbody>\n                        </table></div>\n                        </div>\n                        <% }); %>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n        <div class="accordion-group">\n            <div class="accordion-heading">\n                <a class="accordion-toggle" data-toggle="collapse" data-parent="#catalog-details-accordion" href="#collapseSensors">\n                    Sensors\n                </a>\n            </div>\n            <div id="collapseSensors" class="accordion-body collapse">\n                <div class="accordion-inner">\n                    <% if (model.error) { %>\n                    <p><i class="icon-exclamation-sign"></i> Could not load sensors</p>\n                    <% } else if (!model.get("sensors")) { %>\n                        <p>Loading...</p>\n                    <% } else if (_.isEmpty(model.get("sensors"))) { %>\n                        <p>No sensors</p>\n                    <% } else { %>\n                        <table class="table table-striped table-condensed nonDatatables">\n                            <thead>\n                                <tr>\n                                    <th>Name</th>\n                                    <th>Type</th>\n                                    <th>Description</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                            <% _.each(model.get("sensors"), function(object, index) { %>\n                                <tr>\n                                    <td><%- object.name %></td>\n                                    <td><%- object.type %></td>\n                                    <td><%- object.description %></td>\n                                </tr>\n                            <% }); %>\n                            </tbody>\n                        </table>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n        <div class="accordion-group">\n            <div class="accordion-heading">\n                <a class="accordion-toggle" data-toggle="collapse" data-parent="#catalog-details-accordion" href="#collapseEffectors">\n                    Effectors\n                </a>\n            </div>\n            <div id="collapseEffectors" class="accordion-body collapse">\n                <div class="accordion-inner">\n                <% if (model.error) { %>\n                    <p><i class="icon-exclamation-sign"></i> Could not load effectors</p>\n                <% } else if (!model.get("effectors")) { %>\n                    <p>Loading...</p>\n                <% } else if (_.isEmpty(model.get("effectors"))) { %>\n                    <p>No effectors</p>\n                <% } else { %>\n                    <% _.each(model.get("effectors"), function(object, index) { %>\n                        <div style="padding-bottom: 12px;">\n                        <p><strong><%- object.name %></strong>: <%- object.description %></p>\n                        <% if (!object.parameters || _.isEmpty(object.parameters)) { %>\n                            <p>No parameters</p>\n                        <% } else { %>\n                            <div style="margin-left: 24px;">\n                            <table class="table table-striped table-condensed nonDatatables">\n                                <tbody>\n                                    <% _.each(object.parameters, function(parameter, index) { %>\n                                        <% _.each(parameter, function(value, key) { %>\n                                        <tr>\n                                            <td><%- key %></td>\n                                            <td><%- value %></td>\n                                        </tr>\n                                        <% }); %>\n                                    <% }); %>\n                                </tbody>\n                            </table>\n                            </div>\n                        <% } %>\n                        </div>\n                    <% }); %>\n                <% } %>\n                </div>\n            </div>\n        </div>\n        <% } %>\n    </div>\n\n</div>\n'}),define("text!tpl/catalog/details-generic.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="catalog-details">\n\n    <div class="float-right">\n        <button data-name="<%= model.id %>" class="btn btn-danger delete">Delete</button>\n    </div>\n\n    <% if (model.get("name") !== undefined) { %>\n        <h2><%= model.get("name") %></h2>\n    <% } else if (model.get("type") !== undefined) { %>\n        <h2><%= model.get("type") %></h2>\n    <% } %>\n\n    <dl>\n        <% _.each(model.attributes, function(value, key) { %>\n            <% if (value) { %>\n                <dt><%= key %></dt>\n                <% if (_.isObject(value)) { %>\n                    <dd>Not shown: is a complex object</dd>\n                <% } else { %>\n                    <dd><%= value %></dd>\n                <% } %>\n            <% } %>\n        <% }) %>\n    </dl>\n\n</div>\n'}),define("text!tpl/catalog/details-location.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="catalog-details">\n\n    <div class="float-right">\n      <% if (model.get("catalog") && model.get("catalog").planYaml) { %>\n        <button data-name="<%= model.getIdentifierName() %>" class="btn composer"\n            title="Open this blueprint in the Composer where the YAML can be edited and deployed.">YAML Composer</button>\n        <button data-name="<%= model.getIdentifierName() %>" class="btn btn-danger delete">Delete</button>\n      <% } else { %>\n        <button class="btn composer" disabled\n            title="This item is defined in properties and cannot be edited.">YAML Composer</button>\n        <button class="btn btn-danger delete" disabled\n            title="This item is defined in properties and cannot be deleted.">Delete</button>\n      <% } %>\n    </div>\n\n    <% if (model.get("name") != model.getPrettyName()) { %>\n        <h2><%- model.getPrettyName() %></h2>\n        <p><%- model.get("name") %></p>\n    <% } else { %>\n        <h2><%- model.get("name") %></h2>\n    <% } %>\n    <% if (model.get("description")) { %>\n        <p><%- model.get("description") %></p>\n    <% } %>\n\n    <br/>\n    \n    <table>\n        <tr><td><strong>Implementation Spec:</strong>&nbsp;&nbsp;</td><td><%- model.get("spec") || "" %></td></tr>\n        <tr><td><strong>Internal ID:</strong>&nbsp;&nbsp;</td><td><%- model.get("id") || "" %></td></tr>\n    </table>\n    \n    <br/>\n    \n<% if (model.get("catalog") && model.get("catalog").planYaml) { %>\n\n    <textarea rows="15" readonly><%- model.get("catalog").planYaml %></textarea>\n      \n<% } else if (!model.get("config") || _.isEmpty(model.get("config"))) { %>\n    <p>\n    <i>No configuration is defined explicitly on this item. All config is inherited or defined in properties.</i>\n    <p>\n    <i>This item is not editable.</i>\n<% } else { %>\n\n    <table class="table table-striped table-condensed nonDatatables">\n        <thead><tr>\n            <th>Configuration Key</th>\n            <th>Value</th>\n        </tr></thead>\n        <tbody>\n        <% _.each(model.get("config"), function(value, key) { %>\n        <tr>\n            <td style="border-left:none; width:50%;"><%- key%></td>\n            <td><%- value%></td>\n        </tr>\n        <% }); %>\n        </tbody>\n    </table>\n    \n    <p>\n    <i>Additional configuration may be inherited or defined in properties.</i>\n    <p>\n    <i>This item is not editable.</i>\n<% } %>\n\n</div>\n'}),define("text!tpl/catalog/add-catalog-entry.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div class="catalog-details">\n\n    <h2>Add to Catalog</h2>\n    <br/>\n\n    <div data-toggle="buttons-radio">\n        <button class="btn btn-large show-context" data-context="yaml">YAML</button>\n        <button class="btn btn-large show-context" data-context="location">Location</button>\n    </div>\n\n    <hr/>\n\n    <div id="catalog-add-form">\n        <div class="context">Select the type you wish to add</div>\n    </div>\n</div>\n'}),define("text!tpl/catalog/add-yaml.html",[],function(){return"<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n\"License\"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<form>\n    <label for=\"new-blueprint\">Enter blueprint:</label>\n    <textarea id='new-blueprint' name='yaml' rows='5' cols='15'></textarea>\n\n    <button class='catalog-submit-button btn' data-loading-text='Saving...'>Submit</button>\n    <p class=\"catalog-save-error hide\">\n        <span class=\"alert-error\">\n            <span class=\"catalog-error-message\"><strong>Error</strong></span>\n        </span>\n    </p>\n</form>\n"}),define("text!tpl/catalog/add-location.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<form>\n    <label for="name" class="control-label">Name</label>\n    <input id="name" name="name" type="text" placeholder="e.g. My Cloud Region #3" class="input-xlarge">\n\n    <label for="spec" class="control-label">Spec</label>\n    <input id="spec" name="spec" type="text" placeholder="e.g. jclouds:cloud:region" class="input-xlarge">\n\n    <h4>Configuration</h4>\n    <div id="new-location-config"></div>\n\n    <button class=\'catalog-submit-button btn\' data-loading-text=\'Saving...\'>Submit</button>\n\n    <p class="catalog-save-error hide">\n        <span class="alert-error">\n            <span class="catalog-error-message"><strong>Error</strong></span>\n        </span>\n    </p>\n</form>\n'}),define("text!tpl/catalog/nav-entry.html",[],function(){return'<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n<div data-cid="<%= cid %>" class="accordion-nav-row <%= extraClasses %> <%= isChild ? \'accordion-nav-child\' : \'\' %>"><%- type %></div>\n'}),function(e){function n(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}function r(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length===0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!==undefined)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function i(){if(!e.fn.ajaxSubmit.debug)return;var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined,t.formdata=window.FormData!==undefined,e.fn.ajaxSubmit=function(n){function x(t){var r=new FormData;for(var i=0;i<t.length;i++)r.append(t[i].name,t[i].value);if(n.extraData)for(var s in n.extraData)n.extraData.hasOwnProperty(s)&&r.append(s,n.extraData[s]);n.data=null;var o=e.extend(!0,{},e.ajaxSettings,n,{contentType:!1,processData:!1,cache:!1,type:"POST"});n.uploadProgress&&(o.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var t=0,r=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(r/i*100)),n.uploadProgress(e,r,i,t)}),e}),o.data=null;var u=o.beforeSend;o.beforeSend=function(e,t){t.data=r,u&&u.call(t,e,n)},e.ajax(o)}function T(t){function x(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function C(){function o(){try{var e=x(d).readyState;i("state = "+e),e&&e.toLowerCase()=="uninitialized"&&setTimeout(o,50)}catch(t){i("Server abort: ",t," (",t.name,")"),M(S),b&&clearTimeout(b),b=undefined}}var t=u.attr("target"),n=u.attr("action");s.setAttribute("target",h),r||s.setAttribute("method","POST"),n!=f.url&&s.setAttribute("action",f.url),!f.skipEncodingOverride&&(!r||/post/i.test(r))&&u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(b=setTimeout(function(){y=!0,M(E)},f.timeout));var a=[];try{if(f.extraData)for(var l in f.extraData)f.extraData.hasOwnProperty(l)&&a.push(e('<input type="hidden" name="'+l+'">').attr("value",f.extraData[l]).appendTo(s)[0]);f.iframeTarget||(p.appendTo("body"),d.attachEvent?d.attachEvent("onload",M):d.addEventListener("load",M,!1)),setTimeout(o,15),s.submit()}finally{s.setAttribute("action",n),t?s.setAttribute("target",t):u.removeAttr("target"),e(a).remove()}}function M(t){if(v.aborted||O)return;try{L=x(d)}catch(n){i("cannot access response document: ",n),t=S}if(t===E&&v){v.abort("timeout");return}if(t==S&&v){v.abort("server abort");return}if(!L||L.location.href==f.iframeSrc)if(!y)return;d.detachEvent?d.detachEvent("onload",M):d.removeEventListener("load",M,!1);var r="success",s;try{if(y)throw"timeout";var o=f.dataType=="xml"||L.XMLDocument||e.isXMLDoc(L);i("isXml="+o);if(!o&&window.opera&&(L.body===null||!L.body.innerHTML)&&--A){i("requeing onLoad callback, DOM not available"),setTimeout(M,250);return}var u=L.body?L.body:L.documentElement;v.responseText=u?u.innerHTML:null,v.responseXML=L.XMLDocument?L.XMLDocument:L,o&&(f.dataType="xml"),v.getResponseHeader=function(e){var t={"content-type":f.dataType};return t[e]},u&&(v.status=Number(u.getAttribute("status"))||v.status,v.statusText=u.getAttribute("statusText")||v.statusText);var a=(f.dataType||"").toLowerCase(),l=/(json|script|text)/.test(a);if(l||f.textarea){var h=L.getElementsByTagName("textarea")[0];if(h)v.responseText=h.value,v.status=Number(h.getAttribute("status"))||v.status,v.statusText=h.getAttribute("statusText")||v.statusText;else if(l){var m=L.getElementsByTagName("pre")[0],g=L.getElementsByTagName("body")[0];m?v.responseText=m.textContent?m.textContent:m.innerText:g&&(v.responseText=g.textContent?g.textContent:g.innerText)}}else a=="xml"&&!v.responseXML&&v.responseText&&(v.responseXML=_(v.responseText));try{k=P(v,a,f)}catch(t){r="parsererror",v.error=s=t||r}}catch(t){i("error caught: ",t),r="error",v.error=s=t||r}v.aborted&&(i("upload aborted"),r=null),v.status&&(r=v.status>=200&&v.status<300||v.status===304?"success":"error"),r==="success"?(f.success&&f.success.call(f.context,k,"success",v),c&&e.event.trigger("ajaxSuccess",[v,f])):r&&(s===undefined&&(s=v.statusText),f.error&&f.error.call(f.context,v,r,s),c&&e.event.trigger("ajaxError",[v,f,s])),c&&e.event.trigger("ajaxComplete",[v,f]),c&&!--e.active&&e.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,v,r),O=!0,f.timeout&&clearTimeout(b),setTimeout(function(){f.iframeTarget||p.remove(),v.responseXML=null},100)}var s=u[0],o,a,f,c,h,p,d,v,m,g,y,b,w=!!e.fn.prop;if(e(":input[name=submit],:input[id=submit]",s).length){alert('Error: Form elements must not have name or id of "submit".');return}if(t)for(a=0;a<l.length;a++)o=e(l[a]),w?o.prop("disabled",!1):o.removeAttr("disabled");f=e.extend(!0,{},e.ajaxSettings,n),f.context=f.context||f,h="jqFormIO"+(new Date).getTime(),f.iframeTarget?(p=e(f.iframeTarget),g=p.attr("name"),g?h=g:p.attr("name",h)):(p=e('<iframe name="'+h+'" src="'+f.iframeSrc+'" />'),p.css({position:"absolute",top:"-1000px",left:"-1000px"})),d=p[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";i("aborting upload... "+n),this.aborted=1,p.attr("src",f.iframeSrc),v.error=n,f.error&&f.error.call(f.context,v,n,t),c&&e.event.trigger("ajaxError",[v,f,n]),f.complete&&f.complete.call(f.context,v,n)}},c=f.global,c&&0===e.active++&&e.event.trigger("ajaxStart"),c&&e.event.trigger("ajaxSend",[v,f]);if(f.beforeSend&&f.beforeSend.call(f.context,v,f)===!1){f.global&&e.active--;return}if(v.aborted)return;m=s.clk,m&&(g=m.name,g&&!m.disabled&&(f.extraData=f.extraData||{},f.extraData[g]=m.value,m.type=="image"&&(f.extraData[g+".x"]=s.clk_x,f.extraData[g+".y"]=s.clk_y)));var E=1,S=2,T=e("meta[name=csrf-token]").attr("content"),N=e("meta[name=csrf-param]").attr("content");N&&T&&(f.extraData=f.extraData||{},f.extraData[N]=T),f.forceSync?C():setTimeout(C,10);var k,L,A=50,O,_=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},D=e.parseJSON||function(e){return window.eval("("+e+")")},P=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=D(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o}}if(!this.length)return i("ajaxSubmit: skipping submit process - no element selected"),this;var r,s,o,u=this;typeof n=="function"&&(n={success:n}),r=this.attr("method"),s=this.attr("action"),o=typeof s=="string"?e.trim(s):"",o=o||window.location.href||"",o&&(o=(o.match(/^([^#]+)/)||[])[1]),n=e.extend(!0,{url:o,success:e.ajaxSettings.success,type:r||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var a={};this.trigger("form-pre-serialize",[this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var f=n.traditional;f===undefined&&(f=e.ajaxSettings.traditional);var l=[],c,h=this.formToArray(n.semantic,l);n.data&&(n.extraData=n.data,c=e.param(n.data,f));if(n.beforeSubmit&&n.beforeSubmit(h,this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[h,this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var p=e.param(h,f);c&&(p=p?p+"&"+c:c),n.type.toUpperCase()=="GET"?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+p,n.data=null):n.data=p;var d=[];n.resetForm&&d.push(function(){u.resetForm()}),n.clearForm&&d.push(function(){u.clearForm(n.includeHidden)});if(!n.dataType&&n.target){var v=n.success||function(){};d.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(v,arguments)})}else n.success&&d.push(n.success);n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=d.length;s<o;s++)d[s].apply(i,[e,t,r||u,u])};var m=e("input:file:enabled[value]",this),g=m.length>0,y="multipart/form-data",b=u.attr("enctype")==y||u.attr("encoding")==y,w=t.fileapi&&t.formdata;i("fileAPI :"+w);var E=(g||b)&&!w;n.iframe!==!1&&(n.iframe||E)?n.closeKeepAlive?e.get(n.closeKeepAlive,function(){T(h)}):T(h):(g||b)&&w?x(h):e.ajax(n);for(var S=0;S<l.length;S++)l[S]=null;return this.trigger("form-submit-notify",[this,n]),this},e.fn.ajaxForm=function(t){t=t||{},t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){var s={s:this.selector,c:this.context};return!e.isReady&&s.s?(i("DOM not ready, queuing ajaxForm"),e(function(){e(s.s,s.c).ajaxForm(t)}),this):(i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return t.delegation?(e(document).off("submit.form-plugin",this.selector,n).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,t,n).on("click.form-plugin",this.selector,t,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",t,n).bind("click.form-plugin",t,r)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(n,r){var i=[];if(this.length===0)return i;var s=this[0],o=n?s.getElementsByTagName("*"):s.elements;if(!o)return i;var u,a,f,l,c,h,p;for(u=0,h=o.length;u<h;u++){c=o[u],f=c.name;if(!f)continue;if(n&&s.clk&&c.type=="image"){!c.disabled&&s.clk==c&&(i.push({name:f,value:e(c).val(),type:c.type}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}));continue}l=e.fieldValue(c,!0);if(l&&l.constructor==Array){r&&r.push(c);for(a=0,p=l.length;a<p;a++)i.push({name:f,value:l[a]})}else if(t.fileapi&&c.type=="file"&&!c.disabled){r&&r.push(c);var d=c.files;if(d.length)for(a=0;a<d.length;a++)i.push({name:f,value:d[a],type:c.type});else i.push({name:f,value:"",type:c.type})}else l!==null&&typeof l!="undefined"&&(r&&r.push(c),i.push({name:f,value:l,type:c.type,required:c.required}))}if(!n&&s.clk){var v=e(s.clk),m=v[0];f=m.name,f&&!m.disabled&&m.type=="image"&&(i.push({name:f,value:v.val()}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||i=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:i=="select"?this.selectedIndex=-1:t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e===undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1}(jQuery),define("jquery-form",["jquery"],function(){}),define("view/catalog",["underscore","jquery","backbone","brooklyn","view/location-wizard","model/location","model/entity","text!tpl/catalog/page.html","text!tpl/catalog/details-entity.html","text!tpl/catalog/details-generic.html","text!tpl/catalog/details-location.html","text!tpl/catalog/add-catalog-entry.html","text!tpl/catalog/add-yaml.html","text!tpl/catalog/add-location.html","text!tpl/catalog/nav-entry.html","bootstrap","jquery-form"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function y(e,t){return(new i({onLocationCreated:function(e,n){t.loadAccordionItem("locations",n.id,!0)},onFinish:function(n,r){t.loadAccordionItem("locations",r.id),e.clearWithHtml("Added: "+r.id+". Loading...")}})).render()}var v,m=n.View.extend({events:{"click .composer":"composeItem","click .delete":"deleteItem"},initialize:function(){e.bindAll(this),this.options.template=e.template(this.options.template||f)},render:function(){return this.options.model?this.renderDetails():this.renderEmpty()},renderEmpty:function(e){return this.$el.html("<div class='catalog-details'><h3>Select an entry on the left</h3>"+(e?e:"")+"</div>"),this},renderDetails:function(){var e=this,n=this.options.model,r=this.options.template,i=function(){var i=this.$(".in").attr("id"),s=t(r({model:n,viewName:e.options.name}));t(s).find("#"+i).addClass("in"),e.$el.html(s),e.delegateEvents()};return this.activeModel=n,i(),n.on("change",function(){e.activeModel.cid===n.cid&&i()}),n.fetch().fail(function(t,r,s){console.log("error loading",n.id,":",s),e.activeModel.cid===n.cid&&(n.error=!0,i())}).always(function(){n.off("change")}),this},composeItem:function(e){this.options.name=="locations"?this.composerEditItem(e,this.options.model.get("catalog")):this.composerDeployItem(e)},composerDeployItem:function(e){n.history.navigate("/v1/editor/app/"+encodeURIComponent(t(e.currentTarget).data("name")),{trigger:!0})},composerEditItem:function(e,t){var r=t.planYaml;r.trim().startsWith("brooklyn.locations:")&&(r=r.replace(/^ *brooklyn.locations:( *\n)+/,""),r="\n"+r.replace(/^( *)(-)( *)/,"$1 $3"));var i="brooklyn.catalog:\n  items:\n  - id: "+t.symbolicName+"\n"+"    # NB: the version may need to be increased\n"+"    version: "+t.version+"\n"+(t.description?"    description: "+t.description+"\n":"")+(t.iconUrl?"    iconUrl: "+t.iconUrl+"\n":"")+"    itemType: location\n"+"    item:\n"+this.prefixAllLines("      ",r);n.history.navigate("/v1/editor/catalog/_/"+encodeURIComponent(i),{trigger:!0})},prefixAllLines:function(e,r){return e+r.split("\n").join("\n"+e)},deleteItem:function(e){var n=this,r=t(e.currentTarget).data("name")||"item";this.activeModel.destroy({success:function(){n.renderEmpty("Deleted "+r)},error:function(e){n.renderEmpty("Unable to permanently delete "+r+". Deletion is temporary, client-side only.")}})}}),g=n.View.extend({template:e.template(c),events:{"click .show-context":"showContext"},initialize:function(){e.bindAll(this)},render:function(e){return this.$el.html(this.template()),e&&(e=="entity"&&(e="yaml"),this.$("[data-context='"+e+"']").addClass("active"),this.showFormForType(e)),this},clearWithHtml:function(e){this.contextView&&this.contextView.close(),this.context=undefined,this.$(".btn").removeClass("active"),this.$("#catalog-add-form").html(e)},beforeClose:function(){this.contextView&&this.contextView.close()},showContext:function(e){var n=t(e.currentTarget),r=n.data("context");this.context!==r&&(this.contextView&&this.contextView.close(),this.showFormForType(r))},showFormForType:function(e){this.context=e,e=="location"?(this.contextView=y(this,this.options.parent),n.history.navigate("/v1/catalog/new/"+e),this.$("#catalog-add-form").html(this.contextView.$el)):n.history.navigate("/v1/editor/catalog/",{trigger:!0})}}),b=n.Collection.extend({modelX:n.Model.extend({url:function(){return"/v1/catalog/"+this.name+"/"+this.id+"?allVersions=true"}}),initialize:function(t,n){this.name=n.name;if(!this.name)throw new Error("Catalog collection must know its name");var r=this,i=this.model.extend({url:function(){return"/v1/catalog/"+r.name+"/"+this.id.split(":").join("/")}});e.bindAll(this),this.model=i},url:function(){return"/v1/catalog/"+this.name+"?allVersions=true"}}),w=n.View.extend({tag:"div",className:"accordion-item",events:{"click .accordion-head":"toggle","click .accordion-nav-row":"showDetails"},bodyTemplate:e.template("<div class='accordion-head capitalized'><%= name %></div><div class='accordion-body' style='display: <%= display %>'></div>"),initialize:function(){e.bindAll(this),this.name=this.options.name;if(!this.name)throw new Error("Name should have been given for accordion entry");if(!this.options.onItemSelected)throw new Error("onItemSelected(model, element) callback should have been given for accordion entry");this.template=e.template(this.options.template||d),this.entryTemplateArgs=this.options.entryTemplateArgs||function(e,t){return{type:e.getVersionedAttr("type"),id:e.get("id")}};var t=this.options.model||n.Model;this.collection=this.options.collection||new b(undefined,{name:this.name,model:t}),this.collection.on("sync",this.renderEntries).on("destroy",this.renderEntries),this.refresh()},beforeClose:function(){this.collection.off()},render:function(){return this.$el.html(this.bodyTemplate({name:this.name,display:this.options.autoOpen?"block":"none"})),this.renderEntries(),this},singleItemTemplater:function(t,n,r){var i=e.extend({cid:n.cid,isChild:t,extraClasses:v==this.name&&n.cid==this.activeCid?"active":""},this.entryTemplateArgs(n));return this.template(i)},renderEntries:function(){var t=this.collection.map(e.partial(this.singleItemTemplater,!1),this);this.updateContent(t.join(""))},updateContent:function(e){this.$(".accordion-body").empty().append(e)},refresh:function(){this.collection.fetch()},showDetails:function(e){var r=t(e.currentTarget),i=r.data("cid");if(v!==this.name||this.activeCid!==i){v=this.name,this.activeCid=i;var s=this.collection.get(i);n.history.navigate("v1/catalog/"+this.name+"/"+s.id),this.options.onItemSelected(v,s,r)}},toggle:function(){var e=this.$(".accordion-body"),t=this.hidden=e.css("display")=="none";t?e.removeClass("hide").slideDown("fast"):e.slideUp("fast")},show:function(){var e=this.$(".accordion-body"),t=this.hidden=e.css("display")=="none";t&&e.removeClass("hide").slideDown("fast")}}),E=w.extend({renderEntries:function(){function i(e){return e[0]}var t=function(e){return e.get("symbolicName")},n=this.collection.groupBy(t),r=e.uniq(this.collection.map(t)),s=e.map(r,function(t){var r=n[t],s=i(r),o=e.reject(r,function(e){return s.id==e.id});return{root:s,children:o}}),o=function(t,n,r){return t.push(this.singleItemTemplater(!1,n.root)),t.concat(e.map(n.children,e.partial(this.singleItemTemplater,!0),this))},u=e.reduce(s,o,[],this);this.updateContent(u.join(""))}}),S=n.View.extend({tagName:"div",className:"container container-fluid",entryTemplate:e.template(d),events:{"click .refresh":"refresh","click #add-new-thing":"createNewThing"},initialize:function(){t(".nav1").removeClass("active"),t(".nav1_catalog").addClass("active"),e.bindAll(this),this.accordion=this.options.accordion||{applications:new E({name:"applications",singular:"application",onItemSelected:e.partial(this.showCatalogItem,a),model:o.Model,autoOpen:!this.options.kind||this.options.kind=="applications"}),entities:new E({name:"entities",singular:"entity",onItemSelected:e.partial(this.showCatalogItem,a),model:o.Model,autoOpen:this.options.kind=="entities"}),policies:new E({onItemSelected:e.partial(this.showCatalogItem,a),name:"policies",singular:"policy",model:o.Model,autoOpen:this.options.kind=="policies"}),locations:new w({name:"locations",singular:"location",onItemSelected:e.partial(this.showCatalogItem,l),collection:this.options.locations,autoOpen:this.options.kind=="locations",entryTemplateArgs:function(e,t){return{type:e.getIdentifierName(),id:e.getLinkByName("self")}}})}},beforeClose:function(){e.invoke(this.accordion,"close")},render:function(){this.$el.html(e.template(u,{}));var t=this.$(".catalog-accordion-parent");return e.each(this.accordion,function(e){t.append(e.render().$el)}),this.options.kind==="new"?this.createNewThing(this.options.id):this.options.kind&&this.options.id?this.loadAccordionItem(this.options.kind,this.options.id):this.setDetailsView((new m).render()),this},refresh:function(){e.invoke(this.accordion,"refresh")},createNewThing:function(t){e.isString(t)||(t=undefined);var r="createNewThing";t||n.history.navigate("/v1/catalog/new"),v=r,this.$(".accordion-nav-row").removeClass("active");var i=(new g({parent:this})).render(t);this.setDetailsView(i)},loadAnyAccordionItem:function(e){this.loadAccordionItem("entities",e),this.loadAccordionItem("applications",e),this.loadAccordionItem("policies",e),this.loadAccordionItem("locations",e)},loadAccordionItem:function(t,r,i){if(!this.accordion[t])console.error("No accordion for: "+t);else{var s=this.accordion[t],o=this;s.collection.fetch({reset:!0}).then(function(){var o=s.collection.get(r);o||r&&r.split(":").length>1&&(o=s.collection.get(r.split(":")[0])),o||r&&r.split(":").length==1&&s.collection.models&&(o=e.find(s.collection.models,function(e){return e&&e.id&&e.id.startsWith(r+":")})),o&&!i&&(n.history.navigate("/v1/catalog/"+t+"/"+r),v=t,s.activeCid=o.cid,s.options.onItemSelected(t,o),s.show())})}},showCatalogItem:function(e,t,n,r){this.$(".accordion-nav-row").removeClass("active"),r?r.addClass("active"):this.$("[data-cid="+n.cid+"]").addClass("active");var i=(new m({model:n,template:e,name:t})).render();this.setDetailsView(i)},setDetailsView:function(e){this.$("#details").html(e.el);if(this.detailsView){var t=this.detailsView.$(".in").attr("id");t&&e.$("#"+t).addClass("in"),this.detailsView.close()}this.detailsView=e}});return S}),define("text!tpl/script/groovy.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div id="groovy-ui-container" class="single-main-container">\n\n    <div style="padding-bottom: 12px;">\n        <div><h3>Groovy Scripting</h3></div>\n    </div>\n\n    <div id="message-bar" class="label-important hide style="padding-bottom: 12px;">\n    </div>\n            \n    \n    <div class="output">\n        <div class="throbber"><img src="/assets/images/throbber.gif"/></div>\n        \n        <div class="toggler-region error">\n            <div class="toggler-header">\n                <div class="toggler-icon icon-chevron-down"></div>\n                <div><b>Error</b></div>\n            </div>\n            <div class="for-textarea"><textarea readonly="readonly" placeholder="no details available" class="code-textarea"></textarea></div>\n        </div>\n            \n        <div class="toggler-region result">\n            <div class="toggler-header">\n                <div class="toggler-icon icon-chevron-down"></div>\n                <div><b>Result</b></div>\n            </div>\n            <div class="for-textarea"><textarea readonly="readonly" placeholder="no details available" class="code-textarea"></textarea></div>\n        </div>\n\n        <div class="toggler-region stdout">\n            <div class="toggler-header">\n                <div class="toggler-icon icon-chevron-down"></div>\n                <div><b>Output (stdout)</b></div>\n            </div>\n            <div class="for-textarea"><textarea readonly="readonly" class="code-textarea"></textarea></div>\n        </div>\n\n        <div class="toggler-region stderr">\n            <div class="toggler-header">\n                <div class="toggler-icon icon-chevron-down"></div>\n                <div><b>Output (stderr)</b></div>\n            </div>\n            <div class="for-textarea"><textarea readonly="readonly" class="code-textarea"></textarea></div>\n        </div>\n    </div>\n\n    <div class="input">\n        <div class="toggler-region">\n            <div class="toggler-header">\n                <div class="toggler-icon icon-chevron-down"></div>\n                <div><b>Instructions</b></div>\n            </div>\n            \n            <div class="groovy-scripting-text">\n                Enter code to run on the Brooklyn Server.\n                <p><ul>\n                <li><code>mgmt</code> is the management context</li>\n                <li><code>last</code> is the result of your last successful script</li>\n                <li><code>data</code> is user-session map for storing your data</li>\n                </ul><p>\n                <a id="load-example">Click to load an example.</a>\n            </div>\n        </div>\n        \n        <div class="toggler-region for-textarea">\n            <textarea id="script" placeholder="Enter script here" class="code-textarea"></textarea>\n        </div>\n        <div class="submit">\n            <button id="submit" class="btn btn-info btn-mini">Submit</button>\n        </div>\n    </div>\n\n</div>\n'}),define("view/script-groovy",["underscore","jquery","backbone","view/viewutils","text!tpl/script/groovy.html","jquery-slideto","jquery-wiggle","jquery-ba-bbq","handlebars","bootstrap"],function(e,t,n,r,i){var s=n.View.extend({tagName:"div",events:{"click #groovy-ui-container #submit":"submitScript","click #load-example":"loadExample"},className:"container container-fluid",groovyTemplate:e.template(i),initialize:function(){this.reset()},reset:function(){this.$el.html(e.template(i,{})),t(".output",this.$el).hide(),t(".output .toggler-region",this.$el).hide(),r.attachToggler(this.$el)},render:function(e){return this},loadExample:function(){t(".input textarea").val('import static org.apache.brooklyn.entity.software.base.Entities.*\n\nprintln "Last result: "+last\ndata.exampleRunCount = (data.exampleRunCount ?: 0) + 1\nprintln "Example run count: ${data.exampleRunCount}"\n\nprintln "Application count: ${mgmt.applications.size()}\\n"\n\nmgmt.applications.each { dumpInfo(it) }\n\nreturn mgmt.applications\n')},updateTextareaWithData:function(e,t,n){r.updateTextareaWithData(e,t,n,50,350)},submitScript:function(){var e=this,n=t("#groovy-ui-container #script").val();t(".output .toggler-region",this.$el).hide(),t(".output .throbber",this.$el).show(),t(".output",this.$el).show(),e.updateTextareaWithData(t(".output .result"),undefined,!1,!1),e.updateTextareaWithData(t(".output .error"),undefined,!1,!1),e.updateTextareaWithData(t(".output .stdout"),undefined,!1,!1),e.updateTextareaWithData(t(".output .stderr"),undefined,!1,!1),t.ajax({type:"POST",url:"/v1/script/groovy",data:n,contentType:"application/text",headers:{"Brooklyn-Allow-Non-Master-Access":!0},success:function(n){t(".output .throbber",e.$el).hide(),e.updateTextareaWithData(t(".output .result"),n.result,!0,!0),e.updateTextareaWithData(t(".output .error"),n.problem,!1,!0),e.updateTextareaWithData(t(".output .stdout"),n.stdout,!1,!0),e.updateTextareaWithData(t(".output .stderr"),n.stderr,!1,!0)},error:function(n){t(".output .throbber",e.$el).hide(),t("#groovy-ui-container div.error").val("ERROR: "+n),t(".output .error").show(),console.error("ERROR submitting groovy script"),console.debug(n)}})}});return s}),define("text!tpl/help/page.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- Help page -->\n<div class="container container-fluid single-main-container brooklyn-help-page">\n<div id="help-page">\n    <div class="help-logo-right"><img width="450" src="/assets/img/bridge.png"/></div>\n    <h3>Brooklyn Help</h3>\n    \n    <p>This is the Brooklyn JavaScript web client for the REST API.<br/>\n    Brooklyn is an Apache-licensed open-source project for deployment and management.\n    </p>\n    \n    <p>You are currently using Brooklyn Version 0.9.0.</p> <!-- BROOKLYN_VERSION -->\n    \n    <hr/>\n    Some useful references include:\n    <ul>\n        <li><a href="http://brooklyn.io">Brooklyn Project web page</a></li>\n        <li><a href="http://github.com/brooklyncentral/brooklyn">Code at Github</a></li>\n    </ul>\n    <p>\n    Note you can observe the REST requests made by the Javascript GUI \n    through the developers console in many browsers.\n    <hr/>\n    Some miscellaneous Brooklyn control options are:\n    <ul>\n        <li><a href="/logout">Log out</a></li>\n        <li>Shutdown Brooklyn Server: <a href="javascript:postShutdown(true)">stop all apps</a> or <a href="javascript:postShutdown(false)">leave apps running</a></li>\n        <script type="text/javascript">\n        function postShutdown(stopAppsFirst) {\n          if (window.confirm("Really shutdown the Brooklyn server?")) {\n            $.ajax({\n                type:"POST",\n                url:"/v1/server/shutdown",\n                data: { stopAppsFirst: stopAppsFirst, shutdownTimeout: 0, requestTimeout: 0 },\n                success:function (data) {\n                    // unfaded if server restarted, in router.js ServerCautionOverlay\n                    $(\'#application-content\').fadeTo(500,0.1);\n                },\n                error: function(data) {\n                    $(\'#application-content\')\n                        .fadeTo(200,0.2)\n                        .delay(200).fadeTo(200,1)\n                        .delay(200).fadeTo(100,0.2)\n                        .delay(200).fadeTo(200,1)\n//                      .delay(200).fadeTo(100,0.2)\n//                      .delay(200).fadeTo(200,1)\n                    // TODO render the error better than poor-man\'s flashing\n                    \n                    console.error("ERROR shutting down")\n                    console.debug(data)\n                }})\n          }\n        }\n        </script>\n    </ul> \n    (These are living here until a more appropriate home for them is built.)\n</div>\n</div>\n'}),define("text!tpl/labs/page.html",[],function(){return"\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n\"License\"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<!-- labs page : this is not included in the menu, but by entering the url\n     http://localhost:8081/#/labs\n     this page will load, showing colours and doing other experiments -->\n<div class=\"container container-fluid single-main-container brooklyn-labs-page\">\n<div id=\"labs-page\">\n\n<!--  -->\n<!-- demo the colour themese we use -->\n\n<h1>Colours</h1><br/>\n\n<style media=\"screen\" type=\"text/css\">\n.swatch {\n    padding: 10px 10px 10px 5px;\n    margin: 10px 5px;\n    display: inline-block;\n    border: 2px solid #A0A0A0;\n}\n</style>\n\n<script>\nvar swatch = function(bg, fg, bo) {\n    var bgR = bg ? bg : '#808080';\n    var fgR = fg ? fg : '#202020';\n    var boR = bo ? bo : '#A0A0A0';\n     $('#swatches').append('<div class=\"swatch\" style=\"background-color: '+bgR+'; color: '+fgR+'; border: 2px solid '+boR+';\">'\n    +'<div>'+(bg ? 'bg:'+bg : '&nbsp;')+'</div>'\n    +'<div>'+(fg ? 'fg:'+fg : '&nbsp;')+'</div>'\n    +'<div>'+(bo ? 'bo:'+bo : '&nbsp;')+'</div>'\n    +'</div>');\n}\n\n$(document).ready(function() {\n    // display standard color themese we use for easy reference\n    var colors = [\n           // border colors\n           //'#EEE', '#CCC', '#793',\n           // text colors\n           //'#F0F4E8'\n           // background colors\n           //'#A8B8B0', '#e0f0e0', '#e0e8e0', \n           ];\n    \n    swatch('#492')\n    swatch('#58AA33')\n    swatch('#77AA3E')\n    swatch('#98B890')  // selected alt\n    swatch('#A8B8B0')  // paging numbers\n    swatch('#A8B8B0', null, '#CCC')\n    swatch('#A8B8B0', null, '#EEE')\n    swatch('#B8C8B0')  // selected\n    swatch('#d0d8d0') // app content\n    swatch('#D8E0D4') // opened row\n    swatch('#d8e4d0') // table body\n    swatch('#E0E4E0')  // table row hover, table header\n    swatch('#e8e8e8') // app content\n    swatch('#f0f4f0') // app content\n    swatch('#F9F9F9')  // table odd\n    swatch('#FFFFFF')  // table even\n    swatch('#261', '#F0F4E8', null)\n    swatch(null, '#182018') // tree node\n    swatch(null, '#382')    // links\n    swatch(null, '#65AA34') // hover for above\n    swatch(null, '#273')\n    swatch('#f9f9f9', null, '#d4d4d4')  // tabs\n    swatch('#f9f9f9', '#505050', '#a1cb8c')  // add app\n    swatch('#f9f9f9', '#58a82e', '#58a82e')  // add app hover\n\n\n\n    for (c in colors) {\n//        $('#swatches').append('<div class=\"swatch\" style=\"background-color: '+colors[c]+';\">'+colors[c]+'</div>');\n    }\n})\n</script>\n\n<div id=\"swatches\">\n</div>\n\n\n<br/><br/>\n<h1>Icons</h1><br/>\n\n<div><b>Glyphs</b></div><br/>\n<img src=\"/assets/img/glyphicons-halflings.png\"/>\n\n\n<br/><br/>\n<h1>Experimental Config</h1><br/>\n\n<br/><br/>\n<div><b>Refresh pages (globally in JS)</b></div><br/>\n\n<script>\nvar updateGlobalRefreshDisplay = function() {\n    require([\"brooklyn\"], function(b) {\n        $('#globalRefresh').html(''+b.refresh)\n    })    \n}\n\nvar toggleGlobalRefresh = function() {\n  require([\"brooklyn\"], function(b) {\n      b.toggleRefresh();\n      updateGlobalRefreshDisplay();\n  })    \n}\n\n$(document).ready(function() {\n    updateGlobalRefreshDisplay()\n})\n</script>\n\nBrooklyn Global Auto Refresh is: <b><span id=\"globalRefresh\">?</span>\n<span onclick=\"javascript:toggleGlobalRefresh()\"><i>[change]</i></span></b>\n<br/><span><i>(this setting controls whether things do auto refresh;\ndisabling globally can be helpful when testing)</i></span>\n\n\n\n\n<br/><br/>\n<h1>Debug</h1><br/>\n\n\n<br/><br/>\n<div><b>Fade Practice</b></div><br/>\n\n<script>\nvar fadeHello = function() {\n    require([\"view/viewutils\"], function(v) {\n        log('fading')\n        v.fadeToIndicateInitialLoad($('#hello'))\n    })    \n}\nvar showHello = function() {\n    require([\"view/viewutils\"], function(v) {\n        log('unfading')\n        v.cancelFadeOnceLoaded($('#hello'))\n    })    \n}\n</script>\n<div id=\"hello\">I'm a region which fades.</div>\n<div><span onclick=\"javascript:fadeHello()\">fade</span>  <span onclick=\"javascript:showHello()\">show</span></div>\n\n\n\n<br/><br/>\n<div><b>Ajax Practice</b></div><br/>\n\n        <script type=\"text/javascript\">\n        function fetchSummat() {\n            log(\"fetching\")\n            $.ajax({\n                type:\"GET\",\n                url:\"/v1/applications/dI6fIDvw/entities/dI6fIDvw/sensors/service.state\",\n                success:function (data) {\n                    log(\"fetch success - \"+data)\n                    var a = data;\n                    log(typeof a)\n                    log(a)\n                },\n                error: function(data) {\n                    log(\"fetch fail\")\n                }})\n        }\n        </script>\n\n<div>\n    <span onclick=\"javascript:fetchSummat()\">fetch</span>\n</div>\n\n\n\n</div>\n</div>\n"}),define("text!tpl/home/server-caution.html",[],function(){return'\n<!--\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing,\nsoftware distributed under the License is distributed on an\n"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, either express or implied.  See the License for the\nspecific language governing permissions and limitations\nunder the License.\n-->\n\n<div class="server-caution-overlay overlay-with-opacity"></div>\n<div class="server-caution-overlay">\n    <div class="overlay-content">\n        <h1 class="lead">Warning!</h1>\n\n<% if (!loaded) { %>\n        <p><strong>\n            Connecting to server...</strong></p>\n\n        <p>\n            No response from server (yet). \n            Please check your network connection and the URL, or if you are on a slow connection simply be patient!\n            This dialog will disappear if and when the server responds.</p>\n        \n        <p><i>\n            If you understand the risks, that information may be unavailable and operations may fail, \n            and wish to proceed regardless, click <a id="dismiss-standby-warning">here</a>.</i></p>\n\n<% } else if (shuttingDown) { %>\n        <p><strong>\n            Server shutting down...</strong></p>\n                    \n        <p>\n            The Brooklyn server is shutting down.\n            This dialog will disappear if and when the server is restarted at this address.\n            If in doubt, contact your system administrator.</p>\n        \n        <p><i>\n            If you understand the risks, that information may be unavailable and operations may fail, \n            and wish to proceed regardless, click <a id="dismiss-standby-warning">here</a>.</i></p>\n\n<% } else if (!up) { %>\n            <div style="float: right; position: relative; top: -45px; height: 0; overflow: visible;">\n                <img src="/assets/img/icon-status-starting.gif" width="60"/></div>\n            \n        <p><strong>\n            Starting up...</strong></p>\n                    \n        <p>\n            The Brooklyn server is starting.\n            It is recommended to wait before proceeding.\n            This dialog will disappear when the server is ready.</p>\n        \n        <p><i>\n            If you understand the risks, that information may be incomplete and operations may fail, \n            and wish to proceed regardless, click <a id="dismiss-standby-warning">here</a>.</i></p>\n\n<% } else if (healthy && !master) { %>\n        <p><strong>\n            This Brooklyn server is not the high availability master.</strong></p>\n        \n        <p>\n            It is recommended not to use this server directly.</p>\n            \n    <% if (masterUri) { %>\n        <p>Redirecting to the master server at <a href="<%= masterUri %>"><%= masterUri %></a> shortly.</p>\n    <% } else { %>\n        <p>The address of the master Brooklyn server is not currently known.</p>\n    <% } %>\n\n        <p><i>\n            If you understand the risks, that write operations will likely fail, \n            and wish to proceed regardless, click <a id="dismiss-standby-warning">here</a>.</i></p>\n          \n<% } else { %>\n        <p><strong>\n            This Brooklyn server has errors.</strong></p>\n        \n        <p>\n            Please check with your system administrator.</p>\n\n    <% if (healthy) { /* this page should not be displayed in this case */ %>\n        <p>\n            The misconfiguration may be in Javascript as the server is reporting it is healthy.</p><% } %>\n        \n        <p><i>\n          If you would like to debug the server, click <a id="dismiss-standby-warning">here</a>\n          to dismiss this warning until you reload this page. \n          (You should reload the page once you believe the errors are fixed\n          to confirm that this dialog does not return.)\n          </i></p>\n\n<% } %>\n\n    </div>\n</div>'}),define("router",["brooklyn","underscore","jquery","backbone","model/application","model/app-tree","model/location","model/server-extended-status","view/home","view/editor","view/application-explorer","view/catalog","view/script-groovy","text!tpl/help/page.html","text!tpl/labs/page.html","text!tpl/home/server-caution.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=r.View.extend({template:t.template(v),scheduledRedirect:!1,initialize:function(){var e=this;this.carryOnRegardless=!1,t.bindAll(this),u.addCallback(this.renderAndAddCallback)},renderAndAddCallback:function(){this.renderOnUpdate(),u.addCallback(this.renderAndAddCallback)},renderOnUpdate:function(){var e=this;if(this.carryOnRegardless)return this.renderEmpty();var t={loaded:u.loaded,up:u.isUp(),shuttingDown:u.isShuttingDown(),healthy:u.isHealthy(),master:u.isMaster(),masterUri:u.getMasterUri()};if(t.loaded&&t.up&&t.healthy&&t.master)return this.renderEmpty();this.warningActive=!0,this.$el.html(this.template(t)),n("#application-content").fadeTo(500,.1),this.$el.fadeTo(200,1),n("#dismiss-standby-warning",this.$el).click(function(){e.carryOnRegardless=!0,e.redirectPending&&(log("Cancelling redirect, using this non-master instance"),clearTimeout(e.redirectPending),e.redirectPending=null),e.renderOnUpdate()});if(!t.master&&t.masterUri&&!this.scheduledRedirect&&!this.redirectPending){log("Not master; will redirect shortly to: "+t.masterUri);var i=t.masterUri+"#"+r.history.fragment,s=10;this.scheduledRedirect=!0,log("Redirecting to "+i+" in "+s+" seconds"),this.redirectPending=setTimeout(function(){u.isMaster()?log("Cancelled redirect, this instance is now master"):e.redirectPending?window.location.href=i:log("Cancelled redirect, using this non-master instance")},s*1e3)}return this},renderEmpty:function(){var e=this;return this.warningActive=!1,this.$el.fadeTo(200,.2,function(){e.warningActive||e.$el.empty()}),n("#application-content").fadeTo(200,1),this},beforeClose:function(){this.stopListening()},warnIfNotLoaded:function(){this.loaded||this.renderOnUpdate()}}),g=new m({el:n("#server-caution-overlay").length?n("#server-caution-overlay"):n("#ha-standby-overlay")});g.render();var y=r.Router.extend({routes:{"v1/home/*trail":"homePage","v1/editor(/)(:type)(/)(:typeId)(/:content)":"editorPage","v1/applications/:app/entities/*trail":"applicationsPage","v1/applications/*trail":"applicationsPage","v1/applications":"applicationsPage","v1/locations":"catalogPage","v1/catalog/:kind(/:id)":"catalogPage","v1/catalog":"catalogPage","v1/script/groovy":"scriptGroovyPage","v1/help":"helpPage",labs:"labsPage","*path":"defaultRoute"},showView:function(e,t){return this.currentView&&this.currentView.close(),n(e).html(t.render().el),this.currentView=t,t},defaultRoute:function(){this.homePage("auto")},applications:new i.Collection,appTree:new s.Collection,locations:new o.Collection,homePage:function(e){function i(){r=new a({collection:t.applications,locations:t.locations,cautionOverlay:g,appRouter:t}),n=!t.currentView,t.showView("#application-content",r)}var t=this,n,r;this.applications.fetch({success:function(){i(),(n&&e=="auto"&&t.applications.isEmpty()||e=="add_application")&&u.isMaster()&&r.createApplication()},error:i})},editorPage:function(e,t,r){var i=new f({collection:this.applications,appRouter:this,locations:this.locations,type:e,typeId:t,content:r});this.showView("#application-content",i),n(".nav1").removeClass("active"),n(".nav1_editor").addClass("active")},applicationsPage:function(e,t,n){t===undefined&&(t=e);var r=this;this.appTree.fetch({success:function(){var e=new l({collection:r.appTree,appRouter:r,initialTrail:t});r.showView("#application-content",e),t!==undefined?e.show(t):e.showDefaultSelection()}})},catalogPage:function(e,t){var n=new c({locations:this.locations,appRouter:this,kind:e,id:t});this.showView("#application-content",n)},scriptGroovyPage:function(){this.scriptGroovyResource===undefined&&(this.scriptGroovyResource=new h({})),this.showView("#application-content",this.scriptGroovyResource),n(".nav1").removeClass("active"),n(".nav1_script").addClass("active"),n(".nav1_script_groovy").addClass("active")},helpPage:function(){n("#application-content").html(t.template(p,{})),n(".nav1").removeClass("active"),n(".nav1_help").addClass("active")},labsPage:function(){n("#application-content").html(t.template(d,{})),n(".nav1").removeClass("active")},startBrooklynGui:function(){u.whenUp(function(){r.history.start()}),u.autoUpdate(),t.delay(g.warnIfNotLoaded,2e3)}});return n.ajax({type:"GET",url:"/v1/server/user",dataType:"text"}).done(function(e){e!=null&&n("#user").html(t.escape(e))}),n.ajaxSetup({beforeSend:function(e,t){var n="";n&&t.url.startsWith("/v1")&&(t.url=(n+t.url).replace("//","/"))}}),y}),require.config({waitSeconds:30,baseUrl:"assets/js",paths:{jquery:"libs/jquery",underscore:"libs/underscore",backbone:"libs/backbone",bootstrap:"libs/bootstrap","jquery-form":"libs/jquery.form","jquery-datatables":"libs/jquery.dataTables","jquery-slideto":"util/jquery.slideto","jquery-wiggle":"libs/jquery.wiggle.min","jquery-ba-bbq":"libs/jquery.ba-bbq.min","jquery-easy-autocomplete":"libs/jquery.easy-autocomplete",moment:"libs/moment",handlebars:"libs/handlebars-1.0.rc.1",brooklyn:"util/brooklyn","brooklyn-view":"util/brooklyn-view","brooklyn-utils":"util/brooklyn-utils","datatables-extensions":"util/dataTables.extensions",googlemaps:"view/googlemaps",async:"libs/async",text:"libs/text",uri:"libs/URI",zeroclipboard:"libs/ZeroClipboard","js-yaml":"libs/js-yaml","js-yaml-parser":"util/code-complete/js-yaml-parser","brooklyn-yaml-completion-proposals":"util/code-complete/brooklyn-yaml-completion-proposals",codemirror:"libs/codemirror","codemirror-mode-yaml":"libs/codemirror/mode/yaml/yaml","codemirror-addon-show-hint":"libs/codemirror/addon/hint/show-hint","codemirror-addon-anyword-hint":"libs/codemirror/addon/hint/anyword-hint","codemirror-addon-display-placeholder":"libs/codemirror/addon/display/placeholder",tpl:"../tpl"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},"jquery-datatables":{deps:["jquery"]},"datatables-extensions":{deps:["jquery","jquery-datatables"]},"jquery-form":{deps:["jquery"]},"jquery-slideto":{deps:["jquery"]},"jquery-wiggle":{deps:["jquery"]},"jquery-ba-bbq":{deps:["jquery"]},"jquery-easy-autocomplete":{deps:["jquery"]},handlebars:{deps:["jquery"]},codemirror:{exports:"CodeMirror"},"codemirror-mode-yaml":{deps:["codemirror"]},"codemirror-addon-show-hint":{deps:["codemirror"]},"codemirror-addon-anyword-hint":{deps:["codemirror"]},"codemirror-addon-display-placeholder":{deps:["codemirror"]},bootstrap:{deps:["jquery"]}}}),require(["router"],function(e){(new e).startBrooklynGui()}),define("config",function(){});